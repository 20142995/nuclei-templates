id: CVE-2019-11269

info:
  name: Spring Security OAuth Open Redirect Vulnerability
  author: ProjectDiscoveryAI
  severity: medium
  description: Spring Security OAuth versions 2.3 prior to 2.3.6, 2.2 prior to 2.2.5, 2.1 prior to 2.1.5, and 2.0 prior to 2.0.18, as well as older unsupported versions could be susceptible to an open redirector attack that can leak an authorization code.
  impact: |
    An attacker can redirect users to malicious websites, leading to phishing attacks or further exploitation.
  remediation: |
    Upgrade to a version of Spring Security OAuth that is not affected by CVE-2019-11269.
  reference:
    - http://packetstormsecurity.com/files/153299/Spring-Security-OAuth-2.3-Open-Redirection.html
    - https://www.oracle.com/security-alerts/cpujan2021.html
    - https://github.com/BBB-man/CVE-2019-3778-Spring-Security-OAuth-2.3-Open-Redirection
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:N
    cvss-score: 5.4
    cve-id: CVE-2019-11269
    cwe-id: CWE-601
    epss-score: 0.00203
    epss-percentile: 0.58996
    cpe: cpe:2.3:a:pivotal_software:spring_security_oauth:*:*:*:*:*:*:*:*
  metadata:
    vendor: pivotal_software
    product: spring_security_oauth

http:
  - method: GET
    path:
      - "{{BaseURL}}/oauth/authorize?response_type=code&client_id=your-client-id&scope=read&redirect_uri=https://evil.com"

    matchers:
      - type: word
        words:
          - "Location: https://evil.com"
        part: header
