id: CVE-2019-16394

info:
  name: SPIP Email Enumeration via Password Reset
  author: ProjectDiscoveryAI
  severity: medium
  description: SPIP before 3.1.11 and 3.2 before 3.2.5 provides different error messages from the password-reminder page depending on whether an e-mail address exists, which might help attackers to enumerate subscribers.
  impact: |
    Successful enumeration of valid email addresses can lead to targeted phishing attacks or account takeover.
  remediation: |
    Implement rate limiting or CAPTCHA on password reset functionality to prevent email enumeration.
  reference:
    - https://core.spip.net/issues/4171
    - https://github.com/trungnd51/Silent_CVE_2019_16394
    - https://lists.debian.org/debian-lts-announce/2019/10/msg00038.html
    - https://seclists.org/bugtraq/2019/Sep/40
    - https://usn.ubuntu.com/4536-1/
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
    cve-id: CVE-2019-16394
    cwe-id: CWE-203
    epss-score: 0.00367
    epss-percentile: 0.7327
    cpe: cpe:2.3:a:spip:spip:*:*:*:*:*:*:*:*
  metadata:
    vendor: spip
    product: spip
    shodan-query: html:"spip.php?page=backend"
    fofa-query:
      - app="spip"
      - body="spip.php?page=backend"

http:
  - method: POST
    path:
      - "{{BaseURL}}/spip.php?action=pass"

    body: "email={{email}}"

    headers:
      Content-Type: application/x-www-form-urlencoded
    matchers:
      - type: word
        words:
          - "adresse email n’est pas enregistrée"
          - "un email va vous être envoyé"
        part: body
        condition: or
