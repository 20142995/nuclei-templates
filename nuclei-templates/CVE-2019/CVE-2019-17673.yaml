id: CVE-2019-17673

info:
  name: WordPress Cache Poisoning via JSON GET Requests
  author: ProjectDiscoveryAI
  severity: high
  description: |
    WordPress before 5.2.4 is vulnerable to poisoning of the cache of JSON GET requests because certain requests lack a Vary: Origin header.
  remediation: |
    To mitigate this vulnerability, upgrade WordPress to version 5.2.4 or later. Ensure that the "Vary" header is correctly implemented for the "Origin" requests to prevent cache poisoning.
  reference:
    - https://blog.wpscan.org/wordpress/security/release/2019/10/15/wordpress-524-security-release-breakdown.html

http:
  - method: GET
    path:
      - "{{BaseURL}}/wp-json/wp/v2/posts"

    headers:
      Origin: "{{interactsh-url}}"
      Accept: application/json

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - '"id":'
        part: body

      - type: word
        words:
          - "Vary"
        part: header
