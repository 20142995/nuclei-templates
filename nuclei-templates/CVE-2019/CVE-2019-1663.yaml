id: CVE-2019-1663

info:
  name: Cisco RV Series Routers Remote Code Execution Vulnerability
  author: ProjectDiscoveryAI
  severity: critical
  description: A vulnerability in the web-based management interface of the Cisco RV110W, RV130W, and RV215W routers could allow an unauthenticated, remote attacker to execute arbitrary code on an affected device due to improper validation of user-supplied data.
  impact: |
    Successful exploitation could result in unauthorized access and control of the affected router.
  remediation: |
    Apply the necessary patches provided by Cisco to mitigate the vulnerability (CVE-2019-1663).
  reference:
    - http://packetstormsecurity.com/files/152507/Cisco-RV130W-Routers-Management-Interface-Remote-Command-Execution.html
    - http://packetstormsecurity.com/files/153163/Cisco-RV130W-1.0.3.44-Remote-Stack-Overflow.html
    - http://packetstormsecurity.com/files/154310/Cisco-RV110W-RV130-W-RV215W-Remote-Command-Execution.html
    - https://github.com/StealYourCode/CVE-2019-1663
    - https://github.com/abrumsen/CVE-2019-1663
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2019-1663
    cwe-id: CWE-119,CWE-787
    epss-score: 0.96985
    epss-percentile: 0.99794
    cpe: cpe:2.3:o:cisco:rv110w_firmware:*:*:*:*:*:*:*:*
  metadata:
    vendor: cisco
    product: rv110w_firmware
    shodan-query: http.favicon.hash:"-646322113"
    fofa-query: icon_hash="-646322113"

http:
  - method: POST
    path:
      - "{{BaseURL}}/cgi-bin/config.exp"

    headers:
      Content-Type: "application/x-www-form-urlencoded"

    body: |
      &enc=1&user=cisco&pwd=AAAA...AAAAZZZZ&sel_lang=EN
    matchers:
      - type: word
        words:
          - "Admin login successful: 1"
        part: body
