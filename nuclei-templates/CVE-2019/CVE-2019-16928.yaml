id: CVE-2019-16928

info:
  name: Exim 4.92 - 4.92.2 Remote Code Execution via Heap Overflow
  author: ProjectDiscoveryAI
  severity: critical
  description: |
    Exim 4.92 through 4.92.2 allows remote code execution due to a heap-based buffer overflow in string_vformat using a long EHLO command.
  remediation: |
    Upgrade Exim to a version later than 4.92.2 to mitigate this vulnerability. Review your email server configurations to ensure they do not expose unnecessary network services.
  reference:
    - https://www.openwall.com/lists/oss-security/2019/09/28/1
    - https://bugs.exim.org/show_bug.cgi?id=2449
tcp:
  - inputs:
      - data: "EHLO {{randstr}}\r\n"
    host:
      - "{{Hostname}}"
    port: 25
    read-size: 1024

    matchers-condition: and
    matchers:
      - type: word
        words:
          - "220"
          - "250"
        part: data
