id: CVE-2019-18889

info:
  name: Symfony Cache Component RCE via Deserialization
  author: ProjectDiscoveryAI
  severity: critical
  description: An issue was discovered in Symfony 3.4.0 through 3.4.34, 4.2.0 through 4.2.11, and 4.3.0 through 4.3.7. Serializing certain cache adapter interfaces could result in remote code injection. This is related to symfony/cache.
  impact: |
    Remote attackers can execute arbitrary code on the server.
  remediation: |
    Update Symfony Cache Component to a non-vulnerable version.
  reference:
    - https://github.com/symfony/symfony/releases/tag/v4.3.8
    - https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/UED22BOXTL2SSFMGYKA64ZFHGLLJG3EA/
    - https://symfony.com/blog/symfony-4-3-8-released
    - https://github.com/alex700/phar_deserialization
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2019-18889
    cwe-id: CWE-94
    epss-score: 0.00634
    epss-percentile: 0.79721
    cpe: cpe:2.3:a:sensiolabs:symfony:*:*:*:*:*:*:*:*
  metadata:
    vendor: sensiolabs
    product: symfony
    shodan-query:
      - cpe:"cpe:2.3:a:sensiolabs:symfony"
      - http.html:"symfony profiler"
      - http.title:"index of" "properties.ini"
      - http.title:"index of" "security.yml"
      - http.title:"welcome to symfony"
    fofa-query:
      - body="symfony profiler"
      - title="index of" "properties.ini"
      - title="index of" "security.yml"
      - title="welcome to symfony"
    google-query:
      - intitle:"index of" "properties.ini"
      - intitle:"index of" "security.yml"
      - intitle:"welcome to symfony"

http:
  - method: GET
    path:
      - "{{BaseURL}}/releases/tag/v4.3.8"

    matchers:
      - type: word
        words:
          - "CVE-2019-18889: In Cache, serializing AbstractAdapter and TagAwareAdapter instances is forbidden."
        part: body
