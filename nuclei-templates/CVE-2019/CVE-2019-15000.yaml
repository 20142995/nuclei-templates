id: CVE-2019-15000

info:
  name: Bitbucket Server Arbitrary File Read and Command Execution
  author: ProjectDiscoveryAI
  severity: critical
  description: |
    The commit diff rest endpoint in Bitbucket Server and Data Center allows remote attackers to read the contents of arbitrary files on the system and execute commands by injecting additional arguments into git commands. This affects versions before 5.16.10, 6.0.10, 6.1.8, 6.2.6, 6.3.5, 6.4.3, and 6.5.2.
  impact: |
    High - Remote code execution and sensitive information disclosure.
  remediation: |
    Upgrade Bitbucket Server to a version that is not affected by CVE-2019-15000.
  reference:
    - http://packetstormsecurity.com/files/154610/Bitbucket-Server-Data-Center-Argument-Injection.html
    - https://seclists.org/bugtraq/2019/Sep/43
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2019-15000
    cwe-id: CWE-78
    epss-score: 0.01086
    epss-percentile: 0.84925
    cpe: cpe:2.3:a:atlassian:bitbucket:*:*:*:*:*:*:*:*
  metadata:
    vendor: atlassian
    product: bitbucket
    shodan-query: http.component:"BitBucket"
    fofa-query: body="bitbucket-pipelines.yml"

http:
  - method: GET
    path:
      - "{{BaseURL}}/projects/{{project}}/repos/{{repository}}/compare/diff?targetBranch=develop&sourceBranch=develop%0aInjectedCommandHere"

    matchers:
      - type: word
        words:
          - "specific error or output indicating command execution"
        part: body
