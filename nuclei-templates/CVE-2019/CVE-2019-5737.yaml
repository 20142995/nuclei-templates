id: CVE-2019-5737

info:
  name: Node.js Slow HTTP Headers DoS Vulnerability
  author: ProjectDiscoveryAI
  severity: high
  description: |
    In Node.js including 6.x before 6.17.0, 8.x before 8.15.1, 10.x before 10.15.2, and 11.x before 11.10.1, an attacker can cause a Denial of Service (DoS) by establishing an HTTP or HTTPS connection in keep-alive mode and by sending headers very slowly. This keeps the connection and associated resources alive for a long period of time.
  impact: |
    An attacker can exploit this vulnerability to cause a denial of service (DoS) by sending specially crafted HTTP headers.
  remediation: |
    Update Node.js to a version that includes the fix for CVE-2019-5737.
  reference:
    - http://lists.opensuse.org/opensuse-security-announce/2019-03/msg00041.html
    - http://lists.opensuse.org/opensuse-security-announce/2019-04/msg00046.html
    - http://lists.opensuse.org/opensuse-security-announce/2019-04/msg00059.html
    - https://access.redhat.com/errata/RHSA-2019:1821
    - https://nodejs.org/en/blog/vulnerability/february-2019-security-releases/
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    cvss-score: 7.5
    cve-id: CVE-2019-5737
    cwe-id: CWE-400,CWE-770
    epss-score: 0.01348
    epss-percentile: 0.86704
    cpe: cpe:2.3:a:nodejs:node.js:*:*:*:*:lts:*:*:*
  metadata:
    vendor: nodejs
    product: node.js
    shodan-query: cpe:"cpe:2.3:a:nodejs:node.js"

http:
  - method: GET
    path:
      - "{{BaseURL}}/path"

    headers:
      User-Agent: "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36"
      Connection: "keep-alive"
    matchers:
      - type: dsl
        dsl:
          - "duration>=5"
