id: CVE-2019-17655

info:
  name: FortiOS SSL VPN Cleartext Storage Vulnerability
  author: ProjectDiscoveryAI
  severity: medium
  description: A cleartext storage in a file or on disk (CWE-313) vulnerability in FortiOS SSL VPN 6.2.0 through 6.2.2, 6.0.9 and earlier and FortiProxy 2.0.0, 1.2.9 and earlier may allow an attacker to retrieve a logged-in SSL VPN user's credentials should that attacker be able to read the session file stored on the targeted device's system.
  impact: |
    High impact as it exposes sensitive information to potential attackers.
  remediation: |
    Apply the necessary patches provided by Fortinet to mitigate the vulnerability.
  reference:
    - https://fortiguard.com/psirt/FG-IR-20-224
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
    cve-id: CVE-2019-17655
    cwe-id: CWE-312
    epss-score: 0.00178
    epss-percentile: 0.56099
    cpe: cpe:2.3:o:fortinet:fortios:*:*:*:*:*:*:*:*
  metadata:
    vendor: fortinet
    product: fortios
    shodan-query: http.favicon.hash:945408572
    fofa-query:
      - body="/remote/login" "xxxxxxxx"
      - icon_hash=945408572

http:
  - method: GET
    path:
      - "{{BaseURL}}/path/to/session/file" # Example path, needs to be adjusted based on actual vulnerable endpoint

    matchers:
      - type: word
        words:
          - "username:" # Assuming the session file contains identifiable keywords
          - "password:"
        condition: and
