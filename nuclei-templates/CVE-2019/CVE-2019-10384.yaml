id: CVE-2019-10384

info:
  name: Jenkins CSRF Token Exposure
  author: ProjectDiscoveryAI
  severity: high
  description: Jenkins 2.191 and earlier, LTS 2.176.2 and earlier allowed users to obtain CSRF tokens without an associated web session ID, resulting in CSRF tokens that did not expire and could be used to bypass CSRF protection for the anonymous user.
  impact: |
    An attacker can exploit this vulnerability to perform unauthorized actions on the Jenkins server.
  remediation: |
    Upgrade Jenkins to a version that includes a fix for CVE-2019-10384.
  reference:
    - http://www.openwall.com/lists/oss-security/2019/08/28/4
    - https://access.redhat.com/errata/RHSA-2019:2789
    - https://access.redhat.com/errata/RHSA-2019:3144
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    cvss-score: 8.8
    cve-id: CVE-2019-10384
    cwe-id: CWE-352
    epss-score: 0.00211
    epss-percentile: 0.59814
    cpe: cpe:2.3:a:jenkins:jenkins:*:*:*:*:lts:*:*:*
  metadata:
    vendor: jenkins
    product: jenkins
    shodan-query: http.favicon.hash:81586312
    fofa-query: icon_hash=81586312

http:
  - method: GET
    path:
      - "{{BaseURL}}/crumbIssuer/api/xml?xpath=concat(//crumbRequestField,\":\",//crumb)"

    matchers:
      - type: regex
        regex:
          - "Jenkins-Crumb:[a-zA-Z0-9]{32,}"
        part: body
