id: CVE-2019-18888

info:
  name: Symfony MIME Type Validation Issue
  author: ProjectDiscoveryAI
  severity: high
  description: An issue was discovered in Symfony 2.8.0 through 2.8.50, 3.4.0 through 3.4.34, 4.2.0 through 4.2.11, and 4.3.0 through 4.3.7. If an application passes unvalidated user input as the file for which MIME type validation should occur, then arbitrary arguments are passed to the underlying file command. This is related to symfony/http-foundation (and symfony/mime in 4.3.x).
  impact: |
    Successful exploitation could lead to remote code execution.
  remediation: |
    Upgrade Symfony to version 4.4.1 or higher.
  reference:
    - https://github.com/symfony/symfony/releases/tag/v4.3.8
    - https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/DZNXRVHDQBNZQUCNRVZICPPBFRAUWUJX/
    - https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/UED22BOXTL2SSFMGYKA64ZFHGLLJG3EA/
    - https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/VXEAOEANNIVYANTMOJ42NKSU6BGNBULZ/
    - https://symfony.com/blog/symfony-4-3-8-released
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    cvss-score: 7.5
    cve-id: CVE-2019-18888
    cwe-id: CWE-88
    epss-score: 0.00667
    epss-percentile: 0.80348
    cpe: cpe:2.3:a:sensiolabs:symfony:*:*:*:*:*:*:*:*
  metadata:
    vendor: sensiolabs
    product: symfony
    shodan-query:
      - cpe:"cpe:2.3:a:sensiolabs:symfony"
      - http.html:"symfony profiler"
      - http.title:"index of" "properties.ini"
      - http.title:"index of" "security.yml"
      - http.title:"welcome to symfony"
    fofa-query:
      - body="symfony profiler"
      - title="index of" "properties.ini"
      - title="index of" "security.yml"
      - title="welcome to symfony"
    google-query:
      - intitle:"index of" "properties.ini"
      - intitle:"index of" "security.yml"
      - intitle:"welcome to symfony"

http:
  - method: GET
    path:
      - "{{BaseURL}}/symfony/releases/tag/v4.3.8"

    matchers:
      - type: word
        words:
          - "CVE-2019-18888: In Mime and HttpFoundation, mime-types of files with leading dash are fixed."
        part: body
