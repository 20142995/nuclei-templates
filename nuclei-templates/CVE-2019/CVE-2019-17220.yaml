id: CVE-2019-17220

info:
  name: Rocket.Chat XSS Vulnerability via URL in ![title] Line
  author: ProjectDiscoveryAI
  severity: medium
  description: Rocket.Chat before 2.1.0 allows XSS via a URL on a ![title] line.
  impact: |
    Successful exploitation could lead to unauthorized access or data theft.
  remediation: |
    Upgrade Rocket.Chat to the latest version to mitigate the XSS vulnerability.
  reference:
    - http://packetstormsecurity.com/files/154944/Rocket.Chat-2.1.0-Cross-Site-Scripting.html
    - https://github.com/RocketChat/Rocket.Chat/releases
    - https://github.com/ARPSyndicate/cvemon
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2019-17220
    cwe-id: CWE-79
    epss-score: 0.00132
    epss-percentile: 0.49595
    cpe: cpe:2.3:a:rocket.chat:rocket.chat:*:*:*:*:*:*:*:*
  metadata:
    vendor: rocket.chat
    product: rocket.chat
    shodan-query: http.title:"Rocket.Chat"
    fofa-query: title="rocket.chat"
    google-query: intitle:"rocket.chat"
  tags: packetstorm

http:
  - method: GET
    path:
      - "{{BaseURL}}/l33t.php?leet=`{}token`"

    matchers:
      - type: word
        words:
          - "<title>XSS</title>"
        part: body
