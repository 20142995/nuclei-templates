id: CVE-2019-19766

info:
  name: Bitwarden Server KDF Issue
  author: ProjectDiscoveryAI
  severity: high
  description: The Bitwarden server through 1.32.0 has a potentially unwanted KDF, which may not meet security standards as per NIST and OWASP guidelines.
  impact: |
    Successful exploitation could lead to unauthorized access to sensitive information.
  remediation: |
    Upgrade Bitwarden Server to a version that includes a fix for CVE-2019-19766.
  reference:
    - https://github.com/bitwarden/jslib/issues/52
    - https://github.com/bitwarden/server/issues/589
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cve-id: CVE-2019-19766
    cwe-id: CWE-916
    epss-score: 0.00149
    epss-percentile: 0.52249
    cpe: cpe:2.3:a:bitwarden:server:*:*:*:*:*:*:*:*
  metadata:
    vendor: bitwarden
    product: server
    shodan-query: title:"icewarp"
    fofa-query: title="gotify"
    google-query: intitle:"gotify"

http:
  - method: GET
    path:
      - "{{BaseURL}}/api/settings"

    matchers:
      - type: word
        words:
          - "erlying PRF is what determines the security of the KDF, not just the number of iterations."
          - "The recommendation to increase the minimum to 10,000 iterations is based on NIST guidelines and OWASP recommendations."
        part: body
        condition: and
