id: CVE-2019-17632

info:
  name: Unescaped Exception Messages in Eclipse Jetty
  author: ProjectDiscoveryAI
  severity: medium
  description: In Eclipse Jetty versions 9.4.21.v20190926, 9.4.22.v20191022, and 9.4.23.v20191118, the generation of default unhandled Error response content does not escape Exception messages in stacktraces included in error output.
  impact: |
    Sensitive information disclosure.
  remediation: |
    Upgrade to Eclipse Jetty version 9.4.24.v20191120 or later.
  reference:
    - https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/SAITZ27GKPD2CCNHGT2VBT4VWIBUJJNS/
    - https://www.oracle.com/security-alerts/cpuApr2021.html
    - https://www.oracle.com/security-alerts/cpuoct2020.html
    - https://github.com/Anonymous-Phunter/PHunter
    - https://github.com/CGCL-codes/LibHunter
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2019-17632
    cwe-id: CWE-79
    epss-score: 0.00132
    epss-percentile: 0.49591
    cpe: cpe:2.3:a:eclipse:jetty:9.4.21:20190926:*:*:*:*:*:*
  metadata:
    vendor: eclipse
    product: jetty
    shodan-query:
      - cpe:"cpe:2.3:a:eclipse:jetty"
      - http.html:"contexts known to this"
      - http.title:"powered by jetty"
    fofa-query:
      - body="contexts known to this"
      - title="powered by jetty"
    google-query: intitle:"powered by jetty"

http:
  - method: GET
    path:
      - "{{BaseURL}}/trigger-error"  # Example path that triggers an error

    matchers:
      - type: word
        words:
          - "java.lang.Exception"
          - "at org.eclipse.jetty"
        part: body
        condition: and
