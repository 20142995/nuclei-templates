id: CVE-2019-17567

info:
  name: Apache mod_proxy_wstunnel Security Bypass
  author: ProjectDiscoveryAI
  severity: medium
  description: Apache HTTP Server versions 2.4.6 to 2.4.46 mod_proxy_wstunnel configured on an URL that is not necessarily Upgraded by the origin server was tunneling the whole connection regardless, thus allowing for subsequent requests on the same connection to pass through with no HTTP validation, authentication or authorization possibly configured.
  impact: |
    An attacker can bypass security restrictions
  remediation: |
    Update Apache mod_proxy_wstunnel to the latest version
  reference:
    - http://www.openwall.com/lists/oss-security/2021/06/10/2
    - https://lists.apache.org/thread.html/r7f2b70b621651548f4b6f027552f1dd91705d7111bb5d15cda0a68dd%40%3Cdev.httpd.apache.org%3E
    - https://lists.apache.org/thread.html/r90f693a5c9fb75550ef1412436d5e682a5f845beb427fa6f23419a3c%40%3Cannounce.httpd.apache.org%3E
    - https://lists.debian.org/debian-lts-announce/2024/05/msg00013.html
    - https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/SPBR6WUYBJNACHKE65SPL7TJOHX7RHWD/
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N
    cvss-score: 5.3
    cve-id: CVE-2019-17567
    cwe-id: CWE-444
    epss-score: 0.0028
    epss-percentile: 0.69199
    cpe: cpe:2.3:a:apache:http_server:*:*:*:*:*:*:*:*
  metadata:
    vendor: apache
    product: http_server
    shodan-query: Apache 2.4.49
    fofa-query:
      - title="apache http server test page powered by centos"
      - title="apache+default","apache+http+server+test","apache2+it+works"
      - title="apache2 debian default page:"
      - title="test page for the ssl/tls-aware apache installation on web site"
    google-query:
      - intitle:"apache http server test page powered by centos"
      - intitle:"apache+default","apache+http+server+test","apache2+it+works"
      - intitle:"apache2 debian default page:"
      - intitle:"test page for the ssl/tls-aware apache installation on web site"

http:
  - method: GET
    path:
      - "{{BaseURL}}/somepath"

    matchers:
      - type: word
        words:
          - "specific-error-or-success-indicator"
        part: body
