id: CVE-2019-25145

info:
  name: HTML Injection in WordPress Pirate Forms Plugin
  author: ProjectDiscoveryAI
  severity: high
  description: |
    The Contact Form & SMTP Plugin by PirateForms for WordPress is vulnerable to HTML injection in the 'public/class-pirateforms-public.php' file in versions up to, and including, 2.5.1 due to insufficient input sanitization and output escaping. This allows unauthenticated attackers to inject arbitrary HTML in emails, potentially leading to phishing attacks.
  impact: |
    Allows attackers to inject malicious HTML code into web pages
  remediation: |
    Update WordPress Pirate Forms Plugin to the latest version to mitigate CVE-2019-25145
  reference:
    - https://www.wordfence.com/threat-intel/vulnerabilities/id/9e34c3f6-cc84-4e45-9948-6f7fd5cba8cd?source=cve
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:N
    cvss-score: 7.2
    cve-id: CVE-2019-25145
    cwe-id: CWE-79
    epss-score: 0.00155
    epss-percentile: 0.5298
    cpe: cpe:2.3:a:wpforms:contact_form:*:*:*:*:*:wordpress:*:*
  metadata:
    vendor: wpforms
    product: contact_form
    framework: wordpress
    shodan-query: http.html:"/wp-content/plugins/contact-form-plugin/"
    fofa-query: body=/wp-content/plugins/contact-form-plugin/
    publicwww-query: /wp-content/plugins/contact-form-plugin/

http:
  - method: GET
    path:
      - "{{BaseURL}}/public/class-pirateforms-public.php"

    matchers:
      - type: word
        words:
          - "pirateformsopt_store_ip"
          - "REMOTE_ADDR"
          - "HTTP_X_FORWARDED_FOR"
        part: body
        condition: and
