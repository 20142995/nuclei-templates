id: CVE-2019-7194

info:
  name: QNAP Photo Station External Control of File Name or Path Vulnerability
  author: ProjectDiscoveryAI
  severity: critical
  description: This external control of file name or path vulnerability allows remote attackers to access or modify system files. To fix the vulnerability, QNAP recommend updating Photo Station to their latest versions.
  impact: |
    Arbitrary file upload, path traversal, and potential code execution.
  remediation: |
    Apply the latest security patches provided by QNAP to mitigate CVE-2019-7194.
  reference:
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-7194
    - https://github.com/cycraft-corp/cve-2019-7192-check
    - https://github.com/lnick2023/nicenice
    - https://github.com/qazbnm456/awesome-cve-poc
    - https://github.com/xbl3/awesome-cve-poc_qazbnm456
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2019-7194
    cwe-id: CWE-22
    epss-score: 0.97041
    epss-percentile: 0.9981
    cpe: cpe:2.3:a:qnap:photo_station:*:*:*:*:*:*:*:*
  metadata:
    vendor: qnap
    product: photo_station
    shodan-query: http.title:"Photo Station"
    fofa-query:
      - title="photo station"
      - title="qnap"
    google-query:
      - intitle:"photo station"
      - intitle:"qnap"
  tags: kev

http:
  - method: GET
    path:
      - "{{BaseURL}}/example/vulnerable/path"

    matchers:
      - type: word
        words:
          - "specific error message"
          - "unique output indicating vulnerability"
        condition: or
