id: CVE-2019-15726

info:
  name: GitLab Embedded Media SSRF
  author: ProjectDiscoveryAI
  severity: medium
  description: An issue was discovered in GitLab Community and Enterprise Edition through 12.2.1. Embedded images and media files in markdown could be pointed to an arbitrary server, which would reveal the IP address of clients requesting the file from that server.
  impact: |
    Successful exploitation could lead to unauthorized access to internal systems and sensitive data.
  remediation: |
    Update GitLab to the latest version to mitigate CVE-2019-15726.
  reference:
    - https://gitlab.com/gitlab-org/gitlab-ce/issues/55115
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
    cve-id: CVE-2019-15726
    epss-score: 0.0009
    epss-percentile: 0.40034
    cpe: cpe:2.3:a:gitlab:gitlab:*:*:*:*:community:*:*:*
  metadata:
    vendor: gitlab
    product: gitlab
    shodan-query: http.title:"GitLab"
    fofa-query:
      - body="gitlab enterprise edition"
      - body="gitlab-ci.yml"
      - title="gitlab"
    google-query: intitle:"gitlab"

http:
  - method: GET
    path:
      - "{{BaseURL}}/path-to-markdown-rendering"

    headers:
      User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36
    matchers:
      - type: word
        words:
          - "specific-word-indicating-ssrf"
        part: body
