id: CVE-2019-10910

info:
  name: Symfony Dependency Injection RCE
  author: ProjectDiscoveryAI
  severity: critical
  description: In Symfony before 2.7.51, 2.8.x before 2.8.50, 3.x before 3.4.26, 4.x before 4.1.12, and 4.2.x before 4.2.7, when service ids allow user input, this could allow for SQL Injection and remote code execution. This is related to symfony/dependency-injection.
  impact: |
    Remote attackers can execute arbitrary code on the server.
  remediation: |
    Update Symfony to version 3.4.26, 4.1.12, 4.2.7, or higher.
  reference:
    - https://symfony.com/blog/cve-2019-10910-check-service-ids-are-valid
    - https://www.synology.com/security/advisory/Synology_SA_19_19
    - https://github.com/p1ay8y3ar/cve_monitor
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2019-10910
    cwe-id: CWE-89
    epss-score: 0.02006
    epss-percentile: 0.89351
    cpe: cpe:2.3:a:sensiolabs:symfony:*:*:*:*:*:*:*:*
  metadata:
    vendor: sensiolabs
    product: symfony
    shodan-query:
      - cpe:"cpe:2.3:a:sensiolabs:symfony"
      - http.html:"symfony profiler"
      - http.title:"index of" "properties.ini"
      - http.title:"index of" "security.yml"
      - http.title:"welcome to symfony"
    fofa-query:
      - body="symfony profiler"
      - title="index of" "properties.ini"
      - title="index of" "security.yml"
      - title="welcome to symfony"
    google-query:
      - intitle:"index of" "properties.ini"
      - intitle:"index of" "security.yml"
      - intitle:"welcome to symfony"

http:
  - method: POST
    path:
      - "{{BaseURL}}/vulnerable_endpoint"

    headers:
      Content-Type: application/json

    body: |
      {
        "service_id": "user_input_here"
      }
    matchers:
      - type: status
        status:
          - 500

      - type: word
        words:
          - "Remote code execution vulnerability detected"
        part: body
