id: CVE-2019-17638

info:
  name: Eclipse Jetty Double Release of ByteBuffer Vulnerability
  author: ProjectDiscoveryAI
  severity: critical
  description: |
    In Eclipse Jetty, versions 9.4.27.v20200227 to 9.4.29.v20200521, too large response headers can lead to double release of ByteBuffer, allowing threads to see data from other requests which could contain sensitive data.
  impact: |
    Denial of Service (DoS)
  remediation: |
    Apply the necessary patches provided by Eclipse Jetty to mitigate CVE-2019-17638.
  reference:
    - http://www.openwall.com/lists/oss-security/2020/08/17/1
    - https://lists.apache.org/thread.html/r29073905dc9139d0d7a146595694bf57bb9e35e5ec6aa73eb9c8443a%40%3Ccommits.pulsar.apache.org%3E
    - https://lists.apache.org/thread.html/r378e4cdec15e132575aa1dcb6296ffeff2a896745a8991522e266ad4%40%3Ccommits.pulsar.apache.org%3E
    - https://lists.apache.org/thread.html/r4bdd3f7bb6820a79f9416b6667d718a06d269018619a75ce4b759318%40%3Ccommits.pulsar.apache.org%3E
    - https://lists.apache.org/thread.html/r521168299e023fb075b57afe33d17ff1d09e8a10e0fd8c775ea0e028%40%3Ccommits.pulsar.apache.org%3E
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:L
    cvss-score: 9.4
    cve-id: CVE-2019-17638
    cwe-id: CWE-672
    epss-score: 0.01057
    epss-percentile: 0.84683
    cpe: cpe:2.3:a:eclipse:jetty:9.4.27:20200227:*:*:*:*:*:*
  metadata:
    vendor: eclipse
    product: jetty
    shodan-query:
      - cpe:"cpe:2.3:a:eclipse:jetty"
      - http.html:"contexts known to this"
      - http.title:"powered by jetty"
    fofa-query:
      - body="contexts known to this"
      - title="powered by jetty"
    google-query: intitle:"powered by jetty"

http:
  - method: POST
    path:
      - "{{BaseURL}}/vulnerable_endpoint"

    headers:
      Content-Type: "application/json"

    body: |
      {
        "payload": "exploit_code_here"
      }
    matchers:
      - type: word
        words:
          - "Code executed successfully"
        part: body
