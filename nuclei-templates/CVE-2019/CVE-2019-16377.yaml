id: CVE-2019-16377

info:
  name: Incorrect Access Control in makandra consul gem
  author: ProjectDiscoveryAI
  severity: critical
  description: The makandra consul gem through 1.0.2 for Ruby has Incorrect Access Control, allowing unauthenticated access to certain controller actions.
  impact: |
    An attacker could exploit this vulnerability to gain unauthorized access to sensitive data.
  remediation: |
    Upgrade to a fixed version of makandra consul gem to prevent unauthorized access.
  reference:
    - https://github.com/makandra/consul/issues/49
    - https://rubygems.org/gems/consul
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2019-16377
    epss-score: 0.00639
    epss-percentile: 0.7982
    cpe: cpe:2.3:a:makandra:consul:*:*:*:*:*:ruby:*:*
  metadata:
    vendor: makandra
    product: consul
    framework: ruby
    shodan-query: http.title:"Consul by HashiCorp"
    fofa-query: title="consul by hashicorp"
    google-query: intitle:"consul by hashicorp"

http:
  - method: GET
    path:
      - "{{BaseURL}}/users/index"
      - "{{BaseURL}}/users/show"
      - "{{BaseURL}}/users/edit"
      - "{{BaseURL}}/users/delete"

    matchers:
      - type: status
        status:
          - 200
          - 401
        condition: or
