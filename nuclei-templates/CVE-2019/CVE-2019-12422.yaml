id: CVE-2019-12422

info:
  name: Apache Shiro Padding Attack Vulnerability
  author: ProjectDiscoveryAI
  severity: high
  description: Apache Shiro before 1.4.2, when using the default "remember me" configuration, cookies could be susceptible to a padding attack.
  impact: |
    Successful exploitation could lead to unauthorized access to sensitive data.
  remediation: |
    Upgrade Apache Shiro to version 1.4.2 or later to mitigate CVE-2019-12422.
  reference:
    - https://lists.apache.org/thread.html/c9db14cfebfb8e74205884ed2bf2e2b30790ce24b7dde9191c82572c%40%3Cdev.shiro.apache.org%3E
    - https://lists.apache.org/thread.html/r2d2612c034ab21a3a19d2132d47d3e4aa70105008dd58af62b653040%40%3Ccommits.shiro.apache.org%3E
    - https://github.com/being1943/my_rss_reader
    - https://github.com/pen4uin/awesome-vulnerability-research
    - https://github.com/pen4uin/vulnerability-research
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    cvss-score: 7.5
    cve-id: CVE-2019-12422
    epss-score: 0.0022
    epss-percentile: 0.60766
    cpe: cpe:2.3:a:apache:shiro:*:*:*:*:*:*:*:*
  metadata:
    vendor: apache
    product: shiro
    shodan-query: http.title:"apache shiro quickstart"
    fofa-query: title="apache shiro quickstart"
    google-query: intitle:"apache shiro quickstart"

http:
  - method: GET
    path:
      - "{{BaseURL}}/login"

    headers:
      Cookie: "rememberMe=base64_encoded_payload_here"
    matchers:
      - type: word
        words:
          - "Invalid rememberMe cookie"
        part: body
