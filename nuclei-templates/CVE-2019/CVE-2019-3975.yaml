id: CVE-2019-3975

info:
  name: Advantech WebAccess/SCADA Stack Buffer Overflow
  author: ProjectDiscoveryAI
  severity: critical
  description: Stack-based buffer overflow in Advantech WebAccess/SCADA 8.4.1 allows remote code execution via crafted IOCTL 70603 RPC message.
  reference:
    - https://www.tenable.com/security/research/tra-2019-41
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2019-3975
    cwe-id: CWE-787
    epss-score: 0.02105
    epss-percentile: 0.89585
    cpe: cpe:2.3:a:advantech:webaccess:8.4.1:*:*:*:*:*:*:*
  metadata:
    vendor: advantech
    product: webaccess
  impact: |
    Successful exploitation could result in remote code execution and compromise of the affected system.
  remediation: |
    Apply the necessary patch provided by Advantech to mitigate the CVE-2019-3975 vulnerability.
network:
  - inputs:
      - data: "{{base64('USER:LONGPASSWORDTHATTRIGGERSOVERFLOW')}}"
    host:
      - "{{Hostname}}"
    port: 4592  # Hypothetical port for RPC service
    read-size: 1024

    matchers:
      - type: word
        words:
          - "ERROR"
          - "Exception"
        part: data