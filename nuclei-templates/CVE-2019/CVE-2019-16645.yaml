id: CVE-2019-16645

info:
  name: GoAhead Web Server Host Header Injection
  author: ProjectDiscoveryAI
  severity: high
  description: An issue was discovered in Embedthis GoAhead 2.5.0 where certain pages create links containing a hostname obtained from an arbitrary HTTP Host header sent by an attacker.
  impact: |
    An attacker can manipulate the Host header to perform various attacks, such as cache poisoning, phishing, and session fixation.
  remediation: |
    Update the GoAhead Web Server to a version that has patched the CVE-2019-16645 vulnerability.
  reference:
    - http://packetstormsecurity.com/files/154652/GoAhead-2.5.0-Host-Header-Injection.html
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:H/A:N
    cvss-score: 8.6
    cve-id: CVE-2019-16645
    cwe-id: CWE-94
    epss-score: 0.01175
    epss-percentile: 0.85608
    cpe: cpe:2.3:a:embedthis:goahead:2.5.0:*:*:*:*:*:*:*
  metadata:
    vendor: embedthis
    product: goahead
    shodan-query: cpe:"cpe:2.3:a:embedthis:goahead"

http:
  - method: POST
    path:
      - "{{BaseURL}}/goform/login"

    headers:
      Content-Type: "application/x-www-form-urlencoded"

    body: "username=admin&password=admin&language=english"
    matchers:
      - type: word
        words:
          - "This document has moved to a new <a href=\"https://myevilwebsite.com/login.asp\">location</a>."
        part: body

  - method: POST
    path:
      - "{{BaseURL}}/config/log_off_page.htm"

    headers:
      Content-Type: "application/x-www-form-urlencoded"

    body: |
      restoreUrl=&errorCollector=&ModuleTable=OK&rlPhdModuleTable%24VT=OK&rlPhdModuleStackUnit%24VT=Type%3D0%3BAccess%3D1%3BNumOfEnumerations%3D0%3BRange0%3D%5B-2147483648%2C2147483647%5D&rlPhdModuleIndex%24VT=Type%3D0%3BAccess%3D1%3BNumOfEnumerations%3D0%3BRange0%3D%5B-2147483648%2C2147483647%5D&rlPhdModuleType%24VT=Type%3D0%3BAccess%3D1%3BNumOfEnumerations%3D0%3BRange0%3D%5B-2147483648%2C2147483647%5D&rlPhdModuleNumberOfPorts%24VT=Type%3D0%3BAccess%3D1%3BNumOfEnumerations%3D0%3BRange0%3D%5B-2147483648%2C2147483647%5D&ModuleTable%24endVT=OK&rlPhdModuleStackUnit%24repeat%3F1=1&rlPhdModuleIndex%24repeat%3F1=1&rlPhdModuleType%24repeat%3F1=47&rlPhdModuleNumberOfPorts%24repeat%3F1=28&ModuleTable%24endRepeat%3F1=OK&userName%24query=%24enab15%24&password%24query=admin&x=0&y=0
    matchers:
      - type: word
        words:
          - "http://google.com:443/config/accessnotallowedpage.htm"
        part: header
