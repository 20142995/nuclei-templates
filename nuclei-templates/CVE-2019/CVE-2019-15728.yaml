id: CVE-2019-15728

info:
  name: GitLab Kubernetes SSRF Vulnerability
  author: ProjectDiscoveryAI
  severity: high
  description: An issue was discovered in GitLab Community and Enterprise Edition 10.1 through 12.2.1. Protections against SSRF attacks on the Kubernetes integration are insufficient, which could have allowed an attacker to request any local network resource accessible from the GitLab server.
  impact: |
    Successful exploitation could lead to unauthorized access to internal systems and services.
  remediation: |
    Apply the necessary patches provided by GitLab to mitigate the SSRF vulnerability (CVE-2019-15728).
  reference:
    - https://gitlab.com/gitlab-org/gitlab-ce/issues/61314
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    cvss-score: 7.5
    cve-id: CVE-2019-15728
    cwe-id: CWE-918
    epss-score: 0.0009
    epss-percentile: 0.40034
    cpe: cpe:2.3:a:gitlab:gitlab:*:*:*:*:community:*:*:*
  metadata:
    vendor: gitlab
    product: gitlab
    shodan-query: http.title:"GitLab"
    fofa-query:
      - body="gitlab enterprise edition"
      - body="gitlab-ci.yml"
      - title="gitlab"
    google-query: intitle:"gitlab"

http:
  - method: GET
    path:
      - "{{BaseURL}}/example_path" # Replace with the actual vulnerable path or parameter

    headers:
      User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36
      X-Forwarded-For: 127.0.0.1
    matchers:
      - type: word
        words:
          - "specific_keyword" # Replace with a keyword that indicates SSRF success
        part: body
