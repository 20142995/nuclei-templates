id: CVE-2019-15727

info:
  name: GitLab Insufficient Permission Check on CI Results
  author: ProjectDiscoveryAI
  severity: medium
  description: An issue was discovered in GitLab Community and Enterprise Edition 11.2 through 12.2.1. Insufficient permission checks were being applied when displaying CI results, potentially exposing some CI metrics data to unauthorized users.
  impact: |
    An attacker can view sensitive CI results and potentially escalate privileges.
  remediation: |
    Upgrade GitLab to a version that includes the fix for CVE-2019-15727.
  reference: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-15727

http:
  - method: GET
    path:
      - "{{BaseURL}}/ci"
      - "{{BaseURL}}/api/v4/jobs"

    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "CI_PIPELINE_ID"
          - "CI_JOB_ID"
        part: body
        condition: or
