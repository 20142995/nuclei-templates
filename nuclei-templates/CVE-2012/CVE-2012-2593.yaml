id: CVE-2012-2593

info:
  name: XSS in Atmail Webmail Server 6.4
  author: ProjectDiscoveryAI
  severity: medium
  description: Cross-site scripting (XSS) vulnerability in the administrative interface in Atmail Webmail Server 6.4 allows remote attackers to inject arbitrary web script or HTML via the Date field of an email.
  impact: |
    Allows attackers to execute malicious scripts in the context of a user's session
  remediation: |
    Upgrade Atmail Webmail Server to a version that addresses CVE-2012-2593
  reference:
    - https://github.com/zer0byte/AWAE-OSWP
    - https://github.com/BLACKHAT-SSG/OSWE-Preparation-
    - https://github.com/MdTauheedAlam/AWAE-OSWE-Notes
    - https://github.com/R0B1NL1N/OSWE
    - https://github.com/mishmashclone/ManhNho-AWAE-OSWE
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2012-2593
    cwe-id: CWE-79
    epss-score: 0.00147
    epss-percentile: 0.5201
    cpe: cpe:2.3:a:atmail:atmail:6.4.0:*:*:*:*:*:*:*
  metadata:
    vendor: atmail
    product: atmail
    shodan-query: http.html:"atmail"
    fofa-query:
      - body="atmail"
      - body="powered by atmail"

http:
  - method: GET
    path:
      - "{{BaseURL}}/index.php/admin/plugins/add/file/QmFja2Rvb3IudGz"
      - "{{BaseURL}}/index.php/admin/plugins/preinstall"

    matchers:
      - type: word
        words:
          - "plugin installed successfully"
          - "preinstall completed"
        part: body
        condition: or
