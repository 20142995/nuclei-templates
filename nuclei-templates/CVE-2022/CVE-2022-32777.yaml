id: CVE-2022-32777

info:
  name: WWBN AVideo Session Cookie HttpOnly and Secure Flag Missing
  author: ProjectDiscoveryAI
  severity: high
  description: An information disclosure vulnerability exists in the cookie functionality of WWBN AVideo 11.6 and dev master commit 3f7c0364. The session cookie and the pass cookie miss the HttpOnly flag, making them accessible via JavaScript. The session cookie also misses the secure flag, which allows the session cookie to be leaked over non-HTTPS connections.
  impact: |
    An attacker could potentially perform session hijacking attacks.
  remediation: |
    Ensure that session cookies in the WWBN AVideo application have the HttpOnly and Secure flags set.
  reference:
    - https://github.com/WWBN/AVideo/blob/e04b1cd7062e16564157a82bae389eedd39fa088/updatedb/updateDb.v12.0.sql
    - https://talosintelligence.com/vulnerability_reports/TALOS-2022-1542
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cve-id: CVE-2022-32777
    cwe-id: CWE-732
    epss-score: 0.00196
    epss-percentile: 0.58289
    cpe: cpe:2.3:a:wwbn:avideo:11.6:*:*:*:*:*:*:*
  metadata:
    vendor: wwbn
    product: avideo
    shodan-query: http.html:"AVideo"
    fofa-query:
      - avideo
      - title="avideo"
    google-query: intitle:"avideo"

http:
  - method: GET
    path:
      - "{{BaseURL}}"

    matchers:
      - type: word
        part: header
        words:
          - "set-cookie"
        condition: and
