id: CVE-2022-22818

info:
  name: Django {% debug %} Template Tag XSS
  author: ProjectDiscoveryAI
  severity: medium
  description: The {% debug %} template tag in Django 2.2 before 2.2.27, 3.2 before 3.2.12, and 4.0 before 4.0.2 does not properly encode the current context, leading to XSS.
  impact: |
    Successful exploitation could lead to cross-site scripting attacks.
  remediation: |
    Upgrade Django to a version that has patched the CVE-2022-22818 vulnerability.
  reference:
    - https://groups.google.com/forum/#%21forum/django-announce
    - https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/B4SQG2EAF4WCI2SLRL6XRDJ3RPK3ZRDV/
    - https://security.netapp.com/advisory/ntap-20220221-0003/
    - https://www.debian.org/security/2022/dsa-5254
    - https://github.com/ARPSyndicate/cvemon
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2022-22818
    cwe-id: CWE-79
    epss-score: 0.00564
    epss-percentile: 0.78438
    cpe: cpe:2.3:a:djangoproject:django:*:*:*:*:*:*:*:*
  metadata:
    vendor: djangoproject
    product: django
    shodan-query:
      - cpe:"cpe:2.3:a:djangoproject:django"
      - cpe:"cpe:2.3:a:djangoproject:django" || http.title:"django administration"
      - http.html:"settings.py"
      - http.title:"the install worked successfully! congratulations!"
    fofa-query:
      - body=settings.py
      - title="the install worked successfully! congratulations!"
    google-query: intitle:"the install worked successfully! congratulations!"

http:
  - method: GET
    path:
      - "{{BaseURL}}"

    matchers:
      - type: word
        words:
          - "Django 2.2 before 2.2.27"
          - "Django 3.2 before 3.2.12"
          - "Django 4.0 before 4.0.2"
        part: body
        condition: or
