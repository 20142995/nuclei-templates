id: CVE-2022-3486

info:
  name: GitLab Open Redirect Vulnerability
  author: ProjectDiscoveryAI
  severity: medium
  description: An open redirect vulnerability in GitLab EE/CE allows an attacker to redirect users to an arbitrary location if they trust the URL. This affects versions from 9.3 prior to 15.3.5, 15.4 prior to 15.4.4, and 15.5 prior to 15.5.2.
  impact: |
    Attackers can trick users into visiting malicious sites by redirecting them from GitLab.
  remediation: |
    Apply the vendor-supplied patch or upgrade to the latest version to mitigate the open redirect vulnerability in GitLab.
  reference:
    - https://gitlab.com/gitlab-org/gitlab/-/issues/377810
    - https://hackerone.com/reports/1725190
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:N/I:L/A:N
    cvss-score: 4.7
    cve-id: CVE-2022-3486
    cwe-id: CWE-601
    epss-score: 0.00089
    epss-percentile: 0.39595
    cpe: cpe:2.3:a:gitlab:gitlab:*:*:*:*:community:*:*:*
  metadata:
    vendor: gitlab
    product: gitlab
    shodan-query: http.title:"GitLab"
    fofa-query:
      - body="gitlab enterprise edition"
      - body="gitlab-ci.yml"
      - title="gitlab"
    google-query: intitle:"gitlab"

http:
  - method: GET
    path:
      - "{{BaseURL}}/users/sign_in?redirect_to=https://evil.com"
      - "{{BaseURL}}/dashboard/projects?return_to=https://evil.com"

    matchers:
      - type: word
        words:
          - "You are being redirected"
        part: body
