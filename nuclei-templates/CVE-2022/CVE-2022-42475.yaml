id: CVE-2022-42475

info:
  name: FortiOS SSL-VPN Heap Overflow Vulnerability
  author: ProjectDiscoveryAI
  severity: critical
  description: A heap-based buffer overflow vulnerability in FortiOS SSL-VPN may allow a remote unauthenticated attacker to execute arbitrary code via specifically crafted requests.
  impact: |
    Successful exploitation could lead to remote code execution or denial of service.
  remediation: |
    Apply the necessary patch provided by Fortinet to mitigate the vulnerability.
  reference:
    - https://github.com/Ostorlab/KEV
    - https://github.com/glkfc/CVE_Reproduce
    - https://github.com/3yujw7njai/CVE-2022-42475-RCE-POC
    - https://github.com/f1tao/awesome-iot-security-resource
    - https://github.com/tadmaddad/fortidig
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-42475
    cwe-id: CWE-197,CWE-787
    epss-score: 0.27418
    epss-percentile: 0.96947
    cpe: cpe:2.3:o:fortinet:fortios:*:*:*:*:*:*:*:*
  metadata:
    vendor: fortinet
    product: fortios
    shodan-query: http.favicon.hash:945408572
    fofa-query:
      - body="/remote/login" "xxxxxxxx"
      - icon_hash=945408572
  tags: kev

http:
  - method: GET
    path:
      - "{{BaseURL}}/research-center?search=<script>alert('XSS')</script>"
      - "{{BaseURL}}/resource-center?search=<script>alert('XSS')</script>"

    matchers:
      - type: word
        words:
          - "<script>alert('XSS')</script>"
        part: body
