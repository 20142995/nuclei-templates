id: CVE-2022-36640

info:
  name: InfluxDB Unauthenticated Command Execution
  author: ProjectDiscoveryAI
  severity: critical
  description: InfluxData InfluxDB before v1.8.10 contains no authentication mechanism or controls, allowing unauthenticated attackers to execute arbitrary commands.
  impact: |
    Remote attackers can execute arbitrary commands on the affected system.
  remediation: |
    Upgrade to a patched version of InfluxDB to prevent unauthenticated command execution.
  reference:
    - http://influxdata.com
    - http://influxdb.com
    - http://www.krsecu.com/CVE/409b5310045bd6b9a984a5fb63bd8786d5c5681a8ad5b1c815c84b2b90002ad7.docx
    - https://www.influxdata.com/
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-36640
    cwe-id: CWE-276
    epss-score: 0.00799
    epss-percentile: 0.82302
    cpe: cpe:2.3:a:influxdata:influxdb:*:*:*:*:*:*:*:*
  metadata:
    vendor: influxdata
    product: influxdb
    shodan-query: http.title:"InfluxDB - Admin Interface"
    fofa-query: title="influxdb - admin interface"
    google-query: intitle:"influxdb - admin interface"

http:
  - method: GET
    path:
      - "{{BaseURL}}/query?db=mydb&q=SELECT%20*%20FROM%20home"

    matchers:
      - type: word
        words:
          - "temperature"
          - "humidity"
        condition: and

  - method: POST
    path:
      - "{{BaseURL}}/write?db=mydb"

    body: "home,room=Living\\ Room temp=22.2,hum=36.4,co=17i"

    headers:
      Content-Type: "application/x-www-form-urlencoded"
    matchers:
      - type: status
        status:
          - 204

  - method: GET
    path:
      - "{{BaseURL}}/query?db=mydb&q=SELECT%20*%20FROM%20home%20WHERE%20time%20%3E%20now()%20-%2010m"

    matchers:
      - type: word
        words:
          - "room"
          - "temp"
        condition: and
