id: CVE-2022-21824

info:
  name: Node.js console.table() Prototype Pollution Vulnerability
  author: ProjectDiscoveryAI
  severity: high
  description: |
    Due to the formatting logic of the "console.table()" function it was not safe to allow user controlled input to be passed to the "properties" parameter while simultaneously passing a plain object with at least one property as the first parameter, which could be "__proto__". The prototype pollution has very limited control, in that it only allows an empty string to be assigned to numerical keys of the object prototype. Node.js >= 12.22.9, >= 14.18.3, >= 16.13.2, and >= 17.3.1 use a null prototype for the object these properties are being assigned to.
  impact: |
    Remote code execution, data manipulation, and potential system compromise.
  remediation: |
    Update to a version of Node.js that has patched the console.table() method to prevent prototype pollution.
  reference:
    - https://hackerone.com/reports/1431042
    - https://lists.debian.org/debian-lts-announce/2022/10/msg00006.html
    - https://security.netapp.com/advisory/ntap-20220325-0007/
    - https://security.netapp.com/advisory/ntap-20220729-0004/
    - https://www.debian.org/security/2022/dsa-5170
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:H
    cvss-score: 8.2
    cve-id: CVE-2022-21824
    cwe-id: CWE-471,CWE-1321
    epss-score: 0.01366
    epss-percentile: 0.86798
    cpe: cpe:2.3:a:nodejs:node.js:*:*:*:*:lts:*:*:*
  metadata:
    vendor: nodejs
    product: node.js
    shodan-query: cpe:"cpe:2.3:a:nodejs:node.js"

http:
  - method: GET
    path:
      - "{{BaseURL}}/path-to-vulnerable-endpoint"

    matchers:
      - type: word
        words:
          - "specific-indicator-of-vulnerability"
        part: body
