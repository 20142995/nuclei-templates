id: CVE-2022-35649

info:
  name: GhostScript Remote Code Execution Vulnerability
  author: ProjectDiscoveryAI
  severity: critical
  description: |
    The vulnerability in Moodle occurs due to improper input validation when parsing PostScript code with GhostScript versions older than 9.50. Successful exploitation may result in complete compromise of the vulnerable system.
  impact: |
    Successful exploitation could allow an attacker to execute arbitrary code on the affected system.
  remediation: |
    Apply the latest security patches provided by the vendor to mitigate the vulnerability (CVE-2022-35649).
  reference:
    - https://bugzilla.redhat.com/show_bug.cgi?id=2106273
    - https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/6MOKYVRNFNAODP2XSMGJ5CRDUZCZKAR3/
    - https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/MTKUSFPSYFINSQFSOHDQIDVE6FWBEU6V/
    - https://github.com/nomi-sec/PoC-in-GitHub
    - https://github.com/ARPSyndicate/cvemon
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-35649
    cwe-id: CWE-94,CWE-20
    epss-score: 0.03028
    epss-percentile: 0.91309
    cpe: cpe:2.3:a:moodle:moodle:*:*:*:*:*:*:*:*
  metadata:
    vendor: moodle
    product: moodle
    shodan-query: title:"Moodle"
    fofa-query:
      - body="moodle"
      - title="installation moodle"
      - title="moodle"
    google-query:
      - intitle:"installation moodle"
      - intitle:"moodle"

http:
  - method: GET
    path:
      - "{{BaseURL}}/path/to/trigger"

    headers:
      User-Agent: "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36"
      Content-Type: "application/x-www-form-urlencoded"
    matchers:
      - type: word
        words:
          - "specific error message or output indicating vulnerability"
        part: body
