id: CVE-2022-22534

info:
  name: SAP NetWeaver Code Injection Vulnerability
  author: ProjectDiscoveryAI
  severity: medium
  description: |
    Due to insufficient encoding of user input, SAP NetWeaver allows an unauthenticated attacker to inject code that may expose sensitive data like user ID and password. These endpoints are normally exposed over the network and successful exploitation can partially impact confidentiality of the application.
  impact: |
    Successful exploitation could lead to remote code execution.
  remediation: |
    Apply the latest security patches provided by SAP to mitigate the vulnerability.
  reference:
    - https://launchpad.support.sap.com/#/notes/3124994
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2022-22534
    cwe-id: CWE-79
    epss-score: 0.0009
    epss-percentile: 0.39903
    cpe: cpe:2.3:a:sap:netweaver:700:*:*:*:*:*:*:*
  metadata:
    vendor: sap
    product: netweaver
    shodan-query: http.favicon.hash:-266008933
    fofa-query: icon_hash=-266008933

http:
  - method: GET
    path:
      - "{{BaseURL}}/endpoint1"
      - "{{BaseURL}}/endpoint2"

    matchers:
      - type: word
        words:
          - "sensitive data exposed"
          - "user ID"
        part: body
        condition: or
