id: CVE-2022-31181

info:
  name: PrestaShop SQL Injection and Eval Vulnerability
  author: ProjectDiscoveryAI
  severity: critical
  description: |
    PrestaShop is subject to an SQL injection vulnerability which can be chained to call PHP's Eval function on attacker input in versions from 1.6.0.10 to before 1.7.8.7. The vulnerability is fixed in version 1.7.8.7.
  impact: |
    Successful exploitation could result in unauthorized access to sensitive data and arbitrary code execution.
  remediation: |
    Apply the latest security patches provided by PrestaShop to mitigate the SQL Injection and Eval vulnerabilities.
  reference:
    - https://github.com/PrestaShop/PrestaShop/releases/tag/1.7.8.7
    - https://github.com/PrestaShop/PrestaShop/security/advisories/GHSA-hrgx-p36p-89q4
    - https://github.com/nomi-sec/PoC-in-GitHub
    - https://github.com/trhacknon/Pocingit
    - https://github.com/zecool/cve
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-31181
    cwe-id: CWE-74,CWE-89
    epss-score: 0.00208
    epss-percentile: 0.59517
    cpe: cpe:2.3:a:prestashop:prestashop:*:*:*:*:*:*:*:*
  metadata:
    vendor: prestashop
    product: prestashop
    shodan-query:
      - cpe:"cpe:2.3:a:prestashop:prestashop"
      - http.component:"prestashop"
      - http.title:"prestashop installation assistant"
    fofa-query: title="prestashop installation assistant"
    google-query: intitle:"prestashop installation assistant"

http:
  - method: GET
    path:
      - "{{BaseURL}}/path/to/vulnerable/endpoint?param=sql_inject_test"

    matchers:
      - type: word
        words:
          - "specific_error_indicator"
        part: body
