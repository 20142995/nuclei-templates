id: CVE-2022-32217

info:
  name: Rocket.Chat Cleartext OAuth Token Leak
  author: ProjectDiscoveryAI
  severity: medium
  description: A cleartext storage of sensitive information exists in Rocket.Chat versions before 4.6.4 due to OAuth token being leaked in plaintext in Rocket.Chat logs.
  impact: |
    High: Attackers can gain unauthorized access to user accounts and sensitive information.
  remediation: |
    Update Rocket.Chat to the latest version to fix the cleartext OAuth token leak vulnerability.
  reference:
    - https://hackerone.com/reports/1394399
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
    cve-id: CVE-2022-32217
    cwe-id: CWE-312,CWE-532
    epss-score: 0.00095
    epss-percentile: 0.41495
    cpe: cpe:2.3:a:rocket.chat:rocket.chat:*:*:*:*:*:*:*:*
  metadata:
    vendor: rocket.chat
    product: rocket.chat
    shodan-query: http.title:"Rocket.Chat"
    fofa-query: title="rocket.chat"
    google-query: intitle:"rocket.chat"
  tags: hackerone

http:
  - method: GET
    path:
      - "{{BaseURL}}/api/v1/logs" # Example path where logs might be accessible

    matchers:
      - type: word
        words:
          - "oauthAccessToken"
        part: body
