id: CVE-2022-25762

info:
  name: Apache Tomcat WebSocket Double Release Vulnerability
  author: ProjectDiscoveryAI
  severity: high
  description: |
    If a web application sends a WebSocket message concurrently with the WebSocket connection closing when running on Apache Tomcat 8.5.0 to 8.5.75 or Apache Tomcat 9.0.0.M1 to 9.0.20, it is possible that the application will continue to use the socket after it has been closed. The error handling triggered in this case could cause the a pooled object to be placed in the pool twice. This could result in subsequent connections using the same object concurrently which could result in data being returned to the wrong use and/or other errors.
  impact: |
    Denial of Service (DoS)
  remediation: |
    Upgrade to Apache Tomcat version 10.0.18 or later.
  reference:
    - https://security.netapp.com/advisory/ntap-20220629-0003/
    - https://github.com/versio-io/product-lifecycle-security-api
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:L/A:L
    cvss-score: 8.6
    cve-id: CVE-2022-25762
    cwe-id: CWE-404
    epss-score: 0.00606
    epss-percentile: 0.79205
    cpe: cpe:2.3:a:apache:tomcat:*:*:*:*:*:*:*:*
  metadata:
    vendor: apache
    product: tomcat
    shodan-query: title:"Apache Tomcat"
    fofa-query:
      - body="apache tomcat"
      - body="jk status manager"
      - title="apache tomcat"
    google-query: intitle:"apache tomcat"

http:
  - method: GET
    path:
      - "{{BaseURL}}/some_endpoint_that_triggers_websocket_usage"

    matchers:
      - type: word
        words:
          - "Unexpected WebSocket closure"
        part: body
