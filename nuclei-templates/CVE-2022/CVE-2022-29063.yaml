id: CVE-2022-29063

info:
  name: Apache OFBiz RMI Deserialization Vulnerability
  author: ProjectDiscoveryAI
  severity: critical
  description: |
    The Solr plugin of Apache OFBiz is configured by default to automatically make a RMI request on localhost, port 1099. In version 18.12.05 and earlier, by hosting a malicious RMI server on localhost, an attacker may exploit this behavior, at server start-up or on a server restart, in order to run arbitrary code.
  impact: |
    Remote code execution leading to potential compromise of the affected system.
  remediation: |
    Apply the official patch provided by Apache OFBiz to mitigate the RMI deserialization vulnerability (CVE-2022-29063).

tcp:
  - inputs:
      - data: "{{base64('rO0ABXNyABdqYXZhLnJtaS5yZWdpc3RyeS5SZWZlcmVuY2VXcmFwcGVy_Stub...')}}"
    host:
      - "localhost"
    port: 1099
    read-size: 1024
    matchers-condition: or
    matchers:
      - type: word
        words:
          - "java.rmi.UnmarshalException"
          - "RemoteException"
        part: data