id: CVE-2022-22274

info:
  name: SonicOS Stack-based Buffer Overflow Vulnerability
  author: ProjectDiscoveryAI
  severity: critical
  description: | 
    A Stack-based buffer overflow vulnerability in the SonicOS via HTTP request allows a remote unauthenticated attacker to cause Denial of Service (DoS) or potentially results in code execution in the firewall.
  reference:
    - https://github.com/BishopFox/CVE-2022-22274_CVE-2023-0656
  remediation: |
    To remediate this vulnerability, it is essential to update SonicOS to the latest version provided by the vendor, which includes patches for this specific issue. Additionally, consider implementing network-level security controls to restrict access to the affected devices and monitor traffic for unusual activities.

http:
  - raw:
      - |
        GET /resources/ HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/json

      - |
        GET // HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/json

      - |
        GET /atp/ HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/json
      
      - |
        GET /stats/ HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/json

      - |
        GET /Security_Services HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/json

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
          - 302
      - type: word
        words:
          - "SonicOS"
          - "firewall"