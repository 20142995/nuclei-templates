id: CVE-2022-45020

info:
  name: Rukovoditel v3.2.1 DOM-based XSS
  author: ProjectDiscoveryAI
  severity: high
  description: Rukovoditel v3.2.1 was discovered to contain a DOM-based cross-site scripting (XSS) vulnerability in the component /rukovoditel/index.php?module=users/login. This vulnerability allows attackers to cause a Denial of Service (DoS) via a crafted GET request.
  impact: |
    Successful exploitation could allow an attacker to execute malicious scripts in the context of a user's browser, leading to potential data theft or account takeover.
  remediation: |
    Upgrade Rukovoditel to version 3.2.2 or later to mitigate the DOM-based XSS vulnerability (CVE-2022-45020).

http:
  - method: GET
    path:
      - "{{BaseURL}}/rukovoditel/index.php?module=users/login"

    headers:
      User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/107.0.5304.63 Safari/537.36
      Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
      Accept-Encoding: gzip, deflate
      Accept-Language: en-US,en;q=0.9
      Cookie: cookie_test=please_accept_for_session; sid=2di7vn24tfnntmif91itsspf79
      Connection: close
    matchers:
      - type: word
        words:
          - "Hello_from_nu11secur1ty"
        part: body
