id: CVE-2022-23305

info:
  name: Log4J JDBCAppender SQL Injection
  author: ProjectDiscoveryAI
  severity: critical
  description: By design, the JDBCAppender in Log4j 1.2.x accepts an SQL statement as a configuration parameter where the values to be inserted are converters from PatternLayout. The message converter, %m, is likely to always be included. This allows attackers to manipulate the SQL by entering crafted strings into input fields or headers of an application that are logged allowing unintended SQL queries to be executed.
  impact: |
    Allows attackers to execute arbitrary SQL commands on the database
  remediation: |
    Update Log4J to a version that is not vulnerable to CVE-2022-23305
  reference:
    - http://www.openwall.com/lists/oss-security/2022/01/18/4
    - https://security.netapp.com/advisory/ntap-20220217-0007/
    - https://github.com/zecool/cve
    - https://github.com/SYRTI/POC_to_review
    - https://github.com/Schnitker/log4j-min
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-23305
    cwe-id: CWE-89
    epss-score: 0.00358
    epss-percentile: 0.72916
    cpe: cpe:2.3:a:apache:log4j:*:*:*:*:*:*:*:*
  metadata:
    vendor: apache
    product: log4j
    fofa-query: app="致远互联-oa"

http:
  - method: GET
    path:
      - "/?param=');insert into logs values(':("

    headers:
      Host: "localhost:8080"
    matchers:
      - type: word
        words:
          - "Injected SQL log entry"
        part: body
