id: CVE-2022-39382

info:
  name: Keystone NODE_ENV Misconfiguration Vulnerability
  author: ProjectDiscoveryAI
  severity: critical
  description: Keystone is a headless CMS for Node.js â€” built with GraphQL and React. Versions @keystone-6/core@3.0.0 || 3.0.1 are vulnerable to NODE_ENV being inlined to "development" for user code, irrespective of the environment variables set.
  impact: |
    Successful exploitation could lead to unauthorized access to sensitive data.
  remediation: |
    Ensure proper configuration of NODE_ENV to prevent unauthorized access.
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-39382
    cwe-id: CWE-74
    epss-score: 0.0024
    epss-percentile: 0.62751
    cpe: cpe:2.3:a:keystonejs:keystone:3.0.0:*:*:*:*:node.js:*:*
  metadata:
    vendor: keystonejs
    product: keystone
    framework: node.js

http:
  - method: GET
    path:
      - "{{BaseURL}}/path-that-uses-node-env"

    matchers:
      - type: word
        words:
          - "this code would unintentionally run in your production builds"
        part: body
