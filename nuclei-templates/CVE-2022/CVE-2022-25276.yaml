id: CVE-2022-25276

info:
  name: Drupal Media oEmbed iframe Domain Validation Vulnerability
  author: ProjectDiscoveryAI
  severity: medium
  description: "The Media oEmbed iframe route in Drupal does not properly validate the iframe domain setting, \nwhich allows embeds to be displayed in the context of the primary domain. This can lead to \ncross-site scripting, leaked cookies, or other vulnerabilities.\n"
  impact: |
    An attacker can embed malicious iframes from any domain, leading to potential XSS attacks.
  remediation: |
    Update to the latest version of Drupal Media module to mitigate the vulnerability.
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2022-25276
    cwe-id: CWE-79
    epss-score: 0.00056
    epss-percentile: 0.2487
    cpe: cpe:2.3:a:drupal:drupal:*:*:*:*:*:*:*:*
  metadata:
    vendor: drupal
    product: drupal
    shodan-query: http.component:"drupal"

http:
  - method: GET
    path:
      - "{{BaseURL}}/path-to-oembed-iframe"

    matchers:
      - type: word
        words:
          - "example of a specific error or message indicating vulnerability"
        part: body
