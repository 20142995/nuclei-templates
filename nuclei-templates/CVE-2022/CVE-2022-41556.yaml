id: CVE-2022-41556

info:
  name: lighttpd Resource Leak Denial of Service
  author: ProjectDiscoveryAI
  severity: high
  description: A resource leak in gw_backend.c in lighttpd 1.4.56 through 1.4.66 could lead to a denial of service (connection-slot exhaustion) after a large amount of anomalous TCP behavior by clients. It is related to RDHUP mishandling in certain HTTP/1.1 chunked situations. Use of mod_fastcgi is, for example, affected. This is fixed in 1.4.67.
  impact: |
    An attacker can exploit this vulnerability to exhaust system resources, leading to denial of service.
  remediation: |
    Upgrade to lighttpd version 1.4.71 or later to mitigate the resource leak DoS vulnerability (CVE-2022-41556).
  reference:
    - https://github.com/lighttpd/lighttpd1.4/pull/115
    - https://git.lighttpd.net/lighttpd/lighttpd1.4/commit/b18de6f9264f914f7bf493abd3b6059343548e50
    - https://github.com/lighttpd/lighttpd1.4/compare/lighttpd-1.4.66...lighttpd-1.4.67
    - https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/OVOSBSCMLGCHH2Z74H64ZWVDFJFQTBC2/
    - https://security.gentoo.org/glsa/202210-12
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    cvss-score: 7.5
    cve-id: CVE-2022-41556
    cwe-id: CWE-401
    epss-score: 0.00241
    epss-percentile: 0.62782
    cpe: cpe:2.3:a:lighttpd:lighttpd:*:*:*:*:*:*:*:*
  metadata:
    vendor: lighttpd
    product: lighttpd
    shodan-query:
      - cpe:"cpe:2.3:a:lighttpd:lighttpd"
      - http.title:"powered by lighttpd"
      - if you find a bug in this lighttpd package, or in lighttpd itself
    fofa-query: title="powered by lighttpd"
    google-query: intitle:"powered by lighttpd"

http:
  - method: GET
    path:
      - "{{BaseURL}}/somepath?test=chunked"

    headers:
      Connection: "keep-alive"
      Transfer-Encoding: "chunked"
    matchers:
      - type: word
        words:
          - "HTTP/1.1 411 Length Required"
          - "HTTP/1.1 500 Internal Server Error"
        part: header
        condition: or
