id: CVE-2022-1209

info:
  name: Ultimate Member <= 2.3.1 - Open Redirect Vulnerability
  author: ProjectDiscoveryAI
  severity: medium
  description: The Ultimate Member plugin for WordPress is vulnerable to arbitrary redirects due to insufficient validation on supplied URLs in the social fields of the Profile Page, which makes it possible for attackers to redirect unsuspecting victims in versions up to, and including, 2.3.1.
  impact: |
    An attacker can craft malicious links to redirect users to malicious websites, leading to phishing attacks or malware infections.
  remediation: |
    Update Ultimate Member plugin to version 2.3.1 or later to mitigate the open redirect vulnerability.
  reference:
    - https://github.com/H4de5-7/vulnerabilities/blob/main/Ultimate%20Member%20%3C%3D%202.3.1%20-%20Open%20Redirect.md
    - https://github.com/ultimatemember/ultimatemember/issues/989
    - https://github.com/ultimatemember/ultimatemember/pull/990
    - https://www.wordfence.com/threat-intel/vulnerabilities/id/d638120b-5396-408b-8273-d003ff9dd01d?source=cve
    - https://www.wordfence.com/vulnerability-advisories/#CVE-2022-1209
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N
    cvss-score: 4.3
    cve-id: CVE-2022-1209
    epss-score: 0.0022
    epss-percentile: 0.60779
    cpe: cpe:2.3:a:ultimatemember:ultimate_member:*:*:*:*:*:wordpress:*:*
  metadata:
    vendor: ultimatemember
    product: ultimate_member
    framework: wordpress
    shodan-query:
      - http.html:"/wp-content/plugins/ultimate-member"
      - http.html:"/wp-content/plugins/ultimate-member/"
    fofa-query:
      - body="/wp-content/plugins/ultimate-member"
      - body=/wp-content/plugins/ultimate-member/
    publicwww-query:
      - /wp-content/plugins/ultimate-member
      - /wp-content/plugins/ultimate-member/
    google-query: inurl:/wp-content/plugins/ultimate-member
    zoomeye-query: app:"wordpress ultimate member plugin"

http:
  - method: GET
    path:
      - "{{BaseURL}}/profile/edit"
      - "{{BaseURL}}/profile/view"

    matchers:
      - type: word
        words:
          - "facebook.com@"
          - "twitter.com@"
          - "linkedin.com@"
          - "instagram.com@"
          - "youtube.com@"
          - "soundcloud.com@"
          - "vkontakte.com@"
        part: body
        condition: or
