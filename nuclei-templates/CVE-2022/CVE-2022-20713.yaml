id: CVE-2022-20713

info:
  name: Cisco ASA and FTD Client-Side Request Smuggling Vulnerability
  author: ProjectDiscoveryAI
  severity: medium
  description: |
    A vulnerability in the VPN web client services component of Cisco Adaptive Security Appliance (ASA) Software and Cisco Firepower Threat Defense (FTD) Software could allow an unauthenticated, remote attacker to conduct browser-based attacks against users of an affected device. This vulnerability is due to improper validation of input that is passed to the VPN web client services component before being returned to the browser that is in use. An attacker could exploit this vulnerability by persuading a user to visit a website that is designed to pass malicious requests to a device that is running Cisco ASA Software or Cisco FTD Software and has web services endpoints supporting VPN features enabled. A successful exploit could allow the attacker to reflect malicious input from the affected device to the browser that is in use and conduct browser-based attacks, including cross-site scripting attacks. The attacker could not directly impact the affected device.
  impact: |
    An attacker could exploit this vulnerability to manipulate client-side requests, potentially leading to unauthorized access or data leakage.
  remediation: |
    Apply the necessary patches provided by Cisco to mitigate the CVE-2022-20713 vulnerability.
  reference:
    - https://github.com/karimhabush/cyberowl
    - https://github.com/s1d6point7bugcrowd/CVE-2022-20713-Vulnerability-Detection-Script
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N
    cvss-score: 4.3
    cve-id: CVE-2022-20713
    cwe-id: CWE-444,CWE-79
    epss-score: 0.00136
    epss-percentile: 0.50345
    cpe: cpe:2.3:a:cisco:firepower_threat_defense:6.2.3:*:*:*:*:*:*:*
  metadata:
    vendor: cisco
    product: firepower_threat_defense

http:
  - method: POST
    path:
      - "/webvpn"

    headers:
      Content-Type: "application/x-www-form-urlencoded"

    body: |
      POST /webvpn HTTP/1.1
      Host: {{Hostname}}
      Content-Length: 100
      Content-Type: application/x-www-form-urlencoded

      POST /webvpn HTTP/1.1
      Host: {{Hostname}}
      Content-Length: 100
      Content-Type: application/x-www-form-urlencoded
    matchers:
      - type: word
        words:
          - "Unauthorized"
          - "Error"
          - "Not Allowed"
        part: body
