id: CVE-2022-32778

info:
  name: AVideo Pass Cookie HttpOnly Flag Missing
  author: ProjectDiscoveryAI
  severity: high
  description: An information disclosure vulnerability exists in the cookie functionality of WWBN AVideo 11.6 and dev master commit 3f7c0364. The pass cookie misses the HttpOnly flag, making it accessible via JavaScript. This could allow an attacker to steal the hashed password cookie via crafted JavaScript.
  impact: |
    An attacker could potentially steal the user's session cookie and impersonate the victim, leading to unauthorized access to the application.
  remediation: |
    Ensure that the HttpOnly flag is set for the Pass Cookie in the AVideo application to prevent client-side scripts from accessing it.
  reference:
    - https://github.com/WWBN/AVideo/blob/e04b1cd7062e16564157a82bae389eedd39fa088/updatedb/updateDb.v12.0.sql
    - https://talosintelligence.com/vulnerability_reports/TALOS-2022-1542
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cve-id: CVE-2022-32778
    cwe-id: CWE-732
    epss-score: 0.0018
    epss-percentile: 0.56388
    cpe: cpe:2.3:a:wwbn:avideo:11.6:*:*:*:*:*:*:*
  metadata:
    vendor: wwbn
    product: avideo
    shodan-query: http.html:"AVideo"
    fofa-query:
      - avideo
      - title="avideo"
    google-query: intitle:"avideo"

http:
  - method: GET
    path:
      - "{{BaseURL}}/objects/include_config.php"
      - "{{BaseURL}}/objects/user.php"

    headers:
      User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36
    matchers:
      - type: word
        words:
          - "session_name($global['session_name']);"
          - "_setcookie"
        part: body
        condition: and
