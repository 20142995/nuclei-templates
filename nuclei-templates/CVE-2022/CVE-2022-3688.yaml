id: CVE-2022-3688

info:
  name: WPQA Builder CSRF Vulnerability
  author: ProjectDiscoveryAI
  severity: high
  description: The WPQA Builder WordPress plugin before 5.9 does not have CSRF check when following and unfollowing users, which could allow attackers to make logged in users perform such actions via CSRF attacks.
  impact: |
    An attacker can perform unauthorized actions on behalf of a user
  remediation: |
    Update WPQA Builder plugin to the latest version to mitigate CSRF vulnerability (CVE-2022-3688)
  reference:
    - https://wpscan.com/vulnerability/03b2c6e6-b86e-4143-a84a-7a99060c4848
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    cvss-score: 8.8
    cve-id: CVE-2022-3688
    epss-score: 0.00229
    epss-percentile: 0.61814
    cpe: cpe:2.3:a:2code:wpqa_builder:*:*:*:*:*:wordpress:*:*
  metadata:
    vendor: 2code
    product: wpqa_builder
    framework: wordpress
    google-query: inurl:/wp-content/plugins/wpqa
  tags: wpscan

http:
  - method: POST
    path:
      - "{{BaseURL}}/wp-admin/admin-ajax.php"

    body: |
      action=wpqa_following_you&following_var_id=9839

    headers:
      Content-Type: application/x-www-form-urlencoded
    matchers:
      - type: status
        status:
          - 200
