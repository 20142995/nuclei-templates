id: CVE-2022-2250

info:
  name: GitLab Open Redirect Vulnerability
  author: ProjectDiscoveryAI
  severity: medium
  description: An open redirect vulnerability in GitLab EE/CE allows an attacker to redirect users to an arbitrary location if they trust the URL. Affects all versions from 11.1 prior to 14.10.5, 15.0 prior to 15.0.4, and 15.1 prior to 15.1.1.
  impact: |
    Attackers can trick users into visiting malicious sites by redirecting them from GitLab.
  remediation: |
    Apply the vendor-supplied patch or upgrade to the latest version to mitigate the open redirect vulnerability in GitLab.
  reference:
    - https://gitlab.com/gitlab-org/gitlab/-/issues/355509
    - https://hackerone.com/reports/1506126
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:N/I:L/A:N
    cvss-score: 4.7
    cve-id: CVE-2022-2250
    cwe-id: CWE-601
    epss-score: 0.00089
    epss-percentile: 0.39595
    cpe: cpe:2.3:a:gitlab:gitlab:*:*:*:*:enterprise:*:*:*
  metadata:
    vendor: gitlab
    product: gitlab
    shodan-query: http.title:"GitLab"
    fofa-query:
      - body="gitlab enterprise edition"
      - body="gitlab-ci.yml"
      - title="gitlab"
    google-query: intitle:"gitlab"

http:
  - method: GET
    path:
      - "{{BaseURL}}/lkjdshgflkdsjgh/@@example.com"

    matchers:
      - type: status
        status:
          - 301

      - type: word
        words:
          - "301 Moved Permanently"
        part: header

  - method: GET
    path:
      - "{{BaseURL}}/-/jira/*namespace_id/:project_id(.:format)"
      - "{{BaseURL}}/-/jira/*namespace_id/:project_id/commit/:id(.:format)"
      - "{{BaseURL}}/-/jira/*namespace_id/:project_id/tree/*id(.:format)"

    matchers:
      - type: status
        status:
          - 301

      - type: word
        words:
          - "301 Moved Permanently"
        part: header
