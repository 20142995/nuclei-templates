id: CVE-2022-41903

info:
  name: Git Arbitrary Code Execution via Integer Overflow in git log
  author: ProjectDiscoveryAI
  severity: critical
  description: |
    Git is distributed revision control system. `git log` can display commits in an arbitrary format using its `--format` specifiers. This functionality is also exposed to `git archive` via the `export-subst` gitattribute. When processing the padding operators, there is a integer overflow in `pretty.c::format_and_pad_commit()` where a `size_t` is stored improperly as an `int`, and then added as an offset to a `memcpy()`. This overflow can be triggered directly by a user running a command which invokes the commit formatting machinery (e.g., `git log --format=...`). It may also be triggered indirectly through git archive via the export-subst mechanism, which expands format specifiers inside of files within the repository during a git archive. This integer overflow can result in arbitrary heap writes, which may result in arbitrary code execution. The problem has been patched in the versions published on 2023-01-17, going back to v2.30.7. Users are advised to upgrade. Users who are unable to upgrade should disable `git archive` in untrusted repositories. If you expose git archive via `git daemon`, disable it by running `git config --global daemon.uploadArch false`.
  impact: |
    High impact as it allows remote code execution on the target system.
  remediation: |
    Apply the latest Git patches and updates to mitigate the CVE-2022-41903 vulnerability.
  reference:
    - https://github.com/git/git/security/advisories/GHSA-475x-2q3q-hvwq
    - https://security.gentoo.org/glsa/202312-15
    - https://github.com/fkie-cad/nvd-json-data-feeds
    - https://github.com/juhp/rpmostree-update
    - https://github.com/k0mi-tg/CVE-POC
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-41903
    cwe-id: CWE-190
    epss-score: 0.00523
    epss-percentile: 0.77586
    cpe: cpe:2.3:a:git-scm:git:*:*:*:*:*:*:*:*
  metadata:
    vendor: git-scm
    product: git
    shodan-query: X-Jenkins

http:
  - method: GET
    path:
      - "{{BaseURL}}/check-repofixed.sh"
      - "{{BaseURL}}/buildDockerimages.sh"

    matchers:
      - type: word
        words:
          - "CVE-2022-41903"
          - "CVE-2022-23521"
          - "CVE-2022-41953"
        part: body
        condition: or
