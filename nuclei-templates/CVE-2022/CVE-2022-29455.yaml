id: CVE-2022-29455

info:
  name: Wordpress Elementor <= 3.5.5 | Dom based XSS
  author: rotembar
  severity: high
  description: |
    dom based xss in elementor
  reference:
    - http://cve.mitre.org/cgi-bin/cvename.cgi?name=2022-29455
    - https://nvd.nist.gov/vuln/detail/CVE-2022-29455
    - https://rotem-bar.com/hacking-65-million-websites-greater-cve-2022-29455-elementor
  metadata:
    verified: "true"
  tags: cve,cve2022,xss

requests:
  - method: GET
    path:
      - "{{BaseURL}}/wp-content/plugins/elementor/assets/js/frontend.min.js"
    matchers-condition: and
    matchers:
      - type: regex
        regex:
          - "elementor[\\s-]*v(([0-3]+\\.(([0-5]+\\.[0-5]+)|[0-4]+\\.[0-9]+))|[0-2]+[0-9.]+)"
        part: body
      - type: status
        status:
          - 200
    extractors:
      - type: regex # type of the extractor
        part: body  # part of the response (header,body,all)
        name: version
        group: 1
        regex:
          - "!\\s*elementor[\\s-]*v([0-9.]+)"
