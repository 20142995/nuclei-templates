id: CVE-2018-20494

info:
  name: GitLab Incorrect Access Control on CI Jobs API
  author: ProjectDiscoveryAI
  severity: high
  description: Guest users have access to all Job information via the API in GitLab versions before 11.4.13, 11.5.x before 11.5.6, and 11.6.x before 11.6.1.
  impact: |
    An attacker can access sensitive information from CI job logs, potentially leading to unauthorized access or data leakage.
  remediation: |
    Upgrade to GitLab CE/EE version 11.5.0 or later to fix the incorrect access control on CI Jobs API.
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cve-id: CVE-2018-20494
    cwe-id: CWE-863
    epss-score: 0.00216
    epss-percentile: 0.603
    cpe: cpe:2.3:a:gitlab:gitlab:*:*:*:*:community:*:*:*
  metadata:
    vendor: gitlab
    product: gitlab
    shodan-query: http.title:"GitLab"
    fofa-query:
      - body="gitlab enterprise edition"
      - body="gitlab-ci.yml"
      - title="gitlab"
    google-query: intitle:"gitlab"

http:
  - method: GET
    path:
      - "{{BaseURL}}/api/v4/projects/{{project_id}}/jobs"

    headers:
      PRIVATE-TOKEN: "{{GUEST-USER-TOKEN}}"
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "commit"
          - "branch"
        part: body
        condition: and
