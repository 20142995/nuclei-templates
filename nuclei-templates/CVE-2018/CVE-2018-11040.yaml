id: CVE-2018-11040

info:
  name: Spring Framework JSONP Cross-Domain Data Leakage
  author: ProjectDiscoveryAI
  severity: high
  description: Spring Framework, versions 5.0.x prior to 5.0.7 and 4.3.x prior to 4.3.18 and older unsupported versions, allows web applications to enable cross-domain requests via JSONP through AbstractJsonpResponseBodyAdvice for REST controllers and MappingJackson2JsonView for browser requests.
  impact: |
    An attacker can exploit this vulnerability to leak sensitive data across domains.
  remediation: |
    Upgrade to Spring Framework version 4.3.17 or higher.
  reference:
    - https://lists.debian.org/debian-lts-announce/2021/04/msg00022.html
    - https://github.com/haba713/depcheck-gretty-issue
    - https://github.com/ilmari666/cybsec
    - https://github.com/scordero1234/java_sec_demo-main
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cve-id: CVE-2018-11040
    cwe-id: CWE-829
    epss-score: 0.00245
    epss-percentile: 0.6496
    cpe: cpe:2.3:a:vmware:spring_framework:*:*:*:*:*:*:*:*
  metadata:
    vendor: vmware
    product: spring_framework

http:
  - method: GET
    path:
      - "{{BaseURL}}/example?callback=test"
      - "{{BaseURL}}/example?jsonp=test"

    matchers:
      - type: word
        words:
          - "test("
        part: body
