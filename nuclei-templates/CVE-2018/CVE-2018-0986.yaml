id: CVE-2018-0986

info:
  name: Microsoft Malware Protection Engine Remote Code Execution Vulnerability
  author: ProjectDiscoveryAI
  severity: high
  description: A remote code execution vulnerability exists when the Microsoft Malware Protection Engine does not properly scan a specially crafted file, leading to memory corruption.
  impact: |
    Successful exploitation could allow an attacker to execute arbitrary code on the target system.
  remediation: |
    Apply the necessary security updates provided by Microsoft to address CVE-2018-0986.
  reference:
    - http://www.securitytracker.com/id/1040631
    - https://github.com/ARPSyndicate/cvemon
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    cvss-score: 8.8
    cve-id: CVE-2018-0986
    cwe-id: CWE-787
    epss-score: 0.94834
    epss-percentile: 0.99363
    cpe: cpe:2.3:a:microsoft:exchange_server:2013:-:*:*:*:*:*:*
  metadata:
    vendor: microsoft
    product: exchange_server
    shodan-query: http.favicon.hash:1768726119
    fofa-query:
      - icon_hash=1768726119
      - title="outlook"
      - title=outlook exchange
    google-query:
      - intitle:"outlook"
      - intitle:outlook exchange

http:
  - method: GET
    path:
      - "{{BaseURL}}/exploits/44402/"

    matchers:
      - type: word
        words:
          - "Memory corruption in mpengine.dll when processing RAR archives"
          - "RarVM::ExecuteStandardFilter function in mpengine.dll"
          - "By setting PosR to -2 and DataSize to 1 in a RAR file, the vulnerability can be triggered"
        condition: and
