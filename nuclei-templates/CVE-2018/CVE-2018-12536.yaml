id: CVE-2018-12536

info:
  name: Eclipse Jetty Server Path Disclosure
  author: ProjectDiscoveryAI
  severity: medium
  description: In Eclipse Jetty Server, all 9.x versions, on webapps deployed using default Error Handling, when an intentionally bad query arrives that doesn't match a dynamic url-pattern, and is eventually handled by the DefaultServlet's static file serving, the bad characters can trigger a java.nio.file.InvalidPathException which includes the full path to the base resource directory that the DefaultServlet and/or webapp is using. If this InvalidPathException is then handled by the default Error Handler, the InvalidPathException message is included in the error response, revealing the full server path to the requesting system.
  impact: |
    An attacker can exploit this vulnerability to gain insights into the server's file system structure.
  remediation: |
    Upgrade to a version of Eclipse Jetty Server that has patched the CVE-2018-12536 vulnerability.
  reference:
    - http://www.securitytracker.com/id/1041194
    - https://lists.apache.org/thread.html/053d9ce4d579b02203db18545fee5e33f35f2932885459b74d1e4272%40%3Cissues.activemq.apache.org%3E
    - https://lists.debian.org/debian-lts-announce/2021/05/msg00016.html
    - https://security.netapp.com/advisory/ntap-20181014-0001/
    - https://support.hpe.com/hpsc/doc/public/display?docLocale=en_US&docId=emr_na-hpesbst03953en_us
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
    cve-id: CVE-2018-12536
    cwe-id: CWE-209,NVD-CWE-noinfo
    epss-score: 0.0034
    epss-percentile: 0.7216
    cpe: cpe:2.3:a:eclipse:jetty:*:*:*:*:*:*:*:*
  metadata:
    vendor: eclipse
    product: jetty
    shodan-query:
      - cpe:"cpe:2.3:a:eclipse:jetty"
      - http.html:"contexts known to this"
      - http.title:"powered by jetty"
    fofa-query:
      - body="contexts known to this"
      - title="powered by jetty"
    google-query: intitle:"powered by jetty"

http:
  - method: GET
    path:
      - "{{BaseURL}}/%invalidpath%"

    matchers:
      - type: word
        words:
          - "InvalidPathException"
        part: body
