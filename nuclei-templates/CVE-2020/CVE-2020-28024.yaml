id: CVE-2020-28024

info:
  name: Exim 4 Buffer Underwrite Vulnerability
  author: ProjectDiscoveryAI
  severity: critical
  description: Exim 4 before 4.94.2 allows Buffer Underwrite that may result in unauthenticated remote attackers executing arbitrary commands, because smtp_ungetc was only intended to push back characters, but can actually push back non-character error codes such as EOF.
  reference:
    - https://www.exim.org/static/doc/security/CVE-2020-qualys/CVE-2020-28024-UNGET.txt

network:
  - inputs:
      - data: "EHLO test
MAIL FROM:<>
RCPT TO:<>
DATA
QUIT
"
    host:
      - "{{Hostname}}"
    port: 25
    read-size: 1024

    matchers:
      - type: word
        words:
          - "220"  # SMTP Service Ready response
          - "250"  # Requested mail action okay, completed
          - "354"  # Start mail input
        condition: or