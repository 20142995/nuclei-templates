id: CVE-2020-28022

info:
  name: Exim 4 Buffer Overflow Vulnerability
  author: ProjectDiscoveryAI
  severity: critical
  description: Exim 4 before 4.94.2 has improper restriction of write operations within the bounds of a memory buffer when processing name=value pairs within MAIL FROM and RCPT TO commands.
  reference:
    - https://www.exim.org/static/doc/security/CVE-2020-qualys/CVE-2020-28022-EXOPT.txt

network:
  - inputs:
      - data: "MAIL FROM:<test@example.com> SIZE=1000000000
"
      - data: "RCPT TO:<victim@example.com>
"
    host:
      - "{{Hostname}}"
    port: 25
    read-size: 1024

    matchers:
      - type: word
        words:
          - "500 Line too long"
        part: data