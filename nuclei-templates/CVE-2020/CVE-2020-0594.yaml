id: CVE-2020-0594

info:
  name: Intel AMT/ISM IPv6 Out-of-Bounds Read Vulnerability
  author: ProjectDiscoveryAI
  severity: critical
  description: |
    Out-of-bounds read in IPv6 subsystem in Intel(R) AMT and Intel(R) ISM versions before 11.8.77, 11.12.77, 11.22.77, and 12.0.64 may allow an unauthenticated user to potentially enable escalation of privilege via network access.
  reference:
    - https://support.lenovo.com/de/en/product_security/len-30041
    - https://www.kb.cert.org/vuls/id/257161
    - https://security.netapp.com/advisory/ntap-20200611-0007/
    - https://www.synology.com/security/advisory/Synology_SA_20_15
    - https://github.com/CERTCC/PoC-Exploits/tree/master/vu-257161/scripts
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2020-0594
    cwe-id: CWE-125
    epss-score: 0.01105
    epss-percentile: 0.85068
    cpe: cpe:2.3:o:intel:active_management_technology_firmware:*:*:*:*:*:*:*:*
  metadata:
    vendor: intel
    product: active_management_technology_firmware
    shodan-query: title:"Active Management Technology"
    fofa-query: title="active management technology"
    google-query: intitle:"active management technology"
  impact: |
    Successful exploitation could lead to unauthorized access to sensitive data.
  remediation: |
    Apply the necessary security patches provided by Intel to mitigate the vulnerability.

tcp:
  - inputs:
      - data: "8000" # Example payload to trigger IPv6 vulnerability
        type: hex
    host:
      - "{{Hostname}}"
    port: 623 # Default port for Intel AMT
    read-size: 1024
    matchers:
      - type: word
        words:
          - "Error"
          - "Unauthorized"
        part: data
    matchers-condition: or