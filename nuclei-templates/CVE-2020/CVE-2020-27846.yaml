id: CVE-2020-27846

info:
  name: SAML Signature Verification Bypass
  author: ProjectDiscoveryAI
  severity: critical
  description: A signature verification vulnerability exists in crewjam/saml allowing attackers to bypass SAML Authentication.
  impact: |
    Successful exploitation could lead to unauthorized access to sensitive information or systems.
  remediation: |
    Apply the vendor-supplied patch or update to mitigate the SAML Signature Verification Bypass vulnerability (CVE-2020-27846).
  reference:
    - https://github.com/crewjam/saml/security/advisories/GHSA-4hq8-gmxx-h6w9
    - https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/3YUTKIRWT6TWU7DS6GF3EOANVQBFQZYI/
    - https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/ICP3YRY2VUCNCF2VFUSK77ZMRIC77FEM/
    - https://security.netapp.com/advisory/ntap-20210205-0002/
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2020-27846
    cwe-id: CWE-115
    epss-score: 0.0137
    epss-percentile: 0.86823
    cpe: cpe:2.3:a:grafana:grafana:*:*:*:*:enterprise:*:*:*
  metadata:
    vendor: grafana
    product: grafana
    shodan-query: title:"Grafana"
    fofa-query: app="Grafana"
    google-query: intitle:"grafana"

http:
  - method: GET
    path:
      - "{{BaseURL}}/saml/SSO"

    headers:
      User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36
    matchers:
      - type: word
        words:
          - "You have successfully logged in"
        part: body
