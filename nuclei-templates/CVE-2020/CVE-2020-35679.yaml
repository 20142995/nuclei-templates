id: CVE-2020-35679

info:
  name: OpenSMTPD Memory Leak and Privilege Escalation Vulnerability
  author: ProjectDiscoveryAI
  severity: high
  description: smtpd/table.c in OpenSMTPD before 6.8.0p1 lacks a certain regfree, which might allow attackers to trigger a "very significant" memory leak via messages to an instance that performs many regex lookups. Additionally, OpenSMTPD version 6.8.0p1 is vulnerable to privilege escalation for local users due to improper configuration of maildir, alias, and forward-file actions.
  impact: |
    Successful exploitation could lead to unauthorized access and potential compromise of the system.
  remediation: |
    Apply the vendor-supplied patch or upgrade to a non-vulnerable version.
  reference:
    - https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/5LKTFBQCHGMVPR4IZWHQIYAPM5J3LN3J/
    - https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/TYAYXRV2DM5K4RU7RHCDZSA2UF6VCTRC/
    - https://poolp.org/posts/2020-12-24/december-2020-opensmtpd-6.8.0p1-released-fixed-several-bugs-proposed-several-diffs-book-is-on-github/
    - https://security.gentoo.org/glsa/202105-12
    - https://www.mail-archive.com/misc%40opensmtpd.org/msg05188.html
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    cvss-score: 7.5
    cve-id: CVE-2020-35679
    cwe-id: CWE-401
    epss-score: 0.00448
    epss-percentile: 0.75792
    cpe: cpe:2.3:a:opensmtpd:opensmtpd:*:*:*:*:*:*:*:*
  metadata:
    vendor: opensmtpd
    product: opensmtpd

http:
  - method: GET
    path:
      - "{{BaseURL}}/posts/2020-12-24/december-2020-opensmtpd-6.8.0p1-released-fixed-several-bugs-proposed-several-diffs-book-is-on-github/"

    matchers:
      - type: word
        words:
          - "Vulnerability: OpenSMTPD 6.8.0p1 Multiple Local Users Privilege Escalation"
        part: body
