id: CVE-2020-15688

info:
  name: GoAhead Web Server Digest Authentication Replay Vulnerability
  author: ProjectDiscoveryAI
  severity: high
  description: The HTTP Digest Authentication in the GoAhead web server before 5.1.2 does not completely protect against replay attacks. This allows an unauthenticated remote attacker to bypass authentication via capture-replay if TLS is not used to protect the underlying communication channel.
  impact: |
    An attacker could potentially replay captured Digest Authentication credentials to gain unauthorized access.
  remediation: |
    Update the GoAhead Web Server to a version that has patched CVE-2020-15688.
  reference:
    - https://github.com/embedthis/goahead-gpl/issues/3
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    cvss-score: 8.8
    cve-id: CVE-2020-15688
    cwe-id: CWE-294
    epss-score: 0.02475
    epss-percentile: 0.90456
    cpe: cpe:2.3:a:embedthis:goahead:*:*:*:*:*:*:*:*
  metadata:
    vendor: embedthis
    product: goahead
    shodan-query: cpe:"cpe:2.3:a:embedthis:goahead"

http:
  - method: GET
    path:
      - "{{BaseURL}}/protected-resource"

    headers:
      Authorization: "Digest username=\"admin\", realm=\"testrealm@host.com\", nonce=\"dcd98b7102dd2f0e8b11d0f600bfb0c093\", uri=\"/protected-resource\", qop=auth, nc=00000001, cnonce=\"0a4f113b\", response=\"6629fae49393a05397450978507c4ef1\", opaque=\"5ccc069c403ebaf9f0171e9517f40e41\""
    matchers:
      - type: status
        status:
          - 200
