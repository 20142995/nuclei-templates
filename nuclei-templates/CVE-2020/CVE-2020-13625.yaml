id: CVE-2020-13625

info:
  name: PHPMailer Attachment Name Escaping Vulnerability
  author: ProjectDiscoveryAI
  severity: high
  description: PHPMailer before 6.1.6 contains an output escaping bug when the name of a file attachment contains a double quote character.
  impact: |
    Remote code execution.
  remediation: |
    Update PHPMailer to version 6.1.8 or later.
  reference:
    - http://lists.opensuse.org/opensuse-security-announce/2020-07/msg00067.html
    - http://lists.opensuse.org/opensuse-security-announce/2020-07/msg00085.html
    - https://github.com/PHPMailer/PHPMailer/releases/tag/v6.1.6
    - https://lists.debian.org/debian-lts-announce/2020/06/msg00014.html
    - https://lists.debian.org/debian-lts-announce/2020/08/msg00004.html
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    cvss-score: 7.5
    cve-id: CVE-2020-13625
    cwe-id: CWE-116
    epss-score: 0.0063
    epss-percentile: 0.79658
    cpe: cpe:2.3:a:phpmailer_project:phpmailer:*:*:*:*:*:*:*:*
  metadata:
    vendor: phpmailer_project
    product: phpmailer
    shodan-query: http.title:"php mailer"
    fofa-query: title="php mailer"
    google-query: intitle:"php mailer"

http:
  - method: GET
    path:
      - "{{BaseURL}}/path/to/vulnerable/endpoint"

    matchers:
      - type: word
        words:
          - "filename.html\";.jpg"
        part: body
