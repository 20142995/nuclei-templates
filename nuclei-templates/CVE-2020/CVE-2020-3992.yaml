id: CVE-2020-3992

info:
  name: VMware ESXi OpenSLP Remote Code Execution Vulnerability
  author: ProjectDiscoveryAI
  severity: critical
  description: OpenSLP as used in VMware ESXi (7.0 before ESXi_7.0.1-0.0.16850804, 6.7 before ESXi670-202010401-SG, 6.5 before ESXi650-202010401-SG) has a use-after-free issue leading to remote code execution.
  impact: |
    Successful exploitation could result in remote code execution on the vulnerable VMware ESXi server.
  remediation: |
    Apply the necessary patch provided by VMware to mitigate the CVE-2020-3992 vulnerability.
  reference:
    - https://github.com/dgh05t/VMware_ESXI_OpenSLP_PoCs
    - https://github.com/HynekPetrak/CVE-2019-5544_CVE-2020-3992
    - https://www.zerodayinitiative.com/advisories/ZDI-20-1377/
    - https://www.zerodayinitiative.com/advisories/ZDI-20-1385/
    - https://github.com/tom0li/collection-document
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2020-3992
    cwe-id: CWE-416
    epss-score: 0.44246
    epss-percentile: 0.975
    cpe: cpe:2.3:a:vmware:cloud_foundation:*:*:*:*:*:*:*:*
  metadata:
    vendor: vmware
    product: cloud_foundation
    shodan-query: http.title:"vmware cloud"
    fofa-query: title="vmware cloud"
    google-query: intitle:"vmware cloud"
  tags: kev

http:
  - method: POST
    path:
      - "/slp"

    headers:
      Content-Type: "application/x-www-form-urlencoded"

    body: |
      srvtype=service:VMwareInfrastructure&scope=1
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "Content-Length: 0"
        part: header
