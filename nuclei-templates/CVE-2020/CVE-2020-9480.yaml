id: CVE-2020-9480

info:
  name: Apache Spark Standalone Manager Authentication Bypass
  author: ProjectDiscoveryAI
  severity: critical
  description: In Apache Spark 2.4.5 and earlier, a standalone resource manager's master may be configured to require authentication (spark.authenticate) via a shared secret. When enabled, a specially-crafted RPC to the master can succeed in starting an application's resources on the Spark cluster, even without the shared key. This can be leveraged to execute shell commands on the host machine.
  impact: |
    An attacker can gain unauthorized access to sensitive data and potentially disrupt services.
  remediation: |
    Upgrade to Apache Spark version 2.4.6 or later to fix the authentication bypass vulnerability.
  reference:
    - https://lists.apache.org/thread.html/r03ad9fe7c07d6039fba9f2152d345274473cb0af3d8a4794a6645f4b%40%3Cuser.spark.apache.org%3E
    - https://lists.apache.org/thread.html/ra0e62a18ad080c4ce6df5e0202a27eaada75222761efc3f7238b5a3b%40%3Ccommits.doris.apache.org%3E
    - https://lists.apache.org/thread.html/rb3956440747e41940d552d377d50b144b60085e7ff727adb0e575d8d%40%3Ccommits.submarine.apache.org%3E
    - https://lists.apache.org/thread.html/ree9e87aae81852330290a478692e36ea6db47a52a694545c7d66e3e2%40%3Cdev.spark.apache.org%3E
    - https://github.com/XiaoShaYu617/CVE-2020-9480
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2020-9480
    cwe-id: CWE-306
    epss-score: 0.02985
    epss-percentile: 0.91248
    cpe: cpe:2.3:a:apache:spark:*:*:*:*:*:*:*:*
  metadata:
    vendor: apache
    product: spark
    shodan-query: html:"/apps/IMT/Html/"
    fofa-query:
      - body="/apps/imt/html/"
      - title="spark master at"
    google-query: intitle:"spark master at"

http:
  - method: POST
    path:
      - "{{BaseURL}}/vulnerable_endpoint"

    headers:
      Content-Type: application/json

    body: |
      {"payload": "<malicious_code_here>"}
    matchers:
      - type: word
        words:
          - "successful execution"
          - "sensitive information"
        part: body
