id: CVE-2020-35849

info:
  name: MantisBT Incorrect Access Check
  author: ProjectDiscoveryAI
  severity: high
  description: An issue was discovered in MantisBT before 2.24.4. An incorrect access check in bug_revision_view_page.php allows an unprivileged attacker to view the Summary field of private issues, as well as bugnotes revisions, gaining access to potentially confidential information via the bugnote_id parameter.
  impact: |
    An attacker can gain unauthorized access to sensitive data.
  remediation: |
    Upgrade MantisBT to the latest version to fix the access control issue.
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cve-id: CVE-2020-35849
    cwe-id: CWE-639
    epss-score: 0.0032
    epss-percentile: 0.71318
    cpe: cpe:2.3:a:mantisbt:mantisbt:*:*:*:*:*:*:*:*
  metadata:
    vendor: mantisbt
    product: mantisbt
    shodan-query: http.favicon.hash:662709064
    fofa-query:
      - body="administration - installation - mantisbt"
      - icon_hash=662709064
      - title="mantisbt"
    google-query: intitle:"mantisbt"

http:
  - method: POST
    path:
      - "{{BaseURL}}/bugs/login_password_page.php"

    body: "username=user123&return=%2Fbugs%2Fview.php%3Fid%3D27370"

    headers:
      Content-Type: application/x-www-form-urlencoded
    matchers:
      - type: word
        words:
          - "login_password_page.php"
        part: body
