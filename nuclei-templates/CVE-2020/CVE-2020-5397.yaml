id: CVE-2020-5397

info:
  name: Spring Framework CSRF via CORS Preflight
  author: ProjectDiscoveryAI
  severity: medium
  description: Spring Framework, versions 5.2.x prior to 5.2.3 are vulnerable to CSRF attacks through CORS preflight requests that target Spring MVC or Spring WebFlux endpoints.
  impact: |
    Successful exploitation could result in unauthorized access or actions on the application.
  remediation: |
    Upgrade to Spring Framework version 5.2.3, 5.1.12, or 5.0.16 or later.
  reference:
    - https://www.oracle.com/security-alerts/cpujul2022.html
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N
    cvss-score: 5.3
    cve-id: CVE-2020-5397
    cwe-id: CWE-352
    epss-score: 0.00141
    epss-percentile: 0.51109
    cpe: cpe:2.3:a:vmware:spring_framework:*:*:*:*:*:*:*:*
  metadata:
    vendor: vmware
    product: spring_framework

http:
  - method: OPTIONS
    path:
      - "{{BaseURL}}/example-endpoint"

    headers:
      Origin: "https://example.com"
      Access-Control-Request-Method: "POST"
      Access-Control-Request-Headers: "Content-Type"
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "Access-Control-Allow-Origin: https://example.com"
          - "Access-Control-Allow-Methods: POST"
        part: header
