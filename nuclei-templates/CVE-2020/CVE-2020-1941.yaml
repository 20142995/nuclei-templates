id: CVE-2020-1941

info:
  name: Apache ActiveMQ XSS in Webconsole Admin GUI
  author: ProjectDiscoveryAI
  severity: medium
  description: In Apache ActiveMQ 5.0.0 to 5.15.11, the webconsole admin GUI is open to XSS, in the view that lists the contents of a queue.
  impact: |
    Successful exploitation could lead to unauthorized access or data theft
  remediation: |
    Upgrade Apache ActiveMQ to a version that is not vulnerable to CVE-2020-1941
  reference:
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-1941
    - https://lists.apache.org/thread.html/r946488fb942fd35c6a6e0359f52504a558ed438574a8f14d36d7dcd7%40%3Ccommits.activemq.apache.org%3E
    - https://lists.apache.org/thread.html/rb2fd3bf2dce042e0ab3f3c94c4767c96bb2e7e6737624d63162df36d%40%3Ccommits.activemq.apache.org%3E
    - https://lists.apache.org/thread.html/re4672802b0e5ed67c08c9e77057d52138e062f77cc09581b723cf95a%40%3Ccommits.activemq.apache.org%3E
    - https://www.oracle.com//security-alerts/cpujul2021.html
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2020-1941
    cwe-id: CWE-79
    epss-score: 0.00327
    epss-percentile: 0.71598
    cpe: cpe:2.3:a:apache:activemq:*:*:*:*:*:*:*:*
  metadata:
    vendor: apache
    product: activemq
    shodan-query: product:"ActiveMQ OpenWire Transport"
    fofa-query: title="apache activemq"
    google-query: intitle:"apache activemq"

http:
  - method: GET
    path:
      - "{{BaseURL}}/admin/queues.jsp"

    matchers:
      - type: word
        words:
          - "<script>alert('XSS')</script>"
        part: body
