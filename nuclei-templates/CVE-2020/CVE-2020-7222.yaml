id: CVE-2020-7222

info:
  name: Amcrest Web Server Login Bypass
  author: ProjectDiscoveryAI
  severity: medium
  description: An issue was discovered in Amcrest Web Server 2.520.AC00.18.R 2017-06-29 WEB 3.2.1.453504. The login page responds with JavaScript when one tries to authenticate. An attacker who changes the result parameter (to true) in this JavaScript code can bypass authentication and achieve limited privileges.
  impact: |
    Successful exploitation could lead to unauthorized access to sensitive information.
  remediation: |
    Apply the vendor-supplied patch or update to the latest version to mitigate the vulnerability.
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
    cve-id: CVE-2020-7222
    cwe-id: CWE-287
    epss-score: 0.00126
    epss-percentile: 0.48662
    cpe: cpe:2.3:a:amcrest:web_server:2.520.ac00.18.r:*:*:*:*:*:*:*
  metadata:
    vendor: amcrest
    product: web_server
    shodan-query: cpe:"cpe:2.3:a:google:web_server"

http:
  - method: POST
    path:
      - "{{BaseURL}}/login"

    body: "username=admin&password=admin"
    matchers:
      - type: word
        words:
          - "result=true"
        part: body
