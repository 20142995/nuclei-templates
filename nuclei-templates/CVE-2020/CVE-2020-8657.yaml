id: CVE-2020-8657

info:
  name: EyesOfNetwork 5.3 Hardcoded API Key Vulnerability
  author: ProjectDiscoveryAI
  severity: critical
  description: An issue was discovered in EyesOfNetwork 5.3. The installation uses the same API key (hardcoded as EONAPI_KEY in include/api_functions.php for API version 2.4.2) by default for all installations, hence allowing an attacker to calculate/guess the admin access token.
  impact: |
    An attacker could potentially exploit this vulnerability to gain unauthorized access to sensitive information.
  remediation: |
    Update EyesOfNetwork to version 5.4 or later to remove the hardcoded API key.
  reference:
    - https://github.com/EyesOfNetworkCommunity/eonapi/issues/17
    - https://github.com/ARPSyndicate/cvemon
    - https://github.com/ArianeBlow/EyesOfNetwork-vuln-checker
    - https://github.com/Ostorlab/KEV
    - https://github.com/Ostorlab/known_exploited_vulnerbilities_detectors
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2020-8657
    cwe-id: CWE-798
    epss-score: 0.18236
    epss-percentile: 0.96355
    cpe: cpe:2.3:a:eyesofnetwork:eyesofnetwork:5.3-0:*:*:*:*:*:*:*
  metadata:
    vendor: eyesofnetwork
    product: eyesofnetwork
  tags: kev

http:
  - method: GET
    path:
      - "{{BaseURL}}/include/api_functions.php"

    matchers:
      - type: word
        words:
          - "EONAPI_KEY"
        part: body
