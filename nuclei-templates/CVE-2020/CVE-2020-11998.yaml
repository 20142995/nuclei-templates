id: CVE-2020-11998

info:
  name: Apache ActiveMQ JMX RMIConnectorServer Security Bypass
  author: ProjectDiscoveryAI
  severity: critical
  description: |
    A regression in Apache ActiveMQ allows bypassing JMX authentication. A remote client could create a javax.management.loading.MLet MBean and use it to create new MBeans from arbitrary URLs, potentially leading to remote code execution.
  impact: |
    Remote attackers can exploit this vulnerability to gain unauthorized access to sensitive information or execute arbitrary code
  remediation: |
    Apply the necessary patches provided by Apache to fix the security bypass vulnerability (CVE-2020-11998)
  reference:
    - https://lists.apache.org/thread.html/r946488fb942fd35c6a6e0359f52504a558ed438574a8f14d36d7dcd7%40%3Ccommits.activemq.apache.org%3E
    - https://lists.apache.org/thread.html/rb2fd3bf2dce042e0ab3f3c94c4767c96bb2e7e6737624d63162df36d%40%3Ccommits.activemq.apache.org%3E
    - https://www.oracle.com/security-alerts/cpujan2021.html
    - https://github.com/zhzhdoai/JAVA_Env-Poc
    - https://github.com/404notf0und/CVE-Flow
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2020-11998
    epss-score: 0.00656
    epss-percentile: 0.80132
    cpe: cpe:2.3:a:apache:activemq:5.15.12:*:*:*:*:*:*:*
  metadata:
    vendor: apache
    product: activemq
    shodan-query: product:"ActiveMQ OpenWire Transport"
    fofa-query: title="apache activemq"
    google-query: intitle:"apache activemq"

http:
  - method: GET
    path:
      - "{{BaseURL}}/api/jolokia/?ignoreErrors=true&maxDepth=7&maxCollectionSize=500"

    headers:
      User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36
    matchers:
      - type: word
        words:
          - "javax.management.loading.MLet"
        part: body
