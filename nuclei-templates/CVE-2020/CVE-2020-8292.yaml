id: CVE-2020-8292

info:
  name: Rocket.Chat Self-XSS via Drag & Drop
  author: ProjectDiscoveryAI
  severity: medium
  description: Rocket.Chat server before 3.9.0 is vulnerable to a self cross-site scripting (XSS) vulnerability via the drag & drop functionality in message boxes.
  impact: |
    An attacker could exploit this vulnerability to execute malicious scripts in the context of the user's session.
  remediation: |
    Upgrade Rocket.Chat to the latest version to mitigate CVE-2020-8292.
  reference:
    - https://hackerone.com/reports/962902
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:N
    cvss-score: 5.4
    cve-id: CVE-2020-8292
    cwe-id: CWE-79
    epss-score: 0.00112
    epss-percentile: 0.45929
    cpe: cpe:2.3:a:rocket.chat:rocket.chat:*:*:*:*:*:*:*:*
  metadata:
    vendor: rocket.chat
    product: rocket.chat
    shodan-query: http.title:"Rocket.Chat"
    fofa-query: title="rocket.chat"
    google-query: intitle:"rocket.chat"
  tags: hackerone

http:
  - method: GET
    path:
      - "{{BaseURL}}/path/to/vulnerable/endpoint"

    matchers:
      - type: word
        words:
          - "Meteor.loginToken"
        part: body
