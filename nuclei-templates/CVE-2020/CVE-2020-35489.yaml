id: CVE-2020-35489

info:
  name: Contact Form 7 Plugin Unrestricted File Upload Vulnerability
  author: ProjectDiscoveryAI
  severity: critical
  description: The contact-form-7 (aka Contact Form 7) plugin before 5.3.2 for WordPress allows Unrestricted File Upload and remote code execution because a filename may contain special characters.
  impact: |
    Successful exploitation could lead to remote code execution or unauthorized access to the server.
  remediation: |
    Update Contact Form 7 Plugin to the latest version to mitigate the unrestricted file upload vulnerability (CVE-2020-35489).
  reference:
    - https://wordpress.org/plugins/contact-form-7/#developers
    - https://wpscan.com/vulnerability/10508
    - https://www.getastra.com/blog/911/plugin-exploit/contact-form-7-unrestricted-file-upload/
    - https://www.jinsonvarghese.com/unrestricted-file-upload-in-contact-form-7/
    - https://github.com/ARPSyndicate/cvemon
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    cvss-score: 10
    cve-id: CVE-2020-35489
    cwe-id: CWE-434
    epss-score: 0.05077
    epss-percentile: 0.93195
    cpe: cpe:2.3:a:rocklobster:contact_form_7:*:*:*:*:*:wordpress:*:*
  metadata:
    vendor: rocklobster
    product: contact_form_7
    framework: wordpress

http:
  - method: GET
    path:
      - "{{BaseURL}}?rest_route=/contact-form-7/v1/contact-forms/28/feedback"

    matchers:
      - type: word
        words:
          - "WPCF7_FAIL"
          - "WPCF7_OK"
        part: body
        condition: or
