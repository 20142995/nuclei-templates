id: CVE-2020-28018

info:
  name: Exim 4 Use-After-Free Vulnerability
  author: ProjectDiscoveryAI
  severity: critical
  description: Exim 4 before 4.94.2 allows Use After Free in smtp_reset in certain situations that may be common for builds with OpenSSL.
  reference:
    - https://github.com/zr0tt/CVE-2020-28018
    - https://github.com/dorkerdevil/CVE-2020-28018
    - https://www.exim.org/static/doc/security/CVE-2020-qualys/CVE-2020-28018-OCORK.txt
    - http://www.openwall.com/lists/oss-security/2021/05/11/5

network:
  - inputs:
      - data: "EHLO test
MAIL FROM:<test@example.com>
RCPT TO:<victim@example.com>
DATA
Subject: Test
.
QUIT
"
    host:
      - "{{Hostname}}"
    port: 25
    read-size: 1024

    matchers:
      - type: word
        words:
          - "250 OK"
        part: data