id: CVE-2020-15893

info:
  name: Command Injection in D-Link DIR-816L UPnP
  author: ProjectDiscoveryAI
  severity: critical
  description: An issue was discovered on D-Link DIR-816L devices 2.x before 1.10b04Beta02. Universal Plug and Play (UPnP) is enabled by default on port 1900. An attacker can perform command injection by injecting a payload into the Search Target (ST) field of the SSDP M-SEARCH discover packet.
  reference:
    - https://research.loginsoft.com/bugs/multiple-vulnerabilities-discovered-in-the-d-link-firmware-dir-816l/

network:
  - inputs:
      - data: "M-SEARCH * HTTP/1.1\r
HOST: 239.255.255.250:1900\r
ST: uuid:schemas:device:{{randstr}}\r
MAN: \"ssdp:discover\"\r
MX: 2\r
\r
"
    host:
      - "{{Hostname}}"
    port: 1900
    read-size: 1024

    matchers:
      - type: word
        words:
          - "200 OK"
        part: data