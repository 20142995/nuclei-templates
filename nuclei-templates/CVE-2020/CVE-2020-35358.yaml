id: CVE-2020-35358

info:
  name: DomainMOD Insufficient Session Expiration Vulnerability
  author: ProjectDiscoveryAI
  severity: critical
  description: DomainMOD domainmod-v4.15.0 is affected by an insufficient session expiration vulnerability. On changing a password, both sessions using the changed password and old sessions in any other browser or device do not expire and remain active. Such flaws frequently give attackers unauthorized access to some system data or functionality.
  impact: |
    Attackers can exploit this vulnerability to gain unauthorized access to user accounts and sensitive information.
  remediation: |
    Upgrade DomainMOD to the latest version to fix the insufficient session expiration vulnerability.

http:
  - method: POST
    path:
      - "{{BaseURL}}/login.php"

    body: "username=admin&password=oldpassword"
    matchers:
      - type: word
        words:
          - "Welcome, admin"
        part: body

  - method: POST
    path:
      - "{{BaseURL}}/change-password.php"

    body: "oldpassword=oldpassword&newpassword=newpassword"
    matchers:
      - type: word
        words:
          - "Password successfully changed"
        part: body

  - method: POST
    path:
      - "{{BaseURL}}/login.php"

    body: "username=admin&password=newpassword"
    matchers:
      - type: word
        words:
          - "Welcome, admin"
        part: body

  - method: GET
    path:
      - "{{BaseURL}}/dashboard.php"

    headers:
      Cookie: "sessionid=oldsessionid"
    matchers:
      - type: word
        words:
          - "Your Dashboard"
        part: body
