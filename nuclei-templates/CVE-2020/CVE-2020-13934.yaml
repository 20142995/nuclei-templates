id: CVE-2020-13934

info:
  name: Apache Tomcat h2c Memory Leak DoS
  author: ProjectDiscoveryAI
  severity: high
  description: An h2c direct connection to Apache Tomcat 10.0.0-M1 to 10.0.0-M6, 9.0.0.M5 to 9.0.36, and 8.5.1 to 8.5.56 did not release the HTTP/1.1 processor after the upgrade to HTTP/2, leading to a potential OutOfMemoryException and denial of service.
  impact: |
    Successful exploitation can lead to service unavailability and disruption.
  remediation: |
    Apply the vendor-supplied patches or updates to mitigate the vulnerability.

http:
  - method: POST
    path:
      - "{{BaseURL}}/path/to/trigger/h2c"

    headers:
      Connection: "Upgrade, HTTP2-Settings"
      Upgrade: "h2c"
      HTTP2-Settings: "<base64url encoding of HTTP/2 SETTINGS payload>"

    body: |
      [HTTP2 body here if needed]
    matchers:
      - type: word
        words:
          - "HTTP/2.0"
        part: header
