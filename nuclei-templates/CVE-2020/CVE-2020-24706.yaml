id: CVE-2020-24706

info:
  name: Reflected XSS in WSO2 Products
  author: ProjectDiscoveryAI
  severity: medium
  description: An issue was discovered in certain WSO2 products. The Try It tool allows Reflected XSS. This affects API Manager through 3.1.0, API Manager Analytics 2.5.0, IS as Key Manager through 5.10.0, Identity Server through 5.10.0, Identity Server Analytics through 5.6.0, and IoT Server 3.1.0.
  impact: |
    Allows attackers to execute malicious scripts in the context of a victim's browser.
  remediation: |
    Apply the necessary security patches provided by WSO2 to mitigate the reflected XSS vulnerability (CVE-2020-24706).
  reference: |-
    https://docs.wso2.com/display/Security/Security+Advisory+WSO2-2020-0718
    https://security.docs.wso2.com/en/latest/security-announcements/security-advisories/2020/WSO2-2020-0718/
    https://github.com/s-index/dora
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2020-24706
    cwe-id: CWE-79
    epss-score: 0.00084
    epss-percentile: 0.37476
    cpe: cpe:2.3:a:wso2:api_manager:*:*:*:*:*:*:*:*
  metadata:
    vendor: wso2
    product: api_manager
    shodan-query: http.favicon.hash:1398055326
    fofa-query: icon_hash=1398055326
    google-query: inurl:"carbon/admin/login"

http:
  - method: GET
    path:
      - "{{BaseURL}}/exampleVulnerableEndpoint?param=<script>alert('XSS')</script>"

    matchers:
      - type: word
        words:
          - "<script>alert('XSS')</script>"
        part: body
