id: CVE-2020-13231

info:
  name: CSRF in Cacti Admin Email Change
  author: ProjectDiscoveryAI
  severity: medium
  description: In Cacti before 1.2.11, auth_profile.php?action=edit allows CSRF for an admin email change.
  impact: |
    High impact as it can lead to unauthorized access and potential account takeover.
  remediation: |
    Implement CSRF protection mechanisms such as unique tokens for each request in Cacti application.
  reference:
    - https://github.com/Cacti/cacti/issues/3342
    - https://github.com/Cacti/cacti/releases/tag/release%2F1.2.11
    - https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/ICJMWSY77IIGZYR6FE6NAQZFBO42VECO/
    - https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/Q3PCDGNELH7HEBIXRNT5J5EWQEXQAU6B/
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:H/A:N
    cvss-score: 6.5
    cve-id: CVE-2020-13231
    cwe-id: CWE-352
    epss-score: 0.00119
    epss-percentile: 0.4748
    cpe: cpe:2.3:a:cacti:cacti:*:*:*:*:*:*:*:*
  metadata:
    vendor: cacti
    product: cacti
    shodan-query: title:"Login to Cacti"
    fofa-query:
      - icon_hash="-1797138069"
      - title="cacti"
      - title="login to cacti"
    google-query:
      - intitle:"cacti"
      - intitle:"login to cacti"

http:
  - method: GET
    path:
      - "{{BaseURL}}/cacti/auth_profile.php?action=edit"

    matchers:
      - type: word
        words:
          - "Change Email"
        part: body
