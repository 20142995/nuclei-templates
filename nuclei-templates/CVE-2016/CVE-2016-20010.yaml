id: CVE-2016-20010

info:
  name: EWWW Image Optimizer Remote Command Execution
  author: ProjectDiscoveryAI
  severity: critical
  description: EWWW Image Optimizer before 2.8.5 allows remote command execution because it relies on a protection mechanism involving boolval, which is unavailable before PHP 5.5.
  impact: |
    Successful exploitation could allow an attacker to execute arbitrary commands on the target system.
  remediation: |
    Update to the latest version of the EWWW Image Optimizer plugin to mitigate CVE-2016-20010.
  reference:
    - https://www.wordfence.com/blog/2016/06/vulnerability-ewww-image-optimizer/
    - https://plugins.trac.wordpress.org/browser/ewww-image-optimizer/trunk/changelog.txt
    - https://github.com/ARPSyndicate/cvemon
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    cvss-score: 10
    cve-id: CVE-2016-20010
    epss-score: 0.00353
    epss-percentile: 0.72691
    cpe: cpe:2.3:a:ewww:image_optimizer:*:*:*:*:*:wordpress:*:*
  metadata:
    vendor: ewww
    product: image_optimizer
    framework: wordpress

http:
  - method: POST
    path:
      - "{{BaseURL}}/wp-admin/update.php?action=upgrade-plugin&plugin=ewww-image-optimizer%2Fewww-image-optimizer.php"

    headers:
      Content-Type: application/x-www-form-urlencoded

    body: "plugin=ewww-image-optimizer/ewww-image-optimizer.php"
    matchers:
      - type: status
        status:
          - 200

  - method: GET
    path:
      - "{{BaseURL}}/wp-content/plugins/ewww-image-optimizer/ewww-image-optimizer.php"

    matchers:
      - type: status
        status:
          - 404
