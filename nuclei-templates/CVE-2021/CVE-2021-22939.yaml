id: CVE-2021-22939

info:
  name: Node.js HTTPS rejectUnauthorized Undefined Handling
  author: ProjectDiscoveryAI
  severity: medium
  description: |
    If the Node.js https API was used incorrectly and "undefined" was passed for the "rejectUnauthorized" parameter,
    no error was returned and connections to servers with an expired certificate would have been accepted.
  impact: |
    An attacker can bypass TLS certificate validation and potentially perform man-in-the-middle attacks.
  remediation: |
    Update Node.js to a version that includes the fix for CVE-2021-22939 or explicitly set rejectUnauthorized to true in HTTPS options.
  reference:
    - https://hackerone.com/reports/1278254
    - https://lists.debian.org/debian-lts-announce/2022/10/msg00006.html
    - https://security.gentoo.org/glsa/202401-02
    - https://security.netapp.com/advisory/ntap-20210917-0003/
    - https://github.com/n0-traces/cve_monitor
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N
    cvss-score: 5.3
    cve-id: CVE-2021-22939
    cwe-id: CWE-295
    epss-score: 0.01084
    epss-percentile: 0.84914
    cpe: cpe:2.3:a:nodejs:node.js:*:*:*:*:lts:*:*:*
  metadata:
    vendor: nodejs
    product: node.js
    shodan-query: cpe:"cpe:2.3:a:nodejs:node.js"
  tags: hackerone

http:
  - method: GET
    path:
      - "{{BaseURL}}"

    headers:
      User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "Your connection is not private"
        part: body
        condition: and
