id: CVE-2021-3148

info:
  name: SaltStack Salt Command Injection Vulnerability
  author: ProjectDiscoveryAI
  severity: critical
  description: An issue was discovered in SaltStack Salt before 3002.5 where sending crafted web requests to the Salt API can result in command injection due to improper handling of single versus double quotes.
  impact: |
    High impact, leading to remote code execution on vulnerable systems.
  remediation: |
    Apply the necessary patches provided by SaltStack to mitigate CVE-2021-3148.
  reference:
    - https://github.com/saltstack/salt/releases
    - https://lists.debian.org/debian-lts-announce/2021/11/msg00009.html
    - https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/7GRVZ5WAEI3XFN2BDTL6DDXFS5HYSDVB/
    - https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/FUGLOJ6NXLCIFRD2JTXBYQEMAEF2B6XH/
    - https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/YOGNT2XWPOYV7YT75DN7PS4GIYWFKOK5/
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2021-3148
    cwe-id: CWE-77
    epss-score: 0.05896
    epss-percentile: 0.93692
    cpe: cpe:2.3:a:saltstack:salt:*:*:*:*:*:*:*:*
  metadata:
    vendor: saltstack
    product: salt

http:
  - method: GET
    path:
      - "{{BaseURL}}/releases"

    matchers:
      - type: word
        words:
          - "Vulnerability: Lack of version reporting in GitHub-generated archives"
        part: body
