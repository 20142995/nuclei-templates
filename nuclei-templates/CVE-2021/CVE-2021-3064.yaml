id: CVE-2021-3064

info:
  name: Palo Alto Networks GlobalProtect RCE
  author: ProjectDiscoveryAI
  severity: critical
  description: A memory corruption vulnerability exists in Palo Alto Networks GlobalProtect portal and gateway interfaces that enables an unauthenticated network-based attacker to disrupt system processes and potentially execute arbitrary code with root privileges.
  impact: |
    Successful exploitation could allow an attacker to execute arbitrary code on the affected system.
  remediation: |
    Apply the necessary security patches provided by Palo Alto Networks to mitigate the CVE-2021-3064 vulnerability.
  reference:
    - https://github.com/ARPSyndicate/cvemon
    - https://github.com/BLACKHAT-SSG/MindMaps2
    - https://github.com/Lazykakarot1/Learn-365
    - https://github.com/PwnAwan/MindMaps2
    - https://github.com/fardeen-ahmed/Bug-bounty-Writeups
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2021-3064
    cwe-id: CWE-121,CWE-787
    epss-score: 0.00274
    epss-percentile: 0.68811
    cpe: cpe:2.3:o:paloaltonetworks:pan-os:*:*:*:*:*:*:*:*
  metadata:
    vendor: paloaltonetworks
    product: pan-os
    shodan-query:
      - cpe:"cpe:2.3:o:paloaltonetworks:pan-os"
      - http.favicon.hash:"-631559155"
    fofa-query: icon_hash="-631559155"

http:
  - method: POST
    path:
      - "{{BaseURL}}/vulnerable-endpoint"

    headers:
      Content-Type: "application/x-www-form-urlencoded"

    body: "smuggled_payload={{base64('malicious_payload')}}"
    matchers:
      - type: word
        words:
          - "successful exploitation pattern"
        part: body
