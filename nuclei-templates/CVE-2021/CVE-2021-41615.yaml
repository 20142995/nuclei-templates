id: CVE-2021-41615

info:
  name: GoAhead WebServer 2.1.8 Insufficient Nonce Entropy
  author: ProjectDiscoveryAI
  severity: critical
  description: |
    websda.c in GoAhead WebServer 2.1.8 has insufficient nonce entropy because the nonce calculation relies on the hardcoded onceuponatimeinparadise value, which does not follow the secret-data guideline for HTTP Digest Access Authentication in RFC 7616 section 3.3 (or RFC 2617 section 3.2.1). NOTE: 2.1.8 is a version from 2003; however, the affected websda.c code appears in multiple derivative works that may be used in 2021. Recent GoAhead software is unaffected.
  impact: |
    An attacker could exploit this vulnerability to bypass security controls and launch attacks.
  remediation: |
    Upgrade to a patched version of GoAhead WebServer 2.1.8 or apply vendor-supplied patches to enhance nonce entropy.
  reference:
    - https://devel.rtems.org/browser/rtems/cpukit/httpd/websda.c?rev=c1427d2758079f0e9dd6a8de1662d78e0d6bc4ca
    - https://github.com/trenta3/goahead-versions/blob/master/2.1.8/230165webs218.tar.gz?raw=true
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2021-41615
    cwe-id: CWE-331
    epss-score: 0.00407
    epss-percentile: 0.74528
    cpe: cpe:2.3:a:embedthis:goahead:2.1.8:*:*:*:*:*:*:*
  metadata:
    vendor: embedthis
    product: goahead
    shodan-query: cpe:"cpe:2.3:a:embedthis:goahead"

http:
  - method: GET
    path:
      - "{{BaseURL}}/path-that-triggers-auth"

    matchers:
      - type: word
        words:
          - "onceuponatimeinparadise"
        part: header
