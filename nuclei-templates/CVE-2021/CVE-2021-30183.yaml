id: CVE-2021-30183

info:
  name: Cleartext Storage of Sensitive Information in Octopus Server
  author: ProjectDiscoveryAI
  severity: high
  description: Cleartext storage of sensitive information in multiple versions of Octopus Server where in certain situations when running import or export processes, the password used to encrypt and decrypt sensitive values would be written to the logs in plaintext.
  impact: |
    Potential exposure of sensitive data to unauthorized users
  remediation: |
    Encrypt sensitive information stored in Octopus Server
  reference: |-
    https://advisories.octopus.com/adv/2021-03---Cleartext-Storage-of-Sensitive-Information-(CVE-2021-30183).1817083941.html
    https://advisories.octopus.com/adv/2021-03---Cleartext-Storage-of-Sensitive-Information-%28CVE-2021-30183%29.1817083941.html
    https://github.com/OctopusDeploy/Issues
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cve-id: CVE-2021-30183
    cwe-id: CWE-312
    epss-score: 0.00178
    epss-percentile: 0.56099
    cpe: cpe:2.3:a:octopus:server:*:*:*:*:*:*:*:*
  metadata:
    vendor: octopus
    product: server
    shodan-query: title:"icewarp"
    fofa-query: title="gotify"
    google-query: intitle:"gotify"

http:
  - method: GET
    path:
      - "{{BaseURL}}/path/to/logfile/or/export/import/process"

    matchers:
      - type: word
        words:
          - "password="
        part: body
