id: CVE-2021-25274

info:
  name: SolarWinds Orion Collector Service Remote Code Execution
  author: ProjectDiscoveryAI
  severity: critical
  description: The Collector Service in SolarWinds Orion Platform before 2020.2.4 uses MSMQ and deserializes messages insecurely, allowing remote arbitrary code execution as LocalSystem.
  reference:
    - https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/full-system-control-with-new-solarwinds-orion-based-and-serv-u-ftp-vulnerabilities/
    - https://github.com/bollwarm/SecToolSet
    - https://github.com/teresaweber685/book_list
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2021-25274
    cwe-id: CWE-502
    epss-score: 0.03741
    epss-percentile: 0.92121
    cpe: cpe:2.3:a:solarwinds:orion_platform:*:*:*:*:*:*:*:*
  metadata:
    vendor: solarwinds
    product: orion_platform
  impact: |
    Successful exploitation could result in unauthorized access, data theft, and complete system compromise.
  remediation: |
    Apply the necessary security patches provided by SolarWinds to mitigate the vulnerability.
network:
  - inputs:
      - data: "{{base64('malicious_payload_here')}}"
    host:
      - "{{Hostname}}"
    port: 1801
    read-size: 1024

    matchers:
      - type: word
        words:
          - "acknowledgment from SolarWinds Collector Service"
        part: data