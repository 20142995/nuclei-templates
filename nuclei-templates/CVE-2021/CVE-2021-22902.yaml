id: CVE-2021-22902

info:
  name: Possible Denial of Service in Action Dispatch
  author: ProjectDiscoveryAI
  severity: high
  description: The actionpack ruby gem before 6.0.3.7, 6.1.3.2 suffers from a possible denial of service vulnerability in the Mime type parser of Action Dispatch. Carefully crafted Accept headers can cause the mime type parser in Action Dispatch to do catastrophic backtracking in the regular expression engine.
  impact: |
    Successful exploitation could lead to a denial of service condition.
  remediation: |
    Apply the vendor-supplied patches or updates to mitigate the vulnerability.
  reference:
    - https://hackerone.com/reports/1138654
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    cvss-score: 7.5
    cve-id: CVE-2021-22902
    epss-score: 0.00104
    epss-percentile: 0.44109
    cpe: cpe:2.3:a:rubyonrails:rails:*:*:*:*:*:*:*:*
  metadata:
    vendor: rubyonrails
    product: rails
    shodan-query:
      - cpe:"cpe:2.3:a:rubyonrails:rails"
      - http.title:"index of" "secret_token.rb"
      - http.title:"index of" "secrets.yml"
      - http.title:"index of" storage.yml
    fofa-query:
      - title="index of" "secret_token.rb"
      - title="index of" "secrets.yml"
      - title="index of" storage.yml
    google-query:
      - intitle:"index of" "secret_token.rb"
      - intitle:"index of" "secrets.yml"
      - intitle:"index of" storage.yml

http:
  - method: GET
    path:
      - "{{BaseURL}}/test"

    headers:
      Accept: "text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8"
    matchers:
      - type: dsl
        dsl:
          - "duration>=6"
