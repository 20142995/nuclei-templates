id: CVE-2021-45268

info:
  name: CSRF to RCE on Backdrop CMS
  author: ProjectDiscoveryAI
  severity: high
  description: A Cross Site Request Forgery (CSRF) vulnerability exists in Backdrop CMS 1.20, which allows remote attackers to gain remote code execution (RCE) on the hosting webserver via uploading a malicious add-on with crafted PHP file.
  impact: |
    Successful exploitation could lead to unauthorized code execution on the server.
  remediation: |
    Apply the latest security patches provided by Backdrop CMS to mitigate the CSRF vulnerability and prevent RCE.

http:
  - method: POST
    path:
      - "{{BaseURL}}/path/to/vulnerable/endpoint"

    body: |
      ajax_page_state[css][core/modules/system/css/system.admin.css]=1&ajax_page_state[css][core/modules/system/css/system.menus.css]=1

    headers:
      Content-Type: application/x-www-form-urlencoded
    matchers:
      - type: word
        words:
          - "successful upload"
        part: body
