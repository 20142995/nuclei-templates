id: CVE-2021-44155

info:
  name: Reprise License Manager 14.2 User Enumeration
  author: ProjectDiscoveryAI
  severity: medium
  description: An issue was discovered in /goform/login_process in Reprise RLM 14.2. When an attacker attempts to login, the response if a username is valid includes "Login Failed", but does not include this string if the username is invalid. This allows an attacker to enumerate valid users.
  impact: |
    An attacker can enumerate valid usernames, aiding in further attacks.
  remediation: |
    Upgrade to Reprise License Manager version 14.2.1 or later to mitigate user enumeration vulnerability.
  reference:
    - http://packetstormsecurity.com/files/165182/Reprise-License-Manager-14.2-User-Enumeration.html
    - https://www.reprisesoftware.com/RELEASE_NOTES
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
    cve-id: CVE-2021-44155
    cwe-id: CWE-209
    epss-score: 0.04147
    epss-percentile: 0.92473
    cpe: cpe:2.3:a:reprisesoftware:reprise_license_manager:14.2:*:*:*:*:*:*:*
  metadata:
    vendor: reprisesoftware
    product: reprise_license_manager
    shodan-query: http.html:"Reprise License"
    fofa-query:
      - body="reprise license manager"
      - body="reprise license"
    google-query: inurl:"/goforms/menu"
  tags: packetstorm,user enumeration

http:
  - method: POST
    path:
      - "{{BaseURL}}/goform/login_process"

    body: |
      username=invaliduser&password=invalidpassword

    headers:
      Content-Type: application/x-www-form-urlencoded
    matchers:
      - type: word
        words:
          - "Login Failed"
        part: body
        negative: true

  - method: POST
    path:
      - "{{BaseURL}}/goform/login_process"

    body: |
      username=validuser&password=invalidpassword

    headers:
      Content-Type: application/x-www-form-urlencoded
    matchers:
      - type: word
        words:
          - "Login Failed"
        part: body
