id: CVE-2021-46440

info:
  name: Strapi Documentation Plugin Password Disclosure
  author: ProjectDiscoveryAI
  severity: high
  description: Storing passwords in a recoverable format in the DOCUMENTATION plugin component of Strapi before 3.6.9 and 4.x before 4.1.5 allows an attacker to access a victim's HTTP request, get the victim's cookie, perform a base64 decode on the victim's cookie, and obtain a cleartext password.
  impact: |
    High impact as it exposes sensitive information such as passwords.
  remediation: |
    Update Strapi Documentation Plugin to the latest version to mitigate CVE-2021-46440.
  reference:
    - https://hub.docker.com/r/strapi/strapi
    - https://github.com/karimhabush/cyberowl
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cve-id: CVE-2021-46440
    cwe-id: CWE-522
    epss-score: 0.00759
    epss-percentile: 0.8174
    cpe: cpe:2.3:a:strapi:strapi:*:*:*:*:*:*:*:*
  metadata:
    vendor: strapi
    product: strapi
    shodan-query:
      - http.html:"welcome to your strapi app"
      - http.title:"strapi"
      - http.title:"welcome to your strapi app"
    fofa-query:
      - app="strapi-headless-cms"
      - body="welcome to your strapi app"
      - title="strapi"
      - title="welcome to your strapi app"
    google-query:
      - intitle:"strapi"
      - intitle:"welcome to your strapi app"

http:
  - method: POST
    path:
      - "{{BaseURL}}/documentation/login"

    body: "password=password"
    matchers:
      - type: word
        words:
          - "Redirecting to /documentation"
        part: body
