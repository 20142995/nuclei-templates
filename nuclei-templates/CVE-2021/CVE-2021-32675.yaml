id: CVE-2021-32675

info:
  name: Redis Memory Allocation Vulnerability
  author: ProjectDiscoveryAI
  severity: high
  description: |
    Redis is an open source, in-memory database that persists on disk. This vulnerability allows an attacker to cause the server to allocate significant amounts of memory via specially crafted RESP requests, potentially leading to denial of service. The vulnerability can be exploited by unauthenticated users and is fixed in Redis versions 6.2.6, 6.0.16, and 5.0.14.
  remediation: |
    To mitigate this vulnerability, it is recommended to upgrade Redis to the latest secure versions: 6.2.6, 6.0.16, or 5.0.14. Additionally, consider configuring Redis to bind only to localhost or use a firewall to restrict access to trusted hosts.

tcp:
  - inputs:
      - data: "*3\r\n$3\r\nSET\r\n$1\r\nx\r\n$255\r\n{{randstr}}\r\n"
    host:
      - "{{Hostname}}"
    port: 6379
    read-size: 1024

    matchers:
      - type: word
        words:
          - "OK"
        part: data