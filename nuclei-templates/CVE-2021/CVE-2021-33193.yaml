id: CVE-2021-33193

info:
  name: Apache HTTP Server HTTP/2 Method Bypass
  author: ProjectDiscoveryAI
  severity: high
  description: A crafted method sent through HTTP/2 will bypass validation and be forwarded by mod_proxy, leading to request splitting or cache poisoning. This issue affects Apache HTTP Server 2.4.17 to 2.4.48.
  impact: |
    An attacker can exploit this vulnerability to perform unauthorized actions.
  remediation: |
    Upgrade Apache HTTP Server to version 2.4.48 or later.
  reference:
    - https://lists.apache.org/thread.html/re4162adc051c1a0a79e7a24093f3776373e8733abaff57253fef341d%40%3Ccvs.httpd.apache.org%3E
    - https://lists.apache.org/thread.html/ree7519d71415ecdd170ff1889cab552d71758d2ba2904a17ded21a70%40%3Ccvs.httpd.apache.org%3E
    - https://lists.debian.org/debian-lts-announce/2023/03/msg00002.html
    - https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/DSM6UWQICBJ2TU727RENU3HBKEAFLT6T/
    - https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/EUVJVRJRBW5QVX4OY3NOHZDQ3B3YOTSG/
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    cvss-score: 7.5
    cve-id: CVE-2021-33193
    epss-score: 0.00125
    epss-percentile: 0.48527
    cpe: cpe:2.3:a:apache:http_server:*:*:*:*:*:*:*:*
  metadata:
    vendor: apache
    product: http_server
    shodan-query: Apache 2.4.49
    fofa-query:
      - title="apache http server test page powered by centos"
      - title="apache+default","apache+http+server+test","apache2+it+works"
      - title="apache2 debian default page:"
      - title="test page for the ssl/tls-aware apache installation on web site"
    google-query:
      - intitle:"apache http server test page powered by centos"
      - intitle:"apache+default","apache+http+server+test","apache2+it+works"
      - intitle:"apache2 debian default page:"
      - intitle:"test page for the ssl/tls-aware apache installation on web site"

http:
  - method: POST
    path:
      - "{{BaseURL}}/login"

    headers:
      Content-Type: application/x-www-form-urlencoded

    body: "username=admin&password=admin"
    matchers:
      - type: word
        words:
          - "Welcome back"
        part: body

  - method: GET
    path:
      - "{{BaseURL}}/products"
      - "{{BaseURL}}/solutions"
      - "{{BaseURL}}/research"
      - "{{BaseURL}}/academy"
      - "{{BaseURL}}/support"
      - "{{BaseURL}}/company"
      - "{{BaseURL}}/customers"
      - "{{BaseURL}}/about"
      - "{{BaseURL}}/blog"
      - "{{BaseURL}}/careers"
      - "{{BaseURL}}/legal"
      - "{{BaseURL}}/contact"
      - "{{BaseURL}}/resellers"
      - "{{BaseURL}}/myaccount"

    headers:
      X-Test: "test"
    matchers:
      - type: status
        status:
          - 200
