id: CVE-2021-22931

info:
  name: Node.js DNS Library Hostname Validation RCE, XSS, and Domain Hijacking
  author: ProjectDiscoveryAI
  severity: critical
  description: Node.js before 16.6.0, 14.17.4, and 12.22.4 is vulnerable to Remote Code Execution, XSS, Application crashes due to missing input validation of host names returned by Domain Name Servers in Node.js dns library.
  impact: |
    Remote code execution, cross-site scripting, and domain hijacking.
  remediation: |
    Update Node.js DNS Library to the latest version to mitigate CVE-2021-22931.
  reference:
    - https://security.gentoo.org/glsa/202401-02
    - https://security.netapp.com/advisory/ntap-20210923-0001/
    - https://security.netapp.com/advisory/ntap-20211022-0003/
    - https://www.oracle.com/security-alerts/cpujul2022.html
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2021-22931
    cwe-id: CWE-170,CWE-20
    epss-score: 0.0302
    epss-percentile: 0.91291
    cpe: cpe:2.3:a:nodejs:node.js:*:*:*:*:-:*:*:*
  metadata:
    vendor: nodejs
    product: node.js
    shodan-query: cpe:"cpe:2.3:a:nodejs:node.js"

http:
  - method: GET
    path:
      - "{{BaseURL}}/example?domain=cnamezeroweb.test.xdi-attack.net"
      - "{{BaseURL}}/example?domain=cnamexss.test.xdi-attack.net"

    matchers:
      - type: word
        words:
          - "cnamezeroweb.test.xdi-attack.net"
          - "cnamexss.test.xdi-attack.net"
        part: body
        condition: or
