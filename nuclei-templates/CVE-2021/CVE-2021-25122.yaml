id: CVE-2021-25122

info:
  name: Apache Tomcat h2c Request Mix-up Vulnerability
  author: ProjectDiscoveryAI
  severity: high
  description: Apache Tomcat versions 10.0.0-M1 to 10.0.0, 9.0.0.M1 to 9.0.41, and 8.5.0 to 8.5.61 could duplicate request headers and a limited amount of request body from one request to another, potentially exposing sensitive information between users.
  impact: |
    An attacker could exploit this vulnerability to intercept or manipulate sensitive data transmitted over cleartext HTTP/2 connections.
  remediation: |
    Upgrade Apache Tomcat to version containing the fix for CVE-2021-25122 or apply the vendor-supplied patch.
  reference:
    - http://www.openwall.com/lists/oss-security/2021/03/01/1
    - https://lists.apache.org/thread.html/r7b95bc248603360501f18c8eb03bb6001ec0ee3296205b34b07105b7%40%3Cannounce.apache.org%3E
    - https://lists.apache.org/thread.html/r7b95bc248603360501f18c8eb03bb6001ec0ee3296205b34b07105b7%40%3Cdev.tomcat.apache.org%3E
    - https://lists.apache.org/thread.html/r7b95bc248603360501f18c8eb03bb6001ec0ee3296205b34b07105b7%40%3Cusers.tomcat.apache.org%3E
    - https://lists.apache.org/thread.html/rcd90bf36b1877e1310b87ecd14ed7bbb15da52b297efd9f0e7253a3b%40%3Cusers.tomcat.apache.org%3E
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cve-id: CVE-2021-25122
    cwe-id: CWE-200
    epss-score: 0.00217
    epss-percentile: 0.60576
    cpe: cpe:2.3:a:apache:tomcat:*:*:*:*:*:*:*:*
  metadata:
    vendor: apache
    product: tomcat
    shodan-query: title:"Apache Tomcat"
    fofa-query:
      - body="apache tomcat"
      - body="jk status manager"
      - title="apache tomcat"
    google-query: intitle:"apache tomcat"

http:
  - method: POST
    path:
      - "{{BaseURL}}/example"

    headers:
      Content-Type: "application/x-www-form-urlencoded"

    body: "test=data"
    matchers:
      - type: word
        words:
          - "duplicate"
        part: body
