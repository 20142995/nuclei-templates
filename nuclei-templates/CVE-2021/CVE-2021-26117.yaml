id: CVE-2021-26117

info:
  name: Apache ActiveMQ LDAP Anonymous Access Vulnerability
  author: ProjectDiscoveryAI
  severity: high
  description: The optional ActiveMQ LDAP login module can be configured to use anonymous access to the LDAP server. In this case, for Apache ActiveMQ Artemis prior to version 2.16.0 and Apache ActiveMQ prior to versions 5.16.1 and 5.15.14, the anonymous context is used to verify a valid users password in error, resulting in no check on the password.
  impact: |
    An attacker can exploit this vulnerability to access sensitive information stored in the LDAP server.
  remediation: |
    Disable anonymous access to LDAP in Apache ActiveMQ configuration.
  reference:
    - https://lists.apache.org/thread.html/r110cacfa754471361234965ffe851a046e302ff2693b055f49f47b02%40%3Cissues.activemq.apache.org%3E
    - https://lists.apache.org/thread.html/r22cdc0fb45e223ac92bc2ceff7af92f1193dfc614c8b248534456229%40%3Cissues.activemq.apache.org%3E
    - https://lists.apache.org/thread.html/r3341d96d8f956e878fb7b463b08d57ca1d58fec9c970aee929b58e0d%40%3Cissues.activemq.apache.org%3E
    - https://lists.apache.org/thread.html/r519bfafd67091d0b91243efcb1c49b1eea27321355ba5594f679277d%40%3Cissues.activemq.apache.org%3E
    - https://lists.apache.org/thread.html/r5899ece90bcae5805ad6142fdb05c58595cff19cb2e98cc58a91f55b%40%3Cgitbox.activemq.apache.org%3E
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    cvss-score: 7.5
    cve-id: CVE-2021-26117
    cwe-id: CWE-287
    epss-score: 0.00156
    epss-percentile: 0.53164
    cpe: cpe:2.3:a:apache:activemq:*:*:*:*:*:*:*:*
  metadata:
    vendor: apache
    product: activemq
    shodan-query: product:"ActiveMQ OpenWire Transport"
    fofa-query: title="apache activemq"
    google-query: intitle:"apache activemq"

http:
  - method: POST
    path:
      - "{{BaseURL}}/some-endpoint" # Example endpoint, adjust based on the actual vulnerable endpoint

    body: "username=admin&password="

    headers:
      Content-Type: application/x-www-form-urlencoded
    matchers:
      - type: word
        words:
          - "Logged in successfully" # Example success message, adjust based on actual success response
        part: body
