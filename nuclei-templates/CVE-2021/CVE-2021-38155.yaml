id: CVE-2021-38155

info:
  name: OpenStack Keystone UUID Disclosure
  author: ProjectDiscoveryAI
  severity: high
  description: OpenStack Keystone 10.x through 19.x allows information disclosure during account locking by exposing UUIDs through failed authentication attempts.
  impact: |
    High impact as it can lead to unauthorized access and information disclosure.
  remediation: |
    Apply the necessary patches provided by OpenStack to mitigate the vulnerability (CVE-2021-38155).
  reference:
    - https://lists.debian.org/debian-lts-announce/2024/01/msg00007.html
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cve-id: CVE-2021-38155
    cwe-id: CWE-307
    epss-score: 0.00171
    epss-percentile: 0.55229
    cpe: cpe:2.3:a:openstack:keystone:*:*:*:*:*:*:*:*
  metadata:
    vendor: openstack
    product: keystone

http:
  - method: GET
    path:
      - "{{BaseURL}}/v3/users"

    headers:
      Authorization: "Bearer <valid_token>"
    matchers:
      - type: word
        words:
          - '"id": "'
        part: body

  - method: POST
    path:
      - "{{BaseURL}}/v3/users"

    headers:
      Authorization: "Bearer <valid_token>"
      Content-Type: "application/json"

    body: |
      {
        "user": {
          "id": "<different_user_UUID>"
        }
      }
    matchers:
      - type: word
        words:
          - '"name": "'
        part: body
