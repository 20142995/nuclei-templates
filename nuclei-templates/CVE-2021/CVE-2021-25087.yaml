id: CVE-2021-25087

info:
  name: Wordpress Download Manager < 3.2.35 - Sensitive Information Disclosure
  author: ProjectDiscoveryAI
  severity: high
  description: The Download Manager WordPress plugin before 3.2.35 does not have any authorisation checks in some of the REST API endpoints, allowing unauthenticated attackers to call them, which could lead to sensitive information disclosure, such as posts passwords (fixed in 3.2.24) and files Master Keys (fixed in 3.2.25).
  impact: |
    An attacker can exploit this vulnerability to access sensitive information, potentially leading to further attacks.
  remediation: |
    Update Wordpress Download Manager plugin to version 3.2.35 or later to mitigate the vulnerability.
  reference:
    - https://wpscan.com/vulnerability/d7ceafae-65ec-4e05-9ed1-59470771bf07
    - https://github.com/ARPSyndicate/cvemon
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cve-id: CVE-2021-25087
    cwe-id: CWE-862
    epss-score: 0.00312
    epss-percentile: 0.70865
    cpe: cpe:2.3:a:wpdownloadmanager:wordpress_download_manager:*:*:*:*:*:wordpress:*:*
  metadata:
    vendor: wpdownloadmanager
    product: wordpress_download_manager
    framework: wordpress
  tags: wpscan

http:
  - method: GET
    path:
      - "{{BaseURL}}/wp-json/wpdm/search"

    matchers:
      - type: word
        words:
          - "password"
        part: body

  - method: POST
    path:
      - "{{BaseURL}}/wp-json/wpdm/validate-password"

    body: ""
    matchers:
      - type: word
        words:
          - "_wpdmkey"
        part: body
