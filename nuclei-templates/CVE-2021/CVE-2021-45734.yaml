id: CVE-2021-45734

info:
  name: TOTOLINK X5000R setUrlFilterRules Stack Overflow DoS
  author: ProjectDiscoveryAI
  severity: high
  description: TOTOLINK X5000R v9.1.0u.6118_B20201102 was discovered to contain a stack overflow in the function setUrlFilterRules. This vulnerability allows attackers to cause a Denial of Service (DoS) via the url parameter.
  impact: |
    Successful exploitation could result in denial of service.
  remediation: |
    Apply the vendor-supplied patch or update to the latest firmware version.
  reference:
    - https://github.com/pjqwudi/my_vuln/blob/main/totolink/vuln_10/10.md

http:
  - method: POST
    path:
      - "{{BaseURL}}/path/to/vulnerable/endpoint"

    headers:
      Content-Type: "application/x-www-form-urlencoded"

    body: "url={{randstr}}&otherparam=value"
    matchers:
      - type: status
        status:
          - 500

      - type: word
        words:
          - "Internal Server Error"
        part: body
