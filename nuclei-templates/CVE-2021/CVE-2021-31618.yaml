id: CVE-2021-31618

info:
  name: Apache HTTP Server HTTP/2 NULL Pointer Dereference DoS
  author: ProjectDiscoveryAI
  severity: high
  description: Apache HTTP Server protocol handler for the HTTP/2 protocol checks received request headers against the size limitations as configured for the server and used for the HTTP/1 protocol as well. On violation of these restrictions and HTTP response is sent to the client with a status code indicating why the request was rejected. This rejection response was not fully initialised in the HTTP/2 protocol handler if the offending header was the very first one received or appeared in a footer. This led to a NULL pointer dereference on initialised memory, crashing reliably the child process. Since such a triggering HTTP/2 request is easy to craft and submit, this can be exploited to DoS the server. This issue affected mod_http2 1.15.17 and Apache HTTP Server version 2.4.47 only. Apache HTTP Server 2.4.47 was never released.
  impact: |
    An attacker can exploit this vulnerability to cause a denial of service by sending a crafted HTTP/2 request, potentially leading to service disruption.
  remediation: |
    Apply the necessary patch provided by Apache to address the CVE-2021-31618 vulnerability in the HTTP Server.
  reference:
    - http://www.openwall.com/lists/oss-security/2021/06/10/9
    - http://www.openwall.com/lists/oss-security/2024/03/13/2
    - https://lists.apache.org/thread.html/r14b66ef0f4f569fd515a3f96cd4eb58bd9a8ff525cc326bb0359664f%40%3Ccvs.httpd.apache.org%3E
    - https://lists.apache.org/thread.html/r783b6558abf3305b17ea462bed4bd66d82866438999bf38cef6d11d1%40%3Ccvs.httpd.apache.org%3E
    - https://lists.debian.org/debian-lts-announce/2021/07/msg00006.html
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    cvss-score: 7.5
    cve-id: CVE-2021-31618
    cwe-id: CWE-476
    epss-score: 0.03107
    epss-percentile: 0.91409
    cpe: cpe:2.3:a:apache:http_server:1.15.17:*:*:*:*:*:*:*
  metadata:
    vendor: apache
    product: http_server
    shodan-query: Apache 2.4.49
    fofa-query:
      - title="apache http server test page powered by centos"
      - title="apache+default","apache+http+server+test","apache2+it+works"
      - title="apache2 debian default page:"
      - title="test page for the ssl/tls-aware apache installation on web site"
    google-query:
      - intitle:"apache http server test page powered by centos"
      - intitle:"apache+default","apache+http+server+test","apache2+it+works"
      - intitle:"apache2 debian default page:"
      - intitle:"test page for the ssl/tls-aware apache installation on web site"

http:
  - method: POST
    path:
      - "{{BaseURL}}/path-that-triggers-the-vulnerability"

    headers:
      Content-Type: "application/json"
      Custom-Header: "test" # Assuming this header triggers the vulnerability

    body: |
      {
        "example": "data"
      }
    matchers:
      - type: status
        status:
          - 500 # Assuming the server responds with a 500 error on crash
