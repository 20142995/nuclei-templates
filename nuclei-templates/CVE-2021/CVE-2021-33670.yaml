id: CVE-2021-33670

info:
  name: SAP NetWeaver Java Denial of Service Vulnerability
  author: ProjectDiscoveryAI
  severity: high
  description: SAP NetWeaver AS for Java (Http Service Monitoring Filter), versions - 7.10, 7.11, 7.20, 7.30, 7.31, 7.40, 7.50, allows an attacker to send multiple HTTP requests with different method types thereby crashing the filter and making the HTTP server unavailable to other legitimate users leading to denial of service vulnerability.
  impact: |
    Successful exploitation could lead to a complete denial of service, impacting availability.
  remediation: |
    Apply the latest patches provided by SAP to mitigate the vulnerability (CVE-2021-33670).
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2021-33670
    - https://onapsis.com/blog/sap-security-patch-day-july-2021-serious-vulnerabilities-sap-netweaver-java-fixed
    - https://launchpad.support.sap.com/#/notes/3056652
    - https://github.com/Onapsis/vulnerability_advisories
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    cvss-score: 7.5
    cve-id: CVE-2021-33670
    epss-score: 0.00614
    epss-percentile: 0.79368
    cpe: cpe:2.3:a:sap:netweaver_application_server_java:7.10:*:*:*:*:*:*:*
  metadata:
    vendor: sap
    product: netweaver_application_server_java
    shodan-query: http.favicon.hash:-266008933
    fofa-query: icon_hash=-266008933

http:
  - method: GET
    path:
      - "{{BaseURL}}/path-that-triggers-vulnerability"

    matchers:
      - type: status
        status:
          - 500 # Assuming the server responds with a 500 Internal Server Error when the vulnerability is triggered
