id: CVE-2021-34540

info:
  name: Advantech WebAccess XSS Vulnerability
  author: ProjectDiscoveryAI
  severity: medium
  description: Advantech WebAccess 8.4.2 and 8.4.4 allows XSS via the username column of the bwRoot.asp page of WADashboard.
  impact: |
    Successful exploitation of this vulnerability could allow an attacker to execute malicious scripts in the context of the user's browser, potentially leading to account takeover, data theft, or other malicious actions.
  remediation: |
    Apply the latest security patches provided by Advantech to mitigate the XSS vulnerability in WebAccess.
  reference:
    - https://github.com/ethancsyang/CveProject/tree/main/CVE-2021-34540
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2021-34540
    cwe-id: CWE-79
    epss-score: 0.0032
    epss-percentile: 0.71302
    cpe: cpe:2.3:a:advantech:webaccess:8.4.2:*:*:*:*:*:*:*
  metadata:
    vendor: advantech
    product: webaccess

http:
  - method: GET
    path:
      - "{{BaseURL}}/bwRoot.asp"

    matchers:
      - type: word
        words:
          - "<a onclick=\"alert(1)\">root</a>"
        part: body
