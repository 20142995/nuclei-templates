id: CVE-2021-43449

info:
  name: ONLYOFFICE SSRF via WebSocket Endpoint
  author: ProjectDiscoveryAI
  severity: high
  description: ONLYOFFICE all versions as of 2021-11-08 is vulnerable to Server-Side Request Forgery (SSRF) via the WebSocket endpoint which allows unauthenticated remote code execution.

network:
  - inputs:
      - data: "GET /websocket HTTP/1.1\r
Host: {{Hostname}}\r
Upgrade: websocket\r
Connection: Upgrade\r
Sec-WebSocket-Key: randomkey==\r
Sec-WebSocket-Version: 13\r
\r
"
    host:
      - "{{Hostname}}"
    read-size: 1024
    matchers:
      - type: word
        words:
          - "HTTP/1.1 101 Switching Protocols"
        part: data