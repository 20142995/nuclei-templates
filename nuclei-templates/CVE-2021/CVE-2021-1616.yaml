id: CVE-2021-1616

info:
  name: Cisco IOS XE H.323 ALG Bypass Vulnerability
  author: ProjectDiscoveryAI
  severity: medium
  description: |
    A vulnerability in the H.323 application level gateway (ALG) used by the Network Address Translation (NAT) feature of Cisco IOS XE Software could allow an unauthenticated, remote attacker to bypass the ALG. This vulnerability is due to insufficient data validation of traffic that is traversing the ALG. An attacker could exploit this vulnerability by sending crafted traffic to a targeted device. A successful exploit could allow the attacker to bypass the ALG and open connections that should not be allowed to a remote device located behind the ALG. Note: This vulnerability has been publicly discussed as NAT Slipstreaming.
  reference:
    - https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-iosxe-h323alg-bypass-4vy2MP2Q
  remediation: |
    It is recommended to keep the H.323 ALG service enabled to ensure proper security measures are in place for H.323 protocol traffic. Regularly monitor the configuration settings to detect any unauthorized changes.

tcp:
  - inputs:
      - data: "show running-config | include ip nat service H225\r\n"
    host:
      - "{{Hostname}}"
    port: 23
    read-size: 1024
    matchers-condition: or
    matchers:
      - type: word
        words:
          - "ip nat service H225"
      - type: regex
        regex:
          - "ip nat service H225"