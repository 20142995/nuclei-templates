id: CVE-2021-41303

info:
  name: Apache Shiro Authentication Bypass
  author: ProjectDiscoveryAI
  severity: critical
  description: Apache Shiro before 1.8.0, when using Apache Shiro with Spring Boot, may allow an authentication bypass via a specially crafted HTTP request.
  impact: |
    Successful exploitation could allow an attacker to bypass authentication and gain unauthorized access to the application.
  remediation: |
    Upgrade to Apache Shiro version 1.7.1 or later to mitigate the vulnerability.
  reference:
    - https://lists.apache.org/thread.html/raae98bb934e4bde304465896ea02d9798e257e486d04a42221e2c41b%40%3Cuser.shiro.apache.org%3E
    - https://security.netapp.com/advisory/ntap-20220609-0001/
    - https://github.com/pen4uin/awesome-vulnerability-research
    - https://github.com/pen4uin/vulnerability-research
    - https://github.com/pen4uin/vulnerability-research-list
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2021-41303
    cwe-id: CWE-287,NVD-CWE-noinfo
    epss-score: 0.28344
    epss-percentile: 0.96993
    cpe: cpe:2.3:a:apache:shiro:*:*:*:*:*:*:*:*
  metadata:
    vendor: apache
    product: shiro
    shodan-query: http.title:"apache shiro quickstart"
    fofa-query: title="apache shiro quickstart"
    google-query: intitle:"apache shiro quickstart"

http:
  - method: GET
    path:
      - "{{BaseURL}}/shiro-example"

    headers:
      Cookie: "rememberMe=1; path=/; HttpOnly"
    matchers:
      - type: status
        status:
          - 200
