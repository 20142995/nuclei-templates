id: CVE-2021-34684

info:
  name: Hitachi Vantara Pentaho Business Analytics SQL Injection
  author: ProjectDiscoveryAI
  severity: critical
  description: Hitachi Vantara Pentaho Business Analytics through 9.1 allows an unauthenticated user to execute arbitrary SQL queries on any Pentaho data source and thus retrieve data from the related databases, as demonstrated by an api/repos/dashboards/editor URI.
  impact: |
    Successful exploitation could lead to unauthorized access to sensitive data or complete takeover of the affected system.
  remediation: |
    Apply the vendor-supplied patch or upgrade to a non-vulnerable version.
  reference:
    - https://github.com/Z0fhack/Goby_POC
    - https://github.com/iamaldi/publications
    - https://github.com/ARPSyndicate/cvemon
    - https://github.com/HimmelAward/Goby_POC
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2021-34684
    cwe-id: CWE-89
    epss-score: 0.00752
    epss-percentile: 0.81635
    cpe: cpe:2.3:a:hitachi:vantara_pentaho:*:*:*:*:*:*:*:*
  metadata:
    vendor: hitachi
    product: vantara_pentaho
    shodan-query: Pentaho

http:
  - method: GET
    path:
      - "{{BaseURL}}/api/repos/dashboards/editor?query=SELECT%201"

    matchers:
      - type: word
        words:
          - "expected_response_word_here"
        part: body
