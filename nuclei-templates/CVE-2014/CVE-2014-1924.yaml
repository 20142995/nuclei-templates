id: CVE-2014-1924

info:
  name: Koha MARC Framework SQL Injection
  author: ProjectDiscoveryAI
  severity: critical
  description: The MARC framework import/export function in Koha before specific versions does not require authentication, allowing remote attackers to conduct SQL injection attacks via unspecified vectors.
  impact: |
    Successful exploitation could lead to unauthorized access to sensitive data.
  remediation: |
    Apply the vendor-supplied patch or upgrade to a non-vulnerable version.
  reference:
    - http://bugs.koha-community.org/bugzilla3/show_bug.cgi?id=11666
    - http://www.openwall.com/lists/oss-security/2014/02/07/10
    - http://www.openwall.com/lists/oss-security/2014/02/10/3
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2014-1924
    cwe-id: CWE-89
    epss-score: 0.01092
    epss-percentile: 0.84968
    cpe: cpe:2.3:a:koha:koha:*:*:*:*:*:*:*:*
  metadata:
    vendor: koha
    product: koha
    shodan-query: cpe:"cpe:2.3:a:koha:koha"

http:
  - method: GET
    path:
      - "{{BaseURL}}/admin/import_export_framework.pl"

    matchers:
      - type: word
        words:
          - "DELETE FROM"
          - "INSERT INTO"
        part: body
        condition: or
