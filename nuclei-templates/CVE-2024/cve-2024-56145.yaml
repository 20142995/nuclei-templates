id: cve-2024-56145

info:
  name: Craft CMS Remote Code Execution (CVE-2024-56145)
  author: betmen-n-dgeng
  severity: critical
  description: |
    Craft CMS is vulnerable to a Remote Code Execution (RCE) vulnerability due to improper handling of the `configPath` parameter.
    This template checks if the target is vulnerable by sending a crafted request and checking the response.
  reference:
    - https://www.assetnote.io/resources/research/how-an-obscure-php-footgun-led-to-rce-in-craft-cms
  tags: cve,cve2024,rce,craftcms

requests:
  - method: GET
    path:
      - "{{BaseURL}}?--configPath=/{{randstr}}"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 503

      - type: word
        words:
          - "mkdir()"
          - "{{randstr}}"
        part: body

      - type: word
        words:
          - "Service Unavailable"
        part: header
