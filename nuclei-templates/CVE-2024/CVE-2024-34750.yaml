id: CVE-2024-34750

info:
  name: CVE-2024-34750
  author: Redflare Cyber
  severity: high
  description: Improper Handling of Exceptional Conditions, Uncontrolled Resource Consumption vulnerability in Apache Tomcat. When processing an HTTP/2 stream, Tomcat did not handle some cases of excessive HTTP headers correctly. This led to a miscounting of active HTTP/2 streams which in turn led to the use of an incorrect infinite timeout which allowed connections to remain open which should have been closed.
  classification:
    cpe: cpe:2.3:a:apache:tomcat:*:*:*:*:*:*:*:*
  metadata:
    max-request: 3
    vendor: apache
    product: tomcat
    shodan-query:
      - title:"Apache Tomcat"
      - http.title:"apache tomcat"
      - http.html:"apache tomcat"
      - cpe:"cpe:2.3:a:apache:tomcat"
    fofa-query:
      - body="apache tomcat"
      - title="apache tomcat"
    google-query: intitle:"apache tomcat"
  tags: tech,tomcat,apache,intrusive

http:
  - method: GET
    path:
      - "{{BaseURL}}"
      - "{{BaseURL}}/{{randstr}}"
      - "{{BaseURL}}/docs/introduction.html"

    stop-at-first-match: true

    extractors:
      - type: regex
        name: version
        group: 1
        regex:
          - '(?i)Apache Tomcat.*((11\.0\.0-M([1-9]|1[0-9]|20))|(10\.1\.0-M([1-9]|1[0-9]|2[0-4]))|(9\.0\.(0-M[1-9]|0-M1[0-9]|0-M20|[1-8][0-9]|9[0-8])))'

