id: CVE-2024-31861 # 

info:
  name: Apache Zeppelin shell 代码注入漏洞 # 必填，漏洞名
  author: k3ppf0r # 必填，作者
  severity: critical # 必填，严重程度，critical, high, medium, low, info
  description: |
    Apache Zeppelin 是一个让交互式数据分析变得可行的基于网页的开源框架。Zeppelin提供了数据分析、数据可视化等功能。2024年4月11日，官方发布更新披露 CVE-2024-31861 Apache Zeppelin shell 代码注入漏洞，攻击者可利用Zeppelin 中的shell功能执行任意命令。升级后官方默认禁止shell interpreter。
  reference:
    - https://github.com/apache/zeppelin/pull/4708 
    - https://github.com/apache/zeppelin/pull/4708/files 
    - https://lists.apache.org/thread/99clvqrht5l5r6kzjzwg2kj94boc9sfh 
    - https://www.cve.org/CVERecord?id=CVE-2024-31861
  remediation: |
    1、升级至最新版本。
    2、利用安全组设置其仅对可信地址开放。
  classification:
    # cvss-metrics: CVSS
    cvss-score: 9.8
    cve-id: CVE-2024-31861
    cwe-id: CWE-94
    # cpe: # 可选：cpe:2.3:a:vmware:spring_cloud_function:*:*:*:*:*:*:*:*
  metadata:
    date: 2024-04-11 # 必填，纰漏时间，例：2019-09-22
    version: 0.10.1 <= Apache Zeppelin < 0.11.1
    xxx-query: # 可选
  tags: cve,cve2024



http:
  - raw:
      - |+
        GET /api/security/ticket HTTP/1.1
        Host: {{Hostname}}
        Accept: application/json, text/plain, */*
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.6312.58 Safari/537.36
        X-Requested-With: XMLHttpRequest
        Referer: http://{{Hostname}}
        Accept-Encoding: gzip, deflate, br
        Accept-Language: zh-CN,zh;q=0.9
        Cookie: __test=1
        Connection: close


    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - anonymous
      - type: status
        status:
          - 200

