id: CVE-2024-56145

info:
  name: Craft CMS Remote Code Execution (RCE) Vulnerability
  author: Betmen-N-Dgeng
  severity: critical
  description: |
    Detects the presence of a Remote Code Execution (RCE) vulnerability in Craft CMS (CVE-2024-56145).
    This vulnerability allows an attacker to execute arbitrary code on the target server.
  reference:
    - https://www.assetnote.io/resources/research/how-an-obscure-php-footgun-led-to-rce-in-craft-cms
  tags: cve,cve2024,rce,craftcms

requests:
  - method: GET
    path:
      - "{{BaseURL}}?--configPath=/{{random_uuid}}"

    matchers:
      - type: word
        words:
          - "mkdir()"
          - "{{random_uuid}}"
        condition: and
