id: CVE-2024-6387

info:
  name: Detect RegreSSHion Vulnerability
  author: Yasin Saffari
  severity: Critical
  description: Detects CVE-2024-6387.
  classification:
    cve-id: CVE-2024-6387
  metadata:
    max-request: 2
    vendor: OpenSSH
    product: OpenSSH
  tags: cve,cve2024,regresshion,openssh,ssh

tcp:
  - host:
      - '{{Hostname}}'
    port: 22
    matchers:
      - type: regex
        part: body
        regex:
          - 'OpenSSH_(8\.(5|6|7|8|9)p?[12]?|9\.(0|1|2|3|4|5|6|7)p?[12]?|[0-3]\.[0-9]p?[12]?|4\.(0|1|2|3)p?[12]?)'
