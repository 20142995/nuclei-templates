id: CVE-2024-21762
info:
  name: A out-of-bounds write in Fortinet FortiOS
  author: excis3
  severity: critical
  description: A out-of-bounds write in Fortinet FortiOS versions 7.4.0 through 7.4.2, 7.2.0 through 7.2.6, 7.0.0 through 7.0.13, 6.4.0 through 6.4.14, 6.2.0 through 6.2.15, 6.0.0 through 6.0.17, FortiProxy versions 7.4.0 through 7.4.2, 7.2.0 through 7.2.8, 7.0.0 through 7.0.14, 2.0.0 through 2.0.13, 1.2.0 through 1.2.13, 1.1.0 through 1.1.6, 1.0.0 through 1.0.7 allows attacker to execute unauthorized code or commands via specifically crafted requests
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2024-21762
    - https://github.com/h4x0r-dz/CVE-2024-21762
  tags: tags
http:
  - raw:
      - |+
        GET /remote/login?lang=en HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:123.0) Gecko/20100101 Firefox/123.0
        Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
        Accept-Language: nl,en-US;q=0.7,en;q=0.3
        Accept-Encoding: gzip, deflate, br
        Dnt: 1
        Upgrade-Insecure-Requests: 1
        Sec-Fetch-Dest: document
        Sec-Fetch-Mode: navigate
        Sec-Fetch-Site: same-origin
        Te: trailers
        Connection: close

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - Please Login
      - type: word
        part: body
        words:
          - fortinet
