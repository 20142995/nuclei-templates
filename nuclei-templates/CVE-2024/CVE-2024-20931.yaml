id: CVE-2024-20931

info:
  name: Oracle WebLogic Server - Remote Code Execution
  author: k3ppf0r
  severity: critical
  description: |
    Oracle WebLogic Server (Oracle Fusion Middleware (component: WLS Core Components) is susceptible to a remote code execution vulnerability. Supported versions that are affected are 10.3.6.0.0, 12.1.3.0.0, 2.2.1.3.0 and 12.2.1.4.0. This easily exploitable vulnerability could allow unauthenticated attackers with network access via IIOP to compromise Oracle WebLogic Server.
  impact: |
    Successful exploitation of this vulnerability could allow an attacker to execute arbitrary code on the affected system.
  remediation: |
    1. 官方已发布漏洞补丁及修复版本，请评估业务是否受影响后，酌情升级至安全版本。
    【备注】：建议您在升级前做好数据备份工作，避免出现意外。
    https://www.oracle.com/security-alerts/cpujan2024.html
    2. 临时缓解方案：
    禁用T3协议，登录weblogic后台页面，在base_domain的配置页面中，进入“安全”选项卡页面，点击“筛选器”，进入连接筛选器配置。在连接筛选器中输入：WebLogic.security.net.ConnectionFilterImpl，参考以下写法，在连接筛选器规则中进行配置：
      127.0.0.1 * * allow t3 t3s
      * * * deny t3 t3s
    禁用IIOP协议，登录weblogic后台页面，在左侧菜单页中点击 环境->服务器->AdminServer->协议->IIOP，取消勾选“启动IIOP”。
  reference:
    - https://github.com/hktalent/CVE-2020-2551
    - https://nvd.nist.gov/vuln/detail/CVE-2020-2551
    - https://www.oracle.com/security-alerts/cpujan2020.html
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cve-id: CVE-2024-20931
    epss-score: 0.97491
    epss-percentile: 0.99973
    cpe: cpe:2.3:a:oracle:weblogic_server:10.3.6.0.0:*:*:*:*:*:*:*
  metadata:
    date: 2024-02-17
    version: |
      Oracle WebLogic Server 12.2.1.4.0
      Oracle WebLogic Server 14.1.1.0.0
    max-request: 1
    vendor: oracle
    product: weblogic_server
  tags: cve2024,cve,oracle,weblogic,rce

http:
  - method: GET
    path:
      - "{{BaseURL}}/console/login/LoginForm.jsp"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "12.2.1.4.0"
          - "14.1.1.0.0"
        condition: or

      - type: word
        part: body
        words:
          - "WebLogic"

      - type: status
        status:
          - 200
