id: CVE-2024-8353

info:
  name: GiveWP Plugin PHP Object Injection Vulnerability
  author: ProjectDiscoveryAI
  severity: critical
  description: |
    The GiveWP â€“ Donation Plugin and Fundraising Platform plugin for WordPress is vulnerable to PHP Object Injection in all versions up to, and including, 3.16.1 via deserialization of untrusted input via several parameters like 'give_title' and 'card_address'. This makes it possible for unauthenticated attackers to inject a PHP Object. The additional presence of a POP chain allows attackers to delete arbitrary files and achieve remote code execution.
  impact: |
    An attacker could exploit this vulnerability to execute arbitrary code on the server.
  remediation: |
    Update GiveWP Plugin to the latest version to mitigate the PHP Object Injection vulnerability.
  reference:
    - https://plugins.trac.wordpress.org/browser/give/tags/3.16.0/includes/process-donation.php#L154
    - https://www.wordfence.com/threat-intel/vulnerabilities/id/c4c530fa-eaf4-4721-bfb6-9fc06d7f343c?source=cve
    - https://github.com/20142995/nuclei-templates
    - https://github.com/EQSTLab/CVE-2024-8353
    - https://github.com/cyb3r-w0lf/nuclei-template-collection
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    cvss-score: 10
    cve-id: CVE-2024-8353
    cwe-id: CWE-502
    epss-score: 0.00144
    epss-percentile: 0.51547
    cpe: cpe:2.3:a:givewp:givewp:*:*:*:*:*:wordpress:*:*
  metadata:
    vendor: givewp
    product: givewp
    framework: wordpress
    shodan-query: http.html:"/wp-content/plugins/give/"
    fofa-query: body=/wp-content/plugins/give/
    publicwww-query: /wp-content/plugins/give/

http:
  - method: POST
    path:
      - "{{BaseURL}}/wp-content/plugins/give/handle-donation.php"

    body: |
      give_title={{base64('O:20:"InnocuousClass":0:{}')}}
      card_address={{base64('O:20:"InnocuousClass":0:{}')}}

    headers:
      Content-Type: application/x-www-form-urlencoded
    matchers:
      - type: word
        words:
          - "Thank you for your donation"
        part: body
