id: ibm-d2b-database-server

info:
  name: IBM DB2 Database Server - Detect
  author: pussycat0x
  severity: info
  description: |
    IBM DB2 Database Server panel was detected.
  reference:
    - https://nmap.org/nsedoc/scripts/db2-das-info.html
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:N
    cvss-score: 0.0
    cwe-id: CWE-200
  metadata:
    max-request: 2
    verified: true
    shodan-query: product:"IBM DB2 Database Server"
  tags: network,ibm,database,db,db2,detect

tcp:
  - inputs:
      - data: "01c2000000040000b601000053514c4442325241000100000401010005001d008800000001000080000000010900000001000040000000010900000001000040000000010800000004000040000000010400000001000040000000400400000004000040000000010400000004000040000000010400000004000040000000010400000002000040000000010400000004000040000000010000000001000040000000000400000004000080000000010400000004000080000000010400000003000080000000010400000004000080000000010800000001000040000000010400000004000040000000011000000001000080000000011000000001000080000000010400000004000040000000010900000001000040000000010900000001000080000000010400000003000080000000010000000000000000000000000104000001000080000000010000000000000000000000000000000000000000000000000000000001000040000000010000000001000040000000002020202020202020000000000000000000000000000000000100ff000000000000000000000000000000000000000000e404000000000000000000000000000000000000007f"
        type: hex

    host:
      - "{{Hostname}}"
      - "{{Host}}:50000"

    matchers-condition: and
    matchers:
      - type: word
        encoding: hex
        words:
          - "SQLDB2RA"
          - "DB2"
          - "SQLJS1D"
        condition: or
      - type: word
        words:
          - denied
          - Bad request
          - HTTP
          - 400
        condition: or
        negative: true
