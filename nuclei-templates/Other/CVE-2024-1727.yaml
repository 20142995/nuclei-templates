id: CVE-2024-1727
info:
  name: CSRF Large File Upload in gradio4.16.0
  author: may
  severity: medium
  description: To prevent malicious 3rd party websites from making requests to Gradio applications running locally, this PR tightens the CORS rules around Gradio applications. In particular, it checks to see if the host header is localhost (or one of its aliases) and if so, it requires the origin header (if present) to be localhost (or one of its aliases) as well.
  reference:
    - https://github.com/gradio-app/gradio/commit/84802ee6a4806c25287344dce581f9548a99834a
    - https://huntr.com/bounties/a94d55fb-0770-4cbe-9b20-97a978a2ffff
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:L
    cvss-score: 4.3
    cve-id: CVE-2024-1727
    cwe-id: CWE-352
    epss-score: 0.00043
    epss-percentile: 0.07337
  tags: intrusive

http:
  - method: POST
    path:
      - "{{BaseURL}}/upload?upload_id=k9wbugmn37"
    headers:
      User-Agent: Mozilla/5.0
      Content-Type: multipart/form-data; boundary=---------------------------226429124014608851241059184049
    matchers:
      - type: status
        status:
          - 200

