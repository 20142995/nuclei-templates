id: random-stuffs

info:
  name: Extract random significant stuffs
  author: glatisant
  severity: low

requests:
  - method: GET
    path:
      - "{{BaseURL}}"

    extractors:
      - type: regex
        part: body
        regex:
          - "\b((?:https?://|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}/)(?:[^\s()<>]|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))+(?:\(([^\s()<>]+|(\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:\'\"\\\/.,<>?\xab\xbb\u201c\u201d\u2018\u2019]))"
          - "\u003cinput[^\u003e]+type=[\"']?file[\"']?"
          - "(aws_access|aws_secret|api[_-]?key|ListBucketResult|S3_ACCESS_KEY|Authorization:|RSA PRIVATE|Index of|aws_|secret|ssh-rsa AA)"
          - "([^A-Z0-9]|^)(AKIA|A3T|AGPA|AIDA|AROA|AIPA|ANPA|ANVA|ASIA)[A-Z0-9]{12,}"
          - "([^A-Za-z0-9+/]|^)(eyJ|YTo|Tzo|PD[89]|aHR0cHM6L|aHR0cDo|rO0)[%a-zA-Z0-9+/]+={0,2}"
          - "(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])"
          - "[a-z0-9.-]+\\.s3\\.amazonaws\\.com"
          - "[a-z0-9.-]+\\.s3-[a-z0-9-]\\.amazonaws\\.com"
          - "[a-z0-9.-]+\\.s3-website[.-](eu|ap|us|ca|sa|cn)"
          - "//s3\\.amazonaws\\.com/[a-z0-9._-]+"
          - "//s3-[a-z0-9-]+\\.amazonaws\\.com/[a-z0-9._-]+"