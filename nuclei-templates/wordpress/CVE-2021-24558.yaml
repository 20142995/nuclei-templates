id: CVE-2021-24558

info:
  name: >
    Project Status <= 1.6 - Reflected Cross-Site Scripting
  author: topscoder
  severity: medium
  description: >
    The pspin_duplicate_post_save_as_new_post function of the Project Status WordPress plugin through 1.6 does not sanitise, validate or escape the post GET parameter passed to it before outputting it in an error message when the related post does not exist, leading to a reflected XSS issue
  reference:
    - https://github.com/topscoder/nuclei-wordfence-cve
    - https://www.wordfence.com/threat-intel/vulnerabilities/id/aac9e0cb-cc1e-4041-bb92-21f94c8d35fd?source=api-prod
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 5.4
    cve-id: CVE-2021-24558
  metadata:
    fofa-query: "wp-content/plugins/project-status/"
    google-query: inurl:"/wp-content/plugins/project-status/"
    shodan-query: 'vuln:CVE-2021-24558'
  tags: cve,wordpress,wp-plugin,project-status,medium

http:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}/wp-content/plugins/project-status/readme.txt"

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        internal: true
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "project-status"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '<= 1.6')