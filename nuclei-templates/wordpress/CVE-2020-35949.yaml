id: CVE-2020-35949

info:
  name: >
    Quiz and Survey Master <= 7.0.0 - Arbitrary File Upload
  author: topscoder
  severity: critical
  description: >
    An issue was discovered in the Quiz and Survey Master plugin before 7.0.1 for WordPress. It made it possible for unauthenticated attackers to upload arbitrary files and achieve remote code execution. If a quiz question could be answered by uploading a file, only the Content-Type header was checked during the upload, and thus the attacker could use text/plain for a .php file.
  reference:
    - https://github.com/topscoder/nuclei-wordfence-cve
    - https://www.wordfence.com/threat-intel/vulnerabilities/id/bfd93c33-4672-4914-b052-7bea283ef60c?source=api-prod
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2020-35949
  metadata:
    fofa-query: "wp-content/plugins/quiz-master-next/"
    google-query: inurl:"/wp-content/plugins/quiz-master-next/"
    shodan-query: 'vuln:CVE-2020-35949'
  tags: cve,wordpress,wp-plugin,quiz-master-next,critical

http:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}/wp-content/plugins/quiz-master-next/readme.txt"

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        internal: true
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "quiz-master-next"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '< 7.0.1')