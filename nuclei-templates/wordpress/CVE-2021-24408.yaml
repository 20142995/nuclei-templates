id: CVE-2021-24408

info:
  name: >
    Prismatic <= 2.7 - Stored Cross-Site Scripting
  author: topscoder
  severity: medium
  description: >
    The Prismatic WordPress plugin before 2.8 does not sanitise or validate some of its shortcode parameters, allowing users with a role as low as Contributor to set Cross-Site payload in them. A post made by a contributor would still have to be approved by an admin to have the XSS trigger able in the frontend, however, higher privilege users, such as editor could exploit this without the need of approval, and even when the blog disallows the unfiltered_html capability.
  reference:
    - https://github.com/topscoder/nuclei-wordfence-cve
    - https://www.wordfence.com/threat-intel/vulnerabilities/id/d93c70d6-c439-4bcd-a855-b71896bf9d22?source=api-prod
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 5.4
    cve-id: CVE-2021-24408
  metadata:
    fofa-query: "wp-content/plugins/prismatic/"
    google-query: inurl:"/wp-content/plugins/prismatic/"
    shodan-query: 'vuln:CVE-2021-24408'
  tags: cve,wordpress,wp-plugin,prismatic,medium

http:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}/wp-content/plugins/prismatic/readme.txt"

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        internal: true
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "prismatic"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '<= 2.7')