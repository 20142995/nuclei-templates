id: CVE-2024-1380

info:
  name: >
    Relevanssi – A Better Search <= 4.22.0 - Missing Authorization to Unauthenticated Query Log Export
  author: topscoder
  severity: high
  description: >
    The Relevanssi – A Better Search plugin for WordPress is vulnerable to unauthorized access of data due to a missing capability check on the relevanssi_export_log_check() function in all versions up to, and including, 4.22.0. This makes it possible for unauthenticated attackers to export the query log data. The vendor has indicated that they may look into adding a capability check for proper authorization control, however, this vulnerability is theoretically patched as is.
  reference:
    - https://github.com/topscoder/nuclei-wordfence-cve
    - https://www.wordfence.com/threat-intel/vulnerabilities/id/7b2a3b17-0551-4e02-8e6a-ae8d46da0ef8?source=api-prod
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
    cve-id: CVE-2024-1380
  metadata:
    fofa-query: "wp-content/plugins/relevanssi/"
    google-query: inurl:"/wp-content/plugins/relevanssi/"
    shodan-query: 'vuln:CVE-2024-1380'
  tags: cve,wordpress,wp-plugin,relevanssi,high

http:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}/wp-content/plugins/relevanssi/readme.txt"

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        internal: true
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "relevanssi"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '<= 4.22.0')