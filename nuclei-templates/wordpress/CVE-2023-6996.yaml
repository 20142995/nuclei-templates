id: CVE-2023-6996

info:
  name: >
    Display custom fields in the frontend – Post and User Profile Fields <= 1.2.1 - Authenticated (Contributor+) Code Injection
  author: topscoder
  severity: low
  description: >
    The Display custom fields in the frontend – Post and User Profile Fields plugin for WordPress is vulnerable to Code Injection via the plugin's vg_display_data shortcode in all versions up to, and including, 1.2.1 due to insufficient input validation and restriction on access to that shortcode. This makes it possible for authenticated attackers with contributor-level and above permissions to call arbitrary functions and execute code.
  reference:
    - https://github.com/topscoder/nuclei-wordfence-cve
    - https://www.wordfence.com/threat-intel/vulnerabilities/id/e0662c3a-5b82-4b9a-aa69-147094930d1f?source=api-prod
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.8
    cve-id: CVE-2023-6996
  metadata:
    fofa-query: "wp-content/plugins/shortcode-to-display-post-and-user-data/"
    google-query: inurl:"/wp-content/plugins/shortcode-to-display-post-and-user-data/"
    shodan-query: 'vuln:CVE-2023-6996'
  tags: cve,wordpress,wp-plugin,shortcode-to-display-post-and-user-data,low

http:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}/wp-content/plugins/shortcode-to-display-post-and-user-data/readme.txt"

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        internal: true
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "shortcode-to-display-post-and-user-data"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '<= 1.2.1')