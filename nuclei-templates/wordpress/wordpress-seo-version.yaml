id: wordpress-seo-version

info:
  name: wordpress seo plugin < 4.3.0 cross-site scripting  
  author: Jordan Swebeck
  severity: medium
  description: Find out if the wp seo all in one plugin version is pre 4.3.0, if so it is vulerable to stored XXS
  classification:  
    cve-id: CVE-2023-0585
    cwe-id: CWE-79
    cvss-score: 7.3
  
  tags: cve,cve2023,xss,wp,wp-plugin,wordpress


requests:
  - method: GET
    path:
      - "{{BaseURL}}/wp-content/plugins/all-in-one-seo-pack/readme.txt"

    headers:
      User-Agent: "Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/109.0"
    
    matchers-condition: and
    matchers:
      - type: regex
        part: body
        regex:
          - "Improved PHP 8.1 compatibility"
        negative: true

      - type: status
        status:
          - 200
          - 304

