id: CVE-2022-4109

info:
  name: >
    Wholesale Market for WooCommerce < 2.0.0 - Authenticated (Administrator+) Arbitrary Log File Download
  author: topscoder
  severity: low
  description: >
    The Wholesale Market for WooCommerce plugin for WordPress is vulnerable to Arbitrary Log File Download in versions below 2.0.0. This due to the plugin not verifying that paths accessed belong to the site they are accessed from. This makes it possible for unauthenticated attackers to download log files from the vulnerable service's server even if they belong to another site.
  reference:
    - https://github.com/topscoder/nuclei-wordfence-cve
    - https://www.wordfence.com/threat-intel/vulnerabilities/id/8436ba39-b236-4d76-95b6-d2bed3728d8a?source=api-prod
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:L/I:N/A:N
    cvss-score: 4.1
    cve-id: CVE-2022-4109
  metadata:
    fofa-query: "wp-content/plugins/wholesale-market-for-woocommerce/"
    google-query: inurl:"/wp-content/plugins/wholesale-market-for-woocommerce/"
    shodan-query: 'vuln:CVE-2022-4109'
  tags: cve,wordpress,wp-plugin,wholesale-market-for-woocommerce,low

http:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}/wp-content/plugins/wholesale-market-for-woocommerce/readme.txt"

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        internal: true
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "wholesale-market-for-woocommerce"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '< 2.0.0')