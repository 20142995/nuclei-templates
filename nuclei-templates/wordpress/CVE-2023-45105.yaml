id: CVE-2023-45105

info:
  name: >
    affiliate-toolkit – WordPress Affiliate Plugin <= 3.3.9 - Open Redirect via atkpout.php
  author: topscoder
  severity: low
  description: >
    The affiliate-toolkit – WordPress Affiliate Plugin is vulnerable to Open Redirect in versions up to, and including, 3.3.9. This is due to insufficient validation on the redirect url supplied via the 'url' parameter in atkpout.php. This makes it possible for unauthenticated attackers to redirect users to potentially malicious sites if they can successfully trick them into performing an action. Only sites that do not have a atkp-imagereceiver-key.php setup are vulnerable, as the attacker must calculate the md5 hash of the URL combined with the key from that file in order to successfully redirect victims. If atkp-imagereceiver-key.php is not present, the md5 hash of atkpout.php, which is publicly available, will be used, allowing redirection.
  reference:
    - https://github.com/topscoder/nuclei-wordfence-cve
    - https://www.wordfence.com/threat-intel/vulnerabilities/id/06b332de-4f94-47dc-a573-53514adaf5c0?source=api-prod
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:N/I:L/A:N
    cvss-score: 3.4
    cve-id: CVE-2023-45105
  metadata:
    fofa-query: "wp-content/plugins/affiliate-toolkit-starter/"
    google-query: inurl:"/wp-content/plugins/affiliate-toolkit-starter/"
    shodan-query: 'vuln:CVE-2023-45105'
  tags: cve,wordpress,wp-plugin,affiliate-toolkit-starter,low

http:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}/wp-content/plugins/affiliate-toolkit-starter/readme.txt"

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        internal: true
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "affiliate-toolkit-starter"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '<= 3.3.9')