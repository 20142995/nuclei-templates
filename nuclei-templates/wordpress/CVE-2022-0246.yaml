id: CVE-2022-0246

info:
  name: >
    iQ Block Country < 1.2.13 - Admin+ Arbitrary File Deletion via Zip Slip
  author: topscoder
  severity: medium
  description: >
    The settings of the iQ Block Country WordPress plugin before 1.2.13 can be exported or imported using its backup functionality. An authorized user can import preconfigured settings of the plugin by uploading a zip file. After the uploading process, files in the uploaded zip file are extracted one by one. During the extraction process, existence of a file is checked. If the file exists, it is deleted without any security control by only considering the name of the extracted file. This behavior leads to "Zip Slip" vulnerability.
  reference:
    - https://github.com/topscoder/nuclei-wordfence-cve
    - https://www.wordfence.com/threat-intel/vulnerabilities/id/21e3d4a5-aaf3-4f42-8868-cd8c9bccd026?source=api-prod
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:U/C:H/I:H/A:H
    cvss-score: 6.8
    cve-id: CVE-2022-0246
  metadata:
    fofa-query: "wp-content/plugins/iq-block-country/"
    google-query: inurl:"/wp-content/plugins/iq-block-country/"
    shodan-query: 'vuln:CVE-2022-0246'
  tags: cve,wordpress,wp-plugin,iq-block-country,medium

http:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}/wp-content/plugins/iq-block-country/readme.txt"

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        internal: true
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "iq-block-country"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '< 1.2.13')