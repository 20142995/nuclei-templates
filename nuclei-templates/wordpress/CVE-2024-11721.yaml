id: CVE-2024-11721

info:
  name: >
    Frontend Admin by DynamiApps <= 3.24.5 - Unauthenticated Privilege Escalation
  author: topscoder
  severity: high
  description: >
    The Frontend Admin by DynamiApps plugin for WordPress is vulnerable to privilege escalation in all versions up to, and including, 3.24.5. This is due to insufficient controls on the user role select field when utilizing the 'Role' field in a form. This makes it possible for unauthenticated attackers to create new administrative user accounts, even when the administrative user role has not been provided as an option to the user, granted that unauthenticated users have been provided access to the form.
  reference:
    - https://github.com/topscoder/nuclei-wordfence-cve
    - https://www.wordfence.com/threat-intel/vulnerabilities/id/e9fdc833-8384-42c0-ad9b-72e5b6351964?source=api-prod
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.1
    cve-id: CVE-2024-11721
  metadata:
    fofa-query: "wp-content/plugins/acf-frontend-form-element/"
    google-query: inurl:"/wp-content/plugins/acf-frontend-form-element/"
    shodan-query: 'vuln:CVE-2024-11721'
  tags: cve,wordpress,wp-plugin,acf-frontend-form-element,high

http:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}/wp-content/plugins/acf-frontend-form-element/readme.txt"

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        internal: true
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "acf-frontend-form-element"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '<= 3.24.5')