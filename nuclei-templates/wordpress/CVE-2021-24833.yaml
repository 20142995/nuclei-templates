id: CVE-2021-24833

info:
  name: >
    YOP Poll <= 6.3.0 - Author+ Stored Cross-Site Scripting via Preview Module
  author: topscoder
  severity: medium
  description: >
    The YOP Poll WordPress plugin before 6.3.1 is affected by a stored Cross-Site Scripting vulnerability, which exists in the Admin preview module where a user with a role as low as author is allowed to execute arbitrary script code within the context of the application. This vulnerability is due to insufficient validation of question and answer text parameters in Create Poll module.
  reference:
    - https://github.com/topscoder/nuclei-wordfence-cve
    - https://www.wordfence.com/threat-intel/vulnerabilities/id/2f4e5f34-c107-44da-9f73-e7b25f83e803?source=api-prod
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 5.4
    cve-id: CVE-2021-24833
  metadata:
    fofa-query: "wp-content/plugins/yop-poll/"
    google-query: inurl:"/wp-content/plugins/yop-poll/"
    shodan-query: 'vuln:CVE-2021-24833'
  tags: cve,wordpress,wp-plugin,yop-poll,medium

http:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}/wp-content/plugins/yop-poll/readme.txt"

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        internal: true
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "yop-poll"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '<= 6.3.0')