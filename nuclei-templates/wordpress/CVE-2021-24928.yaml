id: CVE-2021-24928

info:
  name: >
    Rearrange Woocommerce Products <= 3.0.7 - Subscriber+ SQL Injection
  author: topscoder
  severity: low
  description: >
    The Rearrange Woocommerce Products WordPress plugin before 3.0.8 does not have proper access controls in the save_all_order AJAX action, nor validation and escaping when inserting user data in SQL statement, leading to an SQL injection, and allowing any authenticated user, such as subscriber, to modify arbitrary post content (for example with an XSS payload), as well as exfiltrate any data by copying it to another post.
  reference:
    - https://github.com/topscoder/nuclei-wordfence-cve
    - https://www.wordfence.com/threat-intel/vulnerabilities/id/379aa658-ebc4-4000-913e-5f95a4783233?source=api-prod
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N
    cvss-score: 6.5
    cve-id: CVE-2021-24928
  metadata:
    fofa-query: "wp-content/plugins/rearrange-woocommerce-products/"
    google-query: inurl:"/wp-content/plugins/rearrange-woocommerce-products/"
    shodan-query: 'vuln:CVE-2021-24928'
  tags: cve,wordpress,wp-plugin,rearrange-woocommerce-products,low

http:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}/wp-content/plugins/rearrange-woocommerce-products/readme.txt"

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        internal: true
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "rearrange-woocommerce-products"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '< 3.0.8')