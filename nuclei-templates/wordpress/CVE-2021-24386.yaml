id: CVE-2021-24386

info:
  name: >
    WP SVG Images <= 3.3 - Authenticated (author+) Stored Cross-Site Scripting via SVG
  author: topscoder
  severity: low
  description: >
    The WP SVG images WordPress plugin before 3.4 did not sanitise the SVG files uploaded, which could allow low privilege users such as author+ to upload a malicious SVG and then perform XSS attacks by inducing another user to access the file directly. In v3.4, the plugin restricted such upload to editors and admin, with an option to also allow author to do so. The description of the plugin has also been updated with a security warning as upload of such content is intended.
  reference:
    - https://github.com/topscoder/nuclei-wordfence-cve
    - https://www.wordfence.com/threat-intel/vulnerabilities/id/b72a26dd-0d20-462e-bb71-ed83eae6766e?source=api-prod
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N
    cvss-score: 6.4
    cve-id: CVE-2021-24386
  metadata:
    fofa-query: "wp-content/plugins/wp-svg-images/"
    google-query: inurl:"/wp-content/plugins/wp-svg-images/"
    shodan-query: 'vuln:CVE-2021-24386'
  tags: cve,wordpress,wp-plugin,wp-svg-images,low

http:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}/wp-content/plugins/wp-svg-images/readme.txt"

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        internal: true
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "wp-svg-images"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '<= 3.3')