id: CVE-2020-22275

info:
  name: >
    Easy Registration Forms <= 2.0.6 - CSV Injection
  author: topscoder
  severity: high
  description: >
    Easy Registration Forms (ER Forms) Wordpress Plugin 2.0.6 allows an attacker to submit an entry with malicious CSV commands. After that, when the system administrator generates CSV output from the forms information, there is no check on this inputs and the codes are executable.
  reference:
    - https://github.com/topscoder/nuclei-wordfence-cve
    - https://www.wordfence.com/threat-intel/vulnerabilities/id/43a60896-3b88-4b36-b6d9-46812b8ba35b?source=api-prod
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    cvss-score: 8.8
    cve-id: CVE-2020-22275
  metadata:
    fofa-query: "wp-content/plugins/easy-registration-forms/"
    google-query: inurl:"/wp-content/plugins/easy-registration-forms/"
    shodan-query: 'vuln:CVE-2020-22275'
  tags: cve,wordpress,wp-plugin,easy-registration-forms,high

http:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}/wp-content/plugins/easy-registration-forms/readme.txt"

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        internal: true
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "easy-registration-forms"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '<= 2.0.6')