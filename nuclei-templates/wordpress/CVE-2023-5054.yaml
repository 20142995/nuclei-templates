id: CVE-2023-5054

info:
  name: >
    Super Store Finder <= 6.9.3 - Unauthenticated Email Creation/Sending
  author: topscoder
  severity: medium
  description: >
    The Super Store Finder plugin for WordPress is vulnerable to unauthenticated arbitrary email creation and relay in versions up to, and including, 6.9.3. This is due to insufficient restrictions on the sendMail.php file that allows direct access. This makes it possible for unauthenticated attackers to send emails utilizing the vulnerable site's server, with arbitrary content. Please note that this vulnerability has already been publicly disclosed with an exploit which is why we are publishing the details without a patch available, we are attempting to initiate contact with the developer.
  reference:
    - https://github.com/topscoder/nuclei-wordfence-cve
    - https://www.wordfence.com/threat-intel/vulnerabilities/id/d31d0553-9378-4c7e-a258-12562aa6b388?source=api-prod
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:L/A:N
    cvss-score: 5.8
    cve-id: CVE-2023-5054
  metadata:
    fofa-query: "wp-content/plugins/superstorefinder-wp/"
    google-query: inurl:"/wp-content/plugins/superstorefinder-wp/"
    shodan-query: 'vuln:CVE-2023-5054'
  tags: cve,wordpress,wp-plugin,superstorefinder-wp,medium

http:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}/wp-content/plugins/superstorefinder-wp/readme.txt"

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        internal: true
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "superstorefinder-wp"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '<= 6.9.3')