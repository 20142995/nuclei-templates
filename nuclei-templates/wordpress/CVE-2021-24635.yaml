id: CVE-2021-24635

info:
  name: >
    Visual Link Preview <= 2.2.2 - Unauthorised AJAX Calls
  author: topscoder
  severity: low
  description: >
    The Visual Link Preview WordPress plugin before 2.2.3 does not enforce authorisation on several AJAX actions and has the CSRF nonce displayed for all authenticated users, allowing any authenticated user (such as subscriber) to call them and 1) Get and search through title and content of Draft post, 2) Get title of a password-protected post as well as 3) Upload an image from an URL
  reference:
    - https://github.com/topscoder/nuclei-wordfence-cve
    - https://www.wordfence.com/threat-intel/vulnerabilities/id/012e019f-9146-45bc-b4d7-aa724dbebdc6?source=api-prod
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N
    cvss-score: 5.4
    cve-id: CVE-2021-24635
  metadata:
    fofa-query: "wp-content/plugins/visual-link-preview/"
    google-query: inurl:"/wp-content/plugins/visual-link-preview/"
    shodan-query: 'vuln:CVE-2021-24635'
  tags: cve,wordpress,wp-plugin,visual-link-preview,low

http:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}/wp-content/plugins/visual-link-preview/readme.txt"

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        internal: true
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "visual-link-preview"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '< 2.2.3')