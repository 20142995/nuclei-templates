id: CVE-2018-1000510

info:
  name: >
    WP Image Zoom <= 1.23 - Cross-Site Request Forgery to Denial of Service
  author: topscoder
  severity: medium
  description: >
    WP Image Zoom version 1.23 contains a Incorrect Access Control vulnerability in AJAX settings that can result in allows anybody to cause denial of service. This attack appear to be exploitable via Can be triggered intentionally (or unintentionally via CSRF) by any logged in user. This vulnerability appears to have been fixed in 1.24.
  reference:
    - https://github.com/topscoder/nuclei-wordfence-cve
    - https://www.wordfence.com/threat-intel/vulnerabilities/id/312bb534-2a40-42f1-9a3e-8b1395e1e199?source=api-prod
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H
    cvss-score: 6.5
    cve-id: CVE-2018-1000510
  metadata:
    fofa-query: "wp-content/plugins/wp-image-zoooom/"
    google-query: inurl:"/wp-content/plugins/wp-image-zoooom/"
    shodan-query: 'vuln:CVE-2018-1000510'
  tags: cve,wordpress,wp-plugin,wp-image-zoooom,medium

http:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}/wp-content/plugins/wp-image-zoooom/readme.txt"

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        internal: true
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "wp-image-zoooom"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '<= 1.23')