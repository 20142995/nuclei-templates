id: CVE-2019-10673

info:
  name: >
    Ultimate Member <= 2.0.39 - Cross-Site Request Forgery
  author: topscoder
  severity: high
  description: >
    A CSRF vulnerability in a logged-in user's profile edit form in the Ultimate Member plugin before 2.0.40 for WordPress allows attackers to become admin and subsequently extract sensitive information and execute arbitrary code. This occurs because the attacker can change the e-mail address in the administrator profile, and then the attacker is able to reset the administrator password using the WordPress "password forget" form.
  reference:
    - https://github.com/topscoder/nuclei-wordfence-cve
    - https://www.wordfence.com/threat-intel/vulnerabilities/id/fa0881ab-d731-4e57-8323-c49b9306bf50?source=api-prod
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    cvss-score: 8.8
    cve-id: CVE-2019-10673
  metadata:
    fofa-query: "wp-content/plugins/ultimate-member/"
    google-query: inurl:"/wp-content/plugins/ultimate-member/"
    shodan-query: 'vuln:CVE-2019-10673'
  tags: cve,wordpress,wp-plugin,ultimate-member,high

http:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}/wp-content/plugins/ultimate-member/readme.txt"

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        internal: true
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "ultimate-member"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '< 2.0.40')