id: CVE-2023-27035

info:
  name: Obsidian Canvas Sensitive Web API Access
  author: ProjectDiscoveryAI
  severity: medium
  description: Obsidian Canvas 1.1.9 allows remote attackers to send desktop notifications, record user audio, and access sensitive WEB APIs via embedded websites on the canvas page without user permission.
  impact: |
    Allows unauthorized access to sensitive data through the web API
  remediation: |
    Implement proper access controls and authentication mechanisms for the web API in Obsidian Canvas
  reference:
    - https://forum.obsidian.md/t/obsidian-release-v1-1-14-insider-build/54595
    - https://github.com/fivex3/CVE-2023-27035
    - https://github.com/nomi-sec/PoC-in-GitHub
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:N
    cvss-score: 6.5
    cve-id: CVE-2023-27035
    cwe-id: CWE-276
    epss-score: 0.00318
    epss-percentile: 0.71236
    cpe: cpe:2.3:a:obsidian:obsidian:1.1.9:*:*:*:*:*:*:*
  metadata:
    vendor: obsidian
    product: obsidian
    shodan-query: http.html:"Plesk Obsidian"
    fofa-query: title="Plesk Obsidian"
    google-query: intitle:"plesk obsidian"

http:
  - method: GET
    path:
      - "{{BaseURL}}/files/poc1.html"
      - "{{BaseURL}}/files/poc2.html"

    matchers:
      - type: word
        words:
          - "getUserMedia"
          - "Notification.requestPermission"
        part: body
        condition: or
