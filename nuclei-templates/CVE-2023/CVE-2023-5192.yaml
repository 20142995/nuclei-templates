id: CVE-2023-5192

info:
  name: GraphQL Introspection Enabled on demo.pimcore.fun
  author: ProjectDiscoveryAI
  severity: medium
  description: Introspection is enabled on the demo.pimcore.fun GraphQL endpoint, allowing attackers to run introspection queries and obtain the GraphQL schema, exposing the API's attack surface.
  impact: |
    Potential exposure of sensitive schema details leading to information disclosure.
  remediation: |
    Disable GraphQL introspection or restrict access to authorized users only.
  reference:
    - https://huntr.dev/bounties/65c954f2-79c3-4672-8846-a3035e7a1db7
    - https://www.apollographql.com/blog/graphql/security/why-you-should-disable-graphql-introspection-in-production/
    - https://github.com/fkie-cad/nvd-json-data-feeds
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:L
    cvss-score: 6.5
    cve-id: CVE-2023-5192
    cwe-id: CWE-1049
    epss-score: 0.00075
    epss-percentile: 0.34153
    cpe: cpe:2.3:a:pimcore:core:*:*:*:*:*:*:*:*
  metadata:
    vendor: pimcore
    product: core
  tags: huntr

http:
  - method: POST
    path:
      - "{{BaseURL}}/pimcore-datahub-webservices/explorer/assets"

    headers:
      Content-Type: application/json

    body: |
      {
        "__schema": {
          "queryType": {
            "name": ""
          },
          "mutationType": {
            "name": ""
          },
          "subscriptionType": {
            "name": ""
          },
          "types": {
            "name": "FullType"
          },
          "directives": {
            "name": "",
            "description": "",
            "locations": "",
            "args": {
              "name": "InputValue"
            }
          }
        }
      }
    matchers:
      - type: word
        words:
          - "FullType"
          - "InputValue"
        part: body
