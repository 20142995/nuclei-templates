id: CVE-2023-48831

info:
  name: Missing Rate Limiting in Availability Booking Calendar 5.0
  author: ProjectDiscoveryAI
  severity: high
  description: A lack of rate limiting in pjActionAJaxSend in Availability Booking Calendar 5.0 allows attackers to cause resource exhaustion.
  impact: |
    Successful exploitation could lead to unauthorized access to the system or denial of service.
  remediation: |
    Implement rate limiting mechanisms to prevent brute force attacks and enhance system security.
  reference:
    - http://packetstormsecurity.com/files/176039
    - https://www.phpjabbers.com/availability-booking-calendar/#sectionDemo
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    cvss-score: 7.5
    cve-id: CVE-2023-48831
    cwe-id: CWE-400,CWE-770
    epss-score: 0.00062
    epss-percentile: 0.28035
    cpe: cpe:2.3:a:phpjabbers:availability_booking_calendar:5.0:*:*:*:*:*:*:*
  metadata:
    vendor: phpjabbers
    product: availability_booking_calendar
  tags: packetstorm

http:
  - method: POST
    path:
      - "{{BaseURL}}/1701526313_862/index.php?controller=pjBaseOptions&action=pjActionAjaxSend"

    headers:
      Content-Type: application/x-www-form-urlencoded; charset=UTF-8
      X-Requested-With: XMLHttpRequest

    body: |
      options_update=1&next_action=pjActionEmailSettings&email=test1%40test.com&value-enum-o_send_email=mail%7Csmtp%3A%3Amail&value-string-o_smtp_host=&value-int-o_smtp_port=25&value-string-o_smtp_user=&value-string-o_smtp_pass=&value-enum-o_smtp_secure=none%7Cssl%7Ctls%3A%3Anone&value-enum-o_smtp_auth=LOGIN%7CPLAIN%3A%3ALOGIN&o_smtp_seder_email_same_as_username=on&value-enum-o_smtp_seder_email_same_as_username=Yes%7CNo%3A%3AYes&value-string-o_sender_email=test%40test.com&value-string-o_sender_name=Test
    matchers:
      - type: status
        status:
          - 200
