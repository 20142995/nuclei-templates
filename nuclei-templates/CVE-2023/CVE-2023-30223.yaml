id: CVE-2023-30223

info:
  name: Broken Authentication in 4D SAS 4D Server
  author: ProjectDiscoveryAI
  severity: high
  description: |
    A broken authentication vulnerability in 4D SAS 4D Server software v17, v18, v19 R7, and earlier allows attackers to send crafted TCP packets containing requests to perform arbitrary actions.
  reference:
    - https://www.infigo.is/en/insights/42/information-disclosure-and-broken-authentication-in-4d-sas-4d-server/
    - https://blog.4d.com/security-bulletin-two-cves-and-how-to-stay-secure/
    - https://packetstormsecurity.com
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    cvss-score: 7.5
    cve-id: CVE-2023-30223
    cwe-id: CWE-287
    epss-score: 0.00787
    epss-percentile: 0.8211
    cpe: cpe:2.3:a:4d:server:17:*:*:*:*:*:*:*
  metadata:
    vendor: 4d
    product: server
    shodan-query: title:"icewarp"
    fofa-query: title="gotify"
    google-query: intitle:"gotify"
  impact: |
    Successful exploitation could lead to unauthorized access to sensitive information.
  remediation: |
    Apply the vendor-supplied patch or update to the latest version to mitigate the vulnerability.

tcp:
  - inputs:
      - data: "crafted TCP packet data here"
    host:
      - "{{Hostname}}"
    port: 19812 # Example port, should be the actual port used by 4D Server
    read-size: 1024
    matchers:
      - type: word
        words:
          - "specific error or success message indicating broken authentication"
        part: data