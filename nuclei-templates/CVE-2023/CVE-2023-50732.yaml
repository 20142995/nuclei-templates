id: CVE-2023-50732

info:
  name: XWiki Velocity Script Execution Vulnerability
  author: ProjectDiscoveryAI
  severity: high
  description: Unauthorized Velocity script execution through document tree in XWiki.
  impact: |
    Remote code execution leading to potential data leakage or system compromise.
  remediation: |
    Apply the latest security patches provided by XWiki to mitigate the vulnerability.
  reference:
    - https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-p5f8-qf24-24cj
    - https://jira.xwiki.org/browse/XWIKI-20625
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:L
    cvss-score: 8.3
    cve-id: CVE-2023-50732
    cwe-id: CWE-863
    epss-score: 0.00106
    epss-percentile: 0.44537
    cpe: cpe:2.3:a:xwiki:xwiki:*:*:*:*:*:*:*:*
  metadata:
    vendor: xwiki
    product: xwiki
    shodan-query: html:"data-xwiki-reference"
    fofa-query: body="data-xwiki-reference"

http:
  - method: GET
    path:
      - "{{BaseURL}}/xwiki/bin/view/Nasty%20Title/WebHome"

    matchers:
      - type: word
        words:
          - "/xwiki/bin/get/Nasty%20Title/WebHome"
        part: body
