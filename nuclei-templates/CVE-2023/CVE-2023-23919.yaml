id: CVE-2023-23919

info:
  name: Node.js OpenSSL Error Stack Not Cleared Vulnerability
  author: ProjectDiscoveryAI
  severity: high
  description: |
    A cryptographic vulnerability exists in Node.js versions prior to 19.2.0, 18.14.1, 16.19.1, and 14.21.3 where the OpenSSL error stack is not cleared after operations that may set it. This can lead to false positive errors during subsequent cryptographic operations on the same thread, potentially causing a denial of service.
  impact: |
    An attacker could exploit this vulnerability to potentially leak sensitive information or execute arbitrary code.
  remediation: |
    Upgrade Node.js to a version that includes the fix for CVE-2023-23919.
  reference:
    - https://security.netapp.com/advisory/ntap-20230316-0008/
    - https://github.com/ARPSyndicate/cvemon
    - https://github.com/chnzzh/OpenSSL-CVE-lib
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    cvss-score: 7.5
    cve-id: CVE-2023-23919
    cwe-id: CWE-310,NVD-CWE-Other
    epss-score: 0.00076
    epss-percentile: 0.34504
    cpe: cpe:2.3:a:nodejs:node.js:*:*:*:*:-:*:*:*
  metadata:
    vendor: nodejs
    product: node.js
    shodan-query: cpe:"cpe:2.3:a:nodejs:node.js"

http:
  - method: GET
    path:
      - "{{BaseURL}}/path-that-triggers-crypto-operation"

    matchers:
      - type: word
        words:
          - "error from previous failing call"
        part: body
