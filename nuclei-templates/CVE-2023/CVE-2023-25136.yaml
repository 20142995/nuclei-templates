id: CVE-2023-25136

info:
  name: OpenSSH Pre-Auth Double Free
  author: DhiyaneshDK
  severity: critical
  description: |
    OpenSSH server (sshd) 9.1 introduced a double-free vulnerability during options.kex_algorithms handling. This is fixed in OpenSSH 9.2. The double free can be leveraged, by an unauthenticated remote attacker in the default configuration, to jump to any location in the sshd address space. One third-party report states \"remote code execution is theoretically possible.
  reference:
    - https://jfrog.com/blog/openssh-pre-auth-double-free-cve-2023-25136-writeup-and-proof-of-concept/
    - https://github.com/adhikara13/CVE-2023-25136
    - https://www.watchguard.com/wgrd-psirt/advisory/wgsa-2023-00001
    - https://blog.qualys.com/vulnerabilities-threat-research/2023/02/03/cve-2023-25136-pre-auth-double-free-vulnerability-in-openssh-server-9-1
  metadata:
    shodan-query: "OpenSSH_9.1"
    verified: true
  tags: js,ssh,double-free,network

javascript:
  - pre-condition: |
      var m = require("nuclei/ssh");
      var c = m.SSHClient();
      var response = c.ConnectSSHInfoMode(Host, Port);
      response["UserAuth"].includes("password")

    code: |
      var m = require("nuclei/ssh");
      var c = m.SSHClient();
      c.Connect(Host,Port,Username,Password);

    args:
      Host: "{{Host}}"
      Port: "22"
      Username: " "
      Password: " "

    matchers:
      - type: dsl
        dsl:
          - "response == true"
          - "success == true"
        condition: and
