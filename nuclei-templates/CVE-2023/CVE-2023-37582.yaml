id: CVE-2023-37582

info:
  name: RocketMQ Broker - Remote Code Execution
  author: unknown
  severity: critical
  description: For RocketMQ versions 5.1.0 and below, under certain conditions, there is a risk of remote command execution. 
  reference: https://github.com/Le1a/CVE-2023-33246

tcp:
  - inputs:
      - data: "{{hex_decode('000000d0000000b27B22636F6465223A3331382C226578744669656C6473223A7B224163636573734B6579223A22726F636B65746D7132222C225369676E6174757265223A2263474A6A713146424D2B3455426C52734E444E746B3055396E44303D227D2C22666C6167223A302C226C616E6775616765223A224A415641222C226F7061717565223A302C2273657269616C697A655479706543757272656E74525043223A224A534F4E222C2276657273696F6E223A3433357D746869735F69735F6B65793D746869735F69735F76616C75650a')}}"
    host:
      - "{{Hostname}}"
    matchers:
      - type: regex
        regex:
          #"434" "V5_1_0"
          - '"version":(0|[1-9]d{0,2}|4[0-2]d|43[0-4])'