id: CVE-2023-23924

info:
  name: Dompdf SVG Parsing URI Validation Bypass
  author: ProjectDiscoveryAI
  severity: critical
  description: |
    Dompdf is an HTML to PDF converter. The URI validation on dompdf 2.0.1 can be bypassed on SVG parsing by passing `<image>` tags with uppercase letters. This may lead to arbitrary object unserialize on PHP < 8, through the `phar` URL wrapper. An attacker can exploit the vulnerability to call arbitrary URL with arbitrary protocols, if they can provide a SVG file to dompdf. In PHP versions before 8.0.0, it leads to arbitrary unserialize, that will lead to the very least to an arbitrary file deletion and even remote code execution, depending on classes that are available.
  impact: |
    An attacker can exploit this vulnerability to bypass URI validation and potentially execute malicious code.
  remediation: |
    Upgrade Dompdf to the latest version to mitigate the vulnerability.
  reference:
    - https://github.com/dompdf/dompdf/security/advisories/GHSA-3cw5-7cxw-v5qg
    - https://github.com/dompdf/dompdf/releases/tag/v2.0.2
    - https://github.com/k0mi-tg/CVE-POC
    - https://github.com/manas3c/CVE-POC
    - https://github.com/motikan2010/CVE-2023-23924
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:L/A:H
    cvss-score: 10
    cve-id: CVE-2023-23924
    cwe-id: CWE-551,CWE-863
    epss-score: 0.02569
    epss-percentile: 0.90616
    cpe: cpe:2.3:a:dompdf_project:dompdf:2.0.1:*:*:*:*:*:*:*
  metadata:
    vendor: dompdf_project
    product: dompdf
    fofa-query: title="dompdf - the php 5 html to pdf converter"

http:
  - method: GET
    path:
      - "{{BaseURL}}/path-to-vulnerable-endpoint"

    matchers:
      - type: word
        words:
          - "specific-error-indicating-unserialize-issue"
        part: body
