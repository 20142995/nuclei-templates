id: CVE-2023-49052

info:
  name: Microweber CMS v2.0.4 Unrestricted File Upload Vulnerability
  author: ProjectDiscoveryAI
  severity: high
  description: File Upload vulnerability in Microweber v.2.0.4 allows a remote attacker to execute arbitrary code via a crafted script to the file upload function in the created forms component.
  impact: |
    Successful exploitation could result in unauthorized access, data leakage, or complete system compromise.
  remediation: |
    Apply the vendor-supplied patch or upgrade to a version that restricts file uploads to prevent unauthorized access.
  reference: |-
    https://github.com/Cyber-Wo0dy/CVE-2023-49052
    https://github.com/nomi-sec/PoC-in-GitHub
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    cvss-score: 8.8
    cve-id: CVE-2023-49052
    cwe-id: CWE-434
    epss-score: 0.00718
    epss-percentile: 0.81144
    cpe: cpe:2.3:a:microweber:microweber:2.0.4:*:*:*:*:*:*:*
  metadata:
    vendor: microweber
    product: microweber
    shodan-query: http.favicon.hash:780351152
    fofa-query:
      - body="microweber"
      - icon_hash=780351152

http:
  - method: GET
    path:
      - "{{BaseURL}}/userfiles/media/default/contact_form/poc.htm"

    matchers:
      - type: word
        words:
          - "<svg></svg><html><head></head><body><h1>Hi!</h1><script>alert(document.cookie)</script></body></html>"
        part: body
