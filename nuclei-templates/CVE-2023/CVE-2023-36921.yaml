id: CVE-2023-36921

info:
  name: SAP Solution Manager (Diagnostics agent) Header Tampering
  author: ProjectDiscoveryAI
  severity: high
  description: SAP Solution Manager (Diagnostics agent) - version 7.20, allows an attacker to tamper with headers in a client request, leading to poisoned content being served.
  impact: |
    An attacker can manipulate headers to perform various attacks.
  remediation: |
    Apply the necessary patches provided by SAP to mitigate CVE-2023-36921.
  reference:
    - https://me.sap.com/notes/3348145
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:N/A:L
    cvss-score: 7.2
    cve-id: CVE-2023-36921
    cwe-id: CWE-644,CWE-116
    epss-score: 0.00078
    epss-percentile: 0.35515
    cpe: cpe:2.3:a:sap:solution_manager:7.20:*:*:*:*:*:*:*
  metadata:
    vendor: sap
    product: solution_manager

http:
  - method: GET
    path:
      - "{{BaseURL}}/path/to/diagnostic/agent"

    headers:
      X-Custom-Header: "tampered-header-value"
    matchers:
      - type: word
        words:
          - "specific-indicator-of-poisoned-response"
        part: body
