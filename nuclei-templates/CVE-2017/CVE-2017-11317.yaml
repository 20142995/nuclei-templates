id: CVE-2017-11317

info:
  name: Telerik UI for ASP.NET AJAX Inadequate Encryption Strength
  author: uomogrande
  severity: critical
  description: |
    Telerik.Web.UI in Progress Telerik UI for ASP.NET AJAX before R1 2017 and R2 before R2 2017 SP2 uses weak RadAsyncUpload encryption, which allows remote attackers to perform arbitrary file uploads or execute arbitrary code.
  reference:
    - https://packetstormsecurity.com/files/159653/Telerik-UI-ASP.NET-AJAX-RadAsyncUpload-Deserialization.html
    - http://www.telerik.com/support/kb/aspnet-ajax/upload-%28async%29/details/unrestricted-file-upload
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-11317
    - https://nvd.nist.gov/vuln/detail/CVE-2017-11317
    - https://www.exploit-db.com/exploits/43874
  metadata:
    verified: true
    shodan-query: html:"/Telerik.Web.UI.WebResource.axd"
  tags: cve,cve2017,telerik

requests:
  - raw:
      - |
        GET /Telerik.Web.UI.WebResource.axd?type=rau HTTP/1.1
        Host: {{Hostname}}
        Accept: */*

      - |
        GET /Telerik.Web.UI.WebResource.axd?_TSM_CombinedScripts_=;;System.Web.Extensions,%20Version=4.0.0.0,%20Culture=neutral,%20PublicKeyToken=31bf3856ad364e35:de-DE:db3d9eb3-6d72-4959-b303-32b61119a4a8:ea597d4b:b25378d2 HTTP/1.1
        Host: {{Hostname}}
        Accept: */*

    cookie-reuse: true
    req-condition: true
    matchers-condition: and
    redirects: true
    max-redirects: 2
    matchers:
      - type: dsl
        dsl:
          - "contains((body_1),'RadAsyncUpload handler is registered succesfully') && contains((body_2),'MicrosoftAjax') && status_code_1==200 && status_code_2==200"
      - type: regex
        part: header
        # accept 2011 - Jun 2017 ( fixed version 2017.2.711 was released July 11, 2017 )
        regex:
          - 'Last-Modified: [a-zA-Z]+, [0-9]+ (([a-zA-Z]+ 201[0-6])|((Jan|Feb|Mar|Apr|May|Jun) 2017))'
        condition: and
